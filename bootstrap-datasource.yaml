  #------------------------------------------
  # Actual Bootstrap Keys
  #
  # Defaults variable values are injected at load time
  #------------------------------------------
  name: datasource-defaults

  processes:
    objects:
      {{ .Iterate config }}
      runtime: datasource-objects
      connections:
        grpcconn:
          uri: xds://default.cells.com/cells
          services:
            - filter: "{{ .Name }} ~= pydio.grpc..*"
        config:
          uri: xds://default.cells.com/cells
        registry:
          uri: xds://default.cells.com/cells
      listeners:
        grpcobjectss3:
          type: tcp
          bind: 0.0.0.0
          port: 0
      servers:
        grpcobjectss3:
          type: grpc
          listener: grpcobjectss3
          services:
            - filter: "{{ .Name }} ~= pydio.grpc.data.objects.s3"
      env:
        DATASOURCE: "s3"

    index-s3:
      runtime: datasource-index
      connections:
        grpcconn:
          uri: xds://default.cells.com/cells
          services:
            - filter: "{{ .Name }} ~= pydio.grpc..*"
        config:
          uri: xds://default.cells.com/cells
        registry:
          uri: xds://default.cells.com/cells
      listeners:
        grpcindexs3:
          type: tcp
          bind: 0.0.0.0
          port: 0
      servers:
        grpcindexs3:
          type: grpc
          listener: grpcindexs3
          services:
            - filter: "{{ .Name }} ~= pydio.grpc.data.index.s3 or {{ .Name }} ~= pydio.grpc.data.sync.s3"
      env:
        DATASOURCE: "s3"
      services:
        pydio.grpc.data.index.s3:
          storages:
            main:
              - type: sql
                prefix: data_index_s3_