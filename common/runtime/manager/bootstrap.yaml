#------------------------------------------
# Actual Bootstrap Keys
#
# Defaults variable values are injected at load time
#------------------------------------------
name: main
connections: *connections
telemetry:
  loggers:
    - encoding: console
      level: info
      outputs:
        - stdout:///
    - encoding: json
      level: info
      outputs:
        - file://{{{{ .ApplicationWorkingDir }}}}/logs{{ tenantPathWithBlank .Tenant "default" }}/pydio.log
        - service:///?service=pydio.grpc.log
    - encoding: json
      level: error
      outputs:
        - file://{{{{ .ApplicationWorkingDir }}}}/logs{{ tenantPathWithBlank .Tenant "default" }}/pydio_err.log
processes:
  all:
    runtime: main
    connections:
      grpcconn:
        uri: 0.0.0.0:8030
        services:
          - filter: "{{ .Name }} ~= pydio.grpc..*"
    listeners:
      grpcall:
        type: tcp
        bind: 0.0.0.0
        port: 8030
    servers:
      grpc:
        type: grpc
        listener: grpcall
        services:
          - filter: "{{ .Name }} ~= pydio\\.grpc\\..*"
      caddy:
        type: caddy
        services:
          - filter: "{{ .Name }} ~= pydio\\.web\\..* or {{ .Name }} ~= pydio\\.rest\\..* or {{ .Name }} ~= pydio\\.gateway\\.*"
          - filter: "{{ .Name }} !~= pydio\\.web\\.sites"
    env: *env
    storages: *storages
    services: *services
    queues: *queues
    caches: *caches