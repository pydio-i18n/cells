(()=>{var t={38609:()=>{},28566:t=>{"use strict";t.exports=require("create-react-class")},62610:t=>{"use strict";t.exports=require("pydio/http/resources-manager")},16689:t=>{"use strict";t.exports=require("react")}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";o.r(n),o.d(n,{BookmarkButton:()=>D,Callbacks:()=>L,MaskWsButton:()=>V,Navigation:()=>G,PasswordDialog:()=>I,SplashDialog:()=>P});var t=o(38609),e=o.n(t),r=window,i=r.pydio,a=i.MessageHash;const s=require("pydio");var c=o.n(s);const u=require("pydio/http/api");var l=o.n(u);const d=require("cells-sdk");function p(t,e){var o=c().getInstance(),n="true"===t.getMetadata().get("bookmark"),r=t.getMetadata().get("uuid"),i=o.user.id,a=new d.UserMetaServiceApi(l().getRestClient()),s=new d.IdmUpdateUserMetaRequest;if(n){var u=new d.IdmSearchUserMetaRequest;return u.NodeUuids=[r],u.Namespace="bookmark",a.searchUserMeta(u).then((function(t){t.Metadatas&&t.Metadatas.length&&(s.Operation=d.UpdateUserMetaRequestUserMetaOp.constructFromObject("DELETE"),s.MetaDatas=t.Metadatas,a.updateUserMeta(s).then((function(){o.notify("reload-bookmarks")})))}))}s.Operation=d.UpdateUserMetaRequestUserMetaOp.constructFromObject("PUT");var p=new d.IdmUserMeta;return p.NodeUuid=r,p.Namespace="bookmark",p.JsonValue='"true"',p.Policies=[d.ServiceResourcePolicy.constructFromObject({Resource:r,Action:"OWNER",Subject:"user:"+i,Effect:"allow"}),d.ServiceResourcePolicy.constructFromObject({Resource:r,Action:"READ",Subject:"user:"+i,Effect:"allow"}),d.ServiceResourcePolicy.constructFromObject({Resource:r,Action:"WRITE",Subject:"user:"+i,Effect:"allow"})],s.MetaDatas=[p],a.updateUserMeta(s).then((function(){o.notify("reload-bookmarks")}))}var f=o(16689),m=o.n(f),y=o(28566),h=o.n(y);const b=require("material-ui"),g=require("react-markdown");var v=o.n(g),k=c().requireLib("boot"),w=k.ActionDialogMixin,S=k.SubmitButtonProviderMixin,O=k.Loader;const P=h()({displayName:"SplashDialog",mixins:[w,S],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogIsModal:!1,dialogPadding:!1,dialogScrollBody:!0}},submit:function(){this.dismiss()},openDocs:function(){open("https://pydio.com/en/docs")},openForum:function(){open("https://forum.pydio.com")},openGithub:function(){open("https://github.com/pydio/cells/issues")},getInitialState:function(){return{aboutContent:null}},componentDidMount:function(){var t=this;window.fetch("plug/gui.ajax/credits.md",{method:"GET",credentials:"same-origin"}).then((function(e){e.text().then((function(e){t.setState({aboutContent:e})}))}))},render:function(){var t;return t=this.state.aboutContent?m().createElement(v(),{source:this.state.aboutContent}):m().createElement(O,{style:{minHeight:200}}),m().createElement("div",{style:{height:"100%",width:"100%"}},m().createElement(b.Card,{style:{borderRadius:0}},m().createElement(b.CardTitle,{title:pydio.Parameters.get("backend").PackageLabel}),m().createElement(b.Divider,null),m().createElement(b.CardActions,{style:{display:"flex",alignItems:"center"}},m().createElement(b.FlatButton,{primary:!0,icon:m().createElement(b.FontIcon,{className:"mdi mdi-book-variant"}),label:"Docs",onClick:this.openDocs}),m().createElement(b.FlatButton,{primary:!0,icon:m().createElement(b.FontIcon,{className:"mdi mdi-slack"}),label:"Forums",onClick:this.openForum}),m().createElement(b.FlatButton,{primary:!0,icon:m().createElement(b.FontIcon,{className:"mdi mdi-github-box"}),label:"Issues",onClick:this.openGithub}),m().createElement("span",{style:{flex:1}}),m().createElement(b.IconButton,{style:{width:40,height:40,padding:8},iconStyle:{color:"#FF786A"},iconClassName:"icomoon-cells",onClick:function(){open("https://pydio.com/?utm_source=cells-about")},tooltip:"Pydio.com"}),m().createElement(b.IconButton,{style:{width:40,height:40,padding:8},iconStyle:{color:"#3b5998"},iconClassName:"mdi mdi-facebook-box",onClick:function(){open("https://facebook.com/Pydio")},tooltip:"@Pydio"}),m().createElement(b.IconButton,{style:{width:40,height:40,padding:8},iconStyle:{color:"#00acee"},iconClassName:"mdi mdi-twitter-box",onClick:function(){open("https://twitter.com/pydio")},tooltip:"@pydio"})),m().createElement(b.Divider,null),m().createElement(b.CardText,{className:"credits-md"},t),m().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n.credits-md h4 {\n    padding-top: 0;\n}\n\n.credits-md h5 {\n    font-weight: 500;\n}\n\n.credits-md ul {\n    padding-left: 20px;\n    padding-bottom: 20px;\n}\n\n.credits-md li {\n    list-style-type: square;\n    line-height: 1.6em;\n}\n\n.credits-md a {\n    color: #607D8B;\n    font-weight: 500;\n}\n"}})))}});var C=o(16689),E=o(28566),j=o(62610).requireLib("boot"),M=j.ActionDialogMixin,x=j.AsyncComponent;const I=E({displayName:"PasswordDialog",mixins:[M],getInitialState:function(){return{passValid:!1}},getDefaultProps:function(){return{dialogTitle:c().getMessages()[194],dialogIsModal:!0,dialogSize:"sm"}},getButtons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(this._updater=e);var o=[];return this.props.locked||o.push(C.createElement(b.FlatButton,{label:this.props.pydio.MessageHash[54],onClick:function(){return t.dismiss()}})),o.push(C.createElement(b.FlatButton,{label:this.props.pydio.MessageHash[48],onClick:this.submit.bind(this),disabled:!this.state.passValid})),o},submit:function(){if(!this.state.passValid)return!1;this.refs.passwordForm.instance.post(function(t){t&&this.dismiss()}.bind(this))},passValidStatusChange:function(t){var e=this;this.setState({passValid:t},(function(){e._updater(e.getButtons())}))},render:function(){return C.createElement(x,{namespace:"UserAccount",componentName:"PasswordForm",pydio:this.props.pydio,ref:"passwordForm",onValidStatusChange:this.passValidStatusChange})}});function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function N(){return N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},N.apply(this,arguments)}function R(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==_(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===_(r)?r:String(r)),n)}var r}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}const D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(a,t);var e,o,n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=F(n);if(r){var o=F(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).state=e.valueFromNodes(t.nodes),e}return e=a,o=[{key:"valueFromNodes",value:function(){var t,e=void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(o){var n="true"===o.getMetadata().get("bookmark");void 0!==e&&n!==e&&(t=!0),e=n})),{value:e,mixed:t}}},{key:"updateValue",value:function(t){var e=this,o=this.props.nodes;this.setState({saving:!0});var n=[];o.forEach((function(e){var o="true"===e.getMetadata().get("bookmark");if(t!==o){n.push(p(e));var r=e.getMetadata().get("overlay_class")||"";if(t){e.getMetadata().set("bookmark","true");var i=r.replace("mdi mdi-star","").split(",");i.push("mdi mdi-star"),e.getMetadata().set("overlay_class",i.join(","))}else e.getMetadata().delete("bookmark"),e.getMetadata().set("overlay_class",r.replace("mdi mdi-star",""));e.notify("node_replaced")}})),Promise.all(n).then((function(){window.setTimeout((function(){e.setState({saving:!1})}),250),e.setState(e.valueFromNodes(o))})).catch((function(){e.setState({saving:!1})}))}},{key:"render",value:function(){var t,e,o,n,r=this,i=this.props.styles,a=this.state,s=a.value,u=a.mixed,l=a.saving,d=c().getInstance().MessageHash;return u?(t="star-half",e=!0,o=d["bookmark.button.tip.mixed"]):s?(t="star",e=!1,o=d["bookmark.button.tip.remove"]):(t="star-outline",e=!0,o=d["bookmark.button.tip.add"]),l&&(t="star-circle",o=d["bookmark.button.tip.saving"],n=!0),m().createElement(b.IconButton,N({disabled:n,iconClassName:"mdi mdi-"+t,tooltip:o,onClick:function(){return r.updateValue(e)}},i))}}],o&&R(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),a}(m().Component);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function A(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==B(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===B(r)?r:String(r)),n)}var r}function q(t,e){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},q(t,e)}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}var V=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q(t,e)}(a,t);var e,o,n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=H(n);if(r){var o=H(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return e=a,(o=[{key:"render",value:function(){var t=this.props,e=t.pydio,o=t.workspaceId,n=t.iconStyle,r=t.style;if(!e.user)return null;var i=e.user.getGUIPreference("MaskedWorkspaces")||[],a=i.indexOf&&i.indexOf(o)>-1;return m().createElement(b.IconButton,{iconClassName:"mdi mdi-playlist-"+(a?"check":"remove"),style:r,iconStyle:n,tooltip:e.MessageHash["ajax_gui.wslist.action."+(a?"unmask":"mask")],onClick:function(){var t,n=function(t){if(Array.isArray(t))return T(t)}(t=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?T(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();a?n=i.filter((function(t){return t!==o})):n.push(o),e.user.setGUIPreference("MaskedWorkspaces",n,!0)}})}}])&&A(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),a}(m().Component),L={switchLanguage:e(),changePass:function(){i.UI.openComponentInModal("PydioCoreActions","PasswordDialog",{locked:i.user&&"pass_change"===i.user.lock})},toggleBookmark:function(){var t=i.getContextHolder();!t.isEmpty()&&t.isUnique()&&p(t.getUniqueNode())},toggleBookmarkNode:p,activateDesktopNotifications:function(){r.Notification?(alert(a["notification_center.12"]),r.Notification.requestPermission((function(t){["default","granted","denied"].indexOf(t)}))):r.alert(a["notification_center.13"])}},G={splash:function(){i.UI.openComponentInModal("PydioCoreActions","SplashDialog")},up:function(){i.fireContextUp()},refresh:function(){i.getContextHolder().getContextNode()===i.getContextHolder().getSearchNode()?i.getContextHolder().getSearchNode().notify("reload_search"):i.fireContextRefresh()},externalSelection:function(){var t=i.getUserSelection();if(t.isUnique()&&!t.hasDir()){var e=t.getUniqueFileName(),o=i.getController().selectorData;if("ckeditor"==o.get("type")){var n=o.get("data");if(n.CKEditorFuncNum){var a=e;n.relative_path&&(a=n.relative_path+e),r.opener.CKEDITOR.tools.callFunction(n.CKEditorFuncNum,a),r.close()}}}},openGoPro:function(){r.open("https://pydio.com/en/go-pro?referrer=settings")},switchToSettings:function(){i.repositoryId&&"settings"===i.repositoryId||i.triggerRepositoryChange("settings")},switchToHomepage:function(){i.repositoryId&&"homepage"===i.repositoryId||i.triggerRepositoryChange("homepage")}}})(),window.PydioCoreActions=n})();