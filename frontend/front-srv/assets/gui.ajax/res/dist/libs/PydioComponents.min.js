/*! For license information please see PydioComponents.min.js.LICENSE.txt */
(()=>{var e,t,n,r,o={38682:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(76859),o=n(35438),i=n(27125),a=n(60634),s=n(22807),c=n(36999),l=n(64873),u=function(e,t,n){for(var r=0,i=0;r=i,i=(0,o.fj)(),38===r&&12===i&&(t[n]=1),!(0,o.r)(i);)(0,o.lp)();return(0,o.tP)(e,o.FK)},d=new WeakMap,p=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||d.get(n))&&!r){d.set(e,!0);for(var a=[],s=function(e,t){return(0,o.cE)(function(e,t){var n=-1,r=44;do{switch((0,o.r)(r)){case 0:38===r&&12===(0,o.fj)()&&(t[n]=1),e[n]+=u(o.FK-1,t,n);break;case 2:e[n]+=(0,o.iF)(r);break;case 4:if(44===r){e[++n]=58===(0,o.fj)()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=(0,i.Dp)(r)}}while(r=(0,o.lp)());return e}((0,o.un)(e),t))}(t,a),c=n.props,l=0,p=0;l<s.length;l++)for(var f=0;f<c.length;f++,p++)e.props[p]=a[l]?s[l].replace(/&\f/g,c[f]):c[f]+" "+s[l]}}},f=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function h(e,t){switch((0,i.vp)(e,t)){case 5103:return a.G$+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return a.G$+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return a.G$+e+a.uj+e+a.MS+e+e;case 6828:case 4268:return a.G$+e+a.MS+e+e;case 6165:return a.G$+e+a.MS+"flex-"+e+e;case 5187:return a.G$+e+(0,i.gx)(e,/(\w+).+(:[^]+)/,a.G$+"box-$1$2"+a.MS+"flex-$1$2")+e;case 5443:return a.G$+e+a.MS+"flex-item-"+(0,i.gx)(e,/flex-|-self/,"")+e;case 4675:return a.G$+e+a.MS+"flex-line-pack"+(0,i.gx)(e,/align-content|flex-|-self/,"")+e;case 5548:return a.G$+e+a.MS+(0,i.gx)(e,"shrink","negative")+e;case 5292:return a.G$+e+a.MS+(0,i.gx)(e,"basis","preferred-size")+e;case 6060:return a.G$+"box-"+(0,i.gx)(e,"-grow","")+a.G$+e+a.MS+(0,i.gx)(e,"grow","positive")+e;case 4554:return a.G$+(0,i.gx)(e,/([^-])(transform)/g,"$1"+a.G$+"$2")+e;case 6187:return(0,i.gx)((0,i.gx)((0,i.gx)(e,/(zoom-|grab)/,a.G$+"$1"),/(image-set)/,a.G$+"$1"),e,"")+e;case 5495:case 3959:return(0,i.gx)(e,/(image-set\([^]*)/,a.G$+"$1$`$1");case 4968:return(0,i.gx)((0,i.gx)(e,/(.+:)(flex-)?(.*)/,a.G$+"box-pack:$3"+a.MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+a.G$+e+e;case 4095:case 3583:case 4068:case 2532:return(0,i.gx)(e,/(.+)-inline(.+)/,a.G$+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if((0,i.to)(e)-1-t>6)switch((0,i.uO)(e,t+1)){case 109:if(45!==(0,i.uO)(e,t+4))break;case 102:return(0,i.gx)(e,/(.+:)(.+)-([^]+)/,"$1"+a.G$+"$2-$3$1"+a.uj+(108==(0,i.uO)(e,t+3)?"$3":"$2-$3"))+e;case 115:return~(0,i.Cw)(e,"stretch")?h((0,i.gx)(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==(0,i.uO)(e,t+1))break;case 6444:switch((0,i.uO)(e,(0,i.to)(e)-3-(~(0,i.Cw)(e,"!important")&&10))){case 107:return(0,i.gx)(e,":",":"+a.G$)+e;case 101:return(0,i.gx)(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+a.G$+(45===(0,i.uO)(e,14)?"inline-":"")+"box$3$1"+a.G$+"$2$3$1"+a.MS+"$2box$3")+e}break;case 5936:switch((0,i.uO)(e,t+11)){case 114:return a.G$+e+a.MS+(0,i.gx)(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return a.G$+e+a.MS+(0,i.gx)(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return a.G$+e+a.MS+(0,i.gx)(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return a.G$+e+a.MS+e+e}return e}var m=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case a.h5:e.return=h(e.value,e.length);break;case a.lK:return(0,s.q)([(0,o.JG)(e,{value:(0,i.gx)(e.value,"@","@"+a.G$)})],r);case a.Fr:if(e.length)return(0,i.$e)(e.props,(function(t){switch((0,i.EQ)(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return(0,s.q)([(0,o.JG)(e,{props:[(0,i.gx)(t,/:(read-\w+)/,":"+a.uj+"$1")]})],r);case"::placeholder":return(0,s.q)([(0,o.JG)(e,{props:[(0,i.gx)(t,/:(plac\w+)/,":"+a.G$+"input-$1")]}),(0,o.JG)(e,{props:[(0,i.gx)(t,/:(plac\w+)/,":"+a.uj+"$1")]}),(0,o.JG)(e,{props:[(0,i.gx)(t,/:(plac\w+)/,a.MS+"input-$1")]})],r)}return""}))}}];const y=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var o,i,a=e.stylisPlugins||m,u={},d=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)u[t[n]]=!0;d.push(e)}));var h,y=[p,f],b=[s.P,(0,c.cD)((function(e){h.insert(e)}))],v=(0,c.qR)(y.concat(a,b));i=function(e,t,n,r){var o;h=n,o=e?e+"{"+t.styles+"}":t.styles,(0,s.q)((0,l.MY)(o),v),r&&(g.inserted[t.name]=!0)};var g={key:t,sheet:new r.m({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:u,registered:{},insert:i};return g.sheet.hydrate(d),g}},95246:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},78606:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(56861),o=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/;const i=(0,r.Z)((function(e){return o.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}))},56861:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},61513:(e,t,n)=>{"use strict";n.d(t,{T:()=>s,w:()=>a});var r=n(16689),o=n(38682);n(95135),n(29419);var i=(0,r.createContext)("undefined"!=typeof HTMLElement?(0,o.Z)({key:"css"}):null);i.Provider;var a=function(e){return(0,r.forwardRef)((function(t,n){var o=(0,r.useContext)(i);return e(t,o,n)}))},s=(0,r.createContext)({})},95135:(e,t,n)=>{"use strict";n.d(t,{O:()=>y});var r=n(95246),o=n(98961),i=n(56861);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(e){return 45===e.charCodeAt(1)},u=function(e){return null!=e&&"boolean"!=typeof e},d=(0,i.Z)((function(e){return l(e)?e:e.replace(s,"-$&").toLowerCase()})),p=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,n){return h={name:t,styles:n,next:h},t}))}return 1===o.Z[e]||l(e)||"number"!=typeof t||0===t?t:t+"px"};function f(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(a(n)){case"boolean":return"";case"object":if(1===n.anim)return h={name:n.name,styles:n.styles,next:h},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)h={name:r.name,styles:r.styles,next:h},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=f(e,t,n[o])+";";else for(var i in n){var s=n[i];if("object"!==a(s))null!=t&&void 0!==t[s]?r+=i+"{"+t[s]+"}":u(s)&&(r+=d(i)+":"+p(i,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var c=f(e,t,s);switch(i){case"animation":case"animationName":r+=d(i)+":"+c+";";break;default:r+=i+"{"+c+"}"}}else for(var l=0;l<s.length;l++)u(s[l])&&(r+=d(i)+":"+p(i,s[l])+";")}return r}(e,t,n);case"function":if(void 0!==e){var o=h,i=n(e);return h=o,f(e,t,i)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var h,m=/label:\s*([^\s;\n{]+)\s*(;|$)/g,y=function(e,t,n){if(1===e.length&&"object"===a(e[0])&&null!==e[0]&&void 0!==e[0].styles)return e[0];var o=!0,i="";h=void 0;var s=e[0];null==s||void 0===s.raw?(o=!1,i+=f(n,t,s)):i+=s[0];for(var c=1;c<e.length;c++)i+=f(n,t,e[c]),o&&(i+=s[c]);m.lastIndex=0;for(var l,u="";null!==(l=m.exec(i));)u+="-"+l[1];return{name:(0,r.Z)(i)+u,styles:i,next:h}}},76859:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var r=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}()},97942:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(79777),o=n(16689),i=n(78606),a=n(61513),s=n(81612),c=n(95135),l=n(29419),u=i.Z,d=function(e){return"theme"!==e},p=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?u:d},f=function(e,t,n){var r;if(t){var o=t.shouldForwardProp;r=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!=typeof r&&n&&(r=e.__emotion_forwardProp),r},h=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,s.hC)(t,n,r),(0,l.L)((function(){return(0,s.My)(t,n,r)})),null};const m=function e(t,n){var i,l,u=t.__emotion_real===t,d=u&&t.__emotion_base||t;void 0!==n&&(i=n.label,l=n.target);var m=f(t,n,u),y=m||p(d),b=!y("as");return function(){var v=arguments,g=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&g.push("label:"+i+";"),null==v[0]||void 0===v[0].raw)g.push.apply(g,v);else{g.push(v[0][0]);for(var S=v.length,w=1;w<S;w++)g.push(v[w],v[0][w])}var k=(0,a.w)((function(e,t,n){var r=b&&e.as||d,i="",u=[],f=e;if(null==e.theme){for(var v in f={},e)f[v]=e[v];f.theme=(0,o.useContext)(a.T)}"string"==typeof e.className?i=(0,s.fp)(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var S=(0,c.O)(g.concat(u),t.registered,f);i+=t.key+"-"+S.name,void 0!==l&&(i+=" "+l);var w=b&&void 0===m?p(r):y,k={};for(var O in e)b&&"as"===O||w(O)&&(k[O]=e[O]);return k.className=i,k.ref=n,(0,o.createElement)(o.Fragment,null,(0,o.createElement)(h,{cache:t,serialized:S,isStringTag:"string"==typeof r}),(0,o.createElement)(r,k))}));return k.displayName=void 0!==i?i:"Styled("+("string"==typeof d?d:d.displayName||d.name||"Component")+")",k.defaultProps=t.defaultProps,k.__emotion_real=k,k.__emotion_base=d,k.__emotion_styles=g,k.__emotion_forwardProp=m,Object.defineProperty(k,"toString",{value:function(){return"."+l}}),k.withComponent=function(t,o){return e(t,(0,r.Z)({},n,o,{shouldForwardProp:f(k,o,!0)})).apply(void 0,g)},k}}},82441:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i}),n(16689);var r=n(97942),o=(n(95135),n(29419),r.Z.bind());["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){o[e]=o(e)}));const i=o},98961:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},29419:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});var r=n(16689),o=!!r.useInsertionEffect&&r.useInsertionEffect,i=o||function(e){return e()};o||r.useLayoutEffect},81612:(e,t,n)=>{"use strict";function r(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}n.d(t,{My:()=>i,fp:()=>r,hC:()=>o});var o=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},i=function(e,t,n){o(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+r:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}}},26454:(e,t,n)=>{"use strict";var r=n(42970);t.Z=void 0;var o=r(n(17324)),i=n(2038),a=(0,o.default)((0,i.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown");t.Z=a},14741:(e,t,n)=>{"use strict";var r=n(42970);t.Z=void 0;var o=r(n(17324)),i=n(2038),a=(0,o.default)((0,i.jsx)("path",{d:"m10 17 5-5-5-5v10z"}),"ArrowRight");t.Z=a},17324:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(44007)},60543:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"}},74379:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={black:"#000",white:"#fff"}},90232:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"}},36812:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"}},58602:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"}},42137:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"}},26646:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"}},19542:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"}},76531:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(79777);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n;return(0,r.Z)({toolbar:(n={minHeight:56},i(n,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),i(n,e.up("sm"),{minHeight:64}),n)},t)}},77724:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>S});var r=n(79777),o=n(86646),i=n(12469),a=n(44305),s=n(83026),c=n(74379),l=n(36812),u=n(26646),d=n(19542),p=n(42137),f=n(60543),h=n(58602),m=n(90232),y=["mode","contrastThreshold","tonalOffset"],b={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:c.Z.white,default:c.Z.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},v={text:{primary:c.Z.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:c.Z.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function g(e,t,n,r){var o=r.light||r,i=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=(0,s.$n)(e.main,o):"dark"===t&&(e.dark=(0,s._j)(e.main,i)))}function S(e){var t=e.mode,n=void 0===t?"light":t,S=e.contrastThreshold,w=void 0===S?3:S,k=e.tonalOffset,O=void 0===k?.2:k,P=(0,o.Z)(e,y),E=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:f.Z[200],light:f.Z[50],dark:f.Z[400]}:{main:f.Z[700],light:f.Z[400],dark:f.Z[800]}}(n),C=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:u.Z[200],light:u.Z[50],dark:u.Z[400]}:{main:u.Z[500],light:u.Z[300],dark:u.Z[700]}}(n),T=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:d.Z[500],light:d.Z[300],dark:d.Z[700]}:{main:d.Z[700],light:d.Z[400],dark:d.Z[800]}}(n),x=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:h.Z[400],light:h.Z[300],dark:h.Z[700]}:{main:h.Z[700],light:h.Z[500],dark:h.Z[900]}}(n),j=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:m.Z[400],light:m.Z[300],dark:m.Z[700]}:{main:m.Z[800],light:m.Z[500],dark:m.Z[900]}}(n),R=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:p.Z[400],light:p.Z[300],dark:p.Z[700]}:{main:"#ed6c02",light:p.Z[500],dark:p.Z[900]}}(n);function I(e){return(0,s.mi)(e,v.text.primary)>=w?v.text.primary:b.text.primary}var _=function(e){var t=e.color,n=e.name,o=e.mainShade,a=void 0===o?500:o,s=e.lightShade,c=void 0===s?300:s,l=e.darkShade,u=void 0===l?700:l;if(!(t=(0,r.Z)({},t)).main&&t[a]&&(t.main=t[a]),!t.hasOwnProperty("main"))throw new Error((0,i.Z)(11,n?" (".concat(n,")"):"",a));if("string"!=typeof t.main)throw new Error((0,i.Z)(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return g(t,"light",c,O),g(t,"dark",u,O),t.contrastText||(t.contrastText=I(t.main)),t},A={dark:v,light:b};return(0,a.Z)((0,r.Z)({common:(0,r.Z)({},c.Z),mode:n,primary:_({color:E,name:"primary"}),secondary:_({color:C,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:_({color:T,name:"error"}),warning:_({color:R,name:"warning"}),info:_({color:x,name:"info"}),success:_({color:j,name:"success"}),grey:l.Z,contrastThreshold:w,getContrastText:I,augmentColor:_,tonalOffset:O},A[n]),P)}},82013:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var r=n(79777),o=n(86646),i=n(12469),a=n(44305),s=n(38774),c=n(1697),l=n(1267),u=n(76531),d=n(77724),p=n(14680),f=n(60248),h=n(5197),m=n(41495),y=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];const b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,n=void 0===t?{}:t,b=e.palette,v=void 0===b?{}:b,g=e.transitions,S=void 0===g?{}:g,w=e.typography,k=void 0===w?{}:w,O=(0,o.Z)(e,y);if(e.vars)throw new Error((0,i.Z)(18));var P=(0,d.ZP)(v),E=(0,s.Z)(e),C=(0,a.Z)(E,{mixins:(0,u.Z)(E.breakpoints,n),palette:P,shadows:f.Z.slice(),typography:(0,p.Z)(P,k),transitions:(0,h.ZP)(S),zIndex:(0,r.Z)({},m.Z)});C=(0,a.Z)(C,O);for(var T=arguments.length,x=new Array(T>1?T-1:0),j=1;j<T;j++)x[j-1]=arguments[j];return(C=x.reduce((function(e,t){return(0,a.Z)(e,t)}),C)).unstable_sxConfig=(0,r.Z)({},c.Z,null==O?void 0:O.unstable_sxConfig),C.unstable_sx=function(e){return(0,l.Z)({sx:e,theme:this})},C}},5197:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>u,x9:()=>s});var r=n(86646),o=n(79777),i=["duration","easing","delay"],a={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},s={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function c(e){return"".concat(Math.round(e),"ms")}function l(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function u(e){var t=(0,o.Z)({},a,e.easing),n=(0,o.Z)({},s,e.duration);return(0,o.Z)({getAutoHeightDuration:l,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.duration,s=void 0===a?n.standard:a,l=o.easing,u=void 0===l?t.easeInOut:l,d=o.delay,p=void 0===d?0:d;return(0,r.Z)(o,i),(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"==typeof s?s:c(s)," ").concat(u," ").concat("string"==typeof p?p:c(p))})).join(",")}},e,{easing:t,duration:n})}},14680:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(79777),o=n(86646),i=n(44305),a=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"],s={textTransform:"uppercase"},c='"Roboto", "Helvetica", "Arial", sans-serif';function l(e,t){var n="function"==typeof t?t(e):t,l=n.fontFamily,u=void 0===l?c:l,d=n.fontSize,p=void 0===d?14:d,f=n.fontWeightLight,h=void 0===f?300:f,m=n.fontWeightRegular,y=void 0===m?400:m,b=n.fontWeightMedium,v=void 0===b?500:b,g=n.fontWeightBold,S=void 0===g?700:g,w=n.htmlFontSize,k=void 0===w?16:w,O=n.allVariants,P=n.pxToRem,E=(0,o.Z)(n,a),C=p/14,T=P||function(e){return"".concat(e/k*C,"rem")},x=function(e,t,n,o,i){return(0,r.Z)({fontFamily:u,fontWeight:e,fontSize:T(t),lineHeight:n},u===c?{letterSpacing:"".concat((a=o/t,Math.round(1e5*a)/1e5),"em")}:{},i,O);var a},j={h1:x(h,96,1.167,-1.5),h2:x(h,60,1.2,-.5),h3:x(y,48,1.167,0),h4:x(y,34,1.235,.25),h5:x(y,24,1.334,0),h6:x(v,20,1.6,.15),subtitle1:x(y,16,1.75,.15),subtitle2:x(v,14,1.57,.1),body1:x(y,16,1.5,.15),body2:x(y,14,1.43,.15),button:x(v,14,1.75,.4,s),caption:x(y,12,1.66,.4),overline:x(y,12,2.66,1,s)};return(0,i.Z)((0,r.Z)({htmlFontSize:k,pxToRem:T,fontFamily:u,fontSize:p,fontWeightLight:h,fontWeightRegular:y,fontWeightMedium:v,fontWeightBold:S},j),E,{clone:!1})}},15785:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=(0,n(82013).Z)()},60248:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=.2,o=.14,i=.12;function a(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(r,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(o,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(i,")")].join(",")}const s=["none",a(0,2,1,-1,0,1,1,0,0,1,3,0),a(0,3,1,-2,0,2,2,0,0,1,5,0),a(0,3,3,-2,0,3,4,0,0,1,8,0),a(0,2,4,-1,0,4,5,0,0,1,10,0),a(0,3,5,-1,0,5,8,0,0,1,14,0),a(0,3,5,-1,0,6,10,0,0,1,18,0),a(0,4,5,-2,0,7,10,1,0,2,16,1),a(0,5,5,-3,0,8,10,1,0,3,14,2),a(0,5,6,-3,0,9,12,1,0,3,16,2),a(0,6,6,-3,0,10,14,1,0,4,18,3),a(0,6,7,-4,0,11,15,1,0,4,20,3),a(0,7,8,-4,0,12,17,2,0,5,22,4),a(0,7,8,-4,0,13,19,2,0,5,24,4),a(0,7,9,-4,0,14,21,2,0,5,26,4),a(0,8,9,-5,0,15,22,2,0,6,28,5),a(0,8,10,-5,0,16,24,2,0,6,30,5),a(0,8,11,-5,0,17,26,2,0,6,32,5),a(0,9,11,-5,0,18,28,2,0,7,34,6),a(0,9,12,-6,0,19,29,2,0,7,36,6),a(0,10,13,-6,0,20,31,3,0,8,38,7),a(0,10,13,-6,0,21,33,3,0,8,40,7),a(0,10,14,-6,0,22,35,3,0,8,42,7),a(0,11,14,-7,0,23,36,3,0,9,44,8),a(0,11,15,-7,0,24,38,3,0,9,46,8)]},49917:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>i});var r=n(17500),o=n(15785);const i=(0,r.ZP)({defaultTheme:o.Z,rootShouldForwardProp:function(e){return(0,r.x9)(e)&&"classes"!==e}})},47186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(98654),o=n(15785);function i(e){var t=e.props,n=e.name;return(0,r.Z)({props:t,name:n,defaultTheme:o.Z})}},41495:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500}},44007:(e,t,n)=>{"use strict";n.r(t),n.d(t,{capitalize:()=>o,createChainedFunction:()=>i,createSvgIcon:()=>w,debounce:()=>k,deprecatedPropType:()=>O,isMuiElement:()=>P,ownerDocument:()=>E.Z,ownerWindow:()=>T,requirePropFactory:()=>x,setRef:()=>j,unstable_ClassNameGenerator:()=>Z,unstable_useEnhancedEffect:()=>R.Z,unstable_useId:()=>I.Z,unsupportedProp:()=>_,useControlled:()=>A.Z,useEventCallback:()=>D,useForkRef:()=>N.Z,useIsFocusVisible:()=>H});var r=n(21142);const o=n(2494).Z,i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return null==t?e:function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e.apply(this,r),t.apply(this,r)}}),(function(){}))};var a=n(79777),s=n(16689),c=n(86646),l=(n(580),n(82566)),u=n(56e3),d=n(47186),p=n(49917),f=n(46213),h=n(5245);function m(e){return(0,h.Z)("MuiSvgIcon",e)}(0,f.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var y=n(2038),b=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],v=(0,p.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,"inherit"!==n.color&&t["color".concat(o(n.color))],t["fontSize".concat(o(n.fontSize))]]}})((function(e){var t,n,r,o,i,a,s,c,l,u,d,p,f,h,m,y,b,v=e.theme,g=e.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:null==(t=v.transitions)||null==(n=t.create)?void 0:n.call(t,"fill",{duration:null==(r=v.transitions)||null==(o=r.duration)?void 0:o.shorter}),fontSize:{inherit:"inherit",small:(null==(i=v.typography)||null==(a=i.pxToRem)?void 0:a.call(i,20))||"1.25rem",medium:(null==(s=v.typography)||null==(c=s.pxToRem)?void 0:c.call(s,24))||"1.5rem",large:(null==(l=v.typography)||null==(u=l.pxToRem)?void 0:u.call(l,35))||"2.1875rem"}[g.fontSize],color:null!=(d=null==(p=(v.vars||v).palette)||null==(f=p[g.color])?void 0:f.main)?d:{action:null==(h=(v.vars||v).palette)||null==(m=h.action)?void 0:m.active,disabled:null==(y=(v.vars||v).palette)||null==(b=y.action)?void 0:b.disabled,inherit:void 0}[g.color]}})),g=s.forwardRef((function(e,t){var n=(0,d.Z)({props:e,name:"MuiSvgIcon"}),r=n.children,i=n.className,s=n.color,p=void 0===s?"inherit":s,f=n.component,h=void 0===f?"svg":f,g=n.fontSize,S=void 0===g?"medium":g,w=n.htmlColor,k=n.inheritViewBox,O=void 0!==k&&k,P=n.titleAccess,E=n.viewBox,C=void 0===E?"0 0 24 24":E,T=(0,c.Z)(n,b),x=(0,a.Z)({},n,{color:p,component:h,fontSize:S,instanceFontSize:e.fontSize,inheritViewBox:O,viewBox:C}),j={};O||(j.viewBox=C);var R=function(e){var t=e.color,n=e.fontSize,r=e.classes,i={root:["root","inherit"!==t&&"color".concat(o(t)),"fontSize".concat(o(n))]};return(0,u.Z)(i,m,r)}(x);return(0,y.jsxs)(v,(0,a.Z)({as:h,className:(0,l.Z)(R.root,i),focusable:"false",color:w,"aria-hidden":!P||void 0,role:P?"img":void 0,ref:t},j,T,{ownerState:x,children:[r,P?(0,y.jsx)("title",{children:P}):null]}))}));g.muiName="SvgIcon";const S=g;function w(e,t){function n(n,r){return(0,y.jsx)(S,(0,a.Z)({"data-testid":"".concat(t,"Icon"),ref:r},n,{children:e}))}return n.muiName=S.muiName,s.memo(s.forwardRef(n))}const k=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];clearTimeout(t),t=setTimeout((function(){e.apply(r,i)}),n)}return r.clear=function(){clearTimeout(t)},r},O=function(e,t){return function(){return null}},P=function(e,t){return s.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)};var E=n(92466),C=n(91136);const T=function(e){return(0,C.Z)(e).defaultView||window};n(51730);const x=function(e,t){return function(){return null}},j=n(37367).Z;var R=n(43547),I=n(9118);const _=function(e,t,n,r,o){return null};var A=n(90678),M=n(52695);const D=function(e){var t=s.useRef(e);return(0,M.Z)((function(){t.current=e})),s.useCallback((function(){return t.current.apply(void 0,arguments)}),[])};var L,N=n(44880),U=!0,B=!1,F={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function z(e){e.metaKey||e.altKey||e.ctrlKey||(U=!0)}function W(){U=!1}function q(){"hidden"===this.visibilityState&&B&&(U=!0)}const H=function(){var e=s.useCallback((function(e){var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",z,!0),t.addEventListener("mousedown",W,!0),t.addEventListener("pointerdown",W,!0),t.addEventListener("touchstart",W,!0),t.addEventListener("visibilitychange",q,!0))}),[]),t=s.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!function(e){var t,n,r,o=e.target;try{return o.matches(":focus-visible")}catch(e){}return U||(n=(t=o).type,!("INPUT"!==(r=t.tagName)||!F[n]||t.readOnly)||"TEXTAREA"===r&&!t.readOnly||!!t.isContentEditable)}(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(B=!0,window.clearTimeout(L),L=window.setTimeout((function(){B=!1}),100),t.current=!1,!0)},ref:e}};var Z={configure:function(e){r.Z.configure(e)}}},92466:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n(91136).Z},90678:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n(31168).Z},43547:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n(52695).Z},44880:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n(66357).Z},9118:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n(87655).Z},96557:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=n(16689).createContext(null)},24231:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(16689),o=n(96557);function i(){return r.useContext(o.Z)}},7522:(e,t,n)=>{"use strict";n.d(t,{Co:()=>i,ZP:()=>o});var r=n(82441);function o(e,t){return(0,r.Z)(e,t)}var i=function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}},3052:(e,t,n)=>{"use strict";n.d(t,{E0:()=>v,NL:()=>s});var r=n(33994),o=n(39642),i=n(10415),a=n(47921);function s(e){return"number"!=typeof e?e:"".concat(e,"px solid")}var c=(0,r.ZP)({prop:"border",themeKey:"borders",transform:s}),l=(0,r.ZP)({prop:"borderTop",themeKey:"borders",transform:s}),u=(0,r.ZP)({prop:"borderRight",themeKey:"borders",transform:s}),d=(0,r.ZP)({prop:"borderBottom",themeKey:"borders",transform:s}),p=(0,r.ZP)({prop:"borderLeft",themeKey:"borders",transform:s}),f=(0,r.ZP)({prop:"borderColor",themeKey:"palette"}),h=(0,r.ZP)({prop:"borderTopColor",themeKey:"palette"}),m=(0,r.ZP)({prop:"borderRightColor",themeKey:"palette"}),y=(0,r.ZP)({prop:"borderBottomColor",themeKey:"palette"}),b=(0,r.ZP)({prop:"borderLeftColor",themeKey:"palette"}),v=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=(0,i.eI)(e.theme,"shape.borderRadius",4,"borderRadius");return(0,a.k9)(e,e.borderRadius,(function(e){return{borderRadius:(0,i.NA)(t,e)}}))}return null};v.propTypes={},v.filterProps=["borderRadius"],(0,o.Z)(c,l,u,d,p,f,h,m,y,b,v)},47921:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{L7:()=>c,VO:()=>o,W8:()=>s,k9:()=>a}),n(580);var o={xs:0,sm:600,md:900,lg:1200,xl:1536},i={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(o[e],"px)")}};function a(e,t,n){var a=e.theme||{};if(Array.isArray(t)){var s=a.breakpoints||i;return t.reduce((function(e,r,o){return e[s.up(s.keys[o])]=n(t[o]),e}),{})}if("object"===r(t)){var c=a.breakpoints||i;return Object.keys(t).reduce((function(e,r){if(-1!==Object.keys(c.values||o).indexOf(r))e[c.up(r)]=n(t[r],r);else{var i=r;e[i]=t[i]}return e}),{})}return n(t)}function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==(e=t.keys)?void 0:e.reduce((function(e,n){return e[t.up(n)]={},e}),{}))||{}}function c(e,t){return e.reduce((function(e,t){var n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}},83026:(e,t,n)=>{"use strict";n.d(t,{$n:()=>d,Fq:()=>l,_j:()=>u,mi:()=>c});var r=n(12469);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function i(e){if(e.type)return e;if("#"===e.charAt(0))return i(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error((0,r.Z)(9,e));var o,a=e.substring(t+1,e.length-1);if("color"===n){if(o=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(o))throw new Error((0,r.Z)(10,o))}else a=a.split(",");return{type:n,values:a=a.map((function(e){return parseFloat(e)})),colorSpace:o}}function a(e){var t=e.type,n=e.colorSpace,r=e.values;return-1!==t.indexOf("rgb")?r=r.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function s(e){var t="hsl"===(e=i(e)).type||"hsla"===e.type?i(function(e){var t=(e=i(e)).values,n=t[0],r=t[1]/100,o=t[2]/100,s=r*Math.min(o,1-o),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return o-s*Math.max(Math.min(t-3,9-t,1),-1)},l="rgb",u=[Math.round(255*c(0)),Math.round(255*c(8)),Math.round(255*c(4))];return"hsla"===e.type&&(l+="a",u.push(t[3])),a({type:l,values:u})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function c(e,t){var n=s(e),r=s(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function l(e,t){return e=i(e),t=o(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,a(e)}function u(e,t){if(e=i(e),t=o(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return a(e)}function d(e,t){if(e=i(e),t=o(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(var r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return a(e)}},39642:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(88054);const o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t.reduce((function(e,t){return t.filterProps.forEach((function(n){e[n]=t})),e}),{}),i=function(e){return Object.keys(e).reduce((function(t,n){return o[n]?(0,r.Z)(t,o[n](e)):t}),{})};return i.propTypes={},i.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),i}},17500:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>w,x9:()=>g});var r=n(83265),o=n(51730),i=n(7522),a=n(38774),s=n(3965),c=n(1267);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],f=["theme"],h=["theme"];function m(e){return 0===Object.keys(e).length}var y=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null},b=function(e,t){var n=[];t&&t.components&&t.components[e]&&t.components[e].variants&&(n=t.components[e].variants);var r={};return n.forEach((function(e){var t=(0,s.Z)(e.props);r[t]=e.style})),r},v=function(e,t,n,r){var o,i,a=e.ownerState,c=void 0===a?{}:a,l=[],u=null==n||null==(o=n.components)||null==(i=o[r])?void 0:i.variants;return u&&u.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(t){c[t]!==n.props[t]&&e[t]!==n.props[t]&&(r=!1)})),r&&l.push(t[(0,s.Z)(n.props)])})),l};function g(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var S=(0,a.Z)();function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultTheme,n=void 0===t?S:t,a=e.rootShouldForwardProp,s=void 0===a?g:a,d=e.slotShouldForwardProp,w=void 0===d?g:d,k=function(e){var t=m(e.theme)?n:e.theme;return(0,c.Z)((0,o.Z)({},e,{theme:t}))};return k.__mui_systemSx=!0,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.Co)(e,(function(e){return e.filter((function(e){return!(null!=e&&e.__mui_systemSx)}))}));var a=t.name,c=t.slot,d=t.skipVariantsResolver,S=t.skipSx,O=t.overridesResolver,P=(0,r.Z)(t,p),E=void 0!==d?d:c&&"Root"!==c||!1,C=S||!1,T=g;"Root"===c?T=s:c?T=w:function(e){return"string"==typeof e&&e.charCodeAt(0)>96}(e)&&(T=void 0);var x=(0,i.ZP)(e,(0,o.Z)({shouldForwardProp:T,label:void 0},P)),j=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];var c=i?i.map((function(e){return"function"==typeof e&&e.__emotion_real!==e?function(t){var i=t.theme,a=(0,r.Z)(t,f);return e((0,o.Z)({theme:m(i)?n:i},a))}:e})):[],d=e;a&&O&&c.push((function(e){var t=m(e.theme)?n:e.theme,r=y(a,t);if(r){var i={};return Object.entries(r).forEach((function(n){var r,a,s=(a=2,function(e){if(Array.isArray(e))return e}(r=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(r,a)||u(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=s[0],l=s[1];i[c]="function"==typeof l?l((0,o.Z)({},e,{theme:t})):l})),O(e,i)}return null})),a&&!E&&c.push((function(e){var t=m(e.theme)?n:e.theme;return v(e,b(a,t),t,a)})),C||c.push(k);var p=c.length-i.length;if(Array.isArray(e)&&p>0){var g=new Array(p).fill("");(d=[].concat(l(e),l(g))).raw=[].concat(l(e.raw),l(g))}else"function"==typeof e&&e.__emotion_real!==e&&(d=function(t){var i=t.theme,a=(0,r.Z)(t,h);return e((0,o.Z)({theme:m(i)?n:i},a))});return x.apply(void 0,[d].concat(l(c)))};return x.withConfig&&(j.withConfig=x.withConfig),j}}},11242:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(83265),o=n(51730);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var a=["values","unit","step"],s=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return(0,o.Z)({},e,function(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t.key,t.val))}),{})};function c(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,i=e.unit,c=void 0===i?"px":i,l=e.step,u=void 0===l?5:l,d=(0,r.Z)(e,a),p=s(n),f=Object.keys(p);function h(e){var t="number"==typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(c,")")}function m(e){var t="number"==typeof n[e]?n[e]:e;return"@media (max-width:".concat(t-u/100).concat(c,")")}function y(e,t){var r=f.indexOf(t);return"@media (min-width:".concat("number"==typeof n[e]?n[e]:e).concat(c,") and ")+"(max-width:".concat((-1!==r&&"number"==typeof n[f[r]]?n[f[r]]:t)-u/100).concat(c,")")}return(0,o.Z)({keys:f,values:p,up:h,down:m,between:y,only:function(e){return f.indexOf(e)+1<f.length?y(e,f[f.indexOf(e)+1]):h(e)},not:function(e){var t=f.indexOf(e);return 0===t?h(f[1]):t===f.length-1?m(f[t]):y(e,f[f.indexOf(e)+1]).replace("@media","@media not all and")},unit:c},d)}},2354:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(10415);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=(0,r.hB)({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((function(e){var n=t(e);return"number"==typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}},38774:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(51730),o=n(83265),i=n(44305),a=n(11242),s=n(77358),c=n(2354),l=n(1267),u=n(1697),d=["breakpoints","palette","spacing","shape"];const p=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,p=e.palette,f=void 0===p?{}:p,h=e.spacing,m=e.shape,y=void 0===m?{}:m,b=(0,o.Z)(e,d),v=(0,a.Z)(n),g=(0,c.Z)(h),S=(0,i.Z)({breakpoints:v,direction:"ltr",components:{},palette:(0,r.Z)({mode:"light"},f),spacing:g,shape:(0,r.Z)({},s.Z,y)},b),w=arguments.length,k=new Array(w>1?w-1:0),O=1;O<w;O++)k[O-1]=arguments[O];return(S=k.reduce((function(e,t){return(0,i.Z)(e,t)}),S)).unstable_sxConfig=(0,r.Z)({},u.Z,null==b?void 0:b.unstable_sxConfig),S.unstable_sx=function(e){return(0,l.Z)({sx:e,theme:this})},S}},77358:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={borderRadius:4}},83644:(e,t,n)=>{"use strict";n.d(t,{SG:()=>s,e$:()=>c,s2:()=>l});var r=n(33994),o=n(39642),i=n(10415),a=n(47921),s=function(e){if(void 0!==e.gap&&null!==e.gap){var t=(0,i.eI)(e.theme,"spacing",8,"gap");return(0,a.k9)(e,e.gap,(function(e){return{gap:(0,i.NA)(t,e)}}))}return null};s.propTypes={},s.filterProps=["gap"];var c=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=(0,i.eI)(e.theme,"spacing",8,"columnGap");return(0,a.k9)(e,e.columnGap,(function(e){return{columnGap:(0,i.NA)(t,e)}}))}return null};c.propTypes={},c.filterProps=["columnGap"];var l=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=(0,i.eI)(e.theme,"spacing",8,"rowGap");return(0,a.k9)(e,e.rowGap,(function(e){return{rowGap:(0,i.NA)(t,e)}}))}return null};l.propTypes={},l.filterProps=["rowGap"];var u=(0,r.ZP)({prop:"gridColumn"}),d=(0,r.ZP)({prop:"gridRow"}),p=(0,r.ZP)({prop:"gridAutoFlow"}),f=(0,r.ZP)({prop:"gridAutoColumns"}),h=(0,r.ZP)({prop:"gridAutoRows"}),m=(0,r.ZP)({prop:"gridTemplateColumns"}),y=(0,r.ZP)({prop:"gridTemplateRows"}),b=(0,r.ZP)({prop:"gridTemplateAreas"}),v=(0,r.ZP)({prop:"gridArea"});(0,o.Z)(s,c,l,u,d,p,f,h,m,y,b,v)},60722:(e,t,n)=>{"use strict";function r(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}n.d(t,{Z:()=>r})},88054:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(44305);const o=function(e,t){return t?(0,r.Z)(e,t,{clone:!1}):e}},94341:(e,t,n)=>{"use strict";n.d(t,{Sh:()=>i});var r=n(33994),o=n(39642);function i(e,t){return"grey"===t?t:e}var a=(0,r.ZP)({prop:"color",themeKey:"palette",transform:i}),s=(0,r.ZP)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:i}),c=(0,r.ZP)({prop:"backgroundColor",themeKey:"palette",transform:i});(0,o.Z)(a,s,c)},3965:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(83265),o=n(2494),i=["variant"];function a(e){return 0===e.length}function s(e){var t=e.variant,n=(0,r.Z)(e,i),s=t||"";return Object.keys(n).sort().forEach((function(t){s+="color"===t?a(s)?e[t]:(0,o.Z)(e[t]):"".concat(a(s)?t:(0,o.Z)(t)).concat((0,o.Z)(e[t].toString()))})),s}},54157:(e,t,n)=>{"use strict";n.d(t,{EB:()=>a,kk:()=>c});var r=n(33994),o=n(39642),i=n(47921);function a(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var s=(0,r.ZP)({prop:"width",transform:a}),c=function(e){return void 0!==e.maxWidth&&null!==e.maxWidth?(0,i.k9)(e,e.maxWidth,(function(t){var n,r,o;return{maxWidth:(null==(n=e.theme)||null==(r=n.breakpoints)||null==(o=r.values)?void 0:o[t])||i.VO[t]||a(t)}})):null};c.filterProps=["maxWidth"];var l=(0,r.ZP)({prop:"minWidth",transform:a}),u=(0,r.ZP)({prop:"height",transform:a}),d=(0,r.ZP)({prop:"maxHeight",transform:a}),p=(0,r.ZP)({prop:"minHeight",transform:a}),f=((0,r.ZP)({prop:"size",cssProperty:"width",transform:a}),(0,r.ZP)({prop:"size",cssProperty:"height",transform:a}),(0,r.ZP)({prop:"boxSizing"}));(0,o.Z)(s,c,l,u,d,p,f)},10415:(e,t,n)=>{"use strict";n.d(t,{NA:()=>b,e6:()=>g,eI:()=>m,hB:()=>y,o3:()=>S});var r=n(47921),o=n(33994),i=n(88054),a=n(60722);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c={m:"margin",p:"padding"},l={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},u={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},d=(0,a.Z)((function(e){if(e.length>2){if(!u[e])return[e];e=u[e]}var t,n,r=(t=e.split(""),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(t,n)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],a=c[o],d=l[i]||"";return Array.isArray(d)?d.map((function(e){return a+e})):[a+d]})),p=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],f=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],h=[].concat(p,f);function m(e,t,n,r){var i,a=null!=(i=(0,o.DW)(e,t,!1))?i:n;return"number"==typeof a?function(e){return"string"==typeof e?e:a*e}:Array.isArray(a)?function(e){return"string"==typeof e?e:a[e]}:"function"==typeof a?a:function(){}}function y(e){return m(e,"spacing",8)}function b(e,t){if("string"==typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"==typeof n?-n:"-".concat(n)}function v(e,t){var n=y(e.theme);return Object.keys(e).map((function(o){return function(e,t,n,o){if(-1===t.indexOf(n))return null;var i=function(e,t){return function(n){return e.reduce((function(e,r){return e[r]=b(t,n),e}),{})}}(d(n),o),a=e[n];return(0,r.k9)(e,a,i)}(e,t,o,n)})).reduce(i.Z,{})}function g(e){return v(e,p)}function S(e){return v(e,f)}function w(e){return v(e,h)}g.propTypes={},g.filterProps=p,S.propTypes={},S.filterProps=f,w.propTypes={},w.filterProps=h},33994:(e,t,n)=>{"use strict";n.d(t,{DW:()=>a,Jq:()=>s,ZP:()=>c});var r=n(2494),o=n(47921);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!=typeof t)return null;if(e&&e.vars&&n){var r="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=r)return r}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function s(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"==typeof e?e(n):Array.isArray(e)?e[n]||o:a(e,n)||o,t&&(r=t(r,o,e)),r}const c=function(e){var t=e.prop,n=e.cssProperty,c=void 0===n?e.prop:n,l=e.themeKey,u=e.transform,d=function(e){if(null==e[t])return null;var n=e[t],d=a(e.theme,l)||{};return(0,o.k9)(e,n,(function(e){var n=s(d,u,e);return e===n&&"string"==typeof e&&(n=s(d,u,"".concat(t).concat("default"===e?"":(0,r.Z)(e)),e)),!1===c?n:function(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},c,n)}))};return d.propTypes={},d.filterProps=[t],d}},1697:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(10415),o=n(3052),i=n(83644),a=n(94341),s=n(54157);const c={border:{themeKey:"borders",transform:o.NL},borderTop:{themeKey:"borders",transform:o.NL},borderRight:{themeKey:"borders",transform:o.NL},borderBottom:{themeKey:"borders",transform:o.NL},borderLeft:{themeKey:"borders",transform:o.NL},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:o.E0},color:{themeKey:"palette",transform:a.Sh},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:a.Sh},backgroundColor:{themeKey:"palette",transform:a.Sh},p:{style:r.o3},pt:{style:r.o3},pr:{style:r.o3},pb:{style:r.o3},pl:{style:r.o3},px:{style:r.o3},py:{style:r.o3},padding:{style:r.o3},paddingTop:{style:r.o3},paddingRight:{style:r.o3},paddingBottom:{style:r.o3},paddingLeft:{style:r.o3},paddingX:{style:r.o3},paddingY:{style:r.o3},paddingInline:{style:r.o3},paddingInlineStart:{style:r.o3},paddingInlineEnd:{style:r.o3},paddingBlock:{style:r.o3},paddingBlockStart:{style:r.o3},paddingBlockEnd:{style:r.o3},m:{style:r.e6},mt:{style:r.e6},mr:{style:r.e6},mb:{style:r.e6},ml:{style:r.e6},mx:{style:r.e6},my:{style:r.e6},margin:{style:r.e6},marginTop:{style:r.e6},marginRight:{style:r.e6},marginBottom:{style:r.e6},marginLeft:{style:r.e6},marginX:{style:r.e6},marginY:{style:r.e6},marginInline:{style:r.e6},marginInlineStart:{style:r.e6},marginInlineEnd:{style:r.e6},marginBlock:{style:r.e6},marginBlockStart:{style:r.e6},marginBlockEnd:{style:r.e6},displayPrint:{cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:i.SG},rowGap:{style:i.s2},columnGap:{style:i.e$},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:s.EB},maxWidth:{style:s.kk},minWidth:{transform:s.EB},height:{transform:s.EB},maxHeight:{transform:s.EB},minHeight:{transform:s.EB},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}},1267:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(2494),o=n(88054),i=n(33994),a=n(47921),s=n(1697);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){function e(e,t,n,o){var s,c=(l(s={},e,t),l(s,"theme",n),s),u=o[e];if(!u)return l({},e,t);var d=u.cssProperty,p=void 0===d?e:d,f=u.themeKey,h=u.transform,m=u.style;if(null==t)return null;var y=(0,i.DW)(n,f)||{};return m?m(c):(0,a.k9)(c,t,(function(t){var n=(0,i.Jq)(y,h,t);return t===n&&"string"==typeof t&&(n=(0,i.Jq)(y,h,"".concat(e).concat("default"===t?"":(0,r.Z)(t)),t)),!1===p?n:l({},p,n)}))}return function t(n){var r,i=n||{},u=i.sx,d=i.theme,p=void 0===d?{}:d;if(!u)return null;var f=null!=(r=p.unstable_sxConfig)?r:s.Z;function h(n){var r=n;if("function"==typeof n)r=n(p);else if("object"!==c(n))return n;if(!r)return null;var i=(0,a.W8)(p.breakpoints),s=Object.keys(i),u=i;return Object.keys(r).forEach((function(n){var i,s="function"==typeof(i=r[n])?i(p):i;if(null!=s)if("object"===c(s))if(f[n])u=(0,o.Z)(u,e(n,s,p,f));else{var d=(0,a.k9)({theme:p},s,(function(e){return l({},n,e)}));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),o=new Set(r);return t.every((function(e){return o.size===Object.keys(e).length}))}(d,s)?u=(0,o.Z)(u,d):u[n]=t({sx:s,theme:p})}else u=(0,o.Z)(u,e(n,s,p,f))})),(0,a.L7)(s,u)}return Array.isArray(u)?u.map(h):h(u)}}();u.filterProps=["sx"];const d=u},74099:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(38774),o=n(61945),i=(0,r.Z)();const a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return(0,o.Z)(e)}},88464:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(29450);function o(e){var t=e.theme,n=e.name,o=e.props;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?(0,r.Z)(t.components[n].defaultProps,o):o}},98654:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(88464),o=n(74099);function i(e){var t=e.props,n=e.name,i=e.defaultTheme,a=(0,o.Z)(i);return(0,r.Z)({theme:a,name:n,props:t})}},61945:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(24231);const o=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=(0,r.Z)();return n&&(e=n,0!==Object.keys(e).length)?n:t}},21142:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r,o=function(e){return e};const i=(r=o,{configure:function(e){r=e},generate:function(e){return r(e)},reset:function(){r=o}})},2494:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(12469);function o(e){if("string"!=typeof e)throw new Error((0,r.Z)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},56e3:(e,t,n)=>{"use strict";function r(e,t,n){var r={};return Object.keys(e).forEach((function(o){r[o]=e[o].reduce((function(e,r){return r&&(e.push(t(r)),n&&n[r]&&e.push(n[r])),e}),[]).join(" ")})),r}n.d(t,{Z:()=>r})},44305:(e,t,n)=>{"use strict";n.d(t,{P:()=>i,Z:()=>s});var r=n(51730);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e){return null!==e&&"object"===o(e)&&e.constructor===Object}function a(e){if(!i(e))return e;var t={};return Object.keys(e).forEach((function(n){t[n]=a(e[n])})),t}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},o=n.clone?(0,r.Z)({},e):e;return i(e)&&i(t)&&Object.keys(t).forEach((function(r){"__proto__"!==r&&(i(t[r])&&r in e&&i(e[r])?o[r]=s(e[r],t[r],n):n.clone?o[r]=i(t[r])?a(t[r]):t[r]:o[r]=t[r])})),o}},12469:(e,t,n)=>{"use strict";function r(e){for(var t="https://mui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}n.d(t,{Z:()=>r})},5245:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(21142),o={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",i=o[t];return i?"".concat(n,"-").concat(i):"".concat(r.Z.generate(e),"-").concat(t)}},46213:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(5245);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",o={};return t.forEach((function(t){o[t]=(0,r.Z)(e,t,n)})),o}},91136:(e,t,n)=>{"use strict";function r(e){return e&&e.ownerDocument||document}n.d(t,{Z:()=>r})},29450:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(51730);function o(e,t){var n=(0,r.Z)({},t);return Object.keys(e).forEach((function(i){if(i.toString().match(/^(components|slots)$/))n[i]=(0,r.Z)({},e[i],n[i]);else if(i.toString().match(/^(componentsProps|slotProps)$/)){var a=e[i]||{},s=t[i];n[i]={},s&&Object.keys(s)?a&&Object.keys(a)?(n[i]=(0,r.Z)({},s),Object.keys(a).forEach((function(e){n[i][e]=o(a[e],s[e])}))):n[i]=s:n[i]=a}else void 0===n[i]&&(n[i]=e[i])})),n}},37367:(e,t,n)=>{"use strict";function r(e,t){"function"==typeof e?e(t):e&&(e.current=t)}n.d(t,{Z:()=>r})},31168:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(16689);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t,n,i=e.controlled,a=e.default,s=(e.name,e.state,r.useRef(void 0!==i).current),c=(t=r.useState(a),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(t,n)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],u=c[1];return[s?i:l,r.useCallback((function(e){s||u(e)}),[])]}},52695:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(16689);const o="undefined"!=typeof window?r.useLayoutEffect:r.useEffect},66357:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(16689),o=n(37367);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.useMemo((function(){return t.every((function(e){return null==e}))?null:function(e){t.forEach((function(t){(0,o.Z)(t,e)}))}}),t)}},87655:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(16689);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=0,a=r.useId;function s(e){if(void 0!==a){var t=a();return null!=e?e:t}return function(e){var t,n,a=(t=r.useState(e),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(t,n)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],c=a[1],l=e||s;return r.useEffect((function(){null==s&&c("mui-".concat(i+=1))}),[s]),l}(e)}},49493:(e,t,n)=>{"use strict";var r=n(43532),o=n(64411),i=o(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&i(e,".prototype.")>-1?o(n):n}},64411:(e,t,n)=>{"use strict";var r=n(65836),o=n(43532),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||r.call(a,i),c=o("%Object.getOwnPropertyDescriptor%",!0),l=o("%Object.defineProperty%",!0),u=o("%Math.max%");if(l)try{l({},"a",{value:1})}catch(e){l=null}e.exports=function(e){var t=s(r,a,arguments);return c&&l&&c(t,"length").configurable&&l(t,"length",{value:1+u(0,e.length-(arguments.length-1))}),t};var d=function(){return s(r,i,arguments)};l?l(e.exports,"apply",{value:d}):e.exports.apply=d},82566:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==r(e))if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=o(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}n.d(t,{Z:()=>i});const i=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=o(e))&&(r&&(r+=" "),r+=t);return r}},13674:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(42801),i=n(80288),a=n(28675),s=n(92708),c=n(30907),l=n(99776),u=n(47478),d=n(65176),p=n(43532),f=n(49493),h=n(18724),m=n(23382),y=n(645),b=n(2607),v=n(46880),g=f("Date.prototype.getTime"),S=Object.getPrototypeOf,w=f("Object.prototype.toString"),k=p("%Set%",!0),O=f("Map.prototype.has",!0),P=f("Map.prototype.get",!0),E=f("Map.prototype.size",!0),C=f("Set.prototype.add",!0),T=f("Set.prototype.delete",!0),x=f("Set.prototype.has",!0),j=f("Set.prototype.size",!0);function R(e,t,n,r){for(var o,i=m(e);(o=i.next())&&!o.done;)if(D(t,o.value,n,r))return T(e,o.value),!0;return!1}function I(e){return void 0===e?null:"object"!==r(e)?"symbol"!==r(e)&&("string"!=typeof e&&"number"!=typeof e||+e==+e):void 0}function _(e,t,n,r,o,i){var a=I(n);if(null!=a)return a;var s=P(t,a),c=v({},o,{strict:!1});return!(void 0===s&&!O(t,a)||!D(r,s,c,i))&&!O(e,a)&&D(r,s,c,i)}function A(e,t,n){var r=I(n);return null!=r?r:x(t,r)&&!x(e,r)}function M(e,t,n,r,o,i){for(var a,s,c=m(e);(a=c.next())&&!a.done;)if(D(n,s=a.value,o,i)&&D(r,P(t,s),o,i))return T(e,s),!0;return!1}function D(e,t,n,p){var f=n||{};if(f.strict?a(e,t):e===t)return!0;if(d(e)!==d(t))return!1;if(!e||!t||"object"!==r(e)&&"object"!==r(t))return f.strict?a(e,t):e==t;var y,T=p.has(e),I=p.has(t);if(T&&I){if(p.get(e)===p.get(t))return!0}else y={};return T||p.set(e,y),I||p.set(t,y),function(e,t,n,a){var d,p;if(r(e)!==r(t))return!1;if(null==e||null==t)return!1;if(w(e)!==w(t))return!1;if(i(e)!==i(t))return!1;if(l(e)!==l(t))return!1;var f=e instanceof Error,y=t instanceof Error;if(f!==y)return!1;if((f||y)&&(e.name!==t.name||e.message!==t.message))return!1;var T=s(e),I=s(t);if(T!==I)return!1;if((T||I)&&(e.source!==t.source||c(e)!==c(t)))return!1;var N=u(e),U=u(t);if(N!==U)return!1;if((N||U)&&g(e)!==g(t))return!1;if(n.strict&&S&&S(e)!==S(t))return!1;if(b(e)!==b(t))return!1;var B=L(e),F=L(t);if(B!==F)return!1;if(B||F){if(e.length!==t.length)return!1;for(d=0;d<e.length;d++)if(e[d]!==t[d])return!1;return!0}if(r(e)!==r(t))return!1;var z=o(e),W=o(t);if(z.length!==W.length)return!1;for(z.sort(),W.sort(),d=z.length-1;d>=0;d--)if(z[d]!=W[d])return!1;for(d=z.length-1;d>=0;d--)if(!D(e[p=z[d]],t[p],n,a))return!1;var q=h(e),H=h(t);return q===H&&("Set"===q||"Set"===H?function(e,t,n,o){if(j(e)!==j(t))return!1;for(var i,a,s,c=m(e),l=m(t);(i=c.next())&&!i.done;)if(i.value&&"object"===r(i.value))s||(s=new k),C(s,i.value);else if(!x(t,i.value)){if(n.strict)return!1;if(!A(e,t,i.value))return!1;s||(s=new k),C(s,i.value)}if(s){for(;(a=l.next())&&!a.done;)if(a.value&&"object"===r(a.value)){if(!R(s,a.value,n.strict,o))return!1}else if(!n.strict&&!x(e,a.value)&&!R(s,a.value,n.strict,o))return!1;return 0===j(s)}return!0}(e,t,n,a):"Map"!==q||function(e,t,n,o){if(E(e)!==E(t))return!1;for(var i,a,s,c,l,u,d=m(e),p=m(t);(i=d.next())&&!i.done;)if(c=i.value[0],l=i.value[1],c&&"object"===r(c))s||(s=new k),C(s,c);else if(void 0===(u=P(t,c))&&!O(t,c)||!D(l,u,n,o)){if(n.strict)return!1;if(!_(e,t,c,l,n,o))return!1;s||(s=new k),C(s,c)}if(s){for(;(a=p.next())&&!a.done;)if(c=a.value[0],u=a.value[1],c&&"object"===r(c)){if(!M(s,e,c,u,n,o))return!1}else if(!(n.strict||e.has(c)&&D(P(e,c),u,n,o)||M(s,e,c,u,v({},n,{strict:!1}),o)))return!1;return 0===j(s)}return!0}(e,t,n,a))}(e,t,f,p)}function L(e){return!(!e||"object"!==r(e)||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0]||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))}e.exports=function(e,t,n){return D(e,t,n,y())}},10635:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(42801),i="function"==typeof Symbol&&"symbol"===r(Symbol("foo")),a=Object.prototype.toString,s=Array.prototype.concat,c=Object.defineProperty,l=c&&function(){var e={};try{for(var t in c(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),u=function(e,t,n,r){var o;(!(t in e)||"function"==typeof(o=r)&&"[object Function]"===a.call(o)&&r())&&(l?c(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},d=function(e,t){var n=arguments.length>2?arguments[2]:{},r=o(t);i&&(r=s.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)u(e,r[a],t[r[a]],n[r[a]])};d.supportsDescriptors=!!l,e.exports=d},77758:e=>{var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString;e.exports=function(e,r,o){if("[object Function]"!==n.call(r))throw new TypeError("iterator must be a function");var i=e.length;if(i===+i)for(var a=0;a<i;a++)r.call(o,e[a],a,e);else for(var s in e)t.call(e,s)&&r.call(o,e[s],s,e)}},4237:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,r=Object.prototype.toString,o="[object Function]";e.exports=function(e){var i=this;if("function"!=typeof i||r.call(i)!==o)throw new TypeError(t+i);for(var a,s=n.call(arguments,1),c=Math.max(0,i.length-s.length),l=[],u=0;u<c;u++)l.push("$"+u);if(a=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof a){var t=i.apply(this,s.concat(n.call(arguments)));return Object(t)===t?t:this}return i.apply(e,s.concat(n.call(arguments)))})),i.prototype){var d=function(){};d.prototype=i.prototype,a.prototype=new d,d.prototype=null}return a}},65836:(e,t,n)=>{"use strict";var r=n(4237);e.exports=Function.prototype.bind||r},81091:e=>{"use strict";var t=function(){return"string"==typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(e){n=null}t.functionsHaveConfigurableNames=function(){return t()&&n&&!!n((function(){}),"name").configurable};var r=Function.prototype.bind;t.boundFunctionsHaveNames=function(){return t()&&"function"==typeof r&&""!==function(){}.bind().name},e.exports=t},43532:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o,i=SyntaxError,a=Function,s=TypeError,c=function(e){try{return a('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var u=function(){throw new s},d=l?function(){try{return u}catch(e){try{return l(arguments,"callee").get}catch(e){return u}}}():u,p=n(87285)(),f=Object.getPrototypeOf||function(e){return e.__proto__},h={},m="undefined"==typeof Uint8Array?o:f(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?o:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?o:ArrayBuffer,"%ArrayIteratorPrototype%":p?f([][Symbol.iterator]()):o,"%AsyncFromSyncIteratorPrototype%":o,"%AsyncFunction%":h,"%AsyncGenerator%":h,"%AsyncGeneratorFunction%":h,"%AsyncIteratorPrototype%":h,"%Atomics%":"undefined"==typeof Atomics?o:Atomics,"%BigInt%":"undefined"==typeof BigInt?o:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?o:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?o:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?o:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?o:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":h,"%Int8Array%":"undefined"==typeof Int8Array?o:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?o:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?o:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":p?f(f([][Symbol.iterator]())):o,"%JSON%":"object"===("undefined"==typeof JSON?"undefined":r(JSON))?JSON:o,"%Map%":"undefined"==typeof Map?o:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&p?f((new Map)[Symbol.iterator]()):o,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?o:Promise,"%Proxy%":"undefined"==typeof Proxy?o:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?o:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?o:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&p?f((new Set)[Symbol.iterator]()):o,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?o:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":p?f(""[Symbol.iterator]()):o,"%Symbol%":p?Symbol:o,"%SyntaxError%":i,"%ThrowTypeError%":d,"%TypedArray%":m,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?o:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?o:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?o:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?o:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?o:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?o:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?o:WeakSet},b=function e(t){var n;if("%AsyncFunction%"===t)n=c("async function () {}");else if("%GeneratorFunction%"===t)n=c("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=c("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(n=f(o.prototype))}return y[t]=n,n},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=n(65836),S=n(19392),w=g.call(Function.call,Array.prototype.concat),k=g.call(Function.apply,Array.prototype.splice),O=g.call(Function.call,String.prototype.replace),P=g.call(Function.call,String.prototype.slice),E=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,T=function(e){var t=P(e,0,1),n=P(e,-1);if("%"===t&&"%"!==n)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var r=[];return O(e,E,(function(e,t,n,o){r[r.length]=n?O(o,C,"$1"):t||e})),r},x=function(e,t){var n,r=e;if(S(v,r)&&(r="%"+(n=v[r])[0]+"%"),S(y,r)){var o=y[r];if(o===h&&(o=b(r)),void 0===o&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');var n=T(e),r=n.length>0?n[0]:"",o=x("%"+r+"%",t),a=o.name,c=o.value,u=!1,d=o.alias;d&&(r=d[0],k(n,w([0,1],d)));for(var p=1,f=!0;p<n.length;p+=1){var h=n[p],m=P(h,0,1),b=P(h,-1);if(('"'===m||"'"===m||"`"===m||'"'===b||"'"===b||"`"===b)&&m!==b)throw new i("property names with quotes must have matching quotes");if("constructor"!==h&&f||(u=!0),S(y,a="%"+(r+="."+h)+"%"))c=y[a];else if(null!=c){if(!(h in c)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&p+1>=n.length){var v=l(c,h);c=(f=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:c[h]}else f=S(c,h),c=c[h];f&&!u&&(y[a]=c)}}return c}},1865:(e,t)=>{},87285:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o="undefined"!=typeof Symbol&&Symbol,i=n(2112);e.exports=function(){return"function"==typeof o&&"function"==typeof Symbol&&"symbol"===r(o("foo"))&&"symbol"===r(Symbol("bar"))&&i()}},2112:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"===t(Symbol.iterator))return!0;var e={},n=Symbol("test"),r=Object(n);if("string"==typeof n)return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(n in e[n]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var o=Object.getOwnPropertySymbols(e);if(1!==o.length||o[0]!==n)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,n);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},19392:(e,t,n)=>{"use strict";var r=n(65836);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},80288:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o="function"==typeof Symbol&&"symbol"===r(Symbol.toStringTag),i=n(49493)("Object.prototype.toString"),a=function(e){return!(o&&e&&"object"===r(e)&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},s=function(e){return!!a(e)||null!==e&&"object"===r(e)&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},c=function(){return a(arguments)}();a.isLegacyArguments=s,e.exports=c?a:s},39518:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}if("function"==typeof BigInt){var n=BigInt.prototype.valueOf;e.exports=function(e){return null!=e&&"boolean"!=typeof e&&"string"!=typeof e&&"number"!=typeof e&&"symbol"!==t(e)&&"function"!=typeof e&&("bigint"==typeof e||function(e){try{return n.call(e),!0}catch(e){}return!1}(e))}}else e.exports=function(e){return!1}},30293:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(49493),i=o("Boolean.prototype.toString"),a=o("Object.prototype.toString"),s="function"==typeof Symbol&&!!Symbol.toStringTag;e.exports=function(e){return"boolean"==typeof e||null!==e&&"object"===r(e)&&(s&&Symbol.toStringTag in e?function(e){try{return i(e),!0}catch(e){return!1}}(e):"[object Boolean]"===a(e))}},47478:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n=Date.prototype.getDay,r=Object.prototype.toString,o="function"==typeof Symbol&&!!Symbol.toStringTag;e.exports=function(e){return"object"===t(e)&&null!==e&&(o?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object Date]"===r.call(e))}},33410:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n,r="function"==typeof Map&&Map.prototype?Map:null,o="function"==typeof Set&&Set.prototype?Set:null;r||(n=function(e){return!1});var i=r?Map.prototype.has:null,a=o?Set.prototype.has:null;n||i||(n=function(e){return!1}),e.exports=n||function(e){if(!e||"object"!==t(e))return!1;try{if(i.call(e),a)try{a.call(e)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},33524:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n=Number.prototype.toString,r=Object.prototype.toString,o="function"==typeof Symbol&&!!Symbol.toStringTag;e.exports=function(e){return"number"==typeof e||"object"===t(e)&&(o?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object Number]"===r.call(e))}},92708:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o,i,a,s,c=n(49493),l=n(2112)()&&!!Symbol.toStringTag;if(l){o=c("Object.prototype.hasOwnProperty"),i=c("RegExp.prototype.exec"),a={};var u=function(){throw a};s={toString:u,valueOf:u},"symbol"===r(Symbol.toPrimitive)&&(s[Symbol.toPrimitive]=u)}var d=c("Object.prototype.toString"),p=Object.getOwnPropertyDescriptor;e.exports=l?function(e){if(!e||"object"!==r(e))return!1;var t=p(e,"lastIndex");if(!t||!o(t,"value"))return!1;try{i(e,s)}catch(e){return e===a}}:function(e){return!(!e||"object"!==r(e)&&"function"!=typeof e)&&"[object RegExp]"===d(e)}},32454:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n,r="function"==typeof Map&&Map.prototype?Map:null,o="function"==typeof Set&&Set.prototype?Set:null;o||(n=function(e){return!1});var i=r?Map.prototype.has:null,a=o?Set.prototype.has:null;n||a||(n=function(e){return!1}),e.exports=n||function(e){if(!e||"object"!==t(e))return!1;try{if(a.call(e),i)try{i.call(e)}catch(e){return!0}return e instanceof o}catch(e){}return!1}},50434:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n=String.prototype.valueOf,r=Object.prototype.toString,o="function"==typeof Symbol&&!!Symbol.toStringTag;e.exports=function(e){return"string"==typeof e||"object"===t(e)&&(o?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object String]"===r.call(e))}},57764:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=Object.prototype.toString;if(n(87285)()){var i=Symbol.prototype.toString,a=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"===r(e))return!0;if("[object Symbol]"!==o.call(e))return!1;try{return function(e){return"symbol"===r(e.valueOf())&&a.test(i.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},18215:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(77758),i=n(93167),a=n(49493),s=a("Object.prototype.toString"),c=n(87285)()&&"symbol"===r(Symbol.toStringTag),l=i(),u=a("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},d=a("String.prototype.slice"),p={},f=n(16992),h=Object.getPrototypeOf;c&&f&&h&&o(l,(function(e){var t=new n.g[e];if(!(Symbol.toStringTag in t))throw new EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var r=h(t),o=f(r,Symbol.toStringTag);if(!o){var i=h(r);o=f(i,Symbol.toStringTag)}p[e]=o.get})),e.exports=function(e){if(!e||"object"!==r(e))return!1;if(!c){var t=d(s(e),8,-1);return u(l,t)>-1}return!!f&&function(e){var t=!1;return o(p,(function(n,r){if(!t)try{t=n.call(e)===r}catch(e){}})),t}(e)}},30464:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n,r="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,o="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;r||(n=function(e){return!1});var i=r?r.prototype.has:null,a=o?o.prototype.has:null;n||i||(n=function(e){return!1}),e.exports=n||function(e){if(!e||"object"!==t(e))return!1;try{if(i.call(e,i),a)try{a.call(e,a)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},77799:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(43532),i=n(49493),a=o("%WeakSet%",!0),s=i("WeakSet.prototype.has",!0);if(s){var c=i("WeakMap.prototype.has",!0);e.exports=function(e){if(!e||"object"!==r(e))return!1;try{if(s(e,s),c)try{c(e,c)}catch(e){return!0}return e instanceof a}catch(e){}return!1}}else e.exports=function(e){return!1}},99776:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},87856:function(e,t,n){var r,o;function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}!function(a,s){"use strict";r=function(){var e=function(){},t="undefined",n=("undefined"==typeof window?"undefined":i(window))!==t&&i(window.navigator)!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function c(e,n,r){return function(){("undefined"==typeof console?"undefined":i(console))!==t&&(s.call(this,n,r),this[e].apply(this,arguments))}}function l(r,s,l){return function(r){return"debug"===r&&(r="log"),("undefined"==typeof console?"undefined":i(console))!==t&&("trace"===r&&n?a:void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):e)}(r)||c.apply(this,arguments)}function u(e,n,o){var a,c=this;n=null==n?"WARN":n;var u="loglevel";function d(){var e;if(("undefined"==typeof window?"undefined":i(window))!==t&&u){try{e=window.localStorage[u]}catch(e){}if(i(e)===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===c.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"===i(e)&&(u=void 0),c.name=e,c.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},c.methodFactory=o||l,c.getLevel=function(){return a},c.setLevel=function(n,o){if("string"==typeof n&&void 0!==c.levels[n.toUpperCase()]&&(n=c.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=c.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==o&&function(e){var n=(r[e]||"silent").toUpperCase();if(("undefined"==typeof window?"undefined":i(window))!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}(n),s.call(c,n,e),("undefined"==typeof console?"undefined":i(console))===t&&n<c.levels.SILENT)return"No console available for logging"},c.setDefaultLevel=function(e){n=e,d()||c.setLevel(e,!1)},c.resetLevel=function(){c.setLevel(n,!1),function(){if(("undefined"==typeof window?"undefined":i(window))!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},c.enableAll=function(e){c.setLevel(c.levels.TRACE,e)},c.disableAll=function(e){c.setLevel(c.levels.SILENT,e)};var p=d();null==p&&(p=n),c.setLevel(p,!1)}var d=new u,p={};d.getLogger=function(e){if("symbol"!==i(e)&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new u(e,d.getLevel(),d.methodFactory)),t};var f=("undefined"==typeof window?"undefined":i(window))!==t?window.log:void 0;return d.noConflict=function(){return("undefined"==typeof window?"undefined":i(window))!==t&&window.log===d&&(window.log=f),d},d.getLoggers=function(){return p},d.default=d,d},void 0===(o=r.call(t,n,t,e))||(e.exports=o)}()},57860:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var i,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in i=Object(arguments[c]))n.call(i,l)&&(s[l]=i[l]);if(t){a=t(i);for(var u=0;u<a.length;u++)r.call(i,a[u])&&(s[a[u]]=i[a[u]])}}return s}},96338:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&o?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,a=o&&i&&"function"==typeof i.get?i.get:null,s=o&&Map.prototype.forEach,c="function"==typeof Set&&Set.prototype,l=Object.getOwnPropertyDescriptor&&c?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=c&&l&&"function"==typeof l.get?l.get:null,d=c&&Set.prototype.forEach,p="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,h="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,m=Boolean.prototype.valueOf,y=Object.prototype.toString,b=Function.prototype.toString,v=String.prototype.match,g="function"==typeof BigInt?BigInt.prototype.valueOf:null,S=Object.getOwnPropertySymbols,w="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?Symbol.prototype.toString:null,k="function"==typeof Symbol&&"object"===r(Symbol.iterator),O=Object.prototype.propertyIsEnumerable,P=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null),E=n(65863).custom,C=E&&I(E)?E:null,T="function"==typeof Symbol&&void 0!==Symbol.toStringTag?Symbol.toStringTag:null;function x(e,t,n){var r="double"===(n.quoteStyle||t)?'"':"'";return r+e+r}function j(e){return String(e).replace(/"/g,"&quot;")}function R(e){return!("[object Array]"!==M(e)||T&&"object"===r(e)&&T in e)}function I(e){if(k)return e&&"object"===r(e)&&e instanceof Symbol;if("symbol"===r(e))return!0;if(!e||"object"!==r(e)||!w)return!1;try{return w.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,o,i){var c=n||{};if(A(c,"quoteStyle")&&"single"!==c.quoteStyle&&"double"!==c.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(A(c,"maxStringLength")&&("number"==typeof c.maxStringLength?c.maxStringLength<0&&c.maxStringLength!==1/0:null!==c.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=!A(c,"customInspect")||c.customInspect;if("boolean"!=typeof l&&"symbol"!==l)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(A(c,"indent")&&null!==c.indent&&"\t"!==c.indent&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return L(t,c);if("number"==typeof t)return 0===t?1/0/t>0?"0":"-0":String(t);if("bigint"==typeof t)return String(t)+"n";var y=void 0===c.depth?5:c.depth;if(void 0===o&&(o=0),o>=y&&y>0&&"object"===r(t))return R(t)?"[Array]":"[Object]";var S,O=function(e,t){var n;if("\t"===e.indent)n="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;n=Array(e.indent+1).join(" ")}return{base:n,prev:Array(t+1).join(n)}}(c,o);if(void 0===i)i=[];else if(D(i,t)>=0)return"[Circular]";function E(t,n,r){if(n&&(i=i.slice()).push(n),r){var a={depth:c.depth};return A(c,"quoteStyle")&&(a.quoteStyle=c.quoteStyle),e(t,a,o+1,i)}return e(t,c,o+1,i)}if("function"==typeof t){var _=function(e){if(e.name)return e.name;var t=v.call(b.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),N=W(t,E);return"[Function"+(_?": "+_:" (anonymous)")+"]"+(N.length>0?" { "+N.join(", ")+" }":"")}if(I(t)){var q=k?String(t).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):w.call(t);return"object"!==r(t)||k?q:U(q)}if((S=t)&&"object"===r(S)&&("undefined"!=typeof HTMLElement&&S instanceof HTMLElement||"string"==typeof S.nodeName&&"function"==typeof S.getAttribute)){for(var H="<"+String(t.nodeName).toLowerCase(),Z=t.attributes||[],V=0;V<Z.length;V++)H+=" "+Z[V].name+"="+x(j(Z[V].value),"double",c);return H+=">",t.childNodes&&t.childNodes.length&&(H+="..."),H+"</"+String(t.nodeName).toLowerCase()+">"}if(R(t)){if(0===t.length)return"[]";var J=W(t,E);return O&&!function(e){for(var t=0;t<e.length;t++)if(D(e[t],"\n")>=0)return!1;return!0}(J)?"["+z(J,O)+"]":"[ "+J.join(", ")+" ]"}if(function(e){return!("[object Error]"!==M(e)||T&&"object"===r(e)&&T in e)}(t)){var G=W(t,E);return 0===G.length?"["+String(t)+"]":"{ ["+String(t)+"] "+G.join(", ")+" }"}if("object"===r(t)&&l){if(C&&"function"==typeof t[C])return t[C]();if("symbol"!==l&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!a||!e||"object"!==r(e))return!1;try{a.call(e);try{u.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var K=[];return s.call(t,(function(e,n){K.push(E(n,t,!0)+" => "+E(e,t))})),F("Map",a.call(t),K,O)}if(function(e){if(!u||!e||"object"!==r(e))return!1;try{u.call(e);try{a.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var $=[];return d.call(t,(function(e){$.push(E(e,t))})),F("Set",u.call(t),$,O)}if(function(e){if(!p||!e||"object"!==r(e))return!1;try{p.call(e,p);try{f.call(e,f)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return B("WeakMap");if(function(e){if(!f||!e||"object"!==r(e))return!1;try{f.call(e,f);try{p.call(e,p)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return B("WeakSet");if(function(e){if(!h||!e||"object"!==r(e))return!1;try{return h.call(e),!0}catch(e){}return!1}(t))return B("WeakRef");if(function(e){return!("[object Number]"!==M(e)||T&&"object"===r(e)&&T in e)}(t))return U(E(Number(t)));if(function(e){if(!e||"object"!==r(e)||!g)return!1;try{return g.call(e),!0}catch(e){}return!1}(t))return U(E(g.call(t)));if(function(e){return!("[object Boolean]"!==M(e)||T&&"object"===r(e)&&T in e)}(t))return U(m.call(t));if(function(e){return!("[object String]"!==M(e)||T&&"object"===r(e)&&T in e)}(t))return U(E(String(t)));if(!function(e){return!("[object Date]"!==M(e)||T&&"object"===r(e)&&T in e)}(t)&&!function(e){return!("[object RegExp]"!==M(e)||T&&"object"===r(e)&&T in e)}(t)){var Y=W(t,E),X=P?P(t)===Object.prototype:t instanceof Object||t.constructor===Object,Q=t instanceof Object?"":"null prototype",ee=!X&&T&&Object(t)===t&&T in t?M(t).slice(8,-1):Q?"Object":"",te=(X||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(ee||Q?"["+[].concat(ee||[],Q||[]).join(": ")+"] ":"");return 0===Y.length?te+"{}":O?te+"{"+z(Y,O)+"}":te+"{ "+Y.join(", ")+" }"}return String(t)};var _=Object.prototype.hasOwnProperty||function(e){return e in this};function A(e,t){return _.call(e,t)}function M(e){return y.call(e)}function D(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function L(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return L(e.slice(0,t.maxStringLength),t)+r}return x(e.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,N),"single",t)}function N(e){var t=e.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return n?"\\"+n:"\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}function U(e){return"Object("+e+")"}function B(e){return e+" { ? }"}function F(e,t,n,r){return e+" ("+t+") {"+(r?z(n,r):n.join(", "))+"}"}function z(e,t){if(0===e.length)return"";var n="\n"+t.prev+t.base;return n+e.join(","+n)+"\n"+t.prev}function W(e,t){var n=R(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=A(e,o)?t(e[o],e):""}var i,a="function"==typeof S?S(e):[];if(k){i={};for(var s=0;s<a.length;s++)i["$"+a[s]]=a[s]}for(var c in e)A(e,c)&&(n&&String(Number(c))===c&&c<e.length||k&&i["$"+c]instanceof Symbol||(/[^\w$]/.test(c)?r.push(t(c,e)+": "+t(e[c],e)):r.push(c+": "+t(e[c],e))));if("function"==typeof S)for(var l=0;l<a.length;l++)O.call(e,a[l])&&r.push("["+t(a[l])+"]: "+t(e[a[l]],e));return r}},75268:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,n){return 0===e&&0===n?1/e==1/n:e===n||!(!t(e)||!t(n))}},28675:(e,t,n)=>{"use strict";var r=n(10635),o=n(64411),i=n(75268),a=n(8231),s=n(62627),c=o(a(),Object);r(c,{getPolyfill:a,implementation:i,shim:s}),e.exports=c},8231:(e,t,n)=>{"use strict";var r=n(75268);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},62627:(e,t,n)=>{"use strict";var r=n(8231),o=n(10635);e.exports=function(){var e=r();return o(Object,{is:e},{is:function(){return Object.is!==e}}),e}},45131:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o;if(!Object.keys){var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=n(97631),c=Object.prototype.propertyIsEnumerable,l=!c.call({toString:null},"toString"),u=c.call((function(){}),"prototype"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(e){var t=e.constructor;return t&&t.prototype===e},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!f["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"===r(window[e]))try{p(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();o=function(e){var t=null!==e&&"object"===r(e),n="[object Function]"===a.call(e),o=s(e),c=t&&"[object String]"===a.call(e),f=[];if(!t&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var m=u&&n;if(c&&e.length>0&&!i.call(e,0))for(var y=0;y<e.length;++y)f.push(String(y));if(o&&e.length>0)for(var b=0;b<e.length;++b)f.push(String(b));else for(var v in e)m&&"prototype"===v||!i.call(e,v)||f.push(String(v));if(l)for(var g=function(e){if("undefined"==typeof window||!h)return p(e);try{return p(e)}catch(e){return!1}}(e),S=0;S<d.length;++S)g&&"constructor"===d[S]||!i.call(e,d[S])||f.push(d[S]);return f}}e.exports=o},42801:(e,t,n)=>{"use strict";var r=Array.prototype.slice,o=n(97631),i=Object.keys,a=i?function(e){return i(e)}:n(45131),s=Object.keys;a.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return o(e)?s(r.call(e)):s(e)})}else Object.keys=a;return Object.keys||a},e.exports=a},97631:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n=Object.prototype.toString;e.exports=function(e){var r=n.call(e),o="[object Arguments]"===r;return o||(o="[object Array]"!==r&&null!==e&&"object"===t(e)&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),o}},10938:(e,t,n)=>{"use strict";var r=n(42801),o=function(e){return null!=e},i=n(2112)(),a=n(49493),s=Object,c=a("Array.prototype.push"),l=a("Object.prototype.propertyIsEnumerable"),u=i?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(!o(e))throw new TypeError("target must be an object");var n,a,d,p,f,h,m,y=s(e);for(n=1;n<arguments.length;++n){a=s(arguments[n]),p=r(a);var b=i&&(Object.getOwnPropertySymbols||u);if(b)for(f=b(a),d=0;d<f.length;++d)m=f[d],l(a,m)&&c(p,m);for(d=0;d<p.length;++d)h=a[m=p[d]],l(a,m)&&(y[m]=h)}return y}},46880:(e,t,n)=>{"use strict";var r=n(10635),o=n(64411),i=n(10938),a=n(25611),s=n(28993),c=o.apply(a()),l=function(e,t){return c(Object,arguments)};r(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},25611:(e,t,n)=>{"use strict";var r=n(10938);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),n={},r=0;r<t.length;++r)n[t[r]]=t[r];var o=Object.assign({},n),i="";for(var a in o)i+=a;return e!==i}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?r:Object.assign:r}},28993:(e,t,n)=>{"use strict";var r=n(10635),o=n(25611);e.exports=function(){var e=o();return r(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e}},90691:function(e,t,n){var r,o,i,a;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}e=n.nmd(e),a=function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(31);var r=function(e){return e&&e.__esModule?e:{default:e}}(n(13));t.default=r.default},function(t,n){t.exports=e},function(e,t,n){e.exports=n(19)()},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="number"==typeof e[n]?e[n]:e[n].val);return t},e.exports=t.default},function(e,t,n){(function(t){(function(){var n,r,o;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-o)/1e6},r=t.hrtime,n=function(){var e;return 1e9*(e=r())[0]+e[1]},o=n()):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(t,n(10))},function(e,t,n){(function(t){for(var r=n(23),o="undefined"==typeof window?t:window,i=["moz","webkit"],a="AnimationFrame",s=o["request"+a],c=o["cancel"+a]||o["cancelRequest"+a],l=0;!s&&l<i.length;l++)s=o[i[l]+"Request"+a],c=o[i[l]+"Cancel"+a]||o[i[l]+"CancelRequest"+a];if(!s||!c){var u=0,d=0,p=[];s=function(e){if(0===p.length){var t=r(),n=Math.max(0,16.666666666666668-(t-u));u=n+t,setTimeout((function(){var e=p.slice(0);p.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return p.push({handle:++d,callback:e,cancelled:!1}),d},c=function(e){for(var t=0;t<p.length;t++)p[t].handle===e&&(p[t].cancelled=!0)}}e.exports=function(e){return s.call(o,e)},e.exports.cancel=function(){c.apply(o,arguments)},e.exports.polyfill=function(e){e||(e=o),e.requestAnimationFrame=s,e.cancelAnimationFrame=c}}).call(t,function(){return this}())},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=0);return t},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t,n){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(0!==n[r])return!1;var o="number"==typeof t[r]?t[r]:t[r].val;if(e[r]!==o)return!1}return!0},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t,r,o,i,a,s){var c=r+(-i*(t-o)+-a*r)*e,l=t+c*e;return Math.abs(c)<s&&Math.abs(l-o)<s?(n[0]=o,n[1]=0,n):(n[0]=l,n[1]=c,n)};var n=[0,0];e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.version;if("string"!=typeof t)return!0;var n=t.split("."),r=parseInt(n[0],10),o=parseInt(n[1],10);return 0===r&&13===o}Object.defineProperty(t,"__esModule",{value:!0}),t.findDOMNode=function(e){return i?o.default.findDOMNode(e):e},t.warnAboutFunctionChild=function(){a||i||(a=!0,console.error("With React 0.14 and later versions, you no longer need to wrap <ScrollArea> child into a function."))},t.warnAboutElementChild=function(){!a&&i&&(a=!0,console.error("With React 0.13, you need to wrap <ScrollArea> child into a function."))},t.positiveOrZero=function(e){return e<0?0:e},t.modifyObjValues=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n},t.isReact13=r;var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=r(o.default),a=!1},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(){h&&p&&(h=!1,p.length?f=p.concat(f):m=-1,f.length&&a())}function a(){if(!h){var e=o(i);h=!0;for(var t=f.length;t;){for(p=f,f=[];++m<t;)p&&p[m].run();m=-1,t=f.length}p=null,h=!1,function(e){if(u===clearTimeout)return clearTimeout(e);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var l,u,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(e){u=r}}();var p,f=[],h=!1,m=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new s(e,t)),1!==f.length||h||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t){"use strict";t.__esModule=!0,t.default={noWobble:{stiffness:170,damping:26},gentle:{stiffness:120,damping:14},wobbly:{stiffness:180,damping:12},stiff:{stiffness:210,damping:20}},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e.default:e}t.__esModule=!0;var o=n(24);t.Motion=r(o);var i=n(25);t.StaggeredMotion=r(i);var a=n(26);t.TransitionMotion=r(a);var s=n(29);t.spring=r(s);var c=n(11);t.presets=r(c);var l=n(3);t.stripStyle=r(l);var u=n(28);t.reorderKeys=r(u)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(n(1)),l=r(n(2)),u=r(n(18)),d=n(12),p=n(9),f=r(n(14)),h="wheel",m="api",y="touchEnd",b="keypress",v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=s(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={topPosition:0,leftPosition:0,realHeight:0,containerHeight:0,realWidth:0,containerWidth:0},n.scrollArea={refresh:function(){n.setSizesToState()},scrollTop:function(){n.scrollTop()},scrollBottom:function(){n.scrollBottom()},scrollYTo:function(e){n.scrollYTo(e)},scrollLeft:function(){n.scrollLeft()},scrollRight:function(){n.scrollRight()},scrollXTo:function(e){n.scrollXTo(e)}},n.evntsPreviousValues={clientX:0,clientY:0,deltaX:0,deltaY:0},n.bindedHandleWindowResize=n.handleWindowResize.bind(n),n.bindedHandleWheel=n.handleWheel.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+s(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"getChildContext",value:function(){return{scrollArea:this.scrollArea}}},{key:"componentDidMount",value:function(){this.props.contentWindow&&this.props.contentWindow.addEventListener("resize",this.bindedHandleWindowResize),this.lineHeightPx=(0,u.default)((0,p.findDOMNode)(this.content)),this.setSizesToState(),this.wrapper.addEventListener("wheel",this.bindedHandleWheel,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.props.contentWindow&&this.props.contentWindow.removeEventListener("resize",this.bindedHandleWindowResize),this.wrapper.removeEventListener("wheel",this.bindedHandleWheel)}},{key:"componentDidUpdate",value:function(){this.setSizesToState()}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.className,o=t.contentClassName,a=t.ownerDocument,s=this.props.smoothScrolling&&(this.state.eventType===h||this.state.eventType===m||this.state.eventType===y||this.state.eventType===b),l=this.canScrollY()?c.default.createElement(f.default,{ownerDocument:a,realSize:this.state.realHeight,containerSize:this.state.containerHeight,position:this.state.topPosition,onMove:this.handleScrollbarMove.bind(this),onPositionChange:this.handleScrollbarYPositionChange.bind(this),containerStyle:this.props.verticalContainerStyle,scrollbarStyle:this.props.verticalScrollbarStyle,smoothScrolling:s,minScrollSize:this.props.minScrollSize,onFocus:this.focusContent.bind(this),type:"vertical"}):null,u=this.canScrollX()?c.default.createElement(f.default,{ownerDocument:a,realSize:this.state.realWidth,containerSize:this.state.containerWidth,position:this.state.leftPosition,onMove:this.handleScrollbarMove.bind(this),onPositionChange:this.handleScrollbarXPositionChange.bind(this),containerStyle:this.props.horizontalContainerStyle,scrollbarStyle:this.props.horizontalScrollbarStyle,smoothScrolling:s,minScrollSize:this.props.minScrollSize,onFocus:this.focusContent.bind(this),type:"horizontal"}):null;"function"==typeof n?((0,p.warnAboutFunctionChild)(),n=n()):(0,p.warnAboutElementChild)();var v="scrollarea "+(r||""),g="scrollarea-content "+(o||""),S={marginTop:-this.state.topPosition,marginLeft:-this.state.leftPosition},w=s?(0,p.modifyObjValues)(S,(function(e){return(0,d.spring)(e)})):S;return c.default.createElement(d.Motion,{style:w},(function(t){return c.default.createElement("div",{ref:function(t){return e.wrapper=t},className:v,style:e.props.style},c.default.createElement("div",{ref:function(t){return e.content=t},style:i({},e.props.contentStyle,t),className:g,onTouchStart:e.handleTouchStart.bind(e),onTouchMove:e.handleTouchMove.bind(e),onTouchEnd:e.handleTouchEnd.bind(e),onKeyDown:e.handleKeyDown.bind(e),tabIndex:e.props.focusableTabIndex},n),l,u)}))}},{key:"setStateFromEvent",value:function(e,t){this.props.onScroll&&this.props.onScroll(e),this.setState(i({},e,{eventType:t}))}},{key:"handleTouchStart",value:function(e){var t=e.touches;if(1===t.length){var n=t[0],r=n.clientX,o=n.clientY;this.eventPreviousValues=i({},this.eventPreviousValues,{clientY:o,clientX:r,timestamp:Date.now()})}}},{key:"handleTouchMove",value:function(e){this.canScroll()&&(e.preventDefault(),e.stopPropagation());var t=e.touches;if(1===t.length){var n=t[0],r=n.clientX,o=n.clientY,a=this.eventPreviousValues.clientY-o,s=this.eventPreviousValues.clientX-r;this.eventPreviousValues=i({},this.eventPreviousValues,{deltaY:a,deltaX:s,clientY:o,clientX:r,timestamp:Date.now()}),this.setStateFromEvent(this.composeNewState(-s,-a))}}},{key:"handleTouchEnd",value:function(e){var t=this.eventPreviousValues,n=t.deltaX,r=t.deltaY,o=t.timestamp;void 0===n&&(n=0),void 0===r&&(r=0),Date.now()-o<200&&this.setStateFromEvent(this.composeNewState(10*-n,10*-r),y),this.eventPreviousValues=i({},this.eventPreviousValues,{deltaY:0,deltaX:0})}},{key:"handleScrollbarMove",value:function(e,t){this.setStateFromEvent(this.composeNewState(t,e))}},{key:"handleScrollbarXPositionChange",value:function(e){this.scrollXTo(e)}},{key:"handleScrollbarYPositionChange",value:function(e){this.scrollYTo(e)}},{key:"handleWheel",value:function(e){var t=e.deltaY,n=e.deltaX;if(this.props.swapWheelAxes){var r=[n,t];t=r[0],n=r[1]}1===e.deltaMode&&(t*=this.lineHeightPx,n*=this.lineHeightPx),t*=this.props.speed,n*=this.props.speed;var o=this.composeNewState(-n,-t);(o.topPosition&&this.state.topPosition!==o.topPosition||o.leftPosition&&this.state.leftPosition!==o.leftPosition||this.props.stopScrollPropagation)&&(e.preventDefault(),e.stopPropagation()),this.setStateFromEvent(o,h),this.focusContent()}},{key:"handleKeyDown",value:function(e){if("input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&!e.target.isContentEditable){var t=0,n=0,r=this.lineHeightPx?this.lineHeightPx:10;switch(e.keyCode){case 33:t=this.state.containerHeight-r;break;case 34:t=-this.state.containerHeight+r;break;case 37:n=r;break;case 38:t=r;break;case 39:n=-r;break;case 40:t=-r}if(0!==t||0!==n){var o=this.composeNewState(n,t);e.preventDefault(),e.stopPropagation(),this.setStateFromEvent(o,b)}}}},{key:"handleWindowResize",value:function(){var e=this.computeSizes();e=this.getModifiedPositionsIfNeeded(e),this.setStateFromEvent(e)}},{key:"composeNewState",value:function(e,t){var n=this.computeSizes();return this.canScrollY(n)?n.topPosition=this.computeTopPosition(t,n):n.topPosition=0,this.canScrollX(n)&&(n.leftPosition=this.computeLeftPosition(e,n)),n}},{key:"computeTopPosition",value:function(e,t){var n=this.state.topPosition-e;return this.normalizeTopPosition(n,t)}},{key:"computeLeftPosition",value:function(e,t){var n=this.state.leftPosition-e;return this.normalizeLeftPosition(n,t)}},{key:"normalizeTopPosition",value:function(e,t){return e>t.realHeight-t.containerHeight&&(e=t.realHeight-t.containerHeight),e<0&&(e=0),e}},{key:"normalizeLeftPosition",value:function(e,t){return e>t.realWidth-t.containerWidth?e=t.realWidth-t.containerWidth:e<0&&(e=0),e}},{key:"computeSizes",value:function(){return{realHeight:this.content.offsetHeight,containerHeight:this.wrapper.offsetHeight,realWidth:this.content.offsetWidth,containerWidth:this.wrapper.offsetWidth}}},{key:"setSizesToState",value:function(){var e=this.computeSizes();e.realHeight===this.state.realHeight&&e.realWidth===this.state.realWidth||this.setStateFromEvent(this.getModifiedPositionsIfNeeded(e))}},{key:"scrollTop",value:function(){this.scrollYTo(0)}},{key:"scrollBottom",value:function(){this.scrollYTo(this.state.realHeight-this.state.containerHeight)}},{key:"scrollLeft",value:function(){this.scrollXTo(0)}},{key:"scrollRight",value:function(){this.scrollXTo(this.state.realWidth-this.state.containerWidth)}},{key:"scrollYTo",value:function(e){if(this.canScrollY()){var t=this.normalizeTopPosition(e,this.computeSizes());this.setStateFromEvent({topPosition:t},m)}}},{key:"scrollXTo",value:function(e){if(this.canScrollX()){var t=this.normalizeLeftPosition(e,this.computeSizes());this.setStateFromEvent({leftPosition:t},m)}}},{key:"canScrollY",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return e.realHeight>e.containerHeight&&this.props.vertical}},{key:"canScrollX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return e.realWidth>e.containerWidth&&this.props.horizontal}},{key:"canScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return this.canScrollY(e)||this.canScrollX(e)}},{key:"getModifiedPositionsIfNeeded",value:function(e){var t=e.realHeight-e.containerHeight;this.state.topPosition>=t&&(e.topPosition=this.canScrollY(e)?(0,p.positiveOrZero)(t):0);var n=e.realWidth-e.containerWidth;return this.state.leftPosition>=n&&(e.leftPosition=this.canScrollX(e)?(0,p.positiveOrZero)(n):0),e}},{key:"focusContent",value:function(){this.content&&(0,p.findDOMNode)(this.content).focus()}}]),t}(c.default.Component);t.default=v,v.childContextTypes={scrollArea:l.default.object},v.propTypes={className:l.default.string,style:l.default.object,speed:l.default.number,contentClassName:l.default.string,contentStyle:l.default.object,vertical:l.default.bool,verticalContainerStyle:l.default.object,verticalScrollbarStyle:l.default.object,horizontal:l.default.bool,horizontalContainerStyle:l.default.object,horizontalScrollbarStyle:l.default.object,onScroll:l.default.func,contentWindow:l.default.any,ownerDocument:l.default.any,smoothScrolling:l.default.bool,minScrollSize:l.default.number,swapWheelAxes:l.default.bool,stopScrollPropagation:l.default.bool,focusableTabIndex:l.default.number},v.defaultProps={speed:1,vertical:!0,horizontal:!0,smoothScrolling:!1,swapWheelAxes:!1,contentWindow:"object"===("undefined"==typeof window?"undefined":o(window))?window:void 0,ownerDocument:"object"===("undefined"==typeof document?"undefined":o(document))?document:void 0,focusableTabIndex:1}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(1)),c=r(n(2)),l=n(12),u=n(9),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=s(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.calculateState(e);return n.state={position:r.position,scrollSize:r.scrollSize,isDragging:!1,lastClientPosition:0},"vertical"===e.type?n.bindedHandleMouseMove=n.handleMouseMoveForVertical.bind(n):n.bindedHandleMouseMove=n.handleMouseMoveForHorizontal.bind(n),n.bindedHandleMouseUp=n.handleMouseUp.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+s(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this.props.ownerDocument&&(this.props.ownerDocument.addEventListener("mousemove",this.bindedHandleMouseMove),this.props.ownerDocument.addEventListener("mouseup",this.bindedHandleMouseUp))}},{key:"componentWillReceiveProps",value:function(e){this.setState(this.calculateState(e))}},{key:"componentWillUnmount",value:function(){this.props.ownerDocument&&(this.props.ownerDocument.removeEventListener("mousemove",this.bindedHandleMouseMove),this.props.ownerDocument.removeEventListener("mouseup",this.bindedHandleMouseUp))}},{key:"calculateFractionalPosition",value:function(e,t,n){var r=e-t;return 1-(r-n)/r}},{key:"calculateState",value:function(e){var t=this.calculateFractionalPosition(e.realSize,e.containerSize,e.position),n=e.containerSize*e.containerSize/e.realSize,r=n<e.minScrollSize?e.minScrollSize:n,o=(e.containerSize-r)*t;return{scrollSize:r,position:Math.round(o)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.smoothScrolling,r=t.isDragging,i=t.type,s=t.scrollbarStyle,c=t.containerStyle,d="horizontal"===i,p="vertical"===i,f=this.createScrollStyles(),h=n?(0,u.modifyObjValues)(f,(function(e){return(0,l.spring)(e)})):f,m="scrollbar-container "+(r?"active":"")+" "+(d?"horizontal":"")+" "+(p?"vertical":"");return a.default.createElement(l.Motion,{style:h},(function(t){return a.default.createElement("div",{className:m,style:c,onMouseDown:e.handleScrollBarContainerClick.bind(e),ref:function(t){return e.scrollbarContainer=t}},a.default.createElement("div",{className:"scrollbar",style:o({},s,t),onMouseDown:e.handleMouseDown.bind(e)}))}))}},{key:"handleScrollBarContainerClick",value:function(e){e.preventDefault();var t=this.computeMultiplier(),n=this.isVertical()?e.clientY:e.clientX,r=this.scrollbarContainer.getBoundingClientRect(),o=r.top,i=r.left,a=n-(this.isVertical()?o:i),s=this.props.containerSize*this.props.containerSize/this.props.realSize;this.setState({isDragging:!0,lastClientPosition:n}),this.props.onPositionChange((a-s/2)/t)}},{key:"handleMouseMoveForHorizontal",value:function(e){var t=this.computeMultiplier();if(this.state.isDragging){e.preventDefault();var n=this.state.lastClientPosition-e.clientX;this.setState({lastClientPosition:e.clientX}),this.props.onMove(0,n/t)}}},{key:"handleMouseMoveForVertical",value:function(e){var t=this.computeMultiplier();if(this.state.isDragging){e.preventDefault();var n=this.state.lastClientPosition-e.clientY;this.setState({lastClientPosition:e.clientY}),this.props.onMove(n/t,0)}}},{key:"handleMouseDown",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.isVertical()?e.clientY:e.clientX;this.setState({isDragging:!0,lastClientPosition:t}),this.props.onFocus()}},{key:"handleMouseUp",value:function(e){this.state.isDragging&&(e.preventDefault(),this.setState({isDragging:!1}))}},{key:"createScrollStyles",value:function(){return"vertical"===this.props.type?{height:this.state.scrollSize,marginTop:this.state.position}:{width:this.state.scrollSize,marginLeft:this.state.position}}},{key:"computeMultiplier",value:function(){return this.props.containerSize/this.props.realSize}},{key:"isVertical",value:function(){return"vertical"===this.props.type}}]),t}(a.default.Component);d.propTypes={onMove:c.default.func,onPositionChange:c.default.func,onFocus:c.default.func,realSize:c.default.number,containerSize:c.default.number,position:c.default.number,containerStyle:c.default.object,scrollbarStyle:c.default.object,type:c.default.oneOf(["vertical","horizontal"]),ownerDocument:c.default.any,smoothScrolling:c.default.bool,minScrollSize:c.default.number},d.defaultProps={type:"vertical",smoothScrolling:!1},t.default=d},function(e,t){e.exports=function(e,t,n){return((n=window.getComputedStyle)?n(e):e.currentStyle)[t.replace(/-(\w)/gi,(function(e,t){return t.toUpperCase()}))]}},function(e,t,n){(e.exports=n(17)()).push([e.id,".scrollarea-content{margin:0;padding:0;overflow:hidden;position:relative;touch-action:none}.scrollarea-content:focus{outline:0}.scrollarea{position:relative;overflow:hidden}.scrollarea .scrollbar-container{position:absolute;background:none;opacity:.1;z-index:99;-webkit-transition:all .4s;transition:all .4s}.scrollarea .scrollbar-container.horizontal{width:100%;height:10px;left:0;bottom:0}.scrollarea .scrollbar-container.horizontal .scrollbar{width:20px;height:8px;background:#000;margin-top:1px}.scrollarea .scrollbar-container.vertical{width:10px;height:100%;right:0;top:0}.scrollarea .scrollbar-container.vertical .scrollbar{width:8px;height:20px;background:#000;margin-left:1px}.scrollarea .scrollbar-container.active,.scrollarea .scrollbar-container:hover{background:gray;opacity:.6!important}.scrollarea:hover .scrollbar-container{opacity:.3}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){var r=n(15);e.exports=function(e){var t=r(e,"line-height"),n=parseFloat(t,10);if(t===n+""){var o=e.style.lineHeight;e.style.lineHeight=t+"em",t=r(e,"line-height"),n=parseFloat(t,10),o?e.style.lineHeight=o:delete e.style.lineHeight}if(-1!==t.indexOf("pt")?(n*=4,n/=3):-1!==t.indexOf("mm")?(n*=96,n/=25.4):-1!==t.indexOf("cm")?(n*=96,n/=2.54):-1!==t.indexOf("in")?n*=96:-1!==t.indexOf("pc")&&(n*=16),n=Math.round(n),"normal"===t){var i=e.nodeName,a=document.createElement(i);a.innerHTML="&nbsp;";var s=r(e,"font-size");a.style.fontSize=s;var c=document.body;c.appendChild(a),n=a.offsetHeight,c.removeChild(a)}return n}},function(e,t,n){"use strict";var r=n(21),o=n(22),i=n(20);e.exports=function(){function e(e,t,n,r,a,s){s!==i&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=r,n.PropTypes=n,n}},function(e,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){"use strict";function n(e){return function(){return e}}var r=function(){};r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,i,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,i,a,s],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,n){(function(t){(function(){var n,r,o,i,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},r=t.hrtime,n=function(){var e;return 1e9*(e=r())[0]+e[1]},i=n(),s=1e9*t.uptime(),a=i-s):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(t,n(10))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n(6)),c=r(n(3)),l=r(n(8)),u=r(n(4)),d=r(n(5)),p=r(n(7)),f=r(n(1)),h=r(n(2)),m=1e3/60,y=function(e){function t(n){var r=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e.call(this,n),this.wasAnimating=!1,this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyle=null,this.clearUnreadPropStyle=function(e){var t=!1,n=r.state,i=n.currentStyle,a=n.currentVelocity,s=n.lastIdealStyle,c=n.lastIdealVelocity;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var u=e[l];"number"==typeof u&&(t||(t=!0,i=o({},i),a=o({},a),s=o({},s),c=o({},c)),i[l]=u,a[l]=0,s[l]=u,c[l]=0)}t&&r.setState({currentStyle:i,currentVelocity:a,lastIdealStyle:s,lastIdealVelocity:c})},this.startAnimationIfNecessary=function(){r.animationID=d.default((function(e){var t=r.props.style;if(p.default(r.state.currentStyle,t,r.state.currentVelocity))return r.wasAnimating&&r.props.onRest&&r.props.onRest(),r.animationID=null,r.wasAnimating=!1,void(r.accumulatedTime=0);r.wasAnimating=!0;var n=e||u.default(),o=n-r.prevTime;if(r.prevTime=n,r.accumulatedTime=r.accumulatedTime+o,r.accumulatedTime>10*m&&(r.accumulatedTime=0),0===r.accumulatedTime)return r.animationID=null,void r.startAnimationIfNecessary();var i=(r.accumulatedTime-Math.floor(r.accumulatedTime/m)*m)/m,a=Math.floor(r.accumulatedTime/m),s={},c={},d={},f={};for(var h in t)if(Object.prototype.hasOwnProperty.call(t,h)){var y=t[h];if("number"==typeof y)d[h]=y,f[h]=0,s[h]=y,c[h]=0;else{for(var b=r.state.lastIdealStyle[h],v=r.state.lastIdealVelocity[h],g=0;g<a;g++){var S=l.default(m/1e3,b,v,y.val,y.stiffness,y.damping,y.precision);b=S[0],v=S[1]}var w=l.default(m/1e3,b,v,y.val,y.stiffness,y.damping,y.precision),k=w[0],O=w[1];d[h]=b+(k-b)*i,f[h]=v+(O-v)*i,s[h]=b,c[h]=v}}r.animationID=null,r.accumulatedTime-=a*m,r.setState({currentStyle:d,currentVelocity:f,lastIdealStyle:s,lastIdealVelocity:c}),r.unreadPropStyle=null,r.startAnimationIfNecessary()}))},this.state=this.defaultState()}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+s(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,null,[{key:"propTypes",value:{defaultStyle:h.default.objectOf(h.default.number),style:h.default.objectOf(h.default.oneOfType([h.default.number,h.default.object])).isRequired,children:h.default.func.isRequired,onRest:h.default.func},enumerable:!0}]),t.prototype.defaultState=function(){var e=this.props,t=e.defaultStyle,n=e.style,r=t||c.default(n),o=a.default(r);return{currentStyle:r,currentVelocity:o,lastIdealStyle:r,lastIdealVelocity:o}},t.prototype.componentDidMount=function(){this.prevTime=u.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function(e){null!=this.unreadPropStyle&&this.clearUnreadPropStyle(this.unreadPropStyle),this.unreadPropStyle=e.style,null==this.animationID&&(this.prevTime=u.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function(){null!=this.animationID&&(d.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function(){var e=this.props.children(this.state.currentStyle);return e&&f.default.Children.only(e)},t}(f.default.Component);t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){for(var r=0;r<e.length;r++)if(!f.default(e[r],t[r],n[r]))return!1;return!0}t.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(n(6)),l=r(n(3)),u=r(n(8)),d=r(n(4)),p=r(n(5)),f=r(n(7)),h=r(n(1)),m=r(n(2)),y=1e3/60,b=function(e){function t(n){var r=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e.call(this,n),this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyles=null,this.clearUnreadPropStyle=function(e){for(var t=r.state,n=t.currentStyles,o=t.currentVelocities,a=t.lastIdealStyles,s=t.lastIdealVelocities,c=!1,l=0;l<e.length;l++){var u=e[l],d=!1;for(var p in u)if(Object.prototype.hasOwnProperty.call(u,p)){var f=u[p];"number"==typeof f&&(d||(d=!0,c=!0,n[l]=i({},n[l]),o[l]=i({},o[l]),a[l]=i({},a[l]),s[l]=i({},s[l])),n[l][p]=f,o[l][p]=0,a[l][p]=f,s[l][p]=0)}}c&&r.setState({currentStyles:n,currentVelocities:o,lastIdealStyles:a,lastIdealVelocities:s})},this.startAnimationIfNecessary=function(){r.animationID=p.default((function(e){var t=r.props.styles(r.state.lastIdealStyles);if(o(r.state.currentStyles,t,r.state.currentVelocities))return r.animationID=null,void(r.accumulatedTime=0);var n=e||d.default(),i=n-r.prevTime;if(r.prevTime=n,r.accumulatedTime=r.accumulatedTime+i,r.accumulatedTime>10*y&&(r.accumulatedTime=0),0===r.accumulatedTime)return r.animationID=null,void r.startAnimationIfNecessary();for(var a=(r.accumulatedTime-Math.floor(r.accumulatedTime/y)*y)/y,s=Math.floor(r.accumulatedTime/y),c=[],l=[],p=[],f=[],h=0;h<t.length;h++){var m=t[h],b={},v={},g={},S={};for(var w in m)if(Object.prototype.hasOwnProperty.call(m,w)){var k=m[w];if("number"==typeof k)b[w]=k,v[w]=0,g[w]=k,S[w]=0;else{for(var O=r.state.lastIdealStyles[h][w],P=r.state.lastIdealVelocities[h][w],E=0;E<s;E++){var C=u.default(y/1e3,O,P,k.val,k.stiffness,k.damping,k.precision);O=C[0],P=C[1]}var T=u.default(y/1e3,O,P,k.val,k.stiffness,k.damping,k.precision),x=T[0],j=T[1];b[w]=O+(x-O)*a,v[w]=P+(j-P)*a,g[w]=O,S[w]=P}}p[h]=b,f[h]=v,c[h]=g,l[h]=S}r.animationID=null,r.accumulatedTime-=s*y,r.setState({currentStyles:p,currentVelocities:f,lastIdealStyles:c,lastIdealVelocities:l}),r.unreadPropStyles=null,r.startAnimationIfNecessary()}))},this.state=this.defaultState()}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+s(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,null,[{key:"propTypes",value:{defaultStyles:m.default.arrayOf(m.default.objectOf(m.default.number)),styles:m.default.func.isRequired,children:m.default.func.isRequired},enumerable:!0}]),t.prototype.defaultState=function(){var e=this.props,t=e.defaultStyles,n=e.styles,r=t||n().map(l.default),o=r.map((function(e){return c.default(e)}));return{currentStyles:r,currentVelocities:o,lastIdealStyles:r,lastIdealVelocities:o}},t.prototype.componentDidMount=function(){this.prevTime=d.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function(e){null!=this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles),this.unreadPropStyles=e.styles(this.state.lastIdealStyles),null==this.animationID&&(this.prevTime=d.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function(){null!=this.animationID&&(p.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function(){var e=this.props.children(this.state.currentStyles);return e&&h.default.Children.only(e)},t}(h.default.Component);t.default=b,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=t;return null==r?e.map((function(e,t){return{key:e.key,data:e.data,style:n[t]}})):e.map((function(e,t){for(var o=0;o<r.length;o++)if(r[o].key===e.key)return{key:r[o].key,data:r[o].data,style:n[t]};return{key:e.key,data:e.data,style:n[t]}}))}function i(e,t,n,r){if(r.length!==t.length)return!1;for(var o=0;o<r.length;o++)if(r[o].key!==t[o].key)return!1;for(o=0;o<r.length;o++)if(!y.default(e[o],t[o].style,n[o]))return!1;return!0}function a(e,t,n,r,o,i,a,s,c){for(var l=f.default(r,o,(function(e,r){var o=t(r);return null==o||y.default(i[e],o,a[e])?(n({key:r.key,data:r.data}),null):{key:r.key,data:r.data,style:o}})),d=[],p=[],h=[],m=[],b=0;b<l.length;b++){for(var v=l[b],g=null,S=0;S<r.length;S++)if(r[S].key===v.key){g=S;break}if(null==g){var w=e(v);d[b]=w,h[b]=w;var k=u.default(v.style);p[b]=k,m[b]=k}else d[b]=i[g],h[b]=s[g],p[b]=a[g],m[b]=c[g]}return[l,d,p,h,m]}t.__esModule=!0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=r(n(6)),d=r(n(3)),p=r(n(8)),f=r(n(27)),h=r(n(4)),m=r(n(5)),y=r(n(7)),b=r(n(1)),v=r(n(2)),g=1e3/60,S=function(e){function t(n){var r=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e.call(this,n),this.unmounting=!1,this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyles=null,this.clearUnreadPropStyle=function(e){for(var t=a(r.props.willEnter,r.props.willLeave,r.props.didLeave,r.state.mergedPropsStyles,e,r.state.currentStyles,r.state.currentVelocities,r.state.lastIdealStyles,r.state.lastIdealVelocities),n=t[0],o=t[1],i=t[2],s=t[3],l=t[4],u=0;u<e.length;u++){var d=e[u].style,p=!1;for(var f in d)if(Object.prototype.hasOwnProperty.call(d,f)){var h=d[f];"number"==typeof h&&(p||(p=!0,o[u]=c({},o[u]),i[u]=c({},i[u]),s[u]=c({},s[u]),l[u]=c({},l[u]),n[u]={key:n[u].key,data:n[u].data,style:c({},n[u].style)}),o[u][f]=h,i[u][f]=0,s[u][f]=h,l[u][f]=0,n[u].style[f]=h)}}r.setState({currentStyles:o,currentVelocities:i,mergedPropsStyles:n,lastIdealStyles:s,lastIdealVelocities:l})},this.startAnimationIfNecessary=function(){r.unmounting||(r.animationID=m.default((function(e){if(!r.unmounting){var t=r.props.styles,n="function"==typeof t?t(o(r.state.mergedPropsStyles,r.unreadPropStyles,r.state.lastIdealStyles)):t;if(i(r.state.currentStyles,n,r.state.currentVelocities,r.state.mergedPropsStyles))return r.animationID=null,void(r.accumulatedTime=0);var s=e||h.default(),c=s-r.prevTime;if(r.prevTime=s,r.accumulatedTime=r.accumulatedTime+c,r.accumulatedTime>10*g&&(r.accumulatedTime=0),0===r.accumulatedTime)return r.animationID=null,void r.startAnimationIfNecessary();for(var l=(r.accumulatedTime-Math.floor(r.accumulatedTime/g)*g)/g,u=Math.floor(r.accumulatedTime/g),d=a(r.props.willEnter,r.props.willLeave,r.props.didLeave,r.state.mergedPropsStyles,n,r.state.currentStyles,r.state.currentVelocities,r.state.lastIdealStyles,r.state.lastIdealVelocities),f=d[0],m=d[1],y=d[2],b=d[3],v=d[4],S=0;S<f.length;S++){var w=f[S].style,k={},O={},P={},E={};for(var C in w)if(Object.prototype.hasOwnProperty.call(w,C)){var T=w[C];if("number"==typeof T)k[C]=T,O[C]=0,P[C]=T,E[C]=0;else{for(var x=b[S][C],j=v[S][C],R=0;R<u;R++){var I=p.default(g/1e3,x,j,T.val,T.stiffness,T.damping,T.precision);x=I[0],j=I[1]}var _=p.default(g/1e3,x,j,T.val,T.stiffness,T.damping,T.precision),A=_[0],M=_[1];k[C]=x+(A-x)*l,O[C]=j+(M-j)*l,P[C]=x,E[C]=j}}b[S]=P,v[S]=E,m[S]=k,y[S]=O}r.animationID=null,r.accumulatedTime-=u*g,r.setState({currentStyles:m,currentVelocities:y,lastIdealStyles:b,lastIdealVelocities:v,mergedPropsStyles:f}),r.unreadPropStyles=null,r.startAnimationIfNecessary()}})))},this.state=this.defaultState()}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+s(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,null,[{key:"propTypes",value:{defaultStyles:v.default.arrayOf(v.default.shape({key:v.default.string.isRequired,data:v.default.any,style:v.default.objectOf(v.default.number).isRequired})),styles:v.default.oneOfType([v.default.func,v.default.arrayOf(v.default.shape({key:v.default.string.isRequired,data:v.default.any,style:v.default.objectOf(v.default.oneOfType([v.default.number,v.default.object])).isRequired}))]).isRequired,children:v.default.func.isRequired,willEnter:v.default.func,willLeave:v.default.func,didLeave:v.default.func},enumerable:!0},{key:"defaultProps",value:{willEnter:function(e){return d.default(e.style)},willLeave:function(){return null},didLeave:function(){}},enumerable:!0}]),t.prototype.defaultState=function(){var e,t=this.props,n=t.defaultStyles,r=t.styles,o=t.willEnter,i=t.willLeave,s=t.didLeave,c="function"==typeof r?r(n):r;e=null==n?c:n.map((function(e){for(var t=0;t<c.length;t++)if(c[t].key===e.key)return c[t];return e}));var l=null==n?c.map((function(e){return d.default(e.style)})):n.map((function(e){return d.default(e.style)})),p=null==n?c.map((function(e){return u.default(e.style)})):n.map((function(e){return u.default(e.style)})),f=a(o,i,s,e,c,l,p,l,p),h=f[0];return{currentStyles:f[1],currentVelocities:f[2],lastIdealStyles:f[3],lastIdealVelocities:f[4],mergedPropsStyles:h}},t.prototype.componentDidMount=function(){this.prevTime=h.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function(e){this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles);var t=e.styles;this.unreadPropStyles="function"==typeof t?t(o(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.lastIdealStyles)):t,null==this.animationID&&(this.prevTime=h.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function(){this.unmounting=!0,null!=this.animationID&&(m.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function(){var e=o(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.currentStyles),t=this.props.children(e);return t&&b.default.Children.only(t)},t}(b.default.Component);t.default=S,e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t,n){for(var r={},o=0;o<e.length;o++)r[e[o].key]=o;var i={};for(o=0;o<t.length;o++)i[t[o].key]=o;var a=[];for(o=0;o<t.length;o++)a[o]=t[o];for(o=0;o<e.length;o++)if(!Object.prototype.hasOwnProperty.call(i,e[o].key)){var s=n(o,e[o]);null!=s&&a.push(s)}return a.sort((function(e,n){var o=i[e.key],a=i[n.key],s=r[e.key],c=r[n.key];if(null!=o&&null!=a)return i[e.key]-i[n.key];if(null!=s&&null!=c)return r[e.key]-r[n.key];if(null!=o){for(var l=0;l<t.length;l++){var u=t[l].key;if(Object.prototype.hasOwnProperty.call(r,u)){if(o<i[u]&&c>r[u])return-1;if(o>i[u]&&c<r[u])return 1}}return 1}for(l=0;l<t.length;l++)if(u=t[l].key,Object.prototype.hasOwnProperty.call(r,u)){if(a<i[u]&&s>r[u])return 1;if(a>i[u]&&s<r[u])return-1}return-1}))},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(){},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e,t){return r({},i,t,{val:e})};var o=function(e){return e&&e.__esModule?e:{default:e}}(n(11)),i=r({},o.default.noWobble,{precision:.01});e.exports=t.default},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=f[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(l(r.parts[i],t))}else{var a=[];for(i=0;i<r.parts.length;i++)a.push(l(r.parts[i],t));f[r.id]={id:r.id,refs:1,parts:a}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[i]?n[i].parts.push(a):t.push(n[i]={id:i,parts:[a]})}return t}function i(e,t){var n=y(),r=g[g.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),g.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=g.indexOf(e);t>=0&&g.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function c(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function l(e,t){var n,r,o;if(t.singleton){var i=v++;n=b||(b=s(t)),r=u.bind(null,n,i,!1),o=u.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=c(t),r=p.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=d.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function u(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=S(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function d(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function p(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var f={},h=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},m=h((function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())})),y=h((function(){return document.head||document.getElementsByTagName("head")[0]})),b=null,v=0,g=[];e.exports=function(e,t){void 0===(t=t||{}).singleton&&(t.singleton=m()),void 0===t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var s=n[a];(c=f[s.id]).refs--,i.push(c)}for(e&&r(o(e),t),a=0;a<i.length;a++){var c;if(0===(c=i[a]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete f[c.id]}}}};var S=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){var r=n(16);"string"==typeof r&&(r=[[e.id,r,""]]),n(30)(r,{}),r.locals&&(e.exports=r.locals)}])},"object"==s(t)&&"object"==s(e)?e.exports=a(n(16689)):(o=[n(16689)],void 0===(i="function"==typeof(r=a)?r.apply(t,o):r)||(e.exports=i))},6375:(e,t,n)=>{"use strict";n(57860);var r=n(16689),o=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var i=Symbol.for;o=i("react.element"),t.Fragment=i("react.fragment")}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:a.current}}t.jsx=l,t.jsxs=l},2038:(e,t,n)=>{"use strict";e.exports=n(6375)},12590:e=>{"use strict";var t=function(e){return e&&2===e.CLOSING},n=function(e,t,n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t},enumerable:!0,configurable:!0})},r=function(e){return e.minReconnectionDelay+Math.random()*e.minReconnectionDelay},o=["onopen","onclose","onmessage","onerror"];e.exports=function e(i,a,s){var c,l,u=this;void 0===s&&(s={});var d=0,p=0,f=!0,h=null,m={};if(!(this instanceof e))throw new TypeError("Failed to construct 'ReconnectingWebSocket': Please use the 'new' operator");var y={constructor:"undefined"!=typeof WebSocket&&t(WebSocket)?WebSocket:null,maxReconnectionDelay:1e4,minReconnectionDelay:1500,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,debug:!1};if(Object.keys(y).filter((function(e){return s.hasOwnProperty(e)})).forEach((function(e){return y[e]=s[e]})),!t(y.constructor))throw new TypeError("Invalid WebSocket constructor. Set `options.constructor`");var b=y.debug?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.log.apply(console,["RWS:"].concat(e))}:function(){},v=function(e,t){return setTimeout((function(){var n=new Error(t);n.code=e,Array.isArray(m.error)&&m.error.forEach((function(e){return(0,e[0])(n)})),c.onerror&&c.onerror(n)}),0)},g=function(){b("handleClose",{shouldRetry:f}),p++,b("retries count:",p),p>y.maxRetries?v("EHOSTDOWN","Too many failed connection attempts"):(d=d?function(e,t){var n=t*e.reconnectionDelayGrowFactor;return n>e.maxReconnectionDelay?e.maxReconnectionDelay:n}(y,d):r(y),b("handleClose - reconnectDelay:",d),f&&setTimeout(S,d))},S=function(){if(f){b("connect");var e=c,t="function"==typeof i?i():i;for(var s in c=new y.constructor(t,a),l=setTimeout((function(){b("timeout"),c.close(),v("ETIMEDOUT","Connection timeout")}),y.connectionTimeout),b("bypass properties"),c)["addEventListener","removeEventListener","close","send"].indexOf(s)<0&&n(c,u,s);c.addEventListener("open",(function(){clearTimeout(l),b("open"),d=r(y),b("reconnectDelay:",d),p=0})),c.addEventListener("close",g),function(e,t,n){Object.keys(n).forEach((function(t){n[t].forEach((function(n){var r=n[0],o=n[1];e.addEventListener(t,r,o)}))})),t&&o.forEach((function(n){e[n]=t[n]}))}(c,e,m),c.onclose=c.onclose||h,h=null}};b("init"),S(),this.close=function(e,t,n){void 0===e&&(e=1e3),void 0===t&&(t="");var r=void 0===n?{}:n,o=r.keepClosed,i=void 0!==o&&o,a=r.fastClose,s=void 0===a||a,l=r.delay,u=void 0===l?0:l;if(b("close - params:",{reason:t,keepClosed:i,fastClose:s,delay:u,retriesCount:p,maxRetries:y.maxRetries}),f=!i&&p<=y.maxRetries,u&&(d=u),c.close(e,t),s){var v={code:e,reason:t,wasClean:!0};g(),c.removeEventListener("close",g),Array.isArray(m.close)&&m.close.forEach((function(e){var t=e[0],n=e[1];t(v),c.removeEventListener("close",t,n)})),c.onclose&&(h=c.onclose,c.onclose(v),c.onclose=null)}},this.send=function(e){c.send(e)},this.addEventListener=function(e,t,n){Array.isArray(m[e])?m[e].some((function(e){return e[0]===t}))||m[e].push([t,n]):m[e]=[[t,n]],c.addEventListener(e,t,n)},this.removeEventListener=function(e,t,n){Array.isArray(m[e])&&(m[e]=m[e].filter((function(e){return e[0]!==t}))),c.removeEventListener(e,t,n)}}},239:(e,t,n)=>{"use strict";var r=n(81091).functionsHaveConfigurableNames(),o=Object,i=TypeError;e.exports=function(){if(null!=this&&this!==o(this))throw new i("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e},r&&Object.defineProperty&&Object.defineProperty(e.exports,"name",{value:"get flags"})},30907:(e,t,n)=>{"use strict";var r=n(10635),o=n(64411),i=n(239),a=n(12019),s=n(44238),c=o(a());r(c,{getPolyfill:a,implementation:i,shim:s}),e.exports=c},12019:(e,t,n)=>{"use strict";var r=n(239),o=n(10635).supportsDescriptors,i=Object.getOwnPropertyDescriptor;e.exports=function(){if(o&&"gim"===/a/gim.flags){var e=i(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),"dy"===t)return e.get}}return r}},44238:(e,t,n)=>{"use strict";var r=n(10635).supportsDescriptors,o=n(12019),i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,c=Object.getPrototypeOf,l=/a/;e.exports=function(){if(!r||!c)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=o(),t=c(l),n=i(t,"flags");return n&&n.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},645:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(43532),i=n(49493),a=n(96338),s=o("%TypeError%"),c=o("%WeakMap%",!0),l=o("%Map%",!0),u=i("WeakMap.prototype.get",!0),d=i("WeakMap.prototype.set",!0),p=i("WeakMap.prototype.has",!0),f=i("Map.prototype.get",!0),h=i("Map.prototype.set",!0),m=i("Map.prototype.has",!0),y=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n};e.exports=function(){var e,t,n,o={assert:function(e){if(!o.has(e))throw new s("Side channel does not contain "+a(e))},get:function(o){if(c&&o&&("object"===r(o)||"function"==typeof o)){if(e)return u(e,o)}else if(l){if(t)return f(t,o)}else if(n)return function(e,t){var n=y(e,t);return n&&n.value}(n,o)},has:function(o){if(c&&o&&("object"===r(o)||"function"==typeof o)){if(e)return p(e,o)}else if(l){if(t)return m(t,o)}else if(n)return function(e,t){return!!y(e,t)}(n,o);return!1},set:function(o,i){c&&o&&("object"===r(o)||"function"==typeof o)?(e||(e=new c),d(e,o,i)):l?(t||(t=new l),h(t,o,i)):(n||(n={key:{},next:null}),function(e,t,n){var r=y(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,o,i))}};return o}},65176:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(50434),i=n(33524),a=n(30293),s=n(57764),c=n(39518);e.exports=function(e){return null==e||"object"!==r(e)&&"function"!=typeof e?null:o(e)?"String":i(e)?"Number":a(e)?"Boolean":s(e)?"Symbol":c(e)?"BigInt":void 0}},2607:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(77758),i=n(93167),a=n(49493),s=a("Object.prototype.toString"),c=n(87285)()&&"symbol"===r(Symbol.toStringTag),l=i(),u=a("String.prototype.slice"),d={},p=n(16992),f=Object.getPrototypeOf;c&&p&&f&&o(l,(function(e){if("function"==typeof n.g[e]){var t=new n.g[e];if(!(Symbol.toStringTag in t))throw new EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var r=f(t),o=p(r,Symbol.toStringTag);if(!o){var i=f(r);o=p(i,Symbol.toStringTag)}d[e]=o.get}}));var h=n(18215);e.exports=function(e){return!!h(e)&&(c?function(e){var t=!1;return o(d,(function(n,r){if(!t)try{var o=n.call(e);o===r&&(t=o)}catch(e){}})),t}(e):u(s(e),8,-1))}},59003:e=>{"use strict";e.exports=require("classnames")},39105:e=>{"use strict";e.exports=require("color")},4305:e=>{"use strict";e.exports=require("lodash.debounce")},39455:e=>{"use strict";e.exports=require("material-ui")},13173:e=>{"use strict";e.exports=require("material-ui/styles")},580:e=>{"use strict";e.exports=require("prop-types")},10757:e=>{"use strict";e.exports=require("pydio")},56880:e=>{"use strict";e.exports=require("pydio/http/api")},85829:e=>{"use strict";e.exports=require("pydio/http/meta-cache-service")},62610:e=>{"use strict";e.exports=require("pydio/http/resources-manager")},82702:e=>{"use strict";e.exports=require("pydio/http/users-api")},2282:e=>{"use strict";e.exports=require("pydio/model/controller")},14603:e=>{"use strict";e.exports=require("pydio/model/data-model")},7180:e=>{"use strict";e.exports=require("pydio/util/func")},14021:e=>{"use strict";e.exports=require("pydio/util/periodical-executer")},16689:e=>{"use strict";e.exports=require("react")},66405:e=>{"use strict";e.exports=require("react-dom")},70192:e=>{"use strict";e.exports=require("react-draggable")},65863:()=>{},42970:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},93167:(e,t,n)=>{"use strict";var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof n.g[r[t]]&&(e[e.length]=r[t]);return e}},16992:(e,t,n)=>{"use strict";var r=n(43532)("%Object.getOwnPropertyDescriptor%");if(r)try{r([],"length")}catch(e){r=null}e.exports=r},23382:(e,t,n)=>{"use strict";var r=n(80288);if(n(87285)()||n(2112)()){var o=Symbol.iterator;e.exports=function(e){return null!=e&&void 0!==e[o]?e[o]():r(e)?Array.prototype[o].call(e):void 0}}else{var i=n(99776),a=n(50434),s=n(43532),c=s("%Map%",!0),l=s("%Set%",!0),u=n(49493),d=u("Array.prototype.push"),p=u("String.prototype.charCodeAt"),f=u("String.prototype.slice"),h=function(e){var t=0;return{next:function(){var n,r=t>=e.length;return r||(n=e[t],t+=1),{done:r,value:n}}}},m=function(e,t){if(i(e)||r(e))return h(e);if(a(e)){var n=0;return{next:function(){var t=function(e,t){if(t+1>=e.length)return t+1;var n=p(e,t);if(n<55296||n>56319)return t+1;var r=p(e,t+1);return r<56320||r>57343?t+1:t+2}(e,n),r=f(e,n,t);return n=t,{done:t>e.length,value:r}}}}return t&&void 0!==e["_es6-shim iterator_"]?e["_es6-shim iterator_"]():void 0};if(c||l){var y=n(33410),b=n(32454),v=u("Map.prototype.forEach",!0),g=u("Set.prototype.forEach",!0);if("undefined"==typeof process||!process.versions||!process.versions.node)var S=u("Map.prototype.iterator",!0),w=u("Set.prototype.iterator",!0),k=function(e){var t=!1;return{next:function(){try{return{done:t,value:t?void 0:e.next()}}catch(e){return t=!0,{done:!0,value:void 0}}}}};var O=u("Map.prototype.@@iterator",!0)||u("Map.prototype._es6-shim iterator_",!0),P=u("Set.prototype.@@iterator",!0)||u("Set.prototype._es6-shim iterator_",!0);e.exports=function(e){return function(e){if(y(e)){if(S)return k(S(e));if(O)return O(e);if(v){var t=[];return v(e,(function(e,n){d(t,[n,e])})),h(t)}}if(b(e)){if(w)return k(w(e));if(P)return P(e);if(g){var n=[];return g(e,(function(e){d(n,e)})),h(n)}}}(e)||m(e)}}else e.exports=function(e){if(null!=e)return m(e,!0)}}},18724:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n(33410),i=n(32454),a=n(30464),s=n(77799);e.exports=function(e){if(e&&"object"===r(e)){if(o(e))return"Map";if(i(e))return"Set";if(a(e))return"WeakMap";if(s(e))return"WeakSet"}return!1}},79777:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{Z:()=>r})},86646:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}n.d(t,{Z:()=>r})},51730:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{Z:()=>r})},83265:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}n.d(t,{Z:()=>r})},60634:(e,t,n)=>{"use strict";n.d(t,{Ab:()=>a,Fr:()=>s,G$:()=>i,K$:()=>l,MS:()=>r,h5:()=>c,lK:()=>u,uj:()=>o});var r="-ms-",o="-moz-",i="-webkit-",a="comm",s="rule",c="decl",l="@import",u="@keyframes"},36999:(e,t,n)=>{"use strict";n.d(t,{cD:()=>i,qR:()=>o});var r=n(27125);function o(e){var t=(0,r.Ei)(e);return function(n,r,o,i){for(var a="",s=0;s<t;s++)a+=e[s](n,r,o,i)||"";return a}}function i(e){return function(t){t.root||(t=t.return)&&e(t)}}},64873:(e,t,n)=>{"use strict";n.d(t,{MY:()=>a});var r=n(60634),o=n(27125),i=n(35438);function a(e){return(0,i.cE)(s("",null,null,null,[""],e=(0,i.un)(e),0,[0],e))}function s(e,t,n,r,a,d,p,f,h){for(var m=0,y=0,b=p,v=0,g=0,S=0,w=1,k=1,O=1,P=0,E="",C=a,T=d,x=r,j=E;k;)switch(S=P,P=(0,i.lp)()){case 40:if(108!=S&&58==(0,o.uO)(j,b-1)){-1!=(0,o.Cw)(j+=(0,o.gx)((0,i.iF)(P),"&","&\f"),"&\f")&&(O=-1);break}case 34:case 39:case 91:j+=(0,i.iF)(P);break;case 9:case 10:case 13:case 32:j+=(0,i.Qb)(S);break;case 92:j+=(0,i.kq)((0,i.Ud)()-1,7);continue;case 47:switch((0,i.fj)()){case 42:case 47:(0,o.R3)(l((0,i.q6)((0,i.lp)(),(0,i.Ud)()),t,n),h);break;default:j+="/"}break;case 123*w:f[m++]=(0,o.to)(j)*O;case 125*w:case 59:case 0:switch(P){case 0:case 125:k=0;case 59+y:g>0&&(0,o.to)(j)-b&&(0,o.R3)(g>32?u(j+";",r,n,b-1):u((0,o.gx)(j," ","")+";",r,n,b-2),h);break;case 59:j+=";";default:if((0,o.R3)(x=c(j,t,n,m,y,a,f,E,C=[],T=[],b),d),123===P)if(0===y)s(j,t,x,x,C,d,b,f,T);else switch(99===v&&110===(0,o.uO)(j,3)?100:v){case 100:case 109:case 115:s(e,x,x,r&&(0,o.R3)(c(e,x,x,0,0,a,f,E,a,C=[],b),T),a,T,b,f,r?C:T);break;default:s(j,x,x,x,[""],T,0,f,T)}}m=y=g=0,w=O=1,E=j="",b=p;break;case 58:b=1+(0,o.to)(j),g=S;default:if(w<1)if(123==P)--w;else if(125==P&&0==w++&&125==(0,i.mp)())continue;switch(j+=(0,o.Dp)(P),P*w){case 38:O=y>0?1:(j+="\f",-1);break;case 44:f[m++]=((0,o.to)(j)-1)*O,O=1;break;case 64:45===(0,i.fj)()&&(j+=(0,i.iF)((0,i.lp)())),v=(0,i.fj)(),y=b=(0,o.to)(E=j+=(0,i.QU)((0,i.Ud)())),P++;break;case 45:45===S&&2==(0,o.to)(j)&&(w=0)}}return d}function c(e,t,n,a,s,c,l,u,d,p,f){for(var h=s-1,m=0===s?c:[""],y=(0,o.Ei)(m),b=0,v=0,g=0;b<a;++b)for(var S=0,w=(0,o.tb)(e,h+1,h=(0,o.Wn)(v=l[b])),k=e;S<y;++S)(k=(0,o.fy)(v>0?m[S]+" "+w:(0,o.gx)(w,/&\f/g,m[S])))&&(d[g++]=k);return(0,i.dH)(e,t,n,0===s?r.Fr:u,d,p,f)}function l(e,t,n){return(0,i.dH)(e,t,n,r.Ab,(0,o.Dp)((0,i.Tb)()),(0,o.tb)(e,2,-2),0)}function u(e,t,n,a){return(0,i.dH)(e,t,n,r.h5,(0,o.tb)(e,0,a),(0,o.tb)(e,a+1,-1),a)}},22807:(e,t,n)=>{"use strict";n.d(t,{P:()=>a,q:()=>i});var r=n(60634),o=n(27125);function i(e,t){for(var n="",r=(0,o.Ei)(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function a(e,t,n,a){switch(e.type){case r.K$:case r.h5:return e.return=e.return||e.value;case r.Ab:return"";case r.lK:return e.return=e.value+"{"+i(e.children,a)+"}";case r.Fr:e.value=e.props.join(",")}return(0,o.to)(n=i(e.children,a))?e.return=e.value+"{"+n+"}":""}},35438:(e,t,n)=>{"use strict";n.d(t,{FK:()=>s,JG:()=>d,QU:()=>C,Qb:()=>k,Tb:()=>p,Ud:()=>y,cE:()=>S,dH:()=>u,fj:()=>m,iF:()=>w,kq:()=>O,lp:()=>h,mp:()=>f,q6:()=>E,r:()=>v,tP:()=>b,un:()=>g});var r=n(27125),o=1,i=1,a=0,s=0,c=0,l="";function u(e,t,n,r,a,s,c){return{value:e,root:t,parent:n,type:r,props:a,children:s,line:o,column:i,length:c,return:""}}function d(e,t){return(0,r.f0)(u("",null,null,"",null,null,0),e,{length:-e.length},t)}function p(){return c}function f(){return c=s>0?(0,r.uO)(l,--s):0,i--,10===c&&(i=1,o--),c}function h(){return c=s<a?(0,r.uO)(l,s++):0,i++,10===c&&(i=1,o++),c}function m(){return(0,r.uO)(l,s)}function y(){return s}function b(e,t){return(0,r.tb)(l,e,t)}function v(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function g(e){return o=i=1,a=(0,r.to)(l=e),s=0,[]}function S(e){return l="",e}function w(e){return(0,r.fy)(b(s-1,P(91===e?e+2:40===e?e+1:e)))}function k(e){for(;(c=m())&&c<33;)h();return v(e)>2||v(c)>3?"":" "}function O(e,t){for(;--t&&h()&&!(c<48||c>102||c>57&&c<65||c>70&&c<97););return b(e,y()+(t<6&&32==m()&&32==h()))}function P(e){for(;h();)switch(c){case e:return s;case 34:case 39:34!==e&&39!==e&&P(c);break;case 40:41===e&&P(e);break;case 92:h()}return s}function E(e,t){for(;h()&&e+c!==57&&(e+c!==84||47!==m()););return"/*"+b(t,s-1)+"*"+(0,r.Dp)(47===e?e:h())}function C(e){for(;!v(m());)h();return b(e,s)}},27125:(e,t,n)=>{"use strict";n.d(t,{$e:()=>y,Cw:()=>u,Dp:()=>o,EQ:()=>c,Ei:()=>h,R3:()=>m,Wn:()=>r,f0:()=>i,fy:()=>s,gx:()=>l,tb:()=>p,to:()=>f,uO:()=>d,vp:()=>a});var r=Math.abs,o=String.fromCharCode,i=Object.assign;function a(e,t){return 45^d(e,0)?(((t<<2^d(e,0))<<2^d(e,1))<<2^d(e,2))<<2^d(e,3):0}function s(e){return e.trim()}function c(e,t){return(e=t.exec(e))?e[0]:e}function l(e,t,n){return e.replace(t,n)}function u(e,t){return e.indexOf(t)}function d(e,t){return 0|e.charCodeAt(t)}function p(e,t,n){return e.slice(t,n)}function f(e){return e.length}function h(e){return e.length}function m(e,t){return t.push(e),e}function y(e,t){return e.map(t).join("")}}},i={};function a(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return o[e].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=o,a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);a.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,a.d(o,i),o},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,n)=>(a.f[n](e,t),t)),[])),a.u=e=>"rgl.min.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="gui.ajax:",a.l=(e,t,o,i)=>{if(n[e])n[e].push(t);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==r+o){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",r+o),s.src=e),n[e]=[t];var p=(t,r)=>{s.onerror=s.onload=null,clearTimeout(f);var o=n[e];if(delete n[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(r))),t)return t(r)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),c&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.p="plug/gui.ajax/res/dist/libs/",(()=>{var e={543:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=a.p+a.u(t),s=new Error;a.l(i,(n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[i,s,c]=n,l=0;if(i.some((t=>0!==e[t]))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);c&&c(a)}for(t&&t(n);l<i.length;l++)o=i[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkgui_ajax=self.webpackChunkgui_ajax||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s={};(()=>{"use strict";a.r(s),a.d(s,{default:()=>a_});var e=a(16689),t=a.n(e),n=a(66405),r=a.n(n),o=a(14603),i=a.n(o);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}var u=a(7180),d=a(62610),p={NODE_PROVIDER:"node",SORTABLE_LIST_ITEM:"sortable-list-item"};function f(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}function h(e,t){return{connectDropTarget:e.dropTarget(),canDrop:t.canDrop(),isOver:t.isOver(),isOverCurrent:t.isOver({shallow:!0})}}var m=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._source=t,this._target=n,this._step=r,this._dropEffect=o}var t,n;return t=e,(n=[{key:"getSource",value:function(){return this._source}},{key:"getTarget",value:function(){return this._target}},{key:"getStep",value:function(){return this._step}},{key:"getDropEffect",value:function(){return this._dropEffect}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();m.STEP_BEGIN_DRAG="beginDrag",m.STEP_END_DRAG="endDrag",m.STEP_CAN_DROP="canDrop",m.STEP_HOVER_DROP="hover";var y=function(e,t,n,r){var o=window.pydio.Controller,a=o.defaultActions.get("dragndrop");if(!a)throw new Error("No DND Actions available");var s=o.getActionByName(a);if(s.deny){var c=new(i());if(c.setSelectedNodes([e]),s.fireSelectionChange(c),s.deny)throw new Error("DND action disabled")}var l=new m(e,t,n,r),p=s.options.dragndropCheckModule;if(n===m.STEP_CAN_DROP&&p){if(!u.getFunctionByName(p,window))throw d.detectModuleToLoadAndApply(p,(function(){})),new Error("Cannot find test module, trying to load it");u.executeFunctionByName(s.options.dragndropCheckModule,window,o,l)}else s.apply(l)},b={beginDrag:function(e){return{node:e.node}},endDrag:function(e,t,n){if(t.didDrop()){var r=t.getItem(),o=t.getDropResult();try{y(r.node,o.node,m.STEP_END_DRAG,o.dropEffect)}catch(e){}}}},v={hover:function(e,t){},canDrop:function(e,t){var n=t.getItem().node,r=e.node;try{y(n,r,m.STEP_CAN_DROP)}catch(e){return!1}return!0},drop:function(e,t){if(!t.didDrop())return{node:e.node}}},g=a(39455);const S=require("react-dnd");var w=a.n(S);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function x(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function j(e){var t=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===k(t)?t:String(t)}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var M=function(e){R(o,e);var n=_(o);function o(){return C(this,o),n.apply(this,arguments)}return x(o,[{key:"removeClicked",value:function(){this.props.onRemove(this.props.id)}},{key:"render",value:function(){var e,n=this,o=this.props,i=o.isDragging,a=o.connectDragSource,s=o.connectDropTarget,c=o.renderItem,l=o.style,u=o.item,d=o.removable,p=o.className,f=o.label;return d&&(e=t().createElement("span",{className:"button mdi mdi-close",onClick:function(e){return n.removeClicked(e)}})),c?t().createElement("div",{ref:function(e){s(r().findDOMNode(e)),a(r().findDOMNode(e))},style:P(P({},l),{},{opacity:i?0:1})},c(u)):t().createElement(g.Paper,{ref:function(e){s(r().findDOMNode(e)),a(r().findDOMNode(e))},zDepth:1,style:{opacity:i?0:1,margin:"8px 0"}},t().createElement("div",{className:p},f,e))}}]),o}(t().Component),D=function(e){R(r,e);var n=_(r);function r(){return C(this,r),n.apply(this,arguments)}return x(r,[{key:"removeClicked",value:function(){this.props.onRemove(this.props.id)}},{key:"render",value:function(){var e,n=this;return this.props.removable&&(e=t().createElement("span",{className:"button mdi mdi-close",onClick:function(e){return n.removeClicked(e)}})),t().createElement(g.Paper,{zDepth:1,style:{margin:"8px 0"}},t().createElement("div",{className:this.props.className},this.props.label,e))}}]),r}(t().Component),L=D;w()&&(L=w().flow(w().DragSource(p.SORTABLE_LIST_ITEM,{beginDrag:function(e){return{id:e.id}},endDrag:function(e){e.endSwitching()}},f),w().DropTarget(p.SORTABLE_LIST_ITEM,{hover:function(e,t){var n=t.getItem().id;n!==e.id&&e.switchItems(n,e.id)}},h))(M));var N=function(e){R(r,e);var n=_(r);function r(e){var t;return C(this,r),(t=n.call(this,e)).state={values:t.props.values},t}return x(r,[{key:"componentWillReceiveProps",value:function(e){this.setState({values:e.values,switchData:null})}},{key:"findItemIndex",value:function(e,t){for(var n=0;n<t.length;n++)if(t[n].payload===e)return n}},{key:"switchItems",value:function(e,t){var n=this.findItemIndex(e,this.state.values),r=this.state.values[n],o=this.findItemIndex(t,this.state.values),i=this.state.values[o],a=this.state.values.slice();a[n]=i,a[o]=r;var s=this.findItemIndex(e,this.props.values),c=this.findItemIndex(t,this.props.values);s===o&&c===n?this.setState({values:a,switchData:null}):this.setState({values:a,switchData:{oldId:e,newId:t}})}},{key:"endSwitching",value:function(){this.state.switchData&&this.props.onOrderUpdated&&this.props.onOrderUpdated(this.state.switchData.oldId,this.state.switchData.newId,this.state.values),this.setState({switchData:null})}},{key:"render",value:function(){return t().createElement("div",{className:this.props.className},this.state.values.map(function(e){return t().createElement(L,{id:e.payload,key:e.payload,label:e.text,switchItems:this.switchItems.bind(this),endSwitching:this.endSwitching.bind(this),removable:this.props.removable,onRemove:this.props.onRemove,className:this.props.itemClassName,item:e,style:this.props.itemStyle,renderItem:this.props.renderItem})}.bind(this)))}}]),r}(t().Component);const U=require("create-react-class");var B=a.n(U),F=a(580),z=a.n(F),W=a(10757),q=a.n(W);const H=require("react-infinite");var Z=a.n(H),V=a(90691),J=a.n(V);const G=require("pydio/util/lang");var K=a.n(G),$=a(13173),Y=a(39105),X=a.n(Y);function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}var ee=["muiTheme","node","iconCell","firstLine","secondLine"];function te(){return te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},te.apply(this,arguments)}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e,t,n){return(t=se(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,se(r.key),r)}}function se(e){var t=function(e,t){if("object"!==Q(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Q(t)?t:String(t)}function ce(e,t){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ce(e,t)}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}var ue=q().requireLib("hoc").withContextMenu,de=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ce(e,t)}(l,n);var o,i,a,s,c=(a=l,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=le(a);if(s){var n=le(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=c.call(this,t)).inlineEditorRef=(0,e.createRef)(),n}return o=l,(i=[{key:"componentDidMount",value:function(){var e=this.props.setInlineEditionAnchor;e&&this.inlineEditorRef.current&&e(this.inlineEditorRef.current)}},{key:"onClick",value:function(e){if(this.props.showSelector){if(this.props.selectorDisabled)return;this.props.onSelect(this.props.node,e),e.stopPropagation(),e.preventDefault()}else this.props.onClick&&this.props.onClick(this.props.node,e)}},{key:"onDoubleClick",value:function(e){this.props.onDoubleClick&&this.props.onDoubleClick(this.props.node,e)}},{key:"render",value:function(){var e,n,o,i=this,a=this.props,s=a.node,c=a.showSelector,l=a.selected,u=a.selectorDisabled,d=a.firstLine,p=a.secondLine,f=a.thirdLine,h=a.style,m=a.actions,y=a.iconCell,b=a.mainIcon,v=a.className,S=a.muiTheme,w=a.canDrop,k=a.isOver,O=a.nativeIsOver,P=a.connectDragSource,E=a.connectDropTarget,C=a.selectedAsBorder,T=["material-list-entry","material-list-entry-"+(f?3:p?2:1)+"-lines"];v&&T.push(v),c&&(e=t().createElement("div",{className:"material-list-selector"},t().createElement(g.Checkbox,{checked:l,ref:"selector",disabled:u}))),y?n=this.props.iconCell:this.props.mainIcon&&(n=t().createElement(g.FontIcon,{className:"mui-font-icon "+this.props.mainIcon,style:{fontSize:18,color:"#FFF",display:"inline-block",margin:16,backgroundColor:"rgb(189, 189, 189)",padding:"7px 3px",width:33,height:33,textAlign:"center"}})),(w&&k||O)&&T.push("droppable-active"),s&&(T.push("listentry_"+K().computeStringSlug(s.getPath())),T.push("ajxp_node_"+(s.isLeaf()?"leaf":"collection")),s.getAjxpMime()&&T.push("ajxp_mime_"+s.getAjxpMime()),s.getMetadata().has("local:entry-classes")&&T.push.apply(T,function(e){if(Array.isArray(e))return ie(e)}(o=s.getMetadata().get("local:entry-classes"))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()));var x={};if(this.state&&this.state.hover&&!this.props.noHover&&(x=re(re({},x),{},{backgroundColor:S.darkMode?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)",borderBottom:"1px solid transparent"})),l){var j=S.palette.accent2Color,R=X()(j).dark();x=re(re({},x),{},C?{boxShadow:"0 0 0 2px "+j+",rgba(0, 0, 0, .4) 0px 0px 10px"}:{backgroundColor:j,color:R?"white":"rgba(0,0,0,.87)"}),T.push("selected"),T.push("selected-"+(R?"dark":"light"))}return t().createElement(pe,te({},this.props,{ref:function(e){var t=r().findDOMNode(e);"function"==typeof E&&E(t),"function"==typeof P&&P(t)},onClick:this.onClick.bind(this),onDoubleClick:c?null:this.onDoubleClick.bind(this),className:T.join(" "),onMouseOver:function(){i.setState({hover:!0})},onMouseOut:function(){i.setState({hover:!1})},style:re(re({},h),x)}),e,t().createElement("div",{className:"material-list-icon"+(b||y?"":" material-list-icon-none")},n),t().createElement("div",{className:"material-list-text"},t().createElement("div",{key:"line-1",className:"material-list-line-1",ref:this.inlineEditorRef},d),t().createElement("div",{key:"line-2",className:"material-list-line-2"},p),t().createElement("div",{key:"line-3",className:"material-list-line-3"},f)),t().createElement("div",{className:"material-list-actions"},m))}}])&&ae(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),l}(t().Component),pe=function(e){e.muiTheme,e.node,e.iconCell,e.firstLine,e.secondLine;var n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ee);return t().createElement("div",n)};pe=ue(pe),de.propTypes={showSelector:z().bool,selected:z().bool,selectorDisabled:z().bool,onSelect:z().func,onClick:z().func,iconCell:z().element,mainIcon:z().string,firstLine:z().node,secondLine:z().node,thirdLine:z().node,actions:z().element,activeDroppable:z().bool,className:z().string,style:z().object,noHover:z().bool},de=(0,$.muiThemeable)()(de);var fe=(0,S.flow)((0,S.DragSource)(p.NODE_PROVIDER,b,f),(0,S.DropTarget)(p.NODE_PROVIDER,v,h))(de);const he=require("pydio/util/path");var me=a.n(he),ye=a(79777),be=a(86646),ve=a(51730),ge=a(83265),Se=a(66357),we=a(52695),ke=a(91136);function Oe(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Pe(e){return e instanceof Oe(e).Element||e instanceof Element}function Ee(e){return e instanceof Oe(e).HTMLElement||e instanceof HTMLElement}function Ce(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Oe(e).ShadowRoot||e instanceof ShadowRoot)}var Te=Math.max,xe=Math.min,je=Math.round;function Re(){var e=navigator.userAgentData;return null!=e&&e.brands?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Ie(){return!/^((?!chrome|android).)*safari/i.test(Re())}function _e(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),o=1,i=1;t&&Ee(e)&&(o=e.offsetWidth>0&&je(r.width)/e.offsetWidth||1,i=e.offsetHeight>0&&je(r.height)/e.offsetHeight||1);var a=(Pe(e)?Oe(e):window).visualViewport,s=!Ie()&&n,c=(r.left+(s&&a?a.offsetLeft:0))/o,l=(r.top+(s&&a?a.offsetTop:0))/i,u=r.width/o,d=r.height/i;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c,x:c,y:l}}function Ae(e){var t=Oe(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Me(e){return e?(e.nodeName||"").toLowerCase():null}function De(e){return((Pe(e)?e.ownerDocument:e.document)||window.document).documentElement}function Le(e){return _e(De(e)).left+Ae(e).scrollLeft}function Ne(e){return Oe(e).getComputedStyle(e)}function Ue(e){var t=Ne(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Be(e,t,n){void 0===n&&(n=!1);var r,o,i=Ee(t),a=Ee(t)&&function(e){var t=e.getBoundingClientRect(),n=je(t.width)/e.offsetWidth||1,r=je(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),s=De(t),c=_e(e,a,n),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&(("body"!==Me(t)||Ue(s))&&(l=(r=t)!==Oe(r)&&Ee(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:Ae(r)),Ee(t)?((u=_e(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=Le(s))),{x:c.left+l.scrollLeft-u.x,y:c.top+l.scrollTop-u.y,width:c.width,height:c.height}}function Fe(e){var t=_e(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function ze(e){return"html"===Me(e)?e:e.assignedSlot||e.parentNode||(Ce(e)?e.host:null)||De(e)}function We(e){return["html","body","#document"].indexOf(Me(e))>=0?e.ownerDocument.body:Ee(e)&&Ue(e)?e:We(ze(e))}function qe(e,t){var n;void 0===t&&(t=[]);var r=We(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=Oe(r),a=o?[i].concat(i.visualViewport||[],Ue(r)?r:[]):r,s=t.concat(a);return o?s:s.concat(qe(ze(a)))}function He(e){return["table","td","th"].indexOf(Me(e))>=0}function Ze(e){return Ee(e)&&"fixed"!==Ne(e).position?e.offsetParent:null}function Ve(e){for(var t=Oe(e),n=Ze(e);n&&He(n)&&"static"===Ne(n).position;)n=Ze(n);return n&&("html"===Me(n)||"body"===Me(n)&&"static"===Ne(n).position)?t:n||function(e){var t=/firefox/i.test(Re());if(/Trident/i.test(Re())&&Ee(e)&&"fixed"===Ne(e).position)return null;var n=ze(e);for(Ce(n)&&(n=n.host);Ee(n)&&["html","body"].indexOf(Me(n))<0;){var r=Ne(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var Je="top",Ge="bottom",Ke="right",$e="left",Ye="auto",Xe=[Je,Ge,Ke,$e],Qe="start",et="end",tt="clippingParents",nt="viewport",rt="popper",ot="reference",it=Xe.reduce((function(e,t){return e.concat([t+"-"+Qe,t+"-"+et])}),[]),at=[].concat(Xe,[Ye]).reduce((function(e,t){return e.concat([t,t+"-"+Qe,t+"-"+et])}),[]),st=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function ct(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}var lt={placement:"bottom",modifiers:[],strategy:"absolute"};function ut(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function dt(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,i=void 0===o?lt:o;return function(e,t,n){void 0===n&&(n=i);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},lt,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],l=!1,u={state:s,setOptions:function(n){var o="function"==typeof n?n(s.options):n;d(),s.options=Object.assign({},i,s.options,o),s.scrollParents={reference:Pe(e)?qe(e):e.contextElement?qe(e.contextElement):[],popper:qe(t)};var a,l,p=function(e){var t=ct(e);return st.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((a=[].concat(r,s.options.modifiers),l=a.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(l).map((function(e){return l[e]}))));return s.orderedModifiers=p.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var i=o({state:s,name:t,instance:u,options:r});c.push(i||function(){})}})),u.update()},forceUpdate:function(){if(!l){var e=s.elements,t=e.reference,n=e.popper;if(ut(t,n)){s.rects={reference:Be(t,Ve(n),"fixed"===s.options.strategy),popper:Fe(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<s.orderedModifiers.length;r++)if(!0!==s.reset){var o=s.orderedModifiers[r],i=o.fn,a=o.options,c=void 0===a?{}:a,d=o.name;"function"==typeof i&&(s=i({state:s,options:c,name:d,instance:u})||s)}else s.reset=!1,r=-1}}},update:(o=function(){return new Promise((function(e){u.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){d(),l=!0}};if(!ut(e,t))return u;function d(){c.forEach((function(e){return e()})),c=[]}return u.setOptions(n).then((function(e){!l&&n.onFirstUpdate&&n.onFirstUpdate(e)})),u}}var pt={passive:!0};function ft(e){return e.split("-")[0]}function ht(e){return e.split("-")[1]}function mt(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function yt(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?ft(o):null,a=o?ht(o):null,s=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(i){case Je:t={x:s,y:n.y-r.height};break;case Ge:t={x:s,y:n.y+n.height};break;case Ke:t={x:n.x+n.width,y:c};break;case $e:t={x:n.x-r.width,y:c};break;default:t={x:n.x,y:n.y}}var l=i?mt(i):null;if(null!=l){var u="y"===l?"height":"width";switch(a){case Qe:t[l]=t[l]-(n[u]/2-r[u]/2);break;case et:t[l]=t[l]+(n[u]/2-r[u]/2)}}return t}var bt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function vt(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.variation,a=e.offsets,s=e.position,c=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,d=e.isFixed,p=a.x,f=void 0===p?0:p,h=a.y,m=void 0===h?0:h,y="function"==typeof u?u({x:f,y:m}):{x:f,y:m};f=y.x,m=y.y;var b=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),g=$e,S=Je,w=window;if(l){var k=Ve(n),O="clientHeight",P="clientWidth";k===Oe(n)&&"static"!==Ne(k=De(n)).position&&"absolute"===s&&(O="scrollHeight",P="scrollWidth"),(o===Je||(o===$e||o===Ke)&&i===et)&&(S=Ge,m-=(d&&k===w&&w.visualViewport?w.visualViewport.height:k[O])-r.height,m*=c?1:-1),o!==$e&&(o!==Je&&o!==Ge||i!==et)||(g=Ke,f-=(d&&k===w&&w.visualViewport?w.visualViewport.width:k[P])-r.width,f*=c?1:-1)}var E,C=Object.assign({position:s},l&&bt),T=!0===u?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:je(t*r)/r||0,y:je(n*r)/r||0}}({x:f,y:m}):{x:f,y:m};return f=T.x,m=T.y,c?Object.assign({},C,((E={})[S]=v?"0":"",E[g]=b?"0":"",E.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",E)):Object.assign({},C,((t={})[S]=v?m+"px":"",t[g]=b?f+"px":"",t.transform="",t))}const gt={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];Ee(o)&&Me(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});Ee(r)&&Me(r)&&(Object.assign(r.style,i),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},St={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,a=at.reduce((function(e,n){return e[n]=function(e,t,n){var r=ft(e),o=[$e,Je].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},t,{placement:e})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[$e,Ke].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,i),e}),{}),s=a[t.placement],c=s.x,l=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[r]=a}};var wt={left:"right",right:"left",bottom:"top",top:"bottom"};function kt(e){return e.replace(/left|right|bottom|top/g,(function(e){return wt[e]}))}var Ot={start:"end",end:"start"};function Pt(e){return e.replace(/start|end/g,(function(e){return Ot[e]}))}function Et(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&Ce(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ct(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Tt(e,t,n){return t===nt?Ct(function(e,t){var n=Oe(e),r=De(e),o=n.visualViewport,i=r.clientWidth,a=r.clientHeight,s=0,c=0;if(o){i=o.width,a=o.height;var l=Ie();(l||!l&&"fixed"===t)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:i,height:a,x:s+Le(e),y:c}}(e,n)):Pe(t)?function(e,t){var n=_e(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):Ct(function(e){var t,n=De(e),r=Ae(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=Te(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=Te(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+Le(e),c=-r.scrollTop;return"rtl"===Ne(o||n).direction&&(s+=Te(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}(De(e)))}function xt(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function jt(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function Rt(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,i=n.strategy,a=void 0===i?e.strategy:i,s=n.boundary,c=void 0===s?tt:s,l=n.rootBoundary,u=void 0===l?nt:l,d=n.elementContext,p=void 0===d?rt:d,f=n.altBoundary,h=void 0!==f&&f,m=n.padding,y=void 0===m?0:m,b=xt("number"!=typeof y?y:jt(y,Xe)),v=p===rt?ot:rt,g=e.rects.popper,S=e.elements[h?v:p],w=function(e,t,n,r){var o="clippingParents"===t?function(e){var t=qe(ze(e)),n=["absolute","fixed"].indexOf(Ne(e).position)>=0&&Ee(e)?Ve(e):e;return Pe(n)?t.filter((function(e){return Pe(e)&&Et(e,n)&&"body"!==Me(e)})):[]}(e):[].concat(t),i=[].concat(o,[n]),a=i[0],s=i.reduce((function(t,n){var o=Tt(e,n,r);return t.top=Te(o.top,t.top),t.right=xe(o.right,t.right),t.bottom=xe(o.bottom,t.bottom),t.left=Te(o.left,t.left),t}),Tt(e,a,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}(Pe(S)?S:S.contextElement||De(e.elements.popper),c,u,a),k=_e(e.elements.reference),O=yt({reference:k,element:g,strategy:"absolute",placement:o}),P=Ct(Object.assign({},g,O)),E=p===rt?P:k,C={top:w.top-E.top+b.top,bottom:E.bottom-w.bottom+b.bottom,left:w.left-E.left+b.left,right:E.right-w.right+b.right},T=e.modifiersData.offset;if(p===rt&&T){var x=T[o];Object.keys(C).forEach((function(e){var t=[Ke,Ge].indexOf(e)>=0?1:-1,n=[Je,Ge].indexOf(e)>=0?"y":"x";C[e]+=x[n]*t}))}return C}const It={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0===a||a,c=n.fallbackPlacements,l=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,f=n.flipVariations,h=void 0===f||f,m=n.allowedAutoPlacements,y=t.options.placement,b=ft(y),v=c||(b!==y&&h?function(e){if(ft(e)===Ye)return[];var t=kt(e);return[Pt(e),t,Pt(t)]}(y):[kt(y)]),g=[y].concat(v).reduce((function(e,n){return e.concat(ft(n)===Ye?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,l=void 0===c?at:c,u=ht(r),d=u?s?it:it.filter((function(e){return ht(e)===u})):Xe,p=d.filter((function(e){return l.indexOf(e)>=0}));0===p.length&&(p=d);var f=p.reduce((function(t,n){return t[n]=Rt(e,{placement:n,boundary:o,rootBoundary:i,padding:a})[ft(n)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}(t,{placement:n,boundary:u,rootBoundary:d,padding:l,flipVariations:h,allowedAutoPlacements:m}):n)}),[]),S=t.rects.reference,w=t.rects.popper,k=new Map,O=!0,P=g[0],E=0;E<g.length;E++){var C=g[E],T=ft(C),x=ht(C)===Qe,j=[Je,Ge].indexOf(T)>=0,R=j?"width":"height",I=Rt(t,{placement:C,boundary:u,rootBoundary:d,altBoundary:p,padding:l}),_=j?x?Ke:$e:x?Ge:Je;S[R]>w[R]&&(_=kt(_));var A=kt(_),M=[];if(i&&M.push(I[T]<=0),s&&M.push(I[_]<=0,I[A]<=0),M.every((function(e){return e}))){P=C,O=!1;break}k.set(C,M)}if(O)for(var D=function(e){var t=g.find((function(t){var n=k.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return P=t,"break"},L=h?3:1;L>0&&"break"!==D(L);L--);t.placement!==P&&(t.modifiersData[r]._skip=!0,t.placement=P,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function _t(e,t,n){return Te(e,xe(t,n))}const At={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0!==a&&a,c=n.boundary,l=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,f=void 0===p||p,h=n.tetherOffset,m=void 0===h?0:h,y=Rt(t,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),b=ft(t.placement),v=ht(t.placement),g=!v,S=mt(b),w="x"===S?"y":"x",k=t.modifiersData.popperOffsets,O=t.rects.reference,P=t.rects.popper,E="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,C="number"==typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),T=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,x={x:0,y:0};if(k){if(i){var j,R="y"===S?Je:$e,I="y"===S?Ge:Ke,_="y"===S?"height":"width",A=k[S],M=A+y[R],D=A-y[I],L=f?-P[_]/2:0,N=v===Qe?O[_]:P[_],U=v===Qe?-P[_]:-O[_],B=t.elements.arrow,F=f&&B?Fe(B):{width:0,height:0},z=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},W=z[R],q=z[I],H=_t(0,O[_],F[_]),Z=g?O[_]/2-L-H-W-C.mainAxis:N-H-W-C.mainAxis,V=g?-O[_]/2+L+H+q+C.mainAxis:U+H+q+C.mainAxis,J=t.elements.arrow&&Ve(t.elements.arrow),G=J?"y"===S?J.clientTop||0:J.clientLeft||0:0,K=null!=(j=null==T?void 0:T[S])?j:0,$=A+V-K,Y=_t(f?xe(M,A+Z-K-G):M,A,f?Te(D,$):D);k[S]=Y,x[S]=Y-A}if(s){var X,Q="x"===S?Je:$e,ee="x"===S?Ge:Ke,te=k[w],ne="y"===w?"height":"width",re=te+y[Q],oe=te-y[ee],ie=-1!==[Je,$e].indexOf(b),ae=null!=(X=null==T?void 0:T[w])?X:0,se=ie?re:te-O[ne]-P[ne]-ae+C.altAxis,ce=ie?te+O[ne]+P[ne]-ae-C.altAxis:oe,le=f&&ie?function(e,t,n){var r=_t(e,t,n);return r>n?n:r}(se,te,ce):_t(f?se:re,te,f?ce:oe);k[w]=le,x[w]=le-te}t.modifiersData[r]=x}},requiresIfExists:["offset"]};function Mt(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Dt(e){return[Je,Ke,Ge,$e].some((function(t){return e[t]>=0}))}var Lt=dt({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,a=r.resize,s=void 0===a||a,c=Oe(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&l.forEach((function(e){e.addEventListener("scroll",n.update,pt)})),s&&c.addEventListener("resize",n.update,pt),function(){i&&l.forEach((function(e){e.removeEventListener("scroll",n.update,pt)})),s&&c.removeEventListener("resize",n.update,pt)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=yt({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,c=void 0===s||s,l={placement:ft(t.placement),variation:ht(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,vt(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,vt(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},gt,St,It,At,{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=ft(n.placement),c=mt(s),l=[$e,Ke].indexOf(s)>=0?"height":"width";if(i&&a){var u=function(e,t){return xt("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:jt(e,Xe))}(o.padding,n),d=Fe(i),p="y"===c?Je:$e,f="y"===c?Ge:Ke,h=n.rects.reference[l]+n.rects.reference[c]-a[c]-n.rects.popper[l],m=a[c]-n.rects.reference[c],y=Ve(i),b=y?"y"===c?y.clientHeight||0:y.clientWidth||0:0,v=h/2-m/2,g=u[p],S=b-d[l]-u[f],w=b/2-d[l]/2+v,k=_t(g,w,S),O=c;n.modifiersData[r]=((t={})[O]=k,t.centerOffset=k-w,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&Et(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=Rt(t,{elementContext:"reference"}),s=Rt(t,{altBoundary:!0}),c=Mt(a,r),l=Mt(s,o,i),u=Dt(c),d=Dt(l);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),Nt=a(56e3),Ut=a(37367),Bt=a(2038);function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const zt=e.forwardRef((function(t,r){var o=t.children,i=t.container,a=t.disablePortal,s=void 0!==a&&a,c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ft(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.useState(null),2),l=c[0],u=c[1],d=(0,Se.Z)(e.isValidElement(o)?o.ref:null,r);if((0,we.Z)((function(){s||u(function(e){return"function"==typeof e?e():e}(i)||document.body)}),[i,s]),(0,we.Z)((function(){if(l&&!s)return(0,Ut.Z)(r,l),function(){(0,Ut.Z)(r,null)}}),[r,l,s]),s){if(e.isValidElement(o)){var p={ref:d};return e.cloneElement(o,p)}return(0,Bt.jsx)(e.Fragment,{children:o})}return(0,Bt.jsx)(e.Fragment,{children:l?n.createPortal(o,l):l})}));var Wt=a(5245),qt=a(46213);function Ht(e){return(0,Wt.Z)("MuiPopperUnstyled",e)}(0,qt.Z)("MuiPopperUnstyled",["root"]);const Zt=function(e){return"string"==typeof e};var Vt=a(82566);function Jt(e){if(void 0===e)return{};var t={};return Object.keys(e).filter((function(t){return!(t.match(/^on[A-Z]/)&&"function"==typeof e[t])})).forEach((function(n){t[n]=e[n]})),t}var Gt=["elementType","externalSlotProps","ownerState"];function Kt(e){var t,n=e.elementType,r=e.externalSlotProps,o=e.ownerState,i=(0,ge.Z)(e,Gt),a=function(e,t){return"function"==typeof e?e(t):e}(r,o),s=function(e){var t=e.getSlotProps,n=e.additionalProps,r=e.externalSlotProps,o=e.externalForwardedProps,i=e.className;if(!t){var a=(0,Vt.Z)(null==o?void 0:o.className,null==r?void 0:r.className,i,null==n?void 0:n.className),s=(0,ve.Z)({},null==n?void 0:n.style,null==o?void 0:o.style,null==r?void 0:r.style),c=(0,ve.Z)({},n,o,r);return a.length>0&&(c.className=a),Object.keys(s).length>0&&(c.style=s),{props:c,internalRef:void 0}}var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};var n={};return Object.keys(e).filter((function(n){return n.match(/^on[A-Z]/)&&"function"==typeof e[n]&&!t.includes(n)})).forEach((function(t){n[t]=e[t]})),n}((0,ve.Z)({},o,r)),u=Jt(r),d=Jt(o),p=t(l),f=(0,Vt.Z)(null==p?void 0:p.className,null==n?void 0:n.className,i,null==o?void 0:o.className,null==r?void 0:r.className),h=(0,ve.Z)({},null==p?void 0:p.style,null==n?void 0:n.style,null==o?void 0:o.style,null==r?void 0:r.style),m=(0,ve.Z)({},p,n,d,u);return f.length>0&&(m.className=f),Object.keys(h).length>0&&(m.style=h),{props:m,internalRef:p.ref}}((0,ve.Z)({},i,{externalSlotProps:a})),c=s.props,l=s.internalRef,u=(0,Se.Z)(l,null==a?void 0:a.ref,null==(t=e.additionalProps)?void 0:t.ref),d=function(e,t,n){return void 0===e||Zt(e)?t:(0,ve.Z)({},t,{ownerState:(0,ve.Z)({},t.ownerState,n)})}(n,(0,ve.Z)({},c,{ref:u}),o);return d}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xt=["anchorEl","children","component","direction","disablePortal","modifiers","open","ownerState","placement","popperOptions","popperRef","slotProps","slots","TransitionProps"],Qt=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function en(e){return"function"==typeof e?e():e}var tn={},nn=e.forwardRef((function(t,n){var r,o=t.anchorEl,i=t.children,a=t.component,s=t.direction,c=t.disablePortal,l=t.modifiers,u=t.open,d=t.ownerState,p=t.placement,f=t.popperOptions,h=t.popperRef,m=t.slotProps,y=void 0===m?{}:m,b=t.slots,v=void 0===b?{}:b,g=t.TransitionProps,S=(0,ge.Z)(t,Xt),w=e.useRef(null),k=(0,Se.Z)(w,n),O=e.useRef(null),P=(0,Se.Z)(O,h),E=e.useRef(P);(0,we.Z)((function(){E.current=P}),[P]),e.useImperativeHandle(h,(function(){return O.current}),[]);var C=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(p,s),T=$t(e.useState(C),2),x=T[0],j=T[1],R=$t(e.useState(en(o)),2),I=R[0],_=R[1];e.useEffect((function(){O.current&&O.current.forceUpdate()})),e.useEffect((function(){o&&_(en(o))}),[o]),(0,we.Z)((function(){if(I&&u){var e=[{name:"preventOverflow",options:{altBoundary:c}},{name:"flip",options:{altBoundary:c}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:function(e){var t=e.state;j(t.placement)}}];null!=l&&(e=e.concat(l)),f&&null!=f.modifiers&&(e=e.concat(f.modifiers));var t=Lt(I,w.current,(0,ve.Z)({placement:C},f,{modifiers:e}));return E.current(t),function(){t.destroy(),E.current(null)}}}),[I,c,l,u,f,C]);var A={placement:x};null!==g&&(A.TransitionProps=g);var M=(0,Nt.Z)({root:["root"]},Ht,{}),D=null!=(r=null!=a?a:v.root)?r:"div",L=Kt({elementType:D,externalSlotProps:y.root,externalForwardedProps:S,additionalProps:{role:"tooltip",ref:k},ownerState:(0,ve.Z)({},t,d),className:M.root});return(0,Bt.jsx)(D,(0,ve.Z)({},L,{children:"function"==typeof i?i(A):i}))}));const rn=e.forwardRef((function(t,n){var r,o=t.anchorEl,i=t.children,a=t.container,s=t.direction,c=void 0===s?"ltr":s,l=t.disablePortal,u=void 0!==l&&l,d=t.keepMounted,p=void 0!==d&&d,f=t.modifiers,h=t.open,m=t.placement,y=void 0===m?"bottom":m,b=t.popperOptions,v=void 0===b?tn:b,g=t.popperRef,S=t.style,w=t.transition,k=void 0!==w&&w,O=t.slotProps,P=void 0===O?{}:O,E=t.slots,C=void 0===E?{}:E,T=(0,ge.Z)(t,Qt),x=$t(e.useState(!0),2),j=x[0],R=x[1];if(!p&&!h&&(!k||j))return null;if(a)r=a;else if(o){var I=en(o);r=I&&void 0!==I.nodeType?(0,ke.Z)(I).body:(0,ke.Z)(null).body}var _=h||!p||k&&!j?void 0:"none",A=k?{in:h,onEnter:function(){R(!1)},onExited:function(){R(!0)}}:void 0;return(0,Bt.jsx)(zt,{disablePortal:u,container:r,children:(0,Bt.jsx)(nn,(0,ve.Z)({anchorEl:o,direction:c,disablePortal:u,modifiers:f,ref:n,open:k?!j:h,placement:y,popperOptions:v,popperRef:g,slotProps:P,slots:C},T,{style:(0,ve.Z)({position:"fixed",top:0,left:0,display:_},S),TransitionProps:A,children:i}))})}));var on=a(61945),an=a(49917),sn=a(47186),cn=["components","componentsProps","slots","slotProps"],ln=(0,an.ZP)(rn,{name:"MuiPopper",slot:"Root",overridesResolver:function(e,t){return t.root}})({});const un=e.forwardRef((function(e,t){var n,r=(0,on.Z)(),o=(0,sn.Z)({props:e,name:"MuiPopper"}),i=o.components,a=o.componentsProps,s=o.slots,c=o.slotProps,l=(0,be.Z)(o,cn),u=null!=(n=null==s?void 0:s.root)?n:null==i?void 0:i.Root;return(0,Bt.jsx)(ln,(0,ye.Z)({direction:null==r?void 0:r.direction,slots:{root:u},slotProps:null!=c?c:a},l,{ref:t}))}));function dn(e){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(e)}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){hn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hn(e,t,n){return(t=yn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yn(r.key),r)}}function yn(e){var t=function(e,t){if("object"!==dn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==dn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===dn(t)?t:String(t)}function bn(e,t){return bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bn(e,t)}function vn(e){return vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vn(e)}var gn=q().requireLib("boot").PydioContextConsumer,Sn=a(39455),wn=Sn.Paper,kn=Sn.FlatButton,On=q().requireLib("hoc").ModernTextField,Pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bn(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vn(o);if(i){var n=vn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===dn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,e)}return n=s,r=[{key:"submit",value:function(){var e;this.state&&this.state.value&&(e=this.state.value);var t=q().getMessages();e&&e!==this.props.node.getLabel()?e&&e.indexOf("/")>-1?this.setState({errorString:t["filename.forbidden.slash"]}):(this.props.callback(e),this.props.onClose()):this.setState({errorString:t["rename.newvalue.error.similar"]})}},{key:"catchClicks",value:function(e){e.stopPropagation()}},{key:"onKeyDown",value:function(e){e.stopPropagation(),"Enter"===e.key?this.submit():this.setState({errorString:""})}},{key:"render",value:function(){var e=this,n=q().getMessages(),r=this.props,o=r.node,i=r.onClose,a=r.anchor,s=r.muiTheme,c=r.editorStyle,l=void 0===c?{}:c;return t().createElement(un,{id:"rename-popper:"+o.getPath(),open:!0,anchorEl:a,placement:"bottom-start"},t().createElement(wn,{style:fn({padding:8,fontWeight:"initial",background:s.palette.mui3?s.palette.mui3["surface-2"]:"white"},l),zDepth:2},t().createElement(On,{ref:this.text,defaultValue:o.getLabel(),onChange:function(t,n){e.setState({value:n})},onClick:this.catch,onDoubleClick:function(t){return e.catchClicks(t)},tabIndex:"0",onKeyDown:function(t){return e.onKeyDown(t)},errorText:this.state?this.state.errorString:null,selectBaseOnMount:!0}),t().createElement("div",{style:{textAlign:"right",paddingTop:8}},t().createElement(kn,{label:n[54],onClick:i}),t().createElement(kn,{label:n[48],onClick:function(){return e.submit()}}))))}}],r&&mn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function En(e){return En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},En(e)}function Cn(){return Cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cn.apply(this,arguments)}function Tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,In(r.key),r)}}function xn(e,t){return xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xn(e,t)}function jn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rn(e){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rn(e)}function In(e){var t=function(e,t){if("object"!==En(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==En(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===En(t)?t:String(t)}Pn=gn((0,$.muiThemeable)()(Pn));var _n=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=function(o){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xn(e,t)}(u,o);var i,a,s,c,l=(s=u,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(s);if(c){var n=Rn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===En(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jn(e)}(this,e)});function u(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return t=jn(e=l.call.apply(l,[this].concat(i))),r={edit:!1},(n=In(n="state"))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,e}return i=u,a=[{key:"attach",value:function(e){var t=this;this._nodeListener=function(){t.forceUpdate()},this._actionListener=function(e){return e&&"prompt-rename"===e.type&&e.callback&&t.setState({edit:!0,callback:e.callback}),!0},e.observe("node_replaced",this._nodeListener),e.observe("node_action",this._actionListener)}},{key:"detach",value:function(e){this._nodeListener&&(e.stopObserving("node_replaced",this._nodeListener),e.stopObserving("node_action",this._actionListener))}},{key:"getNode",value:function(){return r?r(this.props):this.props.node}},{key:"componentDidMount",value:function(){this.attach(this.getNode())}},{key:"componentWillUnmount",value:function(){this.detach(this.getNode())}},{key:"render",value:function(){var r=this,o=this.getNode(),i=this.state,a=i.edit,s=i.editorStyle,c=i.callback,l=i.anchor;return t().createElement(e.Fragment,null,t().createElement(n,Cn({},this.props,{setInlineEditionAnchor:function(e,t){r.setState({anchor:e,editorStyle:t})}})),a&&l&&t().createElement(Pn,{node:o,anchor:l,onClose:function(){return r.setState({edit:!1})},callback:c,editorStyle:s}))}}],a&&Tn(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),u}(t().Component);return o};function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},An.apply(this,arguments)}var Mn=q().requireLib("boot").moment;const Dn=_n((function(n){var r=n.node,o=n.renderActions,i=n.tableKeys,a=(0,e.useRef)(null);(0,e.useEffect)((function(){var e=n.setInlineEditionAnchor;e&&a.current&&e(a.current,{marginLeft:44})}),[r,i]);var s=n.actions;o&&(s=o(r));var c=[],l=!0,u=r.getMetadata();return Object.keys(i).forEach((function(e){var n,o,s=i[e],d=s.width?{width:s.width}:null;if(s.renderCell)s.name=e,n=s.renderCell(r,s);else if("ajxp_modiftime"===e){var p=Mn(1e3*parseFloat(u.get("ajxp_modiftime"))),f=p.calendar();f.indexOf("/")>-1&&(f=p.fromNow()),n=f}else n="bytesize"===e?parseInt(u.get(e))?me().roundFileSize(parseInt(u.get(e))):"-":u.get(e);o=u.get(e);var h=null;l&&(h=a),c.push(t().createElement("span",{key:e,className:"cell cell-"+e,title:o,style:d,"data-label":s.label,ref:h},n)),l=!1})),t().createElement(fe,An({},n,{iconCell:null,firstLine:c,actions:s}))}));function Ln(e){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(e)}function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Un(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Ln(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ln(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bn={pydioActionsToItems:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],r=!1,o=q().getMessages();return t.map(function(t){if(t.separator){if(r)return;return n.push(t),void(r=!0)}var i;r=!1,i=t.label_id&&o[t.label_id]?o[t.label_id]:t.raw_name?t.raw_name:t.name;var a=t.icon_class;if(t.subMenu){var s=t.subMenuBeforeShow?e(t.subMenuBeforeShow()):t.subMenu;n.push({text:i,iconClassName:a,subItems:s})}else n.push({text:i,iconClassName:a,payload:t.callback})}.bind(this)),r&&(n=n.slice(0,n.length-1)),n.length&&n[0]&&n[0].separator&&n.shift(),n},itemsToMenu:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({display:"normal",width:216,desktop:!0,autoWidth:!1},o);var i=t.map((function(t,r){if(t.separator)return React.createElement(g.Divider,{key:"divider"+r});if(t.subHeader)return React.createElement(g.Subheader,{style:{marginTop:-10,marginBottom:-6}},t.subHeader);var i,a,s,c;t.subItems?i=e(t.subItems,n,!0):t.payload&&(a=function(){t.payload(),n()});var l=t.iconClassName,u=!1;return"__INSET__"===l&&(l="",u=!0),"normal"===o.display?s=l?React.createElement(g.FontIcon,{className:t.iconClassName+" menu-icons",style:{fontSize:16,padding:5}}):null:"right"===o.display&&(c=l?React.createElement(g.FontIcon,{className:t.iconClassName+" menu-icons",style:{fontSize:16,padding:5}}):null),c=i&&i.length?React.createElement(g.FontIcon,{className:"mdi mdi-menu-right menu-icons"}):c,React.createElement(g.MenuItem,{key:t.text,primaryText:t.text,insetChildren:u,leftIcon:s,rightIcon:c,onClick:a,menuItems:i})}));return r?i:React.createElement(g.Menu,o,i)}},Fn=require("lodash");function zn(e){return zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zn(e)}function Wn(){return Wn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wn.apply(this,arguments)}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==zn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==zn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===zn(o)?o:String(o)),r)}var o}function Hn(e,t){return Hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Hn(e,t)}function Zn(e){return Zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zn(e)}var Vn=a(16689),Jn=a(580),Gn=a(2282);const Kn=function(e){var t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hn(e,t)}(s,t);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zn(o);if(i){var n=Zn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===zn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).state={menuItems:n.props.menuItems||[]},n}return n=s,(r=[{key:"componentDidMount",value:function(){var e=this;this.props.controller&&!this.props.menuItems&&(this._observer=(0,Fn.debounce)((function(){var t=e.props.controller.getContextActions("genericContext",null,e.props.toolbars),n=Bn.pydioActionsToItems(t);e.setState({menuItems:n})}),50),this.props.controller===this.props.pydio.Controller?this.props.pydio.observe("actions_refreshed",this._observer):this.props.controller.observe("actions_refreshed",this._observer),this._observer())}},{key:"componentWillUnmount",value:function(){this._observer&&(this.props.controller===this.props.pydio.Controller?this.props.pydio.stopObserving("actions_refreshed",this._observer):this.props.controller.stopObserving("actions_refreshed",this._observer))}},{key:"componentWillReceiveProps",value:function(e){e.menuItems&&e.menuItems!==this.props.menuItems&&this.setState({menuItems:e.menuItems})}},{key:"render",value:function(){return Vn.createElement(e,Wn({},this.props,{menuItems:this.state.menuItems}))}}])&&qn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(Vn.Component);return t.propTypes={menuItems:Jn.array,toolbars:Jn.array,controller:Jn.instanceOf(Gn),pydio:Jn.instanceOf(Pydio)},t};function $n(e){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$n(e)}function Yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==$n(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==$n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===$n(o)?o:String(o)),r)}var o}function Xn(e,t){return Xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xn(e,t)}function Qn(e){return Qn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qn(e)}var er=a(580),tr=a(16689),nr=q().requireLib("hoc").ThemedContainers,rr=nr.Popover,or=nr.IconButton,ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Qn(r);if(o){var n=Qn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===$n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).state={showMenu:!1},n}return t=a,(n=[{key:"showMenu",value:function(e){this.setState({showMenu:!0,anchor:e.currentTarget})}},{key:"closeMenu",value:function(e,t,n){this.setState({showMenu:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.menuItems,r=t.className,o=t.buttonTitle,i=t.buttonClassName,a=t.containerStyle,s=t.style,c=t.buttonStyle,l=t.popoverDirection,u=t.popoverTargetPosition,d=t.menuProps;return n.length?tr.createElement("span",{className:"toolbars-button-menu "+(r||""),style:a},tr.createElement(or,{ref:"menuButton",tooltip:o,iconClassName:i,onClick:this.showMenu.bind(this),iconStyle:c,style:s}),tr.createElement(rr,{open:this.state.showMenu,anchorEl:this.state.anchor,anchorOrigin:{horizontal:l||"right",vertical:u||"bottom"},targetOrigin:{horizontal:l||"right",vertical:"top"},onRequestClose:function(){e.setState({showMenu:!1})},useLayerForClickAway:!1},Bn.itemsToMenu(n,this.closeMenu.bind(this),!1,d||void 0))):null}}])&&Yn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(tr.Component);ir.propTypes={buttonTitle:er.string.isRequired,buttonClassName:er.string.isRequired,className:er.string,popoverDirection:er.oneOf(["right","left"]),popoverPosition:er.oneOf(["top","bottom"]),menuProps:er.object,menuItems:er.array.isRequired};const ar=Kn(ir);function sr(e){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sr(e)}function cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==sr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==sr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===sr(o)?o:String(o)),r)}var o}function lr(e,t){return lr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lr(e,t)}function ur(e){return ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ur(e)}var dr=q().requireLib("boot").PydioContextConsumer,pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lr(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ur(o);if(i){var n=ur(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,r=[{key:"onMenuClicked",value:function(e){this.props.columnClicked(e.payload)}},{key:"onHeaderClick",value:function(e,t){var n=this.props.tableKeys[e];n&&n.sortType&&this.props.columnClicked&&(n.name=e,this.props.columnClicked(n,t))}},{key:"getColumnsItems",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=function(){r&&r.notify("actions_refreshed")},i=this.props,a=i.tableKeys,s=i.sortingInfo;return Object.keys(a).map((function(r){var i,c,l=a[r],u=l.width?{width:l.width}:null,d="cell header_cell cell-"+r;return l.sortType&&(d+=" sortable",s&&(s.attribute===r||s.remote&&l.remoteSortAttribute&&s.attribute===l.remoteSortAttribute)&&(i="asc"===s.direction?"mdi mdi-sort-ascending":"mdi mdi-sort-descending",d+=" active-sort-"+s.direction,c=!0)),"menu"===e?(l.name=r,{payload:l,text:l.label,iconClassName:i}):"menu_data"===e?{name:t().createElement("span",{style:{display:"flex"}},t().createElement("span",{style:{flex:1,fontWeight:c?500:"inherit"}},l.label),c&&t().createElement("span",{className:"mdi mdi-checkbox-marked-circle-outline"})),callback:function(){n.onHeaderClick(r,o)},icon_class:i||("number"===l.sortType?"mdi mdi-sort-numeric":"mdi mdi-sort-alphabetical")}:t().createElement("span",{key:r,className:d,style:u,onClick:function(){n.onHeaderClick(r,o)}},l.label)}))}},{key:"buildSortingMenuItems",value:function(e){return this.getColumnsItems("menu_data",e)}},{key:"componentDidMount",value:function(){var e=new Action({name:"sort_action",icon_class:"mdi mdi-sort-descending",text_id:450,title_id:450,text:this.props.getMessage(450),title:this.props.getMessage(450),hasAccessKey:!1,subMenu:!0,subMenuUpdateImage:!0,weight:50},{selection:!1,dir:!0,actionBar:!0,actionBarGroup:"display_toolbar",contextMenu:!1,infoPanel:!1},{},{},{dynamicBuilder:this.buildSortingMenuItems.bind(this)}),t=new Map;t.set("sort_action",e),this.props.pydio.getController().updateGuiActions(t)}},{key:"componentWillUnmount",value:function(){this.props.pydio.getController().deleteFromGuiActions("sort_action")}},{key:"render",value:function(){var e=this;return"hidden"===this.props.displayMode?null:"menu"===this.props.displayMode?t().createElement(ar,{buttonTitle:"Sort by...",buttonClassName:"mdi mdi-sort-descending",menuItems:this.getColumnsItems("menu",this.props.pydio.getController()),onMenuClicked:function(t){return e.onMenuClicked(t)}}):t().createElement("div",{className:"mui-toolbar-group mui-left"},this.getColumnsItems("header",this.props.pydio.getController()))}}],r&&cr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function fr(e){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(e)}function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(n),!0).forEach((function(t){yr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yr(e,t,n){return(t=vr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vr(r.key),r)}}function vr(e){var t=function(e,t){if("object"!==fr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===fr(t)?t:String(t)}function gr(e,t){return gr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gr(e,t)}function Sr(e){return Sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sr(e)}pr=dr(pr);var wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gr(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sr(o);if(i){var n=Sr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={node:t.props.node},t}return n=s,r=[{key:"componentDidMount",value:function(){var e=this;if(!this.props.node){var t=this.props.dataModel;this._dmObserver=function(){e.setState({node:t.getContextNode()})},t.observe("context_changed",this._dmObserver),this.setState({node:t.getContextNode()})}}},{key:"componentWillUnmount",value:function(){this._dmObserver&&this.props.dataModel.stopObserving("context_changed",this._dmObserver)}},{key:"changePage",value:function(e){this.state.node.getMetadata().get("paginationData").set("new_page",e.currentTarget.getAttribute("data-page")),this.props.dataModel.requireContextChange(this.state.node)}},{key:"onMenuChange",value:function(e,t,n){this.state.node.getMetadata().get("paginationData").set("new_page",n),this.props.dataModel.requireContextChange(this.state.node)}},{key:"render",value:function(){var e=this,n=this.state.node,r=this.props,o=r.toolbarDisplay,i=r.toolbarColor,a=r.smallDisplay,s=r.style,c=r.menuStyle,l=r.id;if(!n||!n.getMetadata().get("paginationData"))return null;var u,d,p,f,h,m=n.getMetadata().get("paginationData"),y=parseInt(m.get("current")),b=parseInt(m.get("total")),v=b>0,S=[],w=q().getMessages()[331];if(v){for(var k=1;k<=b;k++)S.push(t().createElement(g.MenuItem,{value:k,primaryText:w+" "+k+(k===y?" / "+b:"")}));if(S.length<=1)return null}return o&&(i&&(p={color:i}),a&&(f={fontSize:13},h={fontSize:20})),d=t().createElement(g.IconButton,{onClick:function(){e.onMenuChange(null,0,y-1)},iconClassName:"mdi mdi-chevron-left",disabled:1===y,iconStyle:mr(mr({},p),h),style:a?{marginRight:-10,marginTop:-2,width:40,height:40}:null}),u=t().createElement(g.IconButton,{onClick:function(){e.onMenuChange(null,0,y+1)},iconClassName:"mdi mdi-chevron-right",disabled:b>-1&&y===b,style:a?{marginLeft:-40,marginTop:-2,width:40,height:40}:{marginLeft:-20},iconStyle:mr(mr({},p),h)}),t().createElement("div",{id:l,style:mr({display:"flex",alignItems:"center"},s)},d,v&&t().createElement(g.DropDownMenu,{style:{width:150,marginTop:-6},onChange:this.onMenuChange.bind(this),value:y,underlineStyle:{display:"none"},labelStyle:mr(mr({},p),f),menuStyle:c},S),!v&&t().createElement("div",{style:{width:100,paddingLeft:10}},w+" "+y),u)}}],r&&br(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function kr(e){return kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kr(e)}function Or(){return Or=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Or.apply(this,arguments)}function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==kr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===kr(o)?o:String(o)),r)}var o}function Er(e,t){return Er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Er(e,t)}function Cr(e){return Cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cr(e)}var Tr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Er(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Cr(o);if(i){var n=Cr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===kr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"render",value:function(){var e;return this.props.node.getMetadata().get("paginationData")&&this.props.node.getMetadata().get("paginationData").get("total")>1&&(e=t().createElement(wr,{dataModel:this.props.dm,node:this.props.node})),t().createElement("div",{className:"mui-toolbar toolbarTableHeader"},t().createElement(pr,Or({displayMode:"tableHeader"},this.props,{columnClicked:this.props.onHeaderClick})),t().createElement("div",{className:"mui-toolbar-group mui-right"},e,t().createElement(g.FontIcon,{key:1,title:q().getMessages[149],className:"mdi mdi-refresh"+(this.props.loading?" rotating":""),onClick:this.props.reload,style:{padding:16,display:"block",cursor:"pointer",fontSize:24,color:"#9E9E9E"}}),this.props.additionalActions))}}])&&Pr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component),xr=a(56880),jr=a.n(xr);const Rr=require("pydio/model/node");var Ir=a.n(Rr);function _r(e){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r(e)}function Ar(){return Ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ar.apply(this,arguments)}function Mr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==_r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==_r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===_r(o)?o:String(o)),r)}var o}function Dr(e,t){return Dr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dr(e,t)}function Lr(e){return Lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lr(e)}var Nr=q().requireLib("hoc").NativeFileDropProvider,Ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dr(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Lr(o);if(i){var n=Lr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===_r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,r=[{key:"render",value:function(){var e,n,r,o=this.props,i=o.secondLine,a=o.thirdLine,s=o.style,c=void 0===s?{}:s,l=o.actions,u=this.props,d=u.renderIcon,p=u.node,f=u.renderFirstLine,h=u.renderSecondLine,m=u.renderThirdLine,y=u.renderActions,b=u.isOver;if(d)e=d(p,this.props);else{var v=p.getMetadata().get("icon_class")?p.getMetadata().get("icon_class"):p.isLeaf()?"mdi mdi-file":"mdi mdi-folder";e=t().createElement(g.FontIcon,{className:v})}if(n=f?f(this.props.node):p.getLabel(),h&&(i=h(p)),m&&(a=m(p)),y&&(l=y(p)),p.isLeaf()&&p.getMetadata().has("mime")&&q().getInstance().getController().getActionByName("download")){var S=p.getMetadata().get("mime");r=function(e){try{jr().getClient().buildPresignedGetUrl(p).then((function(t){e.dataTransfer.setData("DownloadURL",S+":"+p.getLabel()+":"+t)}))}catch(e){console.error("Cannot set dataTransfer",e)}}}return t().createElement(fe,Ar({},this.props,{iconCell:e,firstLine:n,secondLine:i,thirdLine:a,actions:l,style:c,nativeIsOver:b,onDragStart:r}))}}],r&&Mr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);Ur.propTypes={node:z().instanceOf(Ir()),renderIcon:z().func,renderFirstLine:z().func,renderSecondLine:z().func,renderThirdLine:z().func,renderActions:z().func,style:z().object};var Br=Nr(Ur=_n(Ur),(function(e,t,n){var r=a.g,o=r.pydio,i=r.UploaderModel,s=n.node;if("true"!==s.getMetadata().get("node_readonly")&&"true"!==s.getMetadata().get("level_readonly")){var c=i.Store.getInstance();c.handleDropEventResults(e,t,s),c.getAutoStart()&&!o.Parameters.get("MINISITE")||o.getController().fireAction("upload")}else o.UI.displayMessage("ERROR","You are not allowed to upload files here")}));function Fr(e){return Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fr(e)}function zr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hr(r.key),r)}}function Wr(e,t){return Wr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wr(e,t)}function qr(e){return qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qr(e)}function Hr(e){var t=function(e,t){if("object"!==Fr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Fr(t)?t:String(t)}var Zr,Vr,Jr,Gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wr(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qr(o);if(i){var n=qr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,r=[{key:"clickAction",value:function(e){var t=q().getInstance(),n=e.currentTarget.getAttribute("data-action"),r=this.props,o=r.dataModel,i=r.node;o.setSelectedNodes([i]);var a=t.Controller.getActionByName(n);a.fireContextChange(o,!0,t.user),a.apply([o]),e.stopPropagation(),e.preventDefault()}},{key:"render",value:function(){var e=this.props.actions.map(function(e){var n=this;return t().createElement("div",{key:e.options.name,className:e.options.icon_class+" material-list-action-inline"||0,title:e.options.title,"data-action":e.options.name,onClick:function(e){return n.clickAction(e)}})}.bind(this));return t().createElement("span",null,e)}}],r&&zr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Kr(e){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kr(e)}function $r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(n),!0).forEach((function(t){Xr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xr(e,t,n){return(t=eo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eo(r.key),r)}}function eo(e){var t=function(e,t){if("object"!==Kr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Kr(t)?t:String(t)}function to(e,t){return to=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},to(e,t)}function no(e){return no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},no(e)}Zr=Gr,Vr="propTypes",Jr={dataModel:z().instanceOf(o.PydioDataModel).isRequired,node:z().instanceOf(Rr.Node).isRequired,actions:z().array},(Vr=Hr(Vr))in Zr?Object.defineProperty(Zr,Vr,{value:Jr,enumerable:!0,configurable:!0,writable:!0}):Zr[Vr]=Jr;var ro=a(16689).Component,oo=a(39455),io=oo.FlatButton,ao=oo.FontIcon,so=a(13173).muiThemeable,co=a(39105),lo=a(580),uo=a(10757),po=uo.requireLib("boot").PydioContextConsumer,fo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&to(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=no(r);if(o){var n=no(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Kr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t)}return t=a,n=[{key:"render",value:function(){var e=this.props,t=e.style,n=e.iconClassName,r=e.primaryTextId,o=e.secondaryTextId,i=e.actionLabelId,a=e.actionCallback,s=e.actionStyle,c=e.actionIconClassName,l=e.getMessage,u=e.iconStyle,d=e.legendStyle,p=e.muiTheme,f=co(p.palette.mui3.outline||"#aaa"),h={container:Yr({display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",flex:1,backgroundColor:f.lightness(97).rgb().toString()},t),centered:{maxWidth:280,textAlign:"center",color:f.toString()},icon:Yr({fontSize:100},u),primaryText:Yr({fontSize:16,fontWeight:500},d),secondaryText:{marginTop:20,fontSize:13},buttonContainer:{marginTop:100,textAlign:"center"},buttonStyle:{color:p.palette.mui3.primary}},m=c?React.createElement(ao,{className:c}):null;return React.createElement("div",{style:h.container},React.createElement("div",{style:h.centered},React.createElement("div",{className:n,style:h.icon}),React.createElement("div",{style:h.primaryText},l(r)),o&&React.createElement("div",{style:h.secondaryText},l(o)),i&&a&&React.createElement("div",{style:Yr(Yr({},h.buttonContainer),s)},React.createElement(io,{style:h.buttonStyle,label:l(i),onClick:a,icon:m}))))}}],n&&Qr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro);fo.propTypes={pydio:lo.instanceOf(uo).isRequired,iconClassName:lo.string.isRequired,primaryTextId:lo.string.isRequired,secondaryTextId:lo.string,actionLabelId:lo.string,actionCallback:lo.func,actionStyle:lo.object,style:lo.object,iconStyle:lo.object,legendStyle:lo.object,getMessage:lo.func},fo=po(fo),fo=so()(fo);var ho=q().requireLib("hoc"),mo=ho.PlaceHolder,yo=ho.PhRoundShape,bo=ho.PhTextRow;function vo(e){var n,r=e.displayMode,o=e.elementHeight,i=e.tableKeys,a=[];if("grid"===r){var s=Math.max(40,o);n=t().createElement("div",{style:{width:s,height:s,display:"flex",flexDirection:"column",alignItems:"center",margin:2}},t().createElement("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},t().createElement(yo,{style:{width:40,height:40,borderRadius:6}})),t().createElement(bo,{style:{fontSize:20}}));for(var c=0;c<10;c++)a.push(n);a=t().createElement("div",{style:{display:"flex",flexWrap:"wrap"}},a)}else if(i){n=t().createElement("div",{style:{width:"100%",display:"flex",alignItems:"baseline",height:42,borderBottom:"1px solid rgba(0,0,0,.03)"}},Object.keys(i).map((function(e){return"ajxp_label"===e?t().createElement("span",{className:"cell cell-"+e,style:{display:"flex",fontSize:16,paddingTop:6,marginBottom:2,paddingLeft:16,paddingRight:10}},t().createElement(bo,{style:{display:"inline-block",width:16,marginRight:16}}),t().createElement(bo,{style:{flex:1}})):t().createElement("span",{className:"cell cell-"+e,style:{display:"inline-block",paddingTop:6,marginBottom:2,paddingLeft:10,paddingRight:10}},t().createElement(bo,null))})));for(var l=0;l<5;l++)a.push(n)}else{n=t().createElement("div",{style:{display:"flex",padding:"0 16px",alignItems:"center",height:o,borderBottom:"1px solid rgba(0,0,0,.03)"}},t().createElement(yo,{style:{width:40,height:40,marginRight:20,borderRadius:6}}),t().createElement("div",{style:{flex:1}},t().createElement(bo,{style:{fontSize:16,width:"80%",marginTop:0}}),t().createElement(bo,{style:{fontSize:13,width:"70%"}})));for(var u=0;u<5;u++)a.push(n)}return t().createElement(mo,{showLoadingAnimation:!0,customPlaceholder:a})}function go(e,t){if(e.getMetadata().has("local:pinSort")&&!t.getMetadata().has("local:pinSort"))return-1;if(t.getMetadata().has("local:pinSort")&&!e.getMetadata().has("local:pinSort"))return 1;if(e.isRecycle())return 1;if(t.isRecycle())return-1;var n=e.isLeaf(),r=t.isLeaf(),o=n&&!r?1:!n&&r?-1:0;return 0===o?e.getLabel().localeCompare(t.getLabel(),void 0,{numeric:!0}):o}var So=function(){},wo="undefined"!=typeof window;const ko=wo?e.useLayoutEffect:e.useEffect;var Oo={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const Po=wo&&void 0!==window.ResizeObserver?function(){var t=(0,e.useState)(null),n=t[0],r=t[1],o=(0,e.useState)(Oo),i=o[0],a=o[1],s=(0,e.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,r=t.y,o=t.width,i=t.height,s=t.top,c=t.left,l=t.bottom,u=t.right;a({x:n,y:r,width:o,height:i,top:s,left:c,bottom:l,right:u})}}))}),[]);return ko((function(){if(n)return s.observe(n),function(){s.disconnect()}}),[n]),[r,i]}:function(){return[So,Oo]};function Eo(e){return Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eo(e)}function Co(){return Co=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Co.apply(this,arguments)}function To(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?To(Object(n),!0).forEach((function(t){jo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):To(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Eo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Eo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Eo(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ro(e,t){if(e){if("string"==typeof e)return Io(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Io(e,t):void 0}}function Io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _o=a(14603),Ao=a(14021),Mo=function(e){var n=e.className,r=e.children,o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Ro(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Po(),2),i=o[0],a=o[1].height;return t().createElement("div",{ref:i,className:n},r(a))},Do=B()({displayName:"SimpleList",propTypes:{filterNodes:z().func,customToolbar:z().object,tableKeys:z().object,autoRefresh:z().number,reloadAtCursor:z().bool,clearSelectionOnReload:z().bool,observeNodeReload:z().bool,defaultGroupBy:z().string,groupByLabel:z().string,groupByValueFunc:z().func,skipParentNavigation:z().bool,skipInternalDataModel:z().bool,delayInitialLoad:z().number,entryEnableSelector:z().func,renderCustomEntry:z().func,entryRenderIcon:z().func,entryRenderActions:z().func,entryRenderFirstLine:z().func,entryRenderSecondLine:z().func,entryRenderThirdLine:z().func,entryHandleClicks:z().func,hideToolbar:z().bool,computeActionsForNode:z().bool,multipleActions:z().array,openEditor:z().func,openCollection:z().func,elementStyle:z().object,passScrollingStateToChildren:z().bool,elementHeight:z().oneOfType([z().number,z().object]).isRequired},statics:{HEIGHT_ONE_LINE:50,HEIGHT_TWO_LINES:71,CLICK_TYPE_SIMPLE:"simple",CLICK_TYPE_DOUBLE:"double",PARENT_FOLDER_ICON:"mdi mdi-chevron-left"},getDefaultProps:function(){return{clearSelectionOnReload:!0}},getMessage:function(e){return q().getMessages()[e]||e},clickRow:function(e,t){var n;if(n=e.props?e.props.data.node:e,this.props.entryHandleClicks)this.props.entryHandleClicks(n,Do.CLICK_TYPE_SIMPLE,t);else if(n.isLeaf()&&this.props.openEditor){if(!1===this.props.openEditor(n))return;var r=new Map;r.set(n,!0),this.setState({selection:r},this.rebuildLoadedElements)}else n.isLeaf()||(this.props.openCollection?this.props.openCollection(n):this.props.dataModel.setSelectedNodes([n]))},doubleClickRow:function(e,t){var n;n=e.props?e.props.data.node:e,this.props.entryHandleClicks&&this.props.entryHandleClicks(n,Do.CLICK_TYPE_DOUBLE,t)},onColumnSort:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.props,a=i.node,s=i.pydio,c=i.defaultSortingInfo,l=i.sortingPreferenceKey,u=s.user,d=a.getMetadata(),p=d.get("paginationData");if(e.remoteSortAttribute&&p&&p.get("total")>1){var f=d.get("remoteOrder")||new Map,h="asc"===f.get("order_direction")?"desc":"asc";if(f.get("order_column")===e.remoteSortAttribute&&("asc"===h&&r||o))d.delete("remoteOrder"),this.setState({sortingInfo:null},(function(){return t.sortingInfoChange({})}));else{var m=new Map;m.set("order_column",e.remoteSortAttribute),m.set("order_direction",h),d.set("remoteOrder",m)}this.props.dataModel.requireContextChange(a,!0)}else{d.has("remoteOrder")&&d.delete("remoteOrder");var y,b=e.sortAttribute?e.sortAttribute:e.name,v=this.state.sortingInfo,g=v.attribute,S=v.direction;g===b&&S?(console.log(S,r,o,e),y=o||"desc"===S&&r?c||{}:{attribute:b,sortType:e.sortType,direction:"asc"===S?"desc":"asc"}):y={attribute:b,sortType:e.sortType,direction:"asc"},this.setState({sortingInfo:y},(function(){if(t.rebuildLoadedElements(),null!==n&&n instanceof Function&&n(),l){var e=u.getActiveRepositoryObject().getSlug(),r=u.getGUIPreference(l)||{};r[e]=y,u.setGUIPreference(l,r,!0)}t.sortingInfoChange(y)}))}},computeSelectionFromCurrentPlusTargetNode:function(e,t){var n,r,o=!1;if(!this.indexedElements)return[];for(var i=e[0],a=e[e.length-1],s=[],c=0;c<this.indexedElements.length;c++){if(void 0!==n&&s.push(this.indexedElements[c].node),this.indexedElements[c].node===t){if(void 0!==n&&void 0===r){r=c;break}n=c,o=!0,s.push(this.indexedElements[c].node)}if(this.indexedElements[c].node===i&&void 0===n&&(n=c,s.push(this.indexedElements[c].node)),this.indexedElements[c].node===a&&o){r=c;break}}return s},onKeyDown:function(e){var t,n,r=this.dm,o=this.props.elementsPerLine||1,i=e.shiftKey,a=e.key;if(!r.isEmpty()&&this.indexedElements){var s=r.getSelectedNodes(),c=s[0],l=s[s.length-1];if("Enter"!==a){if("Delete"!==a||!q().getInstance().Controller.fireActionByKey("key_delete")){for(var u=0;u<this.indexedElements.length;u++)if(this.indexedElements[u].node===c&&(t=u),this.indexedElements[u].node===l){n=u;break}var d,p=this.indexedElements.length-1,f="PageDown"===a||"PageUp"===a?10:1;if("ArrowDown"===a||"PageDown"===a?d=Math.min(n+o*f,p):"ArrowUp"===a||"PageUp"===a?d=Math.max(t-o*f,0):"Home"===a?d=0:"End"===a&&(d=p),o>1&&("ArrowRight"===a?d=n+1:"ArrowLeft"===a&&(d=t-1)),i&&void 0!==d){var h=Math.min(t,n,d),m=Math.max(t,n,d);if(h!==m){for(var y=[],b=h;b<m+1;b++)this.indexedElements[b]&&y.push(this.indexedElements[b].node);r.setSelectedNodes(y)}}else this.indexedElements[d]&&this.indexedElements[d].node&&r.setSelectedNodes([this.indexedElements[d].node])}}else this.doubleClickRow(c)}},getInitialState:function(){this.actionsCache={multiple:new Map};var e=this.props,t=e.skipInternalDataModel,n=e.dataModel,r=e.node,o=e.defaultSortingInfo,i=e.pydio,a=e.sortingPreferenceKey;t?this.dm=n:(this.dm=new _o,this.dm.setRootNode(n.getContextNode()),this.dm.setContextNode(n.getContextNode()));var s=o||null;if(a&&i.user.getGUIPreference(a)){var c=i.user.getActiveRepositoryObject().getSlug(),l=i.user.getGUIPreference(a)||{};l[c]&&!l[c].remote&&(s=l[c])}var u={loaded:r.isLoaded(),loading:!r.isLoaded(),showSelector:!1,elements:r.isLoaded()?this.buildElements():[],sortingInfo:s,infiniteLoadBeginBottomOffset:200};return this.sortingInfoChange(s),u},componentWillReceiveProps:function(e){this.indexedElements=null;var t=e.defaultSortingInfo,n=e.node,r=e.sortingPreferenceKey,o=e.pydio,i=e.autoRefresh,a=e.elementsPerLine,s=this.state.sortingInfo,c=void 0===s?t:s,l=this.remoteSortingInfo(n,c);if(-1===l)c={};else if(l instanceof Object)c=l;else if(n!==this.props.node&&r&&o.user.getGUIPreference(r)){var u=o.user.getActiveRepositoryObject().getSlug(),d=o.user.getGUIPreference(r)||{};d[u]&&(c=d[u])}this.sortingInfoChange(c),this.setState({loaded:n.isLoaded(),loading:!n.isLoaded(),showSelector:!1,elements:n.isLoaded()?this.buildElements(n,e):[],infiniteLoadBeginBottomOffset:200,sortingInfo:c}),!i&&this.refreshInterval?(window.clearInterval(this.refreshInterval),this.refreshInterval=null):i&&!this.refreshInterval&&(this.refreshInterval=window.setInterval(this.reload,i)),this.patchInfiniteGrid(a),this.props.node&&n!==this.props.node&&this.observeNodeChildren(this.props.node,!0),this._manualScrollPe&&(this._manualScrollPe.stop(),this._manualScrollPe=null)},sortingInfoChange:function(e){var t=this,n=this.props,r=n.defaultSortingInfo,o=n.onSortingInfoChange;o&&(e!==r&&e.attribute?o(xo(xo({},e),{},{toggle:function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=t.props.sortKeys,o=e.remote?{remoteSortAttribute:e.attribute}:r[e.attribute];console.log("TOGGLE",o,n),t.onColumnSort(o,null,!1,n)}})):o({}))},observeNodeChildren:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&!this._childrenObserver||(this._childrenObserver||(this._childrenObserver=function(){this.indexedElements=null,this.rebuildLoadedElements()}.bind(this)),t?(e.stopObserving("child_added",this._childrenObserver),e.stopObserving("child_removed",this._childrenObserver),e.stopObserving("child_replaced",this._childrenObserver)):(e.observe("child_added",this._childrenObserver),e.observe("child_removed",this._childrenObserver),e.observe("child_replaced",this._childrenObserver)))},_loadNodeIfNotLoaded:function(){var e=this.props.node;e.isLoaded()?this.observeNodeChildren(e):(e.observeOnce("loaded",function(){this.props.node===e&&(this.observeNodeChildren(e),this.setState({loaded:!0,loading:!1,elements:this.buildElements()}))}.bind(this)),e.load())},_loadingListener:function(){this.observeNodeChildren(this.props.node,!0),this.setState({loaded:!1,loading:!0}),this.indexedElements=null},_loadedListener:function(){this.setState({loading:!1,elements:this.buildElements()}),this.observeNodeChildren(this.props.node)},reload:function(){this.props.reloadAtCursor&&this._currentCursor?this.loadStartingAtCursor():(this.props.clearSelectionOnReload&&this.props.dataModel.setSelectedNodes([]),this._loadingListener(),this.props.node.observeOnce("loaded",this._loadedListener),this.props.node.reload())},loadStartingAtCursor:function(){this._loadingListener();var e=this.props.node,t=e.getChildren(),n=[];e.observeOnce("loaded",function(){var r=new Map;n.map((function(e){r.set(e.getPath(),e)})),t.forEach((function(e){r.set(e.getPath(),e)})),e._children=r,this._loadedListener()}.bind(this)),e.setLoaded(!1),e.observe("child_added",(function(t){n.push(e._children.get(t))})),this.props.node.load(null,{cursor:this._currentCursor})},wireReloadListeners:function(){this.wrappedLoading=this._loadingListener,this.wrappedLoaded=this._loadedListener,this.props.node.observe("loading",this.wrappedLoading),this.props.node.observe("loaded",this.wrappedLoaded)},stopReloadListeners:function(){this.props.node.stopObserving("loading",this.wrappedLoading),this.props.node.stopObserving("loaded",this.wrappedLoaded)},toggleSelector:function(){this.setState({showSelector:!this.state.showSelector,selection:new Map,bulkSelectorChecked:!1},this.rebuildLoadedElements)},toggleSelection:function(e){var t=this.state.selection||new Map;t.get(e)?t.delete(e):t.set(e,!0),this.setState({selection:t,bulkSelectorChecked:!1},this.rebuildLoadedElements)},selectAll:function(e){if(e){var t=new Map;this.props.node.getChildren().forEach(function(e){this.props.filterNodes&&!this.props.filterNodes(e)||e.isLeaf()&&t.set(e,!0)}.bind(this)),this.setState({selection:t,bulkSelectorChecked:!0},this.rebuildLoadedElements)}else this.setState({selection:new Map,bulkSelectorChecked:!1},this.rebuildLoadedElements)},applyMultipleAction:function(e){if(this.state.selection&&this.state.selection.size){var t=e.currentTarget.getAttribute("data-action"),n=this.dm||new _o;n.setContextNode(this.props.node);var r=[];this.state.selection.forEach((function(e,t){r.push(t)})),n.setSelectedNodes(r);var o=this.props.pydio.Controller.getActionByName(t);o.fireContextChange(n,!0,this.props.pydio.user),o.apply([n]),e.stopPropagation(),e.preventDefault()}},getActionsForNode:function(e,t){var n=this.props,r=n.computeActionsForNode,o=n.pydio;if(!r)return[];var i=t.isLeaf()?"file-"+t.getAjxpMime():"folder",a=t.isLeaf()?"file":"dir",s=[];return this.actionsCache[i]?s=this.actionsCache[i]:(e.setSelectedNodes([t]),o.Controller.actions.forEach(function(n){n.fireContextChange(e,!0,o.user),!(n.context.selection&&n.context.actionBar&&n.selectionContext[a]&&!n.deny&&n.options.icon_class)||this.props.actionBarGroups&&-1===this.props.actionBarGroups.indexOf(n.context.actionBarGroup)||n.selectionContext.allowedMimes.length&&-1===n.selectionContext.allowedMimes.indexOf(t.getAjxpMime())||(s.push(n),t.isLeaf()&&!1===n.selectionContext.unique&&this.actionsCache.multiple.set(n.options.name,n))}.bind(this)),this.actionsCache[i]=s),s},patchInfiniteGrid:function(e){this.infinite.current&&e>1&&(this.infinite.current.state.infiniteComputer.__proto__.getDisplayIndexStart=function(t){return e*Math.floor(t/this.heightData/e)},this.infinite.current.state.infiniteComputer.__proto__.getDisplayIndexEnd=function(t){return e*Math.ceil(t/this.heightData/e)})},componentWillMount:function(){this.infinite=(0,e.createRef)()},componentDidMount:function(){var e=this;this.props.delayInitialLoad?setTimeout((function(){e._loadNodeIfNotLoaded()}),this.props.delayInitialLoad):this._loadNodeIfNotLoaded(),this.patchInfiniteGrid(this.props.elementsPerLine),this.props.autoRefresh&&(this.refreshInterval=window.setInterval(this.reload,this.props.autoRefresh)),this.props.observeNodeReload&&this.wireReloadListeners(),this.props.dataModel.observe("root_node_changed",(function(t){e.rootNodeChangedFlag=!0})),this.props.dataModel.observe("selection_changed",function(){var e=this;if(this.isMounted()){var t=new Map,n=this.props.dataModel.getSelectedNodes();n.map((function(e){t.set(e,!0)})),this.setState({selection:t},(function(){e.rebuildLoadedElements(),1===n.length&&e.scrollToView(n[0])}))}}.bind(this));var t=new Map,n=this.props.dataModel.getSelectedNodes();n.length&&(n.map((function(e){t.set(e,!0)})),this.setState({selection:t},(function(){setTimeout((function(){e.scrollToView(n[0])}),500)})))},componentWillUnmount:function(){this.refreshInterval&&window.clearInterval(this.refreshInterval),this.props.observeNodeReload&&this.stopReloadListeners(),this.props.node&&this.observeNodeChildren(this.props.node,!0)},componentDidUpdate:function(e,t){!this.rootNodeChangedFlag&&e.node&&this.props.node&&e.node.getPath()===this.props.node.getPath()||(this._loadNodeIfNotLoaded(),this.rootNodeChangedFlag=!1)},onScroll:function(e){if(this.props.onScroll&&this.props.onScroll(e),this.props.passScrollingStateToChildren){this.state.scrollTimeout&&clearTimeout(this.state.scrollTimeout);var t=this,n=setTimeout((function(){t.setState({isScrolling:!1,scrollTimeout:void 0})}),150);this.setState({isScrolling:!0,scrollTimeout:n})}},scrollToLast:function(){this.indexedElements&&this.indexedElements[this.indexedElements.length-1].node&&this.scrollToView(this.indexedElements[this.indexedElements.length-1].node)},scrollToView:function(e){var t=this;if(this.indexedElements&&this.infinite.current&&this.infinite.current.scrollable){var n=r().findDOMNode(this.infinite.current),o=this.infinite.current.scrollable,i=o.scrollTop+this.props.elementHeight/2,a=o.scrollTop+n.clientHeight-this.props.elementHeight/2,s=this.indexedElements.length*this.props.elementHeight-n.clientHeight,c=-1;if(this.indexedElements.forEach((function(t,n){t.node&&t.node===e&&(c=n)})),-1!==c){var l=this.props.elementHeight,u=c*l;u>i&&u<a||(u>=a&&(u-=n.clientHeight-2*l),u=Math.min(u,s),o.scrollTop=u,this._manualScrollPe&&this._manualScrollPe.stop(),o.scrollHeight<u&&(this._manualScrollPe=new Ao((function(){o.scrollTop=u,o.scrollHeight>=u&&(t._manualScrollPe.stop(),t._manualScrollPe=null)}),.25)))}}},buildElementsFromNodeEntries:function(e,n){var r=[],o=e.length,i=this.props,a=i.entriesProps,s=i.elementStyle,c=i.tableKeys,l=i.passScrollingStateToChildren;return a=xo(xo({},a),{},{style:s}),l&&(a.parentIsScrolling=this.state.isScrolling),e.forEach(function(e,i){var s;if(e.parent)s=xo({node:e.node,key:i+":"+e.node.getPath(),id:e.node.getPath(),mainIcon:Do.PARENT_FOLDER_ICON,firstLine:"..",className:"list-parent-node",secondLine:this.getMessage("react.1"),onClick:this.clickRow.bind(this),onDoubleClick:this.doubleClickRow.bind(this),showSelector:!1,selectorDisabled:!0,noHover:!1},a),this.props.entryRenderParentIcon&&!this.props.tableKeys?s.iconCell=this.props.entryRenderParentIcon(e.node,e):s.mainIcon=Do.PARENT_FOLDER_ICON,c&&(s.onClick=s.onDoubleClick),r.push(t().createElement(de,s));else if(e.groupHeader){var l=e.groupHeader,u=e.groupHeaderLabel;this.props.entryRenderGroupHeader&&(u=this.props.entryRenderGroupHeader(l,u)),s=xo({node:null,key:i+":"+l,id:l,mainIcon:null,firstLine:u,className:"list-group-header",onClick:null,showSelector:!1,selectorDisabled:!0,noHover:!0},a),e.groupFill&&(s.style=xo(xo({},s.style),{},{visibility:"hidden"})),r.push(t().createElement(de,s))}else(s=xo({node:e.node,onClick:this.clickRow.bind(this),onDoubleClick:this.doubleClickRow.bind(this),onSelect:this.toggleSelection.bind(this),key:i+":"+e.node.getPath(),id:e.node.getPath(),renderIcon:this.props.entryRenderIcon,renderFirstLine:this.props.entryRenderFirstLine,renderSecondLine:this.props.entryRenderSecondLine,renderThirdLine:this.props.entryRenderThirdLine,renderActions:this.props.entryRenderActions,showSelector:n,selected:!(!this.state||!this.state.selection)&&this.state.selection.get(e.node),actions:t().createElement(Gr,{node:e.node,actions:e.actions,dataModel:this.dm}),selectorDisabled:!(this.props.entryEnableSelector?this.props.entryEnableSelector(e.node):e.node.isLeaf())},a)).isFirst=0===i,s.isLast=i===o-1,i++,this.props.renderCustomEntry?r.push(this.props.renderCustomEntry(s)):c?(this.props.defaultGroupBy?(s.tableKeys=xo({},c),delete s.tableKeys[this.props.defaultGroupBy]):s.tableKeys=c,r.push(t().createElement(Dn,s))):!e.node.isLeaf()||e.node.getMetadata().has("local:dropFunc")?r.push(t().createElement(Br,s)):r.push(t().createElement(Ur,s))}.bind(this)),r},prepareSortFunction:function(){var e=(this.state||{}).sortingInfo;if(!e)return null;var t,n=e.attribute,r=e.direction,o=e.sortType;return t="file-natural"===o?go:function(e,t,n){return function(r,o){if(r.getMetadata().has("local:pinSort")&&!o.getMetadata().has("local:pinSort"))return-1;if(o.getMetadata().has("local:pinSort")&&!r.getMetadata().has("local:pinSort"))return 1;var i;if("number"===t){var a=r.getMetadata().get(e)||0,s=o.getMetadata().get(e)||0;a=parseFloat(a),s=parseFloat(s),i="asc"===n?a-s:s-a}else if("string"===t){var c=r.getMetadata().get(e)||"",l=o.getMetadata().get(e)||"";i="asc"===n?c.localeCompare(l):l.localeCompare(c)}if(0===i){var u=r.getLabel().localeCompare(o.getLabel(),void 0,{numeric:!0});i="asc"===n?u:-u}return i}}(n,o,r),function(e,n){return e.parent?-1:n.parent?1:t(e.node,n.node)}},buildElements:function(){var e,t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0)||this.props.node,i=r||this.props,a=this.prepareSortFunction();if(!this.indexedElements||this.indexedElements.length!==o.getChildren().size){this.indexedElements=[];var s,c,l,u,d=i.defaultGroupBy,p=i.groupByLabel,f=void 0!==p&&p;d&&(s={},c=[],l={}),i.skipParentNavigation||!o.getParent()||i.dataModel.getContextNode()===o&&!i.skipInternalDataModel||(t=!0,this.indexedElements.push({node:o.getParent(),parent:!0,actions:null})),o.getChildren().forEach(function(e){if(e.getMetadata().has("cursor")){var t=parseInt(e.getMetadata().get("cursor"));this._currentCursor=Math.max(this._currentCursor?this._currentCursor:0,t)}if(!i.filterNodes||i.filterNodes(e)){var n,r=this.getActionsForNode(this.dm,e);d?(n=i.groupByValueFunc?i.groupByValueFunc(e.getMetadata().get(d))||"N/A":e.getMetadata().get(d)||"N/A",s[n]||(s[n]=[],c.push(n)),f&&e.getMetadata().has(f)&&!l[n]&&(l[n]=e.getMetadata().get(f)),s[n].push({node:e,parent:!1,actions:r})):this.indexedElements.push({node:e,parent:!1,actions:r})}}.bind(this)),d&&(i.groupSkipUnique&&1===c.length?(u=this.indexedElements).push.apply(u,function(e){if(Array.isArray(e))return Io(e)}(n=s[c[0]])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||Ro(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):(e=!0,(c=c.sort()).map(function(e,n){var r=e;if(l[e]?r=l[e]:i.renderGroupLabels&&(r=i.renderGroupLabels(d,e)),this.indexedElements.push({node:null,groupHeader:e,groupHeaderLabel:r,parent:!1,actions:null}),a&&s[e].sort(a),this.indexedElements=this.indexedElements.concat(s[e]),i.elementsPerLine>1){var o=i.elementsPerLine-s[e].length%i.elementsPerLine-1;0===n&&t&&(o-=1);for(var c=0;c<o;c++)this.indexedElements.push({node:null,groupHeader:Math.random(),groupFill:!0,parent:!1,actions:null})}}.bind(this))))}return!e&&a&&this.indexedElements.sort(a),this.indexedElements},rebuildLoadedElements:function(){this.state.elements,this.setState({elements:this.buildElements()})},remoteSortingInfo:function(e){if(!e)return null;var t=e.getMetadata(),n=t.get("paginationData")||new Map,r=t.get("remoteOrder")||new Map;return n.get("total")>1?r.has("order_column")&&r.has("order_direction")?{remote:!0,attribute:r.get("order_column"),direction:r.get("order_direction")}:-1:0},renderToolbar:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.state.sortingInfo;if(n)return this.props.sortKeys?t().createElement(pr,{displayMode:"hidden",tableKeys:this.props.sortKeys,columnClicked:this.onColumnSort,sortingInfo:r}):null;var o,i,a=[t().createElement(g.FontIcon,{key:1,tooltip:"Reload",className:"mdi mdi-reload"+(this.state.loading?" rotating":""),onClick:this.reload})],s=2;if(this.props.sortKeys&&(a.push(t().createElement(pr,{key:s,displayMode:"menu",tableKeys:this.props.sortKeys,columnClicked:this.onColumnSort,sortingInfo:r})),s++),this.props.additionalActions&&a.push(this.props.additionalActions),this.props.node.getMetadata().get("paginationData")&&this.props.node.getMetadata().get("paginationData").get("total")>1&&(i=t().createElement(wr,{dataModel:this.dm,node:this.props.node})),this.props.listTitle&&(o=t().createElement(g.ToolbarGroup,{key:0,float:"left"},t().createElement("div",{className:"list-title"},this.props.listTitle))),this.props.searchResultData)o=t().createElement(g.ToolbarGroup,{key:0,float:"left"},t().createElement("div",{style:{fontSize:12,fontWeight:500,color:"#9e9e9e"}},this.getMessage("searchengine.topbar.title")+" "+this.props.searchResultData.term)),a=t().createElement(g.RaisedButton,{key:1,label:this.getMessage("86"),primary:!0,onClick:this.props.searchResultData.toggleState,style:{marginRight:-10}});else if(this.actionsCache.multiple.size||this.props.multipleActions){var c=this.getMessage("react.2"),l={transform:"translateX(-80px)"},u=xo({width:24},l),d=xo({},l),p=this.state,f=p.showSelector,h=p.selection,m=p.bulkSelectorChecked;f&&(u={width:24,transform:"translateX(-12px)"},d={transform:"translateX(-40px)"}),h&&f&&(c+=" ("+h.size+")"),o=t().createElement(g.ToolbarGroup,{key:0,float:"left",className:"hide-on-vertical-layout"},t().createElement(g.Checkbox,{checked:m,onCheck:function(t,n){return e.selectAll(n)},style:u}),t().createElement(g.FlatButton,{label:c,onClick:function(){return e.toggleSelector()},style:d})),f&&(a=[],(this.props.multipleActions||this.actionsCache.multiple).forEach(function(e){a.push(t().createElement(g.RaisedButton,{key:0,label:e.options.text,"data-action":e.options.name,onClick:this.applyMultipleAction,primary:!0,disabled:!h||!h.size,style:{marginLeft:5}}))}.bind(this)),a=t().createElement("span",null,a))}return t().createElement(g.Toolbar,{style:this.props.toolbarStyle},o,t().createElement(g.ToolbarGroup,{key:1,float:"right"},i,a))},render:function(){var e,n,r,o=this,i="material-list vertical-layout layout-fill",a=this.props,s=a.className,c=a.showSelector,l=a.tableKeys,u=a.defaultGroupBy,d=a.dataModel,p=a.node,f=a.additionalActions,h=a.customToolbar,m=a.hideToolbar,y=a.emptyStateProps,b=a.entryHandleClicks;if(s&&(i+=" "+s),c&&(i+=" list-show-selectors"),l&&(i+=" table-mode"),l){var v;u?delete(v=xo({},l))[u]:v=this.props.tableKeys;var g=this.state,S=g.sortingInfo,w=g.loading;e=t().createElement(Tr,{tableKeys:v,loading:w,reload:this.reload,ref:"loading_indicator",dm:d,node:p,additionalActions:f,onHeaderClick:this.onColumnSort,sortingInfo:S})}else e=h||(m?null:this.renderToolbar()),(m||h)&&(n=this.renderToolbar(!0));if(y&&p.isLoaded()&&!p.isLoading()&&(!this.state.elements.length||1===this.state.elements.length&&this.state.elements[0].parent)){var k={};if(1===this.state.elements.length&&this.state.elements[0].parent){var O=this.state.elements[0].node;k={actionLabelId:"react.1",actionIconClassName:Do.PARENT_FOLDER_ICON,actionCallback:function(e){b&&b(O,Do.CLICK_TYPE_DOUBLE,e)}}}r=t().createElement(fo,Co({},y,k))}else y&&y.checkEmptyState&&y.checkEmptyState(p)&&(r=t().createElement(fo,y));var P,E,C=this.buildElementsFromNodeEntries(this.state.elements,this.state.showSelector),T=this.props,x=T.verticalScroller,j=T.usePlaceHolder,R=C;if(!C.length&&j&&(R=t().createElement(vo,this.props)),r)R=r;else if(x)P=function(e){return t().createElement(J(),{speed:.8,horizontalScroll:!1,style:{height:e},verticalScrollbarStyle:{borderRadius:10,width:6},verticalContainerStyle:{width:8}},t().createElement("div",null,R))};else{if(l)return t().createElement("div",{className:i,tabIndex:"0",onKeyDown:this.onKeyDown,style:xo(xo({},this.props.style),{},{overflowX:"auto"})},n,t().createElement("div",{style:{display:"flex",flexDirection:"column",flex:1,height:"100%",width:"100%",minWidth:"fit-content"}},e,t().createElement(Mo,{className:r?"layout-fill vertical_layout":"layout-fill"},(function(e){return t().createElement(Z(),{elementHeight:o.state.elementHeight?o.state.elementHeight:o.props.elementHeight,containerHeight:e||1,handleScroll:o.onScroll,ref:o.infinite},R)}))));E=function(e){return t().createElement(Z(),{elementHeight:o.state.elementHeight?o.state.elementHeight:o.props.elementHeight,containerHeight:e||1,handleScroll:o.onScroll,ref:o.infinite},P?P(e):R)}}return t().createElement("div",{className:i,tabIndex:"0",onKeyDown:this.onKeyDown,style:this.props.style},e,n,t().createElement(Mo,{className:r?"layout-fill vertical_layout":"layout-fill"},E||function(){return R}))}});function Lo(e){return Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lo(e)}function No(){return No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},No.apply(this,arguments)}function Uo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bo(r.key),r)}}function Bo(e){var t=function(e,t){if("object"!==Lo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Lo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Lo(t)?t:String(t)}function Fo(e,t){return Fo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fo(e,t)}function zo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wo(e){return Wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wo(e)}var qo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fo(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Wo(o);if(i){var n=Wo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Lo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return zo(e)}(this,e)});function s(e){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=(t=a.call(this,e)).props.presetDataModel?t.props.presetDataModel:PydioDataModel.RemoteDataModelFactory(t.props.nodeProviderProperties);var r=t.props.presetRootNode||n.getRootNode();return t.props.nodeClicked&&(t.openEditor=function(e){return this.props.nodeClicked(e),!1}.bind(zo(t)),t._selObserver=function(e){var n=e.memo.getSelectedNodes();n.length&&(t.props.nodeClicked(n[0]),e.memo.setSelectedNodes([]))},n.observe("selection_changed",t._selObserver)),t.props.reloadOnServerMessage&&t.props.pydio&&(t._smObs=function(e){XMLUtils.XPathSelectSingleNode(e,this.props.reloadOnServerMessage)&&this.reload()}.bind(zo(t)),t.props.pydio.observe("server_message",t._smObs),t.props.pydio.observe("server_message:"+t.props.reloadOnServerMessage,t.reload)),t.state={node:r,dataModel:n},t}return n=s,(r=[{key:"reload",value:function(){this.refs.list&&this.isMounted()&&this.refs.list.reload()}},{key:"componentWillUnmount",value:function(){this._smObs&&(this.props.pydio.stopObserving("server_message",this._smObs),this.props.pydio.stopObserving("server_message:"+this.props.reloadOnServerMessage,this.reload)),this._selObserver&&this.state.dataModel.stopObserving("selection_changed",this._selObserver)}},{key:"componentWillReceiveProps",value:function(e){if(this.props.nodeProviderProperties&&this.props.nodeProviderProperties!==e.nodeProviderProperties){var t=this.state,n=t.dataModel,r=t.node,o=new RemoteNodeProvider(e.nodeProviderProperties);n.setAjxpNodeProvider(o),r.updateProvider(o),this.setState({dataModel:n,node:r})}else this.props.presetDataModel!==e.presetDataModel&&this.setState({dataModel:e.presetDataModel,node:e.presetRootNode||e.presetDataModel.getRootNode()})}},{key:"render",value:function(){return t().createElement("div",{className:this.props.heightAutoWithMax?"":"layout-fill vertical-layout",style:this.props.containerStyle},t().createElement(Do,No({},this.props,{openEditor:this.openEditor,ref:"list",style:Object.assign({height:"100%"},this.props.style||{}),node:this.state.node,dataModel:this.state.dataModel,actionBarGroups:this.props.actionBarGroups,skipParentNavigation:!0,observeNodeReload:!0,hideToolbar:!0})))}}])&&Uo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Ho(){return Ho=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ho.apply(this,arguments)}function Zo(e,t){return Zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zo(e,t)}function Vo(e){return Vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vo(e)}function Jo(e){return Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jo(e)}function Go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ko(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ko(Object(n),!0).forEach((function(t){Yo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ko(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yo(e,t,n){return(t=ti(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ti(r.key),r)}}function ei(e,t,n){return t&&Qo(e.prototype,t),n&&Qo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ti(e){var t=function(e,t){if("object"!==Jo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Jo(t)?t:String(t)}var ni=q().requireLib("boot").moment,ri=q().requireLib("hoc").ThemedModernStyles,oi=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Xo(this,e),this.state=$o({},t),!t.sortCol&&r&&(this.state.sortCol=r,this.state.sortDir=o||"asc"),this.onSort=n}return ei(e,[{key:"renderHeader",value:function(e,n){var r=this,o=this.state,i=o.sortCol,a=o.sortDir,s={cursor:"pointer",position:"relative"},c={left:-17,position:"absolute"};if(i!==e||""===a)return t().createElement("span",{onClick:function(){r.onSort(e,"asc")},style:s},n);var l=n;return"asc"===a?l=t().createElement("span",{onClick:function(){r.onSort(e,"desc")},style:s},n," ",t().createElement("span",{style:c,className:"mdi mdi-arrow-up"})):"desc"===a&&(l=t().createElement("span",{onClick:function(){r.onSort(e,"")},style:s},n," ",t().createElement("span",{style:c,className:"mdi mdi-arrow-down"}))),l}},{key:"setData",value:function(e,t){this.columns=e,this.data=t}},{key:"sorted",value:function(){var e=this.state,t=e.sortCol,n=e.sortDir;if(!t||!n)return this.data;var r,o=function(e){if(Array.isArray(e))return Go(e)}(r=this.data)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return Go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Go(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=this.columns.filter((function(e){return e.name===t}))[0],a=i.sorter;return a?(o.sort((function(e,r){var o,s;return a.value?(o=a.value(e),s=a.value(r)):i.renderCell?(o=i.renderCell(e),s=i.renderCell(r)):(o=e[t],s=r[t]),"string"===a.type?(o||(o=""),s||(s=""),o=o.toLowerCase(),s=s.toLowerCase()):"number"===a.type&&(o=parseInt(o),s=parseInt(s)),"asc"===n?o>s?1:o<s?-1:0:o<s?1:o>s?-1:0})),o):this.data}}]),e}(),ii=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zo(e,t)}(i,e);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vo(n);if(r){var o=Vo(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Jo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function i(e){var t;return Xo(this,i),(t=o.call(this,e)).state={},t}return ei(i,[{key:"onRowSelection",value:function(e){var t=this.props,n=t.data,r=t.onSelectRows;if(r)if("none"===e)r([]);else if("all"===e)r(n);else{var o=n,i=this.computeSorter();i&&(o=i.sorted());var a=this.computePagination();a.use&&(o=o.slice(a.sliceStart,a.sliceEnd));var s=[];e.map((function(e){var t=o.slice(0,e).filter((function(e){return e.expandedRow})).length;t&&(e-=t),s.push(o[e])})),r(s)}}},{key:"loadStoredValue",value:function(){var e=this.props,t=e.storageKey,n=e.columns;if(!t)return null;if(!localStorage.getItem(t+".sort"))return null;try{var r=JSON.parse(localStorage.getItem(t+".sort")),o=r.col,i=r.dir;return 0===n.filter((function(e){return e.name===o})).length||-1===["asc","desc",""].indexOf(i)?null:{col:o,dir:i}}catch(e){return null}}},{key:"computeSorter",value:function(){var e,t=this,n=this.props,r=n.columns,o=n.data,i=n.storageKey,a=r.filter((function(e){return e.sorter}));if(a.length){var s,c=a[0].name,l=a.filter((function(e){return e.sorter.default})),u=this.loadStoredValue();u?(c=u.col,s=u.dir):l.length&&(c=l[0].name,l[0].sorter.defaultDir&&(s=l[0].sorter.defaultDir)),(e=new oi(this.state,(function(e,n){t.setState({sortCol:e,sortDir:n}),i&&localStorage.setItem(i+".sort",JSON.stringify({col:e,dir:n}))}),c,s)).setData(r,o)}return e}},{key:"computePagination",value:function(){var e=this.props,t=e.data,n=e.paginate,r=e.defaultPageSize,o=e.pagination;if(o)return $o($o({},o),{},{use:!0});if(!n||!t||!t.length)return{use:!1};var i=this.state.pageSize||r||n[0];if(t.length<=i)return{use:!1};for(var a=this.state.page,s=void 0===a?1:a,c=Math.ceil(t.length/i),l=(s-1)*i,u=Math.min(s*i,t.length),d=[],p=1;p<=c;p++)d.push(p);return{use:!0,sliceStart:l,sliceEnd:u,pages:d,page:s,pageSize:i,pageSizes:n}}},{key:"renderPagination",value:function(e){var n=this,r=this.props,o=r.data,i=r.muiTheme,a=e.page,s=e.pageSize,c=e.pages,l=e.pageSizes,u=e.sliceStart,d=e.sliceEnd,p=e.nextDisabled,f=e.prevDisabled,h=e.onPageNext,m=e.onPagePrev,y=e.onPageSizeChange;return t().createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",color:"#757575"}},l.length>1&&t().createElement("div",{style:{paddingRight:10}},q().getMessages()["material.paginator.rows"]," :"),l.length>1&&t().createElement("div",{style:{width:90}},t().createElement(g.SelectField,Ho({},ri(i).selectField,{fullWidth:!0,value:s,onChange:function(e,t,r){y?y(r):n.setState({page:1,pageSize:r})}}),l.map((function(e){return t().createElement(g.MenuItem,{value:e,primaryText:e})})))),m&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-chevron-left",disabled:f,onClick:function(){return m()}}),!m&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-chevron-left",disabled:1===a,onClick:function(){return n.setState({page:a-1})}}),(u||d)&&t().createElement("div",null,u+1,"-",d," ",q().getMessages()["material.paginator.of"]," ",o.length),h&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-chevron-right",disabled:p,onClick:function(){return h()}}),!h&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-chevron-right",disabled:a===c.length,onClick:function(){return n.setState({page:a+1})}}))}},{key:"render",value:function(){var e=this.props,n=e.columns,r=e.deselectOnClickAway,o=e.emptyStateString,i=e.masterStyles,a=void 0===i?{}:i,s=e.emptyStateStyle,c=e.onSelectRows,l=e.computeRowStyle,u=e.rowSelected,d=this.props,p=d.actions,f=d.hideHeaders,h=this.props,m=h.data,y=h.showCheckboxes,b=a.actionsColor||"rgba(0,0,0,.33)",v=this.computeSorter();v&&(m=v.sorted());var S,w=this.computePagination();w.use&&(m=m.slice(w.sliceStart,w.sliceEnd),S=this.renderPagination(w));var k,O=0;p&&p.length&&(k=!0,O=1);var P=[];m.map((function(e){var r;if(l&&(r=l(e)),e.Subheader){var o=$o({fontSize:12,color:"#616161",backgroundColor:"#FAFAFA",fontWeight:500},e.style);P.push(t().createElement(g.TableRow,{className:"media-small-hide",style:$o({},a.row)},t().createElement(g.TableRowColumn,{colSpan:n.length+O,style:o},e.Subheader)))}else if(e.colSpan)P.push(t().createElement(g.TableRow,{style:$o($o({},e.rowStyle),a.row)},t().createElement(g.TableRowColumn,{colSpan:n.length+O,style:$o({height:"auto",paddingLeft:0,paddingRight:0,backgroundColor:"transparent"},e.cellStyle)},e.element)));else{var i=$o($o({},r),a.row);e.expandedRow&&(i=$o($o({},i),a.expanderRow)),P.push(t().createElement(g.TableRow,{selectable:void 0!==c,style:i,selected:u&&u(e)},n.map((function(n){var r=e[n.name],o=r;return n.useMoment&&r?o=r=ni(new Date(1e3*parseInt(r))).fromNow():n.renderCell&&(r=n.renderCell(e))&&"object"===Jo(r)&&r.element&&r.text&&(o=r.text,r=r.element),t().createElement(g.TableRowColumn,{style:n.style||{},title:"object"===Jo(o)?null:o,className:n.hideSmall?"media-small-hide":null},r)})),k&&t().createElement(g.TableRowColumn,{style:{overflow:"visible",textOverflow:"none",width:48*p.length+32}},p.map((function(n){var r=!!n.disable&&n.disable(e);return t().createElement(g.IconButton,{style:{padding:14,opacity:r?.5:null},iconStyle:{fontSize:20,color:b},onClick:function(t){t.stopPropagation(),n.onClick(e)},iconClassName:n.iconClassName,tooltip:n.tooltip,disabled:r})}))))),e.expandedRow&&P.push(t().createElement(g.TableRow,{selectable:!1,style:$o($o({},a.row),a.expandedRow)},t().createElement(g.TableRowColumn,{colSpan:n.length+O,style:$o({height:"auto",paddingLeft:0,paddingRight:0,backgroundColor:"transparent"},e.cellStyle)},e.expandedRow)))}}));var E=n.map((function(e){var n=e.label;return v&&e.sorter&&(n=v.renderHeader(e.name,e.label)),t().createElement(g.TableHeaderColumn,{style:$o($o({},e.headerStyle),{},{height:48,backgroundColor:"#F5F5F5",fontWeight:500},a.head),className:e.hideSmall?"media-small-hide":null},n)}));return k&&E.push(t().createElement(g.TableHeaderColumn,{style:$o({width:48*p.length+32,height:48,backgroundColor:"#F5F5F5"},a.head)})),o&&!P.length&&(y=!1,P=[t().createElement(g.TableRow,null,t().createElement(g.TableRowColumn,{colSpan:n.length,style:s},o))]),(m.length&&m[0].Subheader||o&&!P.length)&&P.unshift(t().createElement(g.TableRow,{style:$o({borderBottom:"none",height:0},a.row)},n.map((function(e){var n=e.style||{};return t().createElement(g.TableRowColumn,{style:$o($o({},n),{},{height:0}),className:e.hideSmall?"media-small-hide":null})})))),t().createElement(g.Table,{onRowSelection:this.onRowSelection.bind(this),multiSelectable:y},!f&&t().createElement(g.TableHeader,{displaySelectAll:y,adjustForCheckbox:y,enableSelectAll:y},t().createElement(g.TableRow,{style:a.row},E)),t().createElement(g.TableBody,{deselectOnClickaway:r,displayRowCheckbox:y},P),S&&t().createElement(g.TableFooter,null,t().createElement(g.TableRow,{style:{backgroundColor:"#fafafa"}},t().createElement(g.TableRowColumn,{colSpan:n.length},S))))}}]),i}(t().Component);(ii=(0,$.muiThemeable)()(ii)).PropTypes={data:z().array,columns:z().array,onSelectRows:z().func,emptyStateString:z().string};const ai=t()["undefined"!=typeof document&&void 0!==document.createElement?"useLayoutEffect":"useEffect"],si=function(t,n,r,o){var i=e.useRef(r),a=e.useRef(o);ai((function(){i.current=r,a.current=o})),ai((function(){var e=t&&"current"in t?t.current:t;if(e){var r=0;e.addEventListener(n,s);var o=a.current;return function(){r=1,e.removeEventListener(n,s),o&&o()}}function s(){if(!r){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.current.apply(this,t)}}}),[t,n])};function ci(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function li(e){return li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},li(e)}var ui="undefined",di=("undefined"==typeof window?"undefined":li(window))!==ui?window:{},pi=("undefined"==typeof performance?"undefined":li(performance))!==ui?performance:Date,fi=function(){return pi.now()},hi="AnimationFrame",mi="cancel"+hi,yi="request"+hi,bi=di[yi]&&di[yi].bind(di),vi=di[mi]&&di[mi].bind(di);if(!bi||!vi){var gi=0;bi=function(e){var t=fi(),n=Math.max(gi+1e3/60,t);return setTimeout((function(){e(gi=n)}),n-t)},vi=function(e){return clearTimeout(e)}}var Si=function(e){vi(e.v||-1)},wi=function(e,t){var n=fi(),r={};return r.v=bi((function o(){fi()-n>=t?e.call(null):r.v=bi(o)})),r};const ki=function(t){var n=e.useRef(t);return e.useEffect((function(){n.current=t})),n};var Oi="undefined"!=typeof performance?performance:Date,Pi=function(){return Oi.now()};function Ei(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=ki(t),i=1e3/n,a=e.useRef(0),s=e.useRef(),c=function(){return s.current&&clearTimeout(s.current)},l=[n,r,o];function u(){a.current=0,c()}return e.useEffect((function(){return u}),l),e.useCallback((function(){var e=arguments,t=Pi(),n=function(){a.current=t,c(),o.current.apply(null,e)},l=a.current;if(r&&0===l)return n();if(t-l>i){if(l>0)return n();a.current=t}c(),s.current=setTimeout((function(){n(),a.current=0}),i)}),l)}function Ci(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ti(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ti(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ti(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xi=0,ji=1,Ri=0,Ii=1,_i={low:0,max:0,high:0,C:2,P:void 0,R:void 0,L:void 0,list:void 0};function Ai(e){var t=e.high;e.L===_i&&e.R===_i?e.max=t:e.L===_i?e.max=Math.max(e.R.max,t):e.R===_i?e.max=Math.max(e.L.max,t):e.max=Math.max(Math.max(e.L.max,e.R.max),t)}function Mi(e){for(var t=e;t.P!==_i;)Ai(t.P),t=t.P}function Di(e,t){if(t.R!==_i){var n=t.R;t.R=n.L,n.L!==_i&&(n.L.P=t),n.P=t.P,t.P===_i?e.root=n:t===t.P.L?t.P.L=n:t.P.R=n,n.L=t,t.P=n,Ai(t),Ai(n)}}function Li(e,t){if(t.L!==_i){var n=t.L;t.L=n.R,n.R!==_i&&(n.R.P=t),n.P=t.P,t.P===_i?e.root=n:t===t.P.R?t.P.R=n:t.P.L=n,n.R=t,t.P=n,Ai(t),Ai(n)}}function Ni(e,t,n){t.P===_i?e.root=n:t===t.P.L?t.P.L=n:t.P.R=n,n.P=t.P}function Ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}_i.P=_i,_i.L=_i,_i.R=_i;var Bi=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=function(){var e={root:_i,size:0},t={};return{insert:function(n,r,o){for(var i=e.root,a=_i;i!==_i&&n!==(a=i).low;)i=n<i.low?i.L:i.R;if(n===a.low&&a!==_i){if(!function(e,t,n){for(var r,o=e.list;o;){if(o.index===n)return!1;if(t>o.high)break;r=o,o=o.next}return r||(e.list={index:n,high:t,next:o}),r&&(r.next={index:n,high:t,next:r.next}),!0}(a,r,o))return;return a.high=Math.max(a.high,r),Ai(a),Mi(a),t[o]=a,void e.size++}var s={low:n,high:r,max:r,C:xi,P:a,L:_i,R:_i,list:{index:o,high:r,next:null}};a===_i?e.root=s:(s.low<a.low?a.L=s:a.R=s,Mi(s)),function(e,t){for(var n;t.P.C===xi;)t.P===t.P.P.L?(n=t.P.P.R).C===xi?(t.P.C=ji,n.C=ji,t.P.P.C=xi,t=t.P.P):(t===t.P.R&&Di(e,t=t.P),t.P.C=ji,t.P.P.C=xi,Li(e,t.P.P)):(n=t.P.P.L).C===xi?(t.P.C=ji,n.C=ji,t.P.P.C=xi,t=t.P.P):(t===t.P.L&&Li(e,t=t.P),t.P.C=ji,t.P.P.C=xi,Di(e,t.P.P));e.root.C=ji}(e,s),t[o]=s,e.size++},remove:function(n){var r=t[n];if(void 0!==r){delete t[n];var o=function(e,t){var n=e.list;if(n.index===t)return null===n.next?Ri:(e.list=n.next,Ii);var r=n;for(n=n.next;null!==n;){if(n.index===t)return r.next=n.next,Ii;r=n,n=n.next}}(r,n);if(void 0!==o){if(o===Ii)return r.high=r.list.high,Ai(r),Mi(r),void e.size--;var i,a=r,s=a.C;r.L===_i?(i=r.R,Ni(e,r,r.R)):r.R===_i?(i=r.L,Ni(e,r,r.L)):(a=function(e){for(;e.L!==_i;)e=e.L;return e}(r.R),s=a.C,i=a.R,a.P===r?i.P=a:(Ni(e,a,a.R),a.R=r.R,a.R.P=a),Ni(e,r,a),a.L=r.L,a.L.P=a,a.C=r.C),Ai(i),Mi(i),s===ji&&function(e,t){for(var n;t!==_i&&t.C===ji;)t===t.P.L?((n=t.P.R).C===xi&&(n.C=ji,t.P.C=xi,Di(e,t.P),n=t.P.R),n.L.C===ji&&n.R.C===ji?(n.C=xi,t=t.P):(n.R.C===ji&&(n.L.C=ji,n.C=xi,Li(e,n),n=t.P.R),n.C=t.P.C,t.P.C=ji,n.R.C=ji,Di(e,t.P),t=e.root)):((n=t.P.L).C===xi&&(n.C=ji,t.P.C=xi,Li(e,t.P),n=t.P.L),n.R.C===ji&&n.L.C===ji?(n.C=xi,t=t.P):(n.L.C===ji&&(n.R.C=ji,n.C=xi,Di(e,n),n=t.P.L),n.C=t.P.C,t.P.C=ji,n.L.C=ji,Li(e,t.P),t=e.root));t.C=ji}(e,i),e.size--}}},search:function(t,n,r){for(var o=[e.root];0!==o.length;){var i=o.pop();if(!(i===_i||t>i.max)&&(i.L!==_i&&o.push(i.L),i.R!==_i&&o.push(i.R),i.low<=n&&i.high>=t))for(var a=i.list;null!==a;)a.high>=t&&r(a.index,i.low),a=a.next}},get size(){return e.size}}}(),o=new Array(e),i=[],a=new Array(e),s=0;s<e;s++)o[s]=0,a[s]=[];return{columnCount:e,columnWidth:t,set:function(e){for(var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=0,l=1;l<o.length;l++)o[l]<o[c]&&(c=l);var u=o[c]||0;o[c]=u+s+n,a[c].push(e),i[e]={left:c*(t+n),top:u,height:s,column:c},r.insert(u,u+s,e)},get:function(e){return i[e]},update:function(t){for(var s=new Array(e),c=0,l=0;c<t.length-1;c++){var u=t[c],d=i[u];d.height=t[++c],r.remove(u),r.insert(d.top,d.top+d.height,u),s[d.column]=void 0===s[d.column]?u:Math.min(u,s[d.column])}for(c=0;c<s.length;c++)if(void 0!==s[c]){var p=a[c],f=Fi(p,s[c]),h=a[c][f],m=i[h];for(o[c]=m.top+m.height+n,l=f+1;l<p.length;l++){var y=p[l],b=i[y];b.top=o[c],o[c]=b.top+b.height+n,r.remove(y),r.insert(b.top,b.top+b.height,y)}}},range:function(e,t,n){return r.search(e,t,(function(e,t){return n(e,i[e].left,t)}))},estimateHeight:function(t,n){var i=Math.max(0,Math.max.apply(null,o));return t===r.size?i:i+Math.ceil((t-r.size)/e)*n},shortestColumn:function(){return o.length>1?Math.min.apply(null,o):o[0]||0},size:function(){return r.size}}},Fi=function(e,t){for(var n=0,r=e.length-1;n<=r;){var o=n+r>>>1,i=e[o];if(i===t)return o;i<=t?n=o+1:r=o-1}return-1},zi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3?arguments[3]:void 0;return r=r||Math.floor(e/(t+n))||1,[Math.floor((e-n*(r-1))/r),r]},Wi=[],qi=function(e){try{return new e}catch(e){var t={};return{set:function(e,n){t[e]=n},get:function(e){return t[e]}}}};const Hi=function(e,t){var n,r=function(e){var t,n,r,o,i=e.length,a=qi(e[0]),s=1===i;return i<3?{g:function(e){return void 0===(t=a.get(e[0]))||s?t:t.get(e[1])},s:function(r,o){return s?a.set(r[0],o):void 0===(t=a.get(r[0]))?((n=qi(e[1])).set(r[1],o),a.set(r[0],n)):t.set(r[1],o),o}}:{g:function(e){for(o=a,r=0;r<i;r++)if(void 0===(o=o.get(e[r])))return;return o},s:function(t,s){for(o=a,r=0;r<i-1;r++)void 0===(n=o.get(t[r]))?(n=qi(e[r+1]),o.set(t[r],n),o=n):o=n;return o.set(t[i-1],s),s}}}(e),o=r.g,i=r.s;return function(){return void 0===(n=o(arguments))?i(arguments,t.apply(null,arguments)):n}};var Zi=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var o=r[n];e.call(t,o[1],o[0])}},t}()}(),Vi="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Ji=void 0!==a.g&&a.g.Math===Math?a.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Gi="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Ji):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},Ki=2,$i=20,Yi=["top","right","bottom","left","width","height","size","weight"],Xi="undefined"!=typeof MutationObserver,Qi=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,o=0;function i(){n&&(n=!1,e()),r&&s()}function a(){Gi(i)}function s(){var e=Date.now();if(n){if(e-o<Ki)return;r=!0}else n=!0,r=!1,setTimeout(a,t);o=e}return s}(this.refresh.bind(this),$i)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){Vi&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Xi?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){Vi&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t,r=Yi.some((function(e){return!!~n.indexOf(e)}));r&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),ea=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},ta=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||Ji},na=sa(0,0,0,0);function ra(e){return parseFloat(e)||0}function oa(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+ra(e["border-"+n+"-width"])}),0)}var ia="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof ta(e).SVGGraphicsElement}:function(e){return e instanceof ta(e).SVGElement&&"function"==typeof e.getBBox};function aa(e){return Vi?ia(e)?function(e){var t=e.getBBox();return sa(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return na;var r=ta(e).getComputedStyle(e),o=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var o=r[n],i=e["padding-"+o];t[o]=ra(i)}return t}(r),i=o.left+o.right,a=o.top+o.bottom,s=ra(r.width),c=ra(r.height);if("border-box"===r.boxSizing&&(Math.round(s+i)!==t&&(s-=oa(r,"left","right")+i),Math.round(c+a)!==n&&(c-=oa(r,"top","bottom")+a)),!function(e){return e===ta(e).document.documentElement}(e)){var l=Math.round(s+i)-t,u=Math.round(c+a)-n;1!==Math.abs(l)&&(s-=l),1!==Math.abs(u)&&(c-=u)}return sa(o.left,o.top,s,c)}(e):na}function sa(e,t,n,r){return{x:e,y:t,width:n,height:r}}var ca=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=sa(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=aa(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),la=function(e,t){var n=function(e){var t=e.x,n=e.y,r=e.width,o=e.height,i="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(i.prototype);return ea(a,{x:t,y:n,width:r,height:o,top:n,right:t+r,bottom:o+n,left:t}),a}(t);ea(this,{target:e,contentRect:n})},ua=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new Zi,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof ta(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new ca(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof ta(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new la(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),da="undefined"!=typeof WeakMap?new WeakMap:new Zi,pa=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Qi.getInstance(),r=new ua(t,n,this);da.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){pa.prototype[e]=function(){var t;return(t=da.get(this))[e].apply(t,arguments)}}));const fa=void 0!==Ji.ResizeObserver?Ji.ResizeObserver:pa;var ha=new WeakMap;function ma(){var t=e.useState(ya)[1];return e.useRef((function(){return t({})})).current}var ya={},ba=Hi([WeakMap],(function(e,t){var n,r,o,i,a=(n=function(n){for(var r=[],o=0;o<n.length;o++){var i=n[o],a=i.target.offsetHeight;if(a>0){var s=ha.get(i.target);if(void 0!==s){var c=e.get(s);void 0!==c&&a!==c.height&&r.push(s,a)}}}r.length>0&&(e.update(r),t(r))},r=[],o=null,i=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r=t,o||(o=requestAnimationFrame((function(){o=null,n.apply(void 0,r)})))},i.cancel=function(){o&&(cancelAnimationFrame(o),o=null)},i),s=new fa(a),c=s.disconnect.bind(s);return s.disconnect=function(){c(),a.cancel()},s}));function va(e){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va(e)}function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wa(r.key),r)}}function Sa(e,t,n){return t&&ga(e.prototype,t),n&&ga(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function wa(e){var t=function(e,t){if("object"!==va(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==va(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===va(t)?t:String(t)}var ka=Sa((function e(){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.set=void 0,this.get=void 0,this.get=function(e){return e===t?n:void 0},this.set=function(e,r){t=e,n=r}}));const Oa=ka,Pa=function(e,t){var n,r,o=t||Ea;return function(){return n&&o(arguments,n)?r:r=e.apply(null,n=arguments)}};var Ea=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};function Ca(e){return Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ca(e)}var Ta=e.createElement,xa="0",ja=Hi([Oa,{},WeakMap,Oa],(function(e,t,n,r){return Ta(e,{index:t,data:n,width:r})})),Ra=Pa((function(e,t){return{position:"relative",width:"100%",maxWidth:"100%",height:Math.ceil(t),maxHeight:Math.ceil(t),willChange:e?"contents":void 0,pointerEvents:e?"none":void 0}})),Ia=function(e,t){return e[0]===t[0]&&e[1]===t[1]},_a=Pa((function(e,t){return Object.assign({},e,t)}),Ia);function Aa(e,t){return t}var Ma=Pa((function(e){return{width:e,zIndex:-1e3,visibility:"hidden",position:"absolute",writingMode:"horizontal-tb"}}),(function(e,t){return e[0]===t[0]})),Da=Pa((function(e,t){return function(n){return function(r){null!==r&&(t&&(t.observe(r),ha.set(r,n)),void 0===e.get(n)&&e.set(n,r.offsetHeight))}}}),Ia);function La(e){return La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},La(e)}function Na(){return Na=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Na.apply(this,arguments)}function Ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ba(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ua(Object(n),!0).forEach((function(t){Fa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==La(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==La(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===La(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function za(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qa=q().requireLib("hoc").useImagePreview,Ha={2:{scaleX:-1,scaleY:1},3:{rotate:"180deg"},4:{rotate:"180deg",scaleX:-1,scaleY:1},5:{rotate:"90deg",scaleX:1,scaleY:-1,tX:-1,tY:1},6:{rotate:"90deg",tX:-1,tY:-1},7:{rotate:"270deg",scaleX:1,scaleY:-1,tX:1,tY:-1},8:{rotate:"270deg",tX:1,tY:1}};function Za(e){var t=[];return e.rotate&&t.push("rotate(".concat(e.rotate,")")),e.scaleX&&t.push("scale(".concat(e.scaleX,", ").concat(e.scaleY,")")),e.translateX&&t.push("translate(".concat(e.translateX,"px,").concat(e.translateY,"px)")),t.join(" ")}var Va=(0,Fn.debounce)((function(){window.dispatchEvent(new Event("resize"))}),500),Ja=_n((function(n){var r=n.width,o=n.data,i=o.node,a=o.parent,s=o.dataModel,c=o.entryProps,l=n.setInlineEditionAnchor,u=function(e){var t=.5;if(e.getMetadata().has("ImageDimensions")){var n=e.getMetadata().get("ImageDimensions");t=n.Height/n.Width}return{ratio:t,src:qa(e).src}}(i),d=u.ratio,p=u.src,f=za((0,e.useState)(s.getSelectedNodes().indexOf(i)>-1),2),h=f[0],m=f[1],y=za((0,e.useState)(!1),2),b=y[0],v=y[1];(0,e.useEffect)((function(){var e=function(){m(s.getSelectedNodes().indexOf(i)>-1)};return s.observe("selection_changed",e),function(){s.stopObserving("selection_changed",e)}}),[h,i]);var g=c.handleClicks,S=c.renderIcon,w=c.renderActions,k=q().getMessages()["react.1"],O={};if(p&&d&&i.getMetadata().get("image_exif_orientation")){var P=parseInt(i.getMetadata().get("image_exif_orientation"));if(Ha[P]){var E=Ba({},Ha[P]);if(P<5)O={transform:Za(E)};else{var C=r*(d=1/d),T=(r-C)/2;E.translateX=T*E.tX,E.translateY=T*E.tY,O={transform:Za(E),width:C}}}}var x=["masonry-card"];b&&x.push("hover"),h&&x.push("selected"),p&&x.push("has-src");var j=(0,e.useRef)(null);return(0,e.useEffect)((function(){l&&j.current&&l(j.current)}),[i]),t().createElement(pe,{node:i,style:{width:r,height:r*d,position:"relative"},className:x.join(" "),onClick:function(e){return g(i,a?Do.CLICK_TYPE_DOUBLE:Do.CLICK_TYPE_SIMPLE,e)},onDoubleClick:function(e){return g(i,Do.CLICK_TYPE_DOUBLE,e)},onMouseOver:function(){return v(!0)},onMouseOut:function(){return v(!1)}},p&&t().createElement(Ga,{className:"masonry-image",src:p,alt:i.getPath(),style:Ba({width:r},O)}),a&&t().createElement("div",{className:"mimefont-container"},t().createElement("div",{className:"mimefont mdi mdi-chevron-left"})),!a&&!p&&S(i),!a&&t().createElement("div",{style:{position:"absolute",top:0,left:0}},w(i)),p&&t().createElement("div",{className:"masonry-label-overlay",style:{position:"absolute",bottom:0,left:0,right:0,height:50}}),t().createElement("div",{className:"masonry-label",ref:j,style:Ba({display:b||h||!p?"block":"none"},{position:"absolute",bottom:0,left:0,right:0,height:32,padding:"6px 10px",fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",borderRadius:"0 0 2px 2px"})},a?k:i.getLabel()))}),(function(e){return e.data.node})),Ga=function(n){var r=n.src,o=n.alt,i=n.style,a=n.className,s=(0,e.useRef)(),c=function(t){var n=za((0,e.useState)(!1),2),r=n[0],o=n[1];return(0,e.useEffect)((function(){var e=new IntersectionObserver((function(e){var t,n,r=za(e,1)[0];if(!(r.target&&!r.rootBounds&&(t=r.target,n=t.getBoundingClientRect(),n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth))))return r.isIntersecting?o(r.isIntersecting):void 0;o(!0)}),{threshold:.1,root:null});return e.observe(t.current),function(){e.disconnect()}}),[t]),r}(s),l=Ba({},i);return l.transition="opacity 550ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",c||(l.opacity=0),t().createElement("img",{ref:s,alt:o,src:c?r:null,style:l,className:a})};function Ka(e,t){var n=[];return e.getChildren().forEach((function(e,r){n.push(Ba({id:"item-"+r,node:e},t))})),n.sort((function(e,t){return go(e.node,t.node)})),e.getParent()&&n.unshift(Ba({id:"item-parent",parent:!0,node:e.getParent()},t)),n}const $a=t().memo((function(n){var r=n.className,o=n.dataModel,i=n.entryProps,a=n.emptyStateProps,s=n.containerStyle,c=void 0===s?{}:s,l=n.columnWidth,u=void 0===l?220:l,d=n.onScroll,p={dataModel:o,entryProps:i},f=function(){return Ka(o.getContextNode(),p)},h=za((0,e.useState)(f),2),m=h[0],y=h[1],b=za((0,e.useState)(o.getContextNode()),2),v=b[0],g=b[1];(0,e.useEffect)((function(){var e=function(){var e=o.getContextNode();e.isLoaded()?g(e):e.observeOnce("loaded",(function(){return g(e)}))};return o.observe("context_changed",e),function(){o.stopObserving("context_changed",e)}})),(0,e.useEffect)((function(){y(f());var e=function(){y(Ka(v,p)),Va()},t=function(){y(Ka(v,p)),window.dispatchEvent(new Event("resize")),Va()};return v.observe("child_added",t),v.observe("child_removed",e),v.observe("child_replaced",t),function(){v.stopObserving("child_added",t),v.stopObserving("child_removed",e),v.stopObserving("child_replaced",t)}}),[v]),v.isLoaded()||(v.observeOnce("loaded",(function(){y(Ka(v,p))})),v.load());var S,w,k,O,P,E,C=(0,e.useRef)(null),T=(S=C,w=function(){var e=S.current;if(e){var t=getComputedStyle(e),n=parseFloat;return{width:e.clientWidth-n(t.paddingTop)-n(t.paddingBottom),height:e.clientHeight-n(t.paddingLeft)-n(t.paddingRight)}}return{width:0,height:0}},k=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ci(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ci(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.useState(w),2),O=k[0],P=k[1],E=function(){return P(w())},si(window,"resize",E),si(window,"orientationchange",E),ai((function(){P(w())}),[]),O),x=T.width,j=T.height,R=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.offset,o=void 0===r?0:r,i=n.fps,a=void 0===i?12:i,s=t&&"current"in t?t.current:t,c=function(){return s?"scrollTop"in s?s.scrollTop:s.pageYOffset||s.scrollY:0},l=Ci(function(t,n,r){var o=e.useState(t);return[o[0],Ei(o[1],n,void 0)]}(c,a),2),u=l[0],d=l[1],p=Ci(e.useState(!1),2),f=p[0],h=p[1];function m(){h(!1)}return ai((function(){if(s){var e,t=!1,n=function(){return e&&Si(e)},r=function(){t||(d(c()),h(!0),n(),e=wi(m,1e3/a))};return s.addEventListener("scroll",r),function(){s.removeEventListener("scroll",r),n(),t=!0}}}),[s,a]),{scrollTop:Math.max(0,u-o),isScrolling:f}}(C),I=R.scrollTop,_=R.isScrolling;(0,e.useEffect)((function(){Va()}),[c.marginLeft]),d&&(0,e.useEffect)((function(){d({scrollTop:I})}),[I]);var A=function(t){var n=t.width,r=t.columnWidth,o=void 0===r?200:r,i=t.columnGutter,a=void 0===i?0:i,s=t.columnCount,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wi,l=function(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ui(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ui(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(zi(n,o,a,s),2),t=e[0],r=e[1];return Bi(r,t,a)},u=e.useRef();void 0===u.current&&(u.current=l());var d=e.useRef(c),p=[n,o,a,s],f=e.useRef(p),h=!p.every((function(e,t){return f.current[t]===e}));if(h||!c.every((function(e,t){return d.current[t]===e}))){var m=u.current,y=l();if(d.current=c,f.current=p,h)for(var b=m.size(),v=0;v<b;v++){var g=m.get(v);y.set(v,void 0!==g?g.height:0)}u.current=y}return u.current}({width:x,columnWidth:u,columnGutter:8},[m,u]),M=function(t){var n=ma(),r=ba(t,n);function o(){return r.disconnect()}return e.useEffect((function(){return o}),[r]),r}(A),D=function(t){var n,r=t.positioner,o=t.resizeObserver,i=t.items,a=t.as,s=void 0===a?"div":a,c=t.id,l=t.className,u=t.style,d=t.role,p=void 0===d?"grid":d,f=t.tabIndex,h=void 0===f?0:f,m=t.containerRef,y=t.itemAs,b=void 0===y?"div":y,v=t.itemStyle,g=t.itemHeightEstimate,S=void 0===g?300:g,w=t.itemKey,k=void 0===w?Aa:w,O=t.overscanBy,P=void 0===O?2:O,E=t.scrollTop,C=t.isScrolling,T=t.height,x=t.render,j=t.onRender,R=0,I=ma(),_=Da(r,o),A=i.length,M=r.columnWidth,D=r.columnCount,L=r.range,N=r.estimateHeight,U=r.size,B=r.shortestColumn,F=U(),z=B(),W=[],q="list"===p?"listitem":"grid"===p?"gridcell":void 0,H=ki(j),Z=E+(P*=T),V=z<Z&&F<A;if(L(Math.max(0,E-P/2),Z,(function(e,t,r){var o=i[e],a=k(o,e),s={top:r,left:t,width:M,writingMode:"horizontal-tb",position:"absolute"};W.push(Ta(b,{key:a,ref:_(e),role:q,style:"object"===Ca(v)&&null!==v?Object.assign({},s,v):s},ja(x,e,o,M))),void 0===n?(R=e,n=e):(R=Math.min(R,e),n=Math.max(n,e))})),V)for(var J=Math.min(A-F,Math.ceil((E+P-z)/S*D)),G=F,K=Ma(M);G<F+J;G++){var $=i[G],Y=k($,G);W.push(Ta(b,{key:Y,ref:_(G),role:q,style:"object"===Ca(v)?Object.assign({},K,v):K},ja(x,G,$,M)))}e.useEffect((function(){"function"==typeof H.current&&void 0!==n&&H.current(R,n,i),xa="1"}),[R,n,i,H]),e.useEffect((function(){V&&I()}),[V]);var X=Ra(C,N(A,S));return Ta(s,{ref:m,key:xa,id:c,role:p,className:l,tabIndex:h,style:"object"===Ca(u)?_a(X,u):X,children:W})}({positioner:A,resizeObserver:M,items:m,height:j,scrollTop:I,isScrolling:_,overscanBy:6,render:Ja}),L=a&&!v.isLoading()&&(!m||!m.length);return t().createElement("div",{style:Ba({flex:1,padding:8,overflowY:"auto"},c),className:r,ref:C,onKeyDown:function(e){"Enter"===e.key&&o.getUniqueNode()?i.handleClicks(o.getUniqueNode(),Do.CLICK_TYPE_DOUBLE,e):"Delete"===e.key&&q().getInstance().Controller.fireActionByKey("key_delete")}},L&&t().createElement(fo,Na({pydio:q().getInstance()},a)),!L&&D)}));function Ya(e){return Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ya(e)}function Xa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ts(r.key),r)}}function es(e,t,n){return t&&Qa(e.prototype,t),n&&Qa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ts(e){var t=function(e,t){if("object"!==Ya(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ya(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ya(t)?t:String(t)}function ns(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rs(e,t)}function rs(e,t){return rs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rs(e,t)}function os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=is(e);if(t){var o=is(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ya(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function is(e){return is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},is(e)}var as=function(n){ns(o,n);var r=os(o);function o(t){var n;return Xa(this,o),(n=r.call(this,t)).root=(0,e.createRef)(),n}return es(o,[{key:"componentDidMount",value:function(){this.props.selected&&this.root.current&&this.root.current.scrollIntoView({behavior:"smooth"})}},{key:"render",value:function(){var n=this.props,r=n.item,o=n.prev,i=n.next,a=n.itemUuid,s=n.itemMoment,c=n.itemDesc,l=n.itemAnnotations,u=n.itemActions,d=n.selected,p=n.onSelect,f=n.color,h=s(r),m="tl-block",y="sep-date",b=!1;if(o){var v=s(o);h.format("L")===v.format("L")?(m+=" similar",b=!0):(m+=" newday",y+=" newday")}var g,S=l(r,o,i),w=u(r,o,i);p&&(g=function(){p(a(r))}),d&&(m+=" tl-selected");var k={fontWeight:500,color:f,cursor:"pointer",display:"inline-block",marginLeft:6};return t().createElement(e.Fragment,null,!b&&t().createElement("div",{className:y},t().createElement("div",{className:"daymonth"},h.format("DD")),t().createElement("div",{className:"dayweek"},h.format("ddd"))),t().createElement("div",{className:m,ref:this.root},t().createElement("div",{className:"tl-date"},t().createElement("div",{className:"daymonth"},h.format("DD")),t().createElement("div",{className:"dayweek"},h.format("ddd"))),t().createElement("div",{className:"tl-dot"}),t().createElement("div",{className:"tl-card"+(g?" tl-selectable":""),onClick:g},t().createElement("div",{className:"tl-desc"},t().createElement("div",{className:"desc-date"},h.format(b?"LT":"llll")),c(r,o,i)),t().createElement("div",{className:"tl-actions"},S,d&&w&&t().createElement("div",null,w.map((function(e){return t().createElement("a",{onClick:e.onClick,style:k},e.label)})))))))}}]),o}(e.Component),ss=function(e){ns(r,e);var n=os(r);function r(e){var t;return Xa(this,r),(t=n.call(this,e)).state={},t}return es(r,[{key:"makeStyle",value:function(e){var n=e.palette.mui3["on-surface"],r=e.palette.mui3.tertiary,o=e.palette.mui3["outline-variant"],i=e.palette.mui3.surface,a="0px 1px 3px "+e.palette.mui3["outline-variant"],s="\n        .timeline{\n            color: ".concat(n,";\n        }\n        .timeline .tl-line {\n            border-right: 3px dashed ").concat(o,"; \n        }\n        .timeline .tl-timeline .tl-block .tl-dot{\n            background-color: ").concat(r,";\n            box-shadow: ").concat(r," 0px 0px 4px;\n        }\n        .timeline .tl-timeline .tl-block .tl-dot:before{\n            border-color: ").concat(r,"\n        }\n        .timeline .tl-timeline .tl-block .tl-card.tl-selectable:hover, \n        .timeline .tl-timeline .tl-block.tl-selected .tl-card {\n            box-shadow: ").concat(a,"\n        }\n        .timeline .tl-timeline .daymonth{\n            color: ").concat(r,"\n        }\n        .timeline .tl-card{\n            background-color: ").concat(i,";\n        }\n        ");return t().createElement("style",{type:"text/css"},s)}},{key:"render",value:function(){var e,n=this,r=this.props.muiTheme,o=this.props,i=o.items,a=o.className,s=void 0===a?"":a,c=o.useSelection,l=void 0!==c&&c,u=o.preSelection,d=this.props,p=d.itemUuid,f=d.itemMoment,h=d.itemActions,m=d.itemAnnotations,y=d.itemDesc,b=d.onItemSelect,v=this.props,g=v.loadMoreAction,S=v.loadMoreLabel,w=v.loadMoreDisabled,k=this.state.selection,O=void 0===k?u:k;return r.palette.mui3.tertiary,b?e=b:l&&(e=function(e){n.setState({selection:e})}),t().createElement("div",{className:"timeline "+s},t().createElement("div",{className:"tl-line"}),t().createElement("div",{className:"tl-timeline"},i.map((function(n,o){return t().createElement(as,{item:n,prev:o>0?i[o-1]:null,next:o<i.length-1?i[o+1]:null,selected:!!l&&p(n)===O,onSelect:e,itemUuid:p,itemMoment:f,itemActions:h,itemAnnotations:m,itemDesc:y,color:r.palette.mui3.primary})})),g&&t().createElement("div",{className:"tl-block tl-more"},t().createElement("div",{className:"tl-date"}),t().createElement("div",{className:"tl-dot"}),t().createElement("div",{className:"tl-card tl-selectable",style:{color:r.palette.mui3.primary},onClick:w?null:g},S))),this.makeStyle(r))}}]),r}(e.Component);const cs=ss=(0,$.muiThemeable)()(ss);function ls(e){return ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ls(e)}function us(){return us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},us.apply(this,arguments)}function ds(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ks(r.key),r)}}function fs(e,t,n){return t&&ps(e.prototype,t),n&&ps(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hs(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ms(e,t)}function ms(e,t){return ms=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ms(e,t)}function ys(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vs(e);if(t){var o=vs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ls(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bs(e)}(this,n)}}function bs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vs(e){return vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vs(e)}function gs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ss(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gs(Object(n),!0).forEach((function(t){ws(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ws(e,t,n){return(t=ks(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ks(e){var t=function(e,t){if("object"!==ls(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ls(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ls(t)?t:String(t)}var Os=q().requireLib("hoc").withContextMenu,Ps=function(e){return t().createElement("div",e)};Ps=Os(Ps);var Es=B()({displayName:"SimpleTreeNode",propTypes:{collapse:z().bool,forceExpand:z().bool,childrenOnly:z().bool,depth:z().number,onNodeSelect:z().func,node:z().instanceOf(AjxpNode),dataModel:z().instanceOf(PydioDataModel),forceLabel:z().string,nodeIsSelected:z().func,showLoader:z().bool,checkboxes:z().array,checkboxesValues:z().object,checkboxesComputeStatus:z().func,onCheckboxCheck:z().func,paddingOffset:z().number,offsetSize:z().number},getDefaultProps:function(){return{collapse:!1,childrenOnly:!1,depth:0,paddingOffset:0,offsetSize:20,onNodeSelect:function(e){}}},listenToNode:function(e){this._childrenListener=function(){this.isMounted()&&this.setState({children:this._nodeToChildren(e)})}.bind(this),this._nodeListener=function(){this.isMounted()&&this.forceUpdate()}.bind(this),e.observe("child_added",this._childrenListener),e.observe("child_removed",this._childrenListener),e.observe("loaded",this._childrenListener),e.observe("loading",this._nodeListener),e.observe("node_replaced",this._nodeListener)},stopListening:function(e){e.stopObserving("child_added",this._childrenListener),e.stopObserving("child_removed",this._childrenListener),e.stopObserving("loaded",this._childrenListener),e.stopObserving("loading",this._nodeListener),e.stopObserving("node_replaced",this._nodeListener)},componentDidMount:function(){this.listenToNode(this.props.node)},componentWillUnmount:function(){this.stopListening(this.props.node)},componentWillReceiveProps:function(e){var t=this.props.node,n=e.node;if(n===t&&n.getMetadata().get("paginationData")){var r=this.state.children.map((function(e){return e.setParent(n),e})),o=this.state.children.map((function(e){return e.getPath()}));this._nodeToChildren(n).forEach((function(e){-1===o.indexOf(e.getPath())&&r.push(e)})),this.setState({children:r})}else this.setState({children:this._nodeToChildren(n)});n!==t&&(this.stopListening(t),this.listenToNode(n))},getInitialState:function(){return{showChildren:!this.props.collapse||this.props.forceExpand,children:this._nodeToChildren(this.props.node)}},_nodeToChildren:function(){var e=[];return this.props.node.getChildren().forEach((function(t){t.isLeaf()&&"ajxp_browsable_archive"!==t.getAjxpMime()||e.push(t)})),e.sort((function(e,t){return e.isRecycle()?1:t.isRecycle()?-1:e.getLabel().localeCompare(t.getLabel(),void 0,{numeric:!0})})),e},onNodeSelect:function(e){this.props.onNodeSelect&&this.props.onNodeSelect(this.props.node),e.preventDefault(),e.stopPropagation()},onChildDisplayToggle:function(e){this.props.node.getChildren().size&&this.setState({showChildren:!this.state.showChildren}),e.preventDefault(),e.stopPropagation()},nodeIsSelected:function(e){return this.props.nodeIsSelected?this.props.nodeIsSelected(e):-1!==this.props.dataModel.getSelectedNodes().indexOf(e)},render:function(){var e,n=this.props,o=n.node,i=n.dataModel,a=n.childrenOnly,s=n.canDrop,c=n.isOverCurrent,l=n.checkboxes,u=n.checkboxesComputeStatus,d=n.checkboxesValues,p=n.onCheckboxCheck,f=n.depth,h=n.paddingOffset,m=n.offsetSize,y=n.forceExpand,b=n.selectedItemStyle,v=n.getItemStyle,S=n.getRightIcon,k=n.forceLabel,O=n.showLoader,P=n.noPaginator;if(this.state.children.length)e=t().createElement("span",{onClick:this.onChildDisplayToggle},this.state.showChildren||y?t().createElement("span",{className:"tree-icon mdi mdi-menu-down"}):t().createElement("span",{className:"tree-icon mdi mdi-menu-right"}));else{var E="tree-icon mdi mdi-menu-right";o.isLoaded()&&(E+=" no-folder-children"),e=t().createElement("span",{className:E})}var C,T=this.nodeIsSelected(o)?"mui-menu-item mui-is-selected":"mui-menu-item";if(!a){var x;if(s&&c&&(T+=" droppable-active"),l){var j={},R=!1,I={},_="";if(u){var A=u(o);j=A.VALUES,R=A.INHERITED,I=A.DISABLED,A.CLASSNAME&&(_=" "+A.CLASSNAME)}else d&&d[o.getPath()]&&(j=d[o.getPath()]);var M=[];x=l.map(function(e){var n=void 0!==j[e]&&j[e],r=function(t,n){p(o,e,n)}.bind(this);return n&&M.push(e),t().createElement(g.Checkbox,{name:e,key:e+"-"+(n?"true":"false"),checked:n,onCheck:r,disabled:I[e],className:"cbox-"+e,style:{width:44}})}.bind(this)),T+=R?" inherited ":"",T+=M.length?" checkbox-values-"+M.join("-"):" checkbox-values-empty",x=t().createElement("div",{style:{display:"flex",alignItems:"center"},className:"tree-checkboxes"+_},x)}var D,L={paddingLeft:h+f*m};this.nodeIsSelected(o)&&b&&(L=Ss(Ss({},L),b)),v&&(L=Ss(Ss({},L),v(o))),S&&(D=S(o));var N,U="mdi mdi-folder",B=o.getAjxpMime();"ajxp_browsable_archive"===B?U="mdi mdi-archive":"ajxp_recycle"===B&&(U="mdi mdi-delete"),O&&o.isLoading()&&(N=t().createElement(g.CircularProgress,{size:14,style:{marginLeft:7},thickness:1})),C=t().createElement(Ps,{node:o,className:"tree-item "+T+(x?" has-checkboxes":""),style:L},t().createElement("div",{className:"tree-item-label",style:{display:"flex",alignItems:"center"},onClick:this.onNodeSelect,title:o.getLabel(),"data-id":o.getPath()},e,t().createElement("span",{className:"tree-icon "+U}),t().createElement("span",{style:{flex:1}},k||o.getLabel()),N,D),x)}var F=[],z=function(e){return e},W=!1;if(w()&&this.props.connectDropTarget&&this.props.connectDragSource){var q=this.props.connectDragSource,H=this.props.connectDropTarget;z=function(e){q(r().findDOMNode(e)),H(r().findDOMNode(e))},W=!0}return(this.state.showChildren||y)&&(F=this.state.children.map(function(e){var n=Ss(Ss({},this.props),{},{forceLabel:null,childrenOnly:!1,key:e.getPath(),node:e,depth:f+1});return t().createElement(W?Cs:Es,n)}.bind(this))),t().createElement("li",{ref:z,className:"treenode"+o.getPath().replace(/\//g,"_")},C,t().createElement("ul",null,!P&&o.getMetadata().has("paginationData")&&parseInt(o.getMetadata().get("paginationData").get("total"))>1&&t().createElement(Ts,{node:o,dataModel:i,depth:f+1,offsetSize:m,paddingOffset:h}),F))}}),Cs=Es;w()&&(Cs=w().flow(w().DragSource(p.NODE_PROVIDER,b,f),w().DropTarget(p.NODE_PROVIDER,v,h))(Es));var Ts=function(e){hs(r,e);var n=ys(r);function r(){return ds(this,r),n.apply(this,arguments)}return fs(r,[{key:"goTo",value:function(e){var t=this.props,n=t.dataModel,r=t.node;r.getMetadata().get("paginationData").set("new_page",e),n.requireContextChange(r)}},{key:"render",value:function(){var e=this,n=this.props,r=n.node,o=n.depth,i=n.paddingOffset,a=n.offsetSize,s={style:{width:24,height:24,padding:0}},c=r.getMetadata().get("paginationData"),l=c.get("current"),u=c.get("total"),d=q().getMessages()[331]+" "+l+" / "+u;return t().createElement("li",null,t().createElement("div",{style:{paddingLeft:i+o*a+5,paddingTop:5,paddingBottom:5,display:"flex",alignItems:"center"}},t().createElement("div",{style:{paddingLeft:14,paddingRight:6},className:"mdi mdi-format-list-bulleted"}),t().createElement("div",{style:{display:"flex",alignItems:"center",borderRadius:3,marginRight:10}},t().createElement(g.IconButton,us({iconClassName:"mdi mdi-chevron-left",onClick:function(){e.goTo(l-1)},disabled:1===l},s)),t().createElement("div",{style:{padding:"0 20px",flex:1,textAlign:"center",fontSize:13}},d),t().createElement(g.IconButton,us({iconClassName:"mdi mdi-chevron-right",onClick:function(){e.goTo(l+1)},disabled:l===u},s)))))}}]),r}(t().Component);Ts=(0,$.muiThemeable)()(Ts);var xs=function(e){hs(r,e);var n=ys(r);function r(){var e;ds(this,r);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return ws(bs(e=n.call.apply(n,[this].concat(o))),"onNodeSelect",(function(t){e.props.onNodeSelect?e.props.onNodeSelect(t):e.props.dataModel.setSelectedNodes([t])})),e}return fs(r,[{key:"render",value:function(){return t().createElement("ul",{className:this.props.className},t().createElement(Cs,{childrenOnly:!this.props.showRoot,forceExpand:this.props.forceExpand,node:this.props.node?this.props.node:this.props.dataModel.getRootNode(),dataModel:this.props.dataModel,onNodeSelect:this.onNodeSelect,nodeIsSelected:this.props.nodeIsSelected,forceLabel:this.props.rootLabel,checkboxes:this.props.checkboxes,checkboxesValues:this.props.checkboxesValues,checkboxesComputeStatus:this.props.checkboxesComputeStatus,onCheckboxCheck:this.props.onCheckboxCheck,selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,getRightIcon:this.props.getRightIcon,paddingOffset:this.props.paddingOffset,offsetSize:this.props.offsetSize,noPaginator:this.props.noPaginator,showLoader:this.props.showLoader}))}}]),r}(t().Component);ws(xs,"propTypes",{showRoot:z().bool,rootLabel:z().string,onNodeSelect:z().func,node:z().instanceOf(AjxpNode).isRequired,dataModel:z().instanceOf(PydioDataModel).isRequired,selectable:z().bool,selectableMultiple:z().bool,initialSelectionModel:z().array,onSelectionChange:z().func,forceExpand:z().bool,nodeIsSelected:z().func,showLoader:z().bool,checkboxes:z().array,checkboxesValues:z().object,checkboxesComputeStatus:z().func,onCheckboxCheck:z().func,paddingOffset:z().number,offsetSize:z().number}),ws(xs,"defaultProps",{showRoot:!0,onNodeSelect:xs.onNodeSelect});var js=function(e){hs(r,e);var n=ys(r);function r(){var e;ds(this,r);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return ws(bs(e=n.call.apply(n,[this].concat(o))),"onNodeSelect",(function(t){e.props.onNodeSelect?e.props.onNodeSelect(t):e.props.dataModel.setSelectedNodes([t])})),e}return fs(r,[{key:"render",value:function(){return t().createElement("ul",{className:this.props.className},t().createElement(Es,{childrenOnly:!this.props.showRoot,forceExpand:this.props.forceExpand,node:this.props.node?this.props.node:this.props.dataModel.getRootNode(),dataModel:this.props.dataModel,onNodeSelect:this.onNodeSelect,nodeIsSelected:this.props.nodeIsSelected,forceLabel:this.props.rootLabel,checkboxes:this.props.checkboxes,checkboxesValues:this.props.checkboxesValues,checkboxesComputeStatus:this.props.checkboxesComputeStatus,onCheckboxCheck:this.props.onCheckboxCheck,selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,getRightIcon:this.props.getRightIcon,paddingOffset:this.props.paddingOffset,offsetSize:this.props.offsetSize,showLoader:this.props.showLoader}))}}]),r}(t().Component);ws(js,"propTypes",{showRoot:z().bool,rootLabel:z().string,onNodeSelect:z().func,node:z().instanceOf(AjxpNode).isRequired,dataModel:z().instanceOf(PydioDataModel).isRequired,selectable:z().bool,selectableMultiple:z().bool,initialSelectionModel:z().array,onSelectionChange:z().func,forceExpand:z().bool,nodeIsSelected:z().func,showLoader:z().bool,checkboxes:z().array,checkboxesValues:z().object,checkboxesComputeStatus:z().func,onCheckboxCheck:z().func,paddingOffset:z().number,offsetSize:z().number}),ws(js,"defaultProps",{showRoot:!0,onNodeSelect:js.onNodeSelect});var Rs=function(e){hs(r,e);var n=ys(r);function r(){var e;ds(this,r);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return ws(bs(e=n.call.apply(n,[this].concat(o))),"nodeObserver",(function(){var t=e.props.dataModel.getRootNode();t.isLoaded()?e.forceUpdate():t.observeOnce("loaded",function(){this.forceUpdate()}.bind(bs(e)))})),ws(bs(e),"treeNodeSelected",(function(t){e.props.onNodeSelected?e.props.onNodeSelected(t):e.props.dataModel.requireContextChange(t)})),ws(bs(e),"nodeIsSelected",(function(t){return t===e.props.dataModel.getContextNode()})),e}return fs(r,[{key:"componentDidMount",value:function(){var e=this.props.dataModel;this._dmObs=this.nodeObserver,e.observe("context_changed",this._dmObs),e.observe("root_node_changed",this._dmObs),this.nodeObserver()}},{key:"componentWillUnmount",value:function(){if(this._dmObs){var e=this.props.dataModel;e.stopObserving("context_changed",this._dmObs),e.stopObserving("root_node_changed",this._dmObs)}}},{key:"render",value:function(){return this.props.draggable?t().createElement(xs,{onNodeSelect:this.treeNodeSelected,nodeIsSelected:this.nodeIsSelected,dataModel:this.props.dataModel,node:this.props.rootNode||this.props.dataModel.getRootNode(),showRoot:!!this.props.showRoot,selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,getRightIcon:this.props.getRightIcon,rootLabel:this.props.rootLabel,noPaginator:this.props.noPaginator,paddingOffset:this.props.paddingOffset,offsetSize:this.props.offsetSize,className:"folders-tree"+(this.props.className?" "+this.props.className:"")}):t().createElement(js,{onNodeSelect:this.treeNodeSelected,nodeIsSelected:this.nodeIsSelected,dataModel:this.props.dataModel,node:this.props.rootNode||this.props.dataModel.getRootNode(),selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,getRightIcon:this.props.getRightIcon,showRoot:!!this.props.showRoot,rootLabel:this.props.rootLabel,noPaginator:this.props.noPaginator,paddingOffset:this.props.paddingOffset,offsetSize:this.props.offsetSize,className:"folders-tree"+(this.props.className?" "+this.props.className:"")})}}]),r}(t().Component);function Is(e){return Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Is(e)}function _s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function As(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){Ms(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ms(e,t,n){return(t=Ls(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ls(r.key),r)}}function Ls(e){var t=function(e,t){if("object"!==Is(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Is(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Is(t)?t:String(t)}function Ns(e,t){return Ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ns(e,t)}function Us(e){return Us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Us(e)}ws(Rs,"propTypes",{pydio:z().instanceOf(q()).isRequired,dataModel:z().instanceOf(PydioDataModel).isRequired,className:z().string,onNodeSelected:z().func,draggable:z().bool,rootLabel:z().string});var Bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ns(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Us(o);if(i){var n=Us(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Is(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={show:!1},t}return n=s,(r=[{key:"show",value:function(){this.setState({show:!0})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){if(this.props.tooltip){var e,n={};this.props.label||this.props.labelElement?this.state.show&&(n={bottom:-10,top:"inherit"}):n={position:"relative"},this.props.label?e=t().createElement("span",{className:"ellipsis-label"},this.props.label):this.props.labelElement&&(e=this.props.labelElement);var r=this.props.style||{position:"relative"};return t().createElement("span",{onMouseEnter:this.show.bind(this),onMouseLeave:this.hide.bind(this),style:r,className:this.props.className},e,this.props.children,t().createElement("div",{label:this.props.tooltip,style:As(As({},n),{},{display:this.state.show?"block":"none"}),className:this.props.tooltipClassName}))}return this.props.label?t().createElement("span",null,this.props.label):this.props.labelElement?this.props.labelElement:t().createElement("span",null,this.props.children)}}])&&Ds(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Fs(e){return Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fs(e)}function zs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ws(e,t,n){return(t=Hs(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hs(r.key),r)}}function Hs(e){var t=function(e,t){if("object"!==Fs(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Fs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Fs(t)?t:String(t)}function Zs(e,t){return Zs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zs(e,t)}function Vs(e){return Vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vs(e)}var Js=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zs(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vs(o);if(i){var n=Vs(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Fs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zs(Object(n),!0).forEach((function(t){Ws(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({colorIndicator:""},e))}return n=s,(r=[{key:"render",value:function(){return t().createElement(g.Paper,{style:{display:"inline-block",marginLeft:16}},t().createElement("div",{className:"figure-badge",style:this.props.colorIndicator?{borderLeftColor:this.props.colorIndicator}:{}},t().createElement("div",{className:"figure"},this.props.figure),t().createElement("div",{className:"legend"},this.props.legend)))}}])&&qs(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);const Gs=require("clipboard");var Ks=a.n(Gs);function $s(e){return $s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$s(e)}function Ys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xs(e,t,n){return(t=ec(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ec(r.key),r)}}function ec(e){var t=function(e,t){if("object"!==$s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==$s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===$s(t)?t:String(t)}function tc(e,t){return tc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tc(e,t)}function nc(e){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nc(e)}var rc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tc(e,t)}(c,e);var n,r,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nc(o);if(i){var n=nc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===$s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).state={copyMessage:null},t}return n=c,r=[{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"attachClipboard",value:function(){this._clip&&this._clip.destroy(),this.refs["copy-button"]&&(this._clip=new(Ks())(this.refs["copy-button"],{text:function(e){return this.props.inputValue}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage(this.props.inputCopyMessage||"192")},this.clearCopyMessage.bind(this))}.bind(this)),this._clip.on("error",function(){var e;e=0===a.g.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("143"),this.refs.input.focus(),this.setState({copyMessage:e},this.clearCopyMessage.bind(this))}.bind(this)))}},{key:"clearCopyMessage",value:function(){a.g.setTimeout(function(){this.setState({copyMessage:""})}.bind(this),3e3)}},{key:"render",value:function(){var e=null;if(this.state.copyMessage){var n=function(){return{__html:this.state.copyMessage}}.bind(this);e=t().createElement("div",{style:{color:"rgba(0,0,0,0.23)"},className:"copy-message",dangerouslySetInnerHTML:n()})}var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(n),!0).forEach((function(t){Xs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({position:"absolute",right:-8,bottom:13,fontSize:15,color:this.props.buttonColor||"rgba(0, 150, 136, 0.52)",height:26,width:26,lineHeight:"28px",textAlign:"center",cursor:"pointer",borderRadius:"50%"},this.props.buttonStyle);return t().createElement("div",null,t().createElement("div",{style:{position:"relative"}},t().createElement(g.TextField,{fullWidth:!0,ref:"input",floatingLabelText:this.props.floatingLabelText,floatingLabelStyle:{whiteSpace:"nowrap"},underlineShow:this.props.underlineShow,defaultValue:this.props.inputValue,className:this.props.inputClassName,multiLine:this.props.multiLine,rows:this.props.rows,rowsMax:this.props.rowsMax,readOnly:!0,onClick:function(e){e.currentTarget.select()},style:{marginTop:-10,width:"92%",fontSize:14}}),t().createElement("span",{ref:"copy-button",style:r,title:this.props.getMessage("191"),className:"copy-button mdi mdi-content-copy"})),e)}}],r&&Qs(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),c}(t().Component);function oc(e){return oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oc(e)}function ic(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mc(r.key),r)}}function sc(e,t,n){return t&&ac(e.prototype,t),n&&ac(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function cc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lc(e,t)}function lc(e,t){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lc(e,t)}function uc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dc(e);if(t){var o=dc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===oc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function dc(e){return dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dc(e)}function pc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pc(Object(n),!0).forEach((function(t){hc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hc(e,t,n){return(t=mc(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mc(e){var t=function(e,t){if("object"!==oc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==oc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===oc(t)?t:String(t)}var yc=q().requireLib("hoc"),bc=yc.PlaceHolder,vc=yc.PhRoundShape,gc=yc.PhTextRow,Sc=yc.AdditionalIcons,wc=(0,$.muiThemeable)()((function(e){var n=e.legend,r=e.data,o=e.legendStyle,i=e.dataStyle,a=(e.placeHolder,e.placeHolderReady,e.muiTheme),s={legend:fc({fontSize:14,color:a.palette.mui3["on-surface"],fontWeight:500},o),data:fc({fontSize:12,color:a.palette.mui3["on-surface-variant"],paddingRight:6,overflow:"hidden",textOverflow:"ellipsis"},i)};return t().createElement("div",{style:{marginBottom:20}},t().createElement("div",{style:s.legend},n),t().createElement("div",{style:s.data},r))})),kc=function(e){cc(r,e);var n=uc(r);function r(){return ic(this,r),n.apply(this,arguments)}return sc(r,[{key:"render",value:function(){var e=this.props,n=e.iconClassName,r=e.legend,o=e.data,i=e.dataStyle,a=e.legendStyle,s=e.iconStyle,c=e.placeHolder,l=e.placeHolderReady,u=e.muiTheme,d={icon:fc({margin:"16px 20px 0"},s),legend:fc({fontSize:12,color:u.palette.mui3["on-surface"],fontWeight:500},a),data:fc({fontSize:14,paddingRight:6,overflow:"hidden",textOverflow:"ellipsis"},i)},p=t().createElement("div",{style:fc({display:"flex",marginBottom:8,overflow:"hidden"},this.props.style)},t().createElement("div",{style:{width:64}},t().createElement(g.FontIcon,{color:u.palette.mui3.secondary||"#aaaaaa",className:n,style:d.icon})),t().createElement("div",{style:{flex:1}},t().createElement("div",{style:d.legend},r),t().createElement("div",{style:d.data},o)));if(c){var f=t().createElement("div",{style:fc({display:"flex",marginBottom:16,overflow:"hidden"},this.props.style)},t().createElement("div",{style:{width:64}},t().createElement(vc,{style:{width:35,height:35,margin:"10px 15px 0"}})),t().createElement("div",{style:{flex:1}},t().createElement("div",{style:fc(fc({},d.legend),{},{maxWidth:100})},t().createElement(gc,null)),t().createElement("div",{style:fc(fc({},d.data),{},{marginRight:24})},t().createElement(gc,{style:{height:"1.3em",marginTop:"0.4em"}}))));return t().createElement(bc,{ready:l,showLoadingAnimation:!0,customPlaceholder:f},p)}return p}}]),r}(t().Component);kc=(0,$.muiThemeable)()(kc);var Oc=function(e){cc(r,e);var n=uc(r);function r(){return ic(this,r),n.apply(this,arguments)}return sc(r,[{key:"render",value:function(){var e=this.props,n=e.title,r=e.onDismissAction,o=e.onEditAction,i=e.onDeleteAction,a=e.otherActions,s=e.moreMenuItems,c=e.children,l=e.muiTheme,u=e.style,d=e.headerSmall,p=e.editTooltip,f=e.deleteTooltip,h=e.mui3,m=void 0!==h&&h,y=e.topLeftAvatar,b=l.palette.mui3["secondary-container"],v=l.palette.mui3["on-secondary-container"],S=l.palette.mui3.primary,w={headerHeight:"auto",buttonBarHeight:60,headerBg:b,headerColor:v,buttonBar:{display:"flex",height:60},fabTop:80,button:{style:{height:40,width:40,padding:8},iconStyle:{color:S}},title:{paddingLeft:o?64:20,fontSize:20,lineHeight:"26px",paddingBottom:16}};m&&(w.headerBg="transparent",w.childrenContainer={padding:"0 20px"},w.buttonBar={padding:20,display:"flex",alignItems:"center"},w.title={fontSize:22,lineHeight:"26px",padding:"0px 20px 16px"}),d&&(w={headerHeight:"auto",headerBg:b,headerColor:v,buttonBar:{display:"flex",alignItems:"center",height:42,padding:"0 7px 0 16px"},fabTop:60,button:{style:{width:38,height:38,padding:9},iconStyle:{color:S,fontSize:18}}});var k=Sc.DeleteOutline;return t().createElement("div",{style:fc({width:"100%",position:"relative",overflowX:"hidden"},u)},t().createElement(g.Paper,{zDepth:0,style:{backgroundColor:w.headerBg,color:w.headerColor,height:w.headerHeight,borderRadius:"2px 2px 0 0"}},t().createElement("div",{style:w.buttonBar},y,d&&t().createElement("span",{style:{flex:1,fontSize:14,fontWeight:500}},n),!d&&t().createElement("span",{style:{flex:1}}),a,o&&d&&t().createElement(g.IconButton,{style:w.button.style,iconStyle:w.button.iconStyle,iconClassName:"mdi mdi-pencil",onClick:o,tooltip:p,tooltipPosition:"bottom-left"}),i&&d&&t().createElement(g.IconButton,{style:fc(fc({},w.button.style),{},{padding:7}),iconStyle:w.button.iconStyle,onClick:i,tooltip:f,tooltipPosition:"bottom-left"},t().createElement(k,null)),s&&s.length>0&&t().createElement(g.IconMenu,{anchorOrigin:{vertical:"top",horizontal:d?"right":"left"},targetOrigin:{vertical:"top",horizontal:d?"right":"left"},iconButtonElement:t().createElement(g.IconButton,{style:w.button.style,iconStyle:w.button.iconStyle,iconClassName:"mdi mdi-dots-vertical"})},s),r&&t().createElement(g.IconButton,{style:fc(fc({},w.button.style),{},{backgroundColor:l.palette.mui3["surface-variant"],borderRadius:"50%"}),iconStyle:w.button.iconStyle,iconClassName:"mdi mdi-close",onClick:r})),!d&&t().createElement("div",{style:w.title},n)),t().createElement("div",{style:fc({paddingTop:12,paddingBottom:8,position:"relative"},w.childrenContainer)},!m&&o&&!d&&t().createElement(g.FloatingActionButton,{onClick:o,backgroundColor:l.palette.mui3.tertiary,mini:!0,style:{position:"absolute",top:-20,left:10}},t().createElement(g.FontIcon,{className:"mdi mdi-pencil",style:{color:l.palette.mui3["on-tertiary"]}})),c),(o||i)&&!d&&m&&t().createElement("div",{style:{padding:"12px 0",margin:"0 20px",display:"flex",borderTop:"1px solid "+l.palette.mui3["outline-variant"]}},t().createElement("span",{style:{flex:1}}),i&&t().createElement(g.FlatButton,{label:f,onClick:function(){return i()}}),o&&t().createElement(g.RaisedButton,{style:{marginLeft:5},label:p,onClick:function(){return o()}})))}}]),r}(t().Component);function Pc(e){return Pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pc(e)}function Ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Cc(r.key),r)}}function Cc(e){var t=function(e,t){if("object"!==Pc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Pc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Pc(t)?t:String(t)}function Tc(e,t){return Tc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tc(e,t)}function xc(e){return xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xc(e)}Oc=(0,$.muiThemeable)()(Oc);var jc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tc(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xc(o);if(i){var n=xc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Pc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"render",value:function(){var e=this.props,n=e.node,r=e.mui3,o=parseInt(n.getMetadata().get("ws_quota_usage")),i=parseInt(n.getMetadata().get("ws_quota"));o=Math.min(o,i);var a=Math.round(o/i*100),s="#4caf50";a>90?s="#e53935":a>60&&(s="#ff9800");var c=q().getMessages()["workspace.quota-usage"]+" ("+me().roundFileSize(i)+")",l=t().createElement("div",{style:{display:"flex",maxWidth:200,alignItems:"center",marginTop:5}},t().createElement("div",{style:{flex:1,paddingRight:12}},t().createElement(g.LinearProgress,{mode:"determinate",min:0,max:i,value:o,color:s})),t().createElement("div",{style:{color:"#bdbdbd",fontWeight:500,fontSize:15}},a,"%"));return r?t().createElement(wc,{legend:c,data:l}):t().createElement(kc,{iconClassName:"mdi mdi-gauge",legend:c,data:l,iconStyle:{marginTop:30}})}}])&&Ec(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Rc(e){return Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rc(e)}var Ic=["style","titleStyle","iconStyleRight","iconStyleLeft"];function _c(){return _c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_c.apply(this,arguments)}function Ac(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(n),!0).forEach((function(t){Dc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ac(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Rc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Rc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rc(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lc(e){return Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lc(e)}function Nc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Uc(r.key),r)}}function Uc(e){var t=function(e,t){if("object"!==Lc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Lc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Lc(t)?t:String(t)}function Bc(e,t){return Bc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bc(e,t)}function Fc(e){return Fc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fc(e)}var zc={node:z().instanceOf(AjxpNode).isRequired,registry:z().instanceOf(Registry).isRequired,editorData:z().object.isRequired,icon:z().bool},Wc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bc(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fc(o);if(i){var n=Fc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Lc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={ready:!1},t}return n=s,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.editorData;t.registry.loadEditorResources(n.resourcesManager,(function(){return e.setState({ready:!0})}))}},{key:"render",value:function(){var e,n=this.props.editorData;return this.state.ready?(e=FuncUtils.getFunctionByName(n.editorClass,window))?t().createElement(e.Editor,this.props):t().createElement("div",null,"Cannot find editor component ("+n.editorClass+")!"):null}}])&&Nc(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);Wc.propTypes=zc,Wc.defaultProps={icon:!1};const qc=Wc;var Hc=a(62610),Zc=a.n(Hc),Vc=a(13674),Jc=a.n(Vc);function Gc(e){return Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gc(e)}function Kc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$c(r.key),r)}}function $c(e){var t=function(e,t){if("object"!==Gc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Gc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Gc(t)?t:String(t)}function Yc(e,t){return Yc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yc(e,t)}function Xc(e){return Xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xc(e)}var Qc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yc(e,t)}(a,Observable);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xc(r);if(o){var n=Xc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Gc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this))._namespace=e,r._pydio=n,r._cards=r.getUserPreference("Cards"),r._cards||(r._cards=t),r}return t=a,n=[{key:"getUserPreference",value:function(e){var t=this._namespace+e,n=this._pydio.user.getPreference("gui_preferences",!0);return n&&n[t]?n[t]:null}},{key:"saveUserPreference",value:function(e,t){var n=this._namespace+e,r=this._pydio.user.getPreference("gui_preferences",!0);r||(r={}),r[n]=t,this._pydio.user.setPreference("gui_preferences",r,!0),this._pydio.user.savePreference("gui_preferences")}},{key:"saveCards",value:function(e){this.saveUserPreference("Cards",e)}},{key:"resetCards",value:function(){this.saveUserPreference("Cards",null)}},{key:"setCards",value:function(e){this._cards=e,this.notify("cards",this._cards),this.saveCards(e)}},{key:"getCards",value:function(){return this._cards}},{key:"removeCard",value:function(e){var t,n=-1,r=this.getCards();r.map((function(t,r){t.id==e&&(n=r)})),-1!=n?(t=0==n?r.slice(1):n==r.length-1?r.slice(0,-1):r.slice(0,n).concat(r.slice(n+1)),this.setCards(t)):console.warn("Card ID not found, this is strange.",e)}},{key:"createCardId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=LangUtils.computeStringSlug(e.title);t&&(n+="-"+Math.round(100*Math.random()+10));var r=!1;return this._cards.map(function(e){e.id==n&&(r=!0)}.bind(this)),r&&(n=this.createCardId(e,!0)),n}},{key:"addCard",value:function(e){e.id=this.createCardId(e),this.setCards(this._cards.concat([e]))}}],n&&Kc(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function el(e){return el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},el(e)}function tl(){return tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tl.apply(this,arguments)}function nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rl(r.key),r)}}function rl(e){var t=function(e,t){if("object"!==el(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==el(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===el(t)?t:String(t)}function ol(e,t){return ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ol(e,t)}function il(e){return il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},il(e)}var al=a(16689),sl=a(10757).requireLib("boot"),cl=sl.PydioContextConsumer,ll=sl.AsyncComponent,ul=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ol(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=il(r);if(o){var n=il(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===el(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).state={selectedIndex:0,availableWidgets:t.listAvailableWidgets()},t}return t=s,n=[{key:"listAvailableWidgets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],n=[];return this.props.namespaces.map((function(e){if(a.g[e]){for(var r in a.g[e])if(a.g[e].hasOwnProperty(r)){var o=a.g[e][r];o.hasBuilderFields&&o.hasBuilderFields()&&t.push({reactClass:o,fullName:e+"."+o.displayName})}}else n.push(e)})),n.length&&!e&&ResourcesManager.loadClassesAndApply(n,function(){this.setState({availableWidgets:this.listAvailableWidgets(!0)})}.bind(this)),t}},{key:"onDropDownChange",value:function(e,t,n){var r={};0!=t&&n.payload.reactClass.getBuilderFields().map((function(e){e.default&&(r[e.name]=e.default)})),this.props.onEditStatusChange&&this.props.onEditStatusChange(0!=t),this.setState({selectedIndex:t,selectedWidget:n.payload,currentFormValues:r})}},{key:"cancel",value:function(){this.props.onEditStatusChange&&this.props.onEditStatusChange(!1),this.setState({selectedIndex:0})}},{key:"onFormValueChange",value:function(e){this.setState({currentFormValues:e})}},{key:"onFormSubmit",value:function(){var e=this.state.currentFormValues,t=this.state.selectedWidget,n=e.title?e.title:e.legend;n||(n=this.state.selectedWidget.reactClass.builderDisplayName),this.props.onCreateCard({componentClass:t.fullName,title:n,props:e}),this.cancel()}},{key:"resetLayout",value:function(){window.confirm(this.props.getMessage("home.51"))&&this.props.onResetLayout()}},{key:"render",value:function(){var e,t,n=this.props.getMessage,r=([{payload:0,text:n("home.50")}].concat(this.state.availableWidgets.map((function(e,t){return{payload:e,text:e.reactClass.builderDisplayName}}))),al.createElement("div",null,"DropDownMenu (to be re-implemented)"));if(0!==this.state.selectedIndex){var o=this.state.selectedWidget.reactClass.getBuilderFields(),i={};o.map((function(e){e.default&&(i[e.name]=e.default)})),this.state.currentFormValues&&(i=LangUtils.mergeObjectsRecursive(i,this.state.currentFormValues)),e=al.createElement(ll,{namespace:"PydioForm",componentName:"FormPanel",parameters:o,depth:-1,values:i,onChange:this.onFormValueChange}),t=al.createElement("div",{style:{textAlign:"center",paddingBottom:100}},al.createElement(g.RaisedButton,{label:n("home.52"),onClick:this.onFormSubmit})," ",al.createElement(g.RaisedButton,{label:n("54",""),onClick:this.cancel}))}return al.createElement(g.Paper,tl({},this.props,{zDepth:3}),al.createElement("h3",null,n("home.53")),al.createElement("div",{className:"legend"},n("home.54"),al.createElement("br",null),n("home.55")),r,e,t,al.createElement("div",{style:{position:"absolute",bottom:30,left:10}},al.createElement(g.FlatButton,{disabled:0!=this.state.selectedIndex,label:n("home.56"),secondary:!0,onClick:this.resetLayout})))}}],n&&nl(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(al.Component);function dl(e){return dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dl(e)}function pl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pl(Object(n),!0).forEach((function(t){hl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hl(e,t,n){return(t=vl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ml(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vl(r.key),r)}}function bl(e,t,n){return t&&yl(e.prototype,t),n&&yl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vl(e){var t=function(e,t){if("object"!==dl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==dl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===dl(t)?t:String(t)}function gl(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sl(e,t)}function Sl(e,t){return Sl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Sl(e,t)}function wl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ol(e);if(t){var o=Ol(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===dl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return kl(e)}(this,n)}}function kl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ol(e){return Ol=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ol(e)}ul=cl(ul);var Pl=a(16689),El=a(10757).requireLib("boot").PydioContextConsumer,Cl=function(e){gl(n,e);var t=wl(n);function n(e,r){var o;return ml(this,n),(o=t.call(this,e,r))._storeObserver=function(t){var n=this;this._forceUpdate=!0,this.setState({cards:e.store.getCards()},(function(){n._forceUpdate=!1}))}.bind(kl(o)),e.store.observe("cards",o._storeObserver),o.state={cards:e.store.getCards()},o.requests=[],o.throttle=jr().getThrottler({concurrent:6}),o.restClient=jr().getRestClient({silent:!0,plugins:[o.throttle.plugin(),function(e){return o.requests.push(e),e}]}),a.e(597).then(a.t.bind(a,25993,23)).then((function(e){o.setState({rgl:e.default})})),o}return bl(n,[{key:"saveFullLayouts",value:function(e){var t={};Object.keys(e).forEach((function(n){t[n]=e[n].map((function(e){return{i:e.i,h:e.h,w:e.w,x:e.x,y:e.y}}))}));var n=this.props.store.getUserPreference("Layout");Jc()(n,t)||this.props.store.saveUserPreference("Layout",t)}},{key:"onLayoutChange",value:function(e,t){this._blockLayoutSave||this.saveFullLayouts(t)}},{key:"componentWillUnmount",value:function(){this.props.store.stopObserving("cards",this._storeObserver),this.throttle.options({active:!1}),this.requests.filter((function(e){return e.xhr})).map((function(e){return e.xhr.abort()}))}},{key:"componentWillReceiveProps",value:function(e){this.props&&e.editMode!==this.props.editMode&&Object.keys(this.refs).forEach(function(t){this.refs[t].toggleEditMode(e.editMode)}.bind(this))}},{key:"shouldComponentUpdate",value:function(e,t){return this._forceUpdate||t.rgl!==this.state.rgl||!1}},{key:"removeCard",value:function(e){this.props.removeCard(e)}},{key:"buildCards",value:function(e){var t=this,n=0,r={lg:[],md:[],sm:[],xs:[],xxs:[]},o=[],i=[],s=(Math.random(),this.props.store.getUserPreference("Layout")),c=function(e,t,n,r,o){var i=e.getGridLayout(r,o);return i.handle="h4",n.gridHandle&&(i.handle=n.gridHandle),i.i=t,i};return e.map((function(e){var l,u=e.componentClass.split("."),d=u[0],p=u[1];if(a.g[d]&&a.g[d][p]){l=a.g[d][p];var f=fl({},e.props),h=f.key=e.id||"item_"+n;f.ref=h,f.restClient=t.restClient,f.pydio=t.props.pydio,f.onCloseAction=function(){t.removeCard(h)},f.preferencesProvider=t.props.store;var m=0,y=0;e.defaultPosition&&(m=e.defaultPosition.x,y=e.defaultPosition.y);var b=c(l,h,e,m,y);for(var v in r)if(r.hasOwnProperty(v)){var g,S=r[v];if(s&&s[v]&&s[v].map((function(e){e.i===h&&e.h===b.h&&(g=e)})),g)S.push(g);else if(e.defaultLayouts&&e.defaultLayouts[v]){var w=c(l,h,e,e.defaultLayouts[v].x,e.defaultLayouts[v].y);S.push(w)}else S.push(b)}n++,o.push(Pl.createElement(l,f))}else a.g[d]||i.push(d)})),i.length&&(this._blockLayoutSave=!0,Zc().loadClassesAndApply(i,function(){this.setState({additionalNamespacesLoaded:i},function(){this._blockLayoutSave=!1}.bind(this))}.bind(this))),{cards:o,layouts:r}}},{key:"render",value:function(){var e=this.state.rgl;if(!e)return null;var t=this.buildCards(this.state.cards),n=t.cards,r=t.layouts,o=e.Responsive,i=(0,e.WidthProvider)(o);return Pl.createElement(i,{className:"dashboard-layout",cols:this.props.cols||{lg:10,md:8,sm:8,xs:4,xxs:2},layouts:r,rowHeight:5,onLayoutChange:this.onLayoutChange.bind(this),isDraggable:!this.props.disableDrag,style:this.props.style,autoSize:!1},n)}}]),n}(Pl.Component),Tl=function(e){gl(n,e);var t=wl(n);function n(e){var r;ml(this,n),r=t.call(this,e);var o=new Qc(e.storeNamespace,e.defaultCards,e.pydio);return r.state={editMode:!1,store:o},r}return bl(n,[{key:"removeCard",value:function(e){this.state.store.removeCard(e)}},{key:"addCard",value:function(e){this.state.store.addCard(e)}},{key:"resetCardsAndLayout",value:function(){this.state.store.saveUserPreference("Layout",null),this.state.store.setCards(this.props.defaultCards)}},{key:"toggleEditMode",value:function(){this.setState({editMode:!this.state.editMode})}},{key:"render",value:function(){var e,t=this,n=function(e){this.setState({widgetEditing:e})}.bind(this);this.props.builderNamespaces&&this.state.editMode&&(e=Pl.createElement(ul,{className:"admin-helper-panel",namespaces:this.props.builderNamespaces,onCreateCard:this.addCard.bind(this),onResetLayout:this.resetCardsAndLayout.bind(this),onEditStatusChange:n,getMessage:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ajxp_admin";return t.props.getMessage(e,n)}}));var r=this.props.rglStyle||{};return Pl.createElement("div",{style:fl(fl({},this.props.style),{},{width:"100%",flex:"1"}),className:this.state.editMode?"builder-open":""},!this.props.disableEdit&&Pl.createElement("div",{style:{position:"absolute",bottom:30,right:18,zIndex:11}},Pl.createElement(g.FloatingActionButton,{tooltip:this.props.getMessage("home.49"),onClick:this.toggleEditMode.bind(this),iconClassName:this.state.editMode?"mdi mdi-check":"mdi mdi-pencil",mini:this.state.editMode,disabled:this.state.editMode&&this.state.widgetEditing})),e,Pl.createElement("div",{className:"home-dashboard",style:{height:"100%"}},Pl.createElement(Cl,{disableDrag:this.props.disableDrag,cols:this.props.cols,store:this.state.store,style:r,pydio:this.props.pydio,editMode:this.state.editMode,removeCard:this.removeCard.bind(this)})))}}]),n}(Pl.Component);function xl(e){return xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xl(e)}function jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jl(Object(n),!0).forEach((function(t){Il(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Il(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==xl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xl(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Tl=El(Tl);const _l={propTypes:{showCloseAction:z().bool,onCloseAction:z().func},focusItem:function(){this.setState({focus:!0})},blurItem:function(){this.setState({focus:!1})},mergeStyleWithFocus:function(){return Rl(Rl({},this.props.style),{},{zIndex:this.state.focus?1:null})},getInitialSate:function(){return{focus:!1,showCloseAction:!1}},toggleEditMode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;void 0===e?this.setState({showCloseAction:!(this.state&&this.state.showCloseAction)}):this.setState({showCloseAction:e})},getCloseButton:function(){if(this.state&&this.state.showCloseAction){var e=this.props.onCloseAction||function(){};return React.createElement("div",{style:{position:"absolute",backgroundColor:"rgba(0,0,0,0.53)",zIndex:10,top:0,left:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement(g.FlatButton,{label:q().getInstance().MessageHash["ajxp_admin.home.48"],className:"card-close-button",onClick:e,style:{color:"white"}}))}return null},statics:{getGridLayout:function(e,t){return{x:e||0,y:t||0,w:this.gridWidth||4,h:this.gridHeight||12,isResizable:!1}},hasBuilderFields:function(){return!!this.builderFields},getBuilderFields:function(){return this.builderFields}}};function Al(e){return Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Al(e)}function Ml(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ml(Object(n),!0).forEach((function(t){Ll(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ml(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ll(e,t,n){return(t=Ul(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ul(r.key),r)}}function Ul(e){var t=function(e,t){if("object"!==Al(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Al(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Al(t)?t:String(t)}function Bl(e,t){return Bl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bl(e,t)}function Fl(e){return Fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fl(e)}var zl=a(580),Wl=a(16689).Component,ql=a(39455).FlatButton,Hl=a(13173).muiThemeable;function Zl(e){return Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zl(e)}function Vl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jl(Object(n),!0).forEach((function(t){Kl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kl(e,t,n){return(t=Yl(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yl(r.key),r)}}function Yl(e){var t=function(e,t){if("object"!==Zl(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Zl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Zl(t)?t:String(t)}function Xl(e,t){return Xl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xl(e,t)}function Ql(e){return Ql=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ql(e)}var eu=q().requireLib("boot").PydioContextConsumer,tu=q().requireLib("hoc").ModernSelectField,nu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xl(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ql(o);if(i){var n=Ql(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Zl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,r=[{key:"render",value:function(){var e,n,r,o=this.props,i=o.item,a=o.paginatorCallback,s=o.paginatorType,c=o.style,l=o.getMessage,u=o.paginatorLabel,d=o.muiTheme,p=(0,$.getMuiTheme)(Gl(Gl({},d),{},{zIndex:{layer:3e3,popover:3001}}));if(i.pagination){for(var f=i.pagination,h=f.start,m=f.max,y=f.interval,b=Math.ceil(m/y),v=Math.ceil(h/y),S=[],w=0;w<b;w++)S.push(w);e=t().createElement(g.MuiThemeProvider,{muiTheme:p},t().createElement(tu,{floatingLabelText:l(331),style:{width:60},dropDownMenuProps:{anchorOrigin:{vertical:"center",horizontal:"right"}},fullWidth:!0,value:v,onChange:function(e,t,n){a(n*y+"-"+(n+1)*y)}},S.map((function(e){return t().createElement(g.MenuItem,{value:e,key:e,primaryText:e+1})}))))}if("alpha"===s){var k="abcdefghijklmnopqrstuvwxyz0123456789".split("");k=[-1].concat(function(e){if(Array.isArray(e))return Vl(e)}(r=k)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return Vl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vl(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var O=i.currentParams&&i.currentParams.alpha_pages&&i.currentParams.value||-1;n=t().createElement(g.MuiThemeProvider,{muiTheme:p},t().createElement(tu,{floatingLabelText:l(625),style:{width:60,marginLeft:8},dropDownMenuProps:{anchorOrigin:{vertical:"center",horizontal:"right"}},fullWidth:!0,value:O,onChange:function(e,t,n){a(n)}},k.map((function(e){return t().createElement(g.MenuItem,{value:e,key:e,primaryText:-1===e?l(597,""):e})}))))}return t().createElement("div",{style:Gl(Gl({},c),{},{display:"flex",paddingRight:8,alignItems:"center"})},t().createElement("div",{style:{flex:1,height:20}},u||l(249,"")),e,n)}}],r&&$l(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.Component);nu.propTypes={item:z().object,paginatorCallback:z().func.isRequired,pydio:z().instanceOf(q()),mode:z().oneOf(["book","selector","popover"]).isRequired},nu=eu(nu),nu=(0,$.muiThemeable)()(nu);var ru=a(4305),ou=a.n(ru);function iu(e){return iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iu(e)}function au(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function su(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?au(Object(n),!0).forEach((function(t){pu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):au(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fu(r.key),r)}}function lu(e,t){return lu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lu(e,t)}function uu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function du(e){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},du(e)}function pu(e,t,n){return(t=fu(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fu(e){var t=function(e,t){if("object"!==iu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==iu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===iu(t)?t:String(t)}var hu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lu(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=du(r);if(o){var n=du(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===iu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return uu(e)}(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),pu(uu(n=i.call(this,e,t)),"state",{});var r=e.onSearch;return e.setSearchTerm||(n.state={value:""},n.search=ou()((function(){r(n.state.value)}),300)),n}return t=a,n=[{key:"onChange",value:function(e,t){var n=this.props.setSearchTerm;n?n(t):(this.setState({value:t}),this.search())}},{key:"render",value:function(){var e=this,t=this.props,n=t.underlineShow,r=t.searchLabel,o=t.style,i=t.inputStyle,a=t.underlineStyle,s=t.underlineFocusStyle,c=t.hintStyle,l=t.searchTerm,u=this.state.value;return React.createElement("div",{style:su({minWidth:320},o)},React.createElement(g.TextField,{fullWidth:!0,value:u||l,onChange:function(t,n){return e.onChange(t,n)},hintText:r,inputStyle:i,hintStyle:c,underlineStyle:a,underlineFocusStyle:s,underlineShow:void 0===n||n}))}}],n&&cu(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(e.Component);hu.propTypes={searchLabel:z().string.isRequired,onSearch:z().func.isRequired,style:z().object,underlineShow:z().bool};const mu=require("pydio/model/idm-object-helper");var yu=a.n(mu);const bu=require("pydio/model/cell");var vu=a.n(bu);function gu(e){return gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gu(e)}function Su(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wu(r.key),r)}}function wu(e){var t=function(e,t){if("object"!==gu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==gu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===gu(t)?t:String(t)}var ku=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props={pydio:t,cellModel:n,acl:r,addressBookItem:o}}var t,n;return t=e,n=[{key:"createCell",value:function(){var e,t=this.props,n=t.addressBookItem,r=t.pydio,o=r.MessageHash;n.IdmUser?e=n.IdmUser:n.IdmRole&&(e=n.IdmRole),e&&r.user.getIdmUser().then((function(t){var i=yu().extractLabelFromIdmObject(t),a=yu().extractLabelFromIdmObject(n.IdmUser||n.IdmRole),s=new(vu());s.setLabel(i+", "+a),s.setDescription("Created by "+i),s.addUser(e),s.save().then((function(e){r.UI.displayMessage("SUCCESS",o[643].replace("%s",a))})).catch((function(e){r.UI.displayMessage("ERROR",o[644].replace("%s",e.message))}))}))}},{key:"addToCell",value:function(){var e,t=this.props,n=t.addressBookItem,r=t.cellModel;n.IdmUser?e=n.IdmUser:n.IdmRole&&(e=n.IdmRole),e&&(r.addUser(e),r.save())}},{key:"removeFromCell",value:function(){var e=this.props,t=e.acl,n=e.cellModel;n.removeUser(t.RoleId),n.save()}},{key:"renderItems",value:function(){var e,t,n,r=this.props,o=r.pydio,i=r.cellModel,a=r.acl,s=r.addressBookItem,c=o.MessageHash,l=[];if(a?a.User&&a.User.Login===o.user.id:"user"===t&&o.user.id===e)return l;if(s&&(e=s.id,"group"===(t=s.type)&&s.IdmRole&&(e=s.IdmRole.Uuid,t="team")),n=a?yu().extractLabel(o,a):s.label,!0===i)return o.getPluginConfigs("auth").get("USER_CREATE_CELLS")?[React.createElement(g.MenuItem,{primaryText:c[640].replace("%s",n),onClick:this.createCell.bind(this)})]:[];var u,d=i.isEditable(),p=i.getAcls();return Object.keys(p).map((function(n){var r=p[n];(a?a.RoleId===r.RoleId:"user"===t&&r.User&&r.User.Login===e||"group"===t&&r.Group&&r.Group.Uuid===e||"team"===t&&r.Role&&r.Role.Uuid===e)&&(u=!0)})),u?l.push(React.createElement(g.MenuItem,{primaryText:c[641],disabled:!d,onClick:this.removeFromCell.bind(this)})):l.push(React.createElement(g.MenuItem,{primaryText:c[642],disabled:!d,onClick:this.addToCell.bind(this)})),o.getPluginConfigs("auth").get("USER_CREATE_CELLS")&&l.push(React.createElement(g.Divider,null),React.createElement(g.MenuItem,{primaryText:c[640].replace("%s",n),onClick:this.createCell.bind(this)})),l}}],n&&Su(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const Ou=ku,Pu={list:{},listItem:{style:{fontSize:13},innerDivStyle:{padding:"10px 56px 10px 62px"}},avatar:{avatarSize:26,style:{top:5}},iconMenu:{style:{top:4,right:8}},iconButton:{style:{width:26,height:26,padding:5,right:8},iconStyle:{color:"rgba(0,0,0,.33)",fontSize:20}},divider:{style:{marginLeft:62}},className:"compact"},Eu=require("pydio/lang/observable");var Cu=a.n(Eu);function Tu(e){return Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tu(e)}function xu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ju(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xu(Object(n),!0).forEach((function(t){Ru(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ru(e,t,n){return(t=Mu(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Mu(r.key),r)}}function Mu(e){var t=function(e,t){if("object"!==Tu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Tu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Tu(t)?t:String(t)}var Du=jr().getRestClient().getIdmApi(),Lu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"childrenAsPromise",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.childrenLoader,r=e.itemsLoader,o=e.leafLoaded,i=e.collectionsLoaded,a=e.leafs,s=e.collections,c=t?r:n,l=t?o:i;return new Promise((function(n,r){!l&&c?c(e,(function(r){t?(e.leafs=r,e.leafLoaded=!0):(e.collections=r,e.collectionsLoaded=!0),n(r)})):n((t?a:s)||[])}))}},{key:"computePagination",value:function(e){var t;return e.Users?t=e.Users.length:e.Groups?t=e.Groups.length:e.Teams&&(t=e.Teams.length),e.Total>t?{start:e.Offset,end:e.Offset+e.Limit,max:e.Total,interval:e.Limit}:null}},{key:"prepareIdmUser",value:function(e){var t;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var n=[];n.push(q().getMessages()[e.Attributes&&"shared"===e.Attributes.profile?"589":"590"]),"/"!==e.GroupPath&&n.push(e.GroupPath),t=n.join(" - ")}return{id:e.Login,label:e.Attributes&&e.Attributes.displayName?e.Attributes.displayName:e.Login,avatar:e.Attributes&&e.Attributes.avatar?e.Attributes.avatar:void 0,type:"user",IdmUser:e,secondaryText:t}}},{key:"prepareIdmGroup",value:function(e){var t;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t=e.GroupPath+e.GroupLabel),{id:e.Uuid,label:e.Attributes&&e.Attributes.displayName?e.Attributes.displayName:e.GroupLabel,type:"group",icon:"mdi mdi-account-multiple",secondaryText:t,IdmUser:e}}},{key:"prepareTeam",value:function(t){var n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(n=q().getMessages()[603]),{id:t.Uuid,label:t.Label,type:"team",icon:"mdi mdi-account-multiple-outline",itemsLoader:e.loadTeamUsers,_notSelectable:!0,secondaryText:n,IdmRole:t}}},{key:"loadTeams",value:function(t,n){var r=0,o=50;if(t.range){var i=Iu(t.range.split("-"),2),a=i[0],s=i[1];r=parseInt(a),o=(s=parseInt(s))-r}var c={};q().getInstance().getController().actions.has("user_team_create")&&(c={type:"team",remove:"574",multiple:!0}),Du.listTeams("",r,o).then((function(r){t.pagination=e.computePagination(r);var o=r.Teams.map((function(n){return ju(ju({_parent:t},e.prepareTeam(n)),{},{actions:c})}));n(o)}))}},{key:"loadGroups",value:function(t,n){var r="/",o="";t.IdmUser&&(r=K().trimRight(t.IdmUser.GroupPath,"/")+"/"+t.IdmUser.GroupLabel),t.currentParams&&t.currentParams.has_search&&(o=t.currentParams.value),Du.listGroups(r,o,!1,0,1e3).then((function(r){var o=r.Groups.map((function(n){return ju(ju({_parent:t},e.prepareIdmGroup(n)),{},{childrenLoader:t.childrenLoader?e.loadGroups:null,itemsLoader:t.itemsLoader?e.loadGroupUsers:null,currentParams:t.currentParams&&t.currentParams.alpha_pages?ju({},t.currentParams):{}})}));n(o)}))}},{key:"loadExternalUsers",value:function(t,n){var r="",o=0,i=50;if(t.currentParams&&t.currentParams.alpha_pages&&(r=t.currentParams.value),t.range){var a=Iu(t.range.split("-"),2),s=a[0],c=a[1];o=parseInt(s),i=(c=parseInt(c))-o}var l=jr().getClient().getPydioObject();Du.listUsers("/",r,!0,o,i,"shared").then((function(r){t.pagination=e.computePagination(r);var o=r.Users.filter((function(e){return e.Login!==l.user.id})).map((function(n){return ju(ju({_parent:t},e.prepareIdmUser(n)),{},{external:!0})}));n(o)}))}},{key:"loadGroupUsers",value:function(t,n){var r="/",o="",i=0,a=50;if(t.IdmUser&&(r=K().trimRight(t.IdmUser.GroupPath,"/")+"/"+t.IdmUser.GroupLabel),t.currentParams&&(t.currentParams.alpha_pages||t.currentParams.has_search)&&(o=t.currentParams.value),t.range){var s=Iu(t.range.split("-"),2),c=s[0],l=s[1];i=parseInt(c),a=(l=parseInt(l))-i}var u=jr().getClient().getPydioObject();Du.listUsers(r,o,!1,i,a,"!shared").then((function(r){t.pagination=e.computePagination(r);var o=r.Users.filter((function(e){return e.Login!==u.user.id&&"pydio.anon.user"!==e.Login})).map((function(n){return ju({_parent:t},e.prepareIdmUser(n))}));n(o)}))}},{key:"loadTeamUsers",value:function(t,n){var r=0,o=50,i="";if(t.range){var a=Iu(t.range.split("-"),2),s=a[0],c=a[1];r=parseInt(s),o=(c=parseInt(c))-r}t.currentParams&&(t.currentParams.alpha_pages||t.currentParams.has_search)&&(i=t.currentParams.value),Du.listUsersWithRole(t.IdmRole.Uuid,r,o,i).then((function(r){t.pagination=e.computePagination(r);var o=r.Users.map((function(n){return ju({_parent:t},e.prepareIdmUser(n))}));n(o)}))}},{key:"globalSearch",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];t="*"+t;var c=jr().getClient().getPydioObject(),l=[];if(i||a){var u=i?a?"":"shared":"!shared",d=Du.listUsers("/",t,!0,r,o,u).then((function(t){return t.Users.filter((function(e){return e.Login!==c.user.id&&"pydio.anon.user"!==e.Login})).map((function(t){return ju(ju({},e.prepareIdmUser(t,!0)),{},{external:t.Attributes&&"shared"===t.Attributes.profile})}))})).then((function(e){return{users:e}}));l.push(d);var p=Du.listGroups("/",t,!0,r,o).then((function(t){return t.Groups.map((function(t){return ju(ju({},e.prepareIdmGroup(t,!0)),{},{childrenLoader:e.loadGroups,itemsLoader:e.loadGroupUsers})}))})).then((function(e){return{groups:e}}));l.push(p)}if(s){var f=Du.listTeams(t,r,o).then((function(t){return t.Teams.map((function(t){return ju({},e.prepareTeam(t,!0))}))})).then((function(e){return{teams:e}}));l.push(f)}return Promise.all(l).then((function(e){var t=e.reduce((function(e,t){return ju(ju({},e),t)}),{});return n(t),t}))}}],null&&Au(t.prototype,null),n&&Au(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Nu=a(82702);function Uu(e){return Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uu(e)}function Bu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bu(Object(n),!0).forEach((function(t){Ju(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zu(e){return function(e){if(Array.isArray(e))return Wu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Wu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wu(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gu(r.key),r)}}function Hu(e,t){return Hu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Hu(e,t)}function Zu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vu(e){return Vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vu(e)}function Ju(e,t,n){return(t=Gu(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gu(e){var t=function(e,t){if("object"!==Uu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Uu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Uu(t)?t:String(t)}var Ku=(0,Fn.debounce)(Lu.globalSearch,350),$u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hu(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vu(r);if(o){var n=Vu(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Uu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zu(e)}(this,e)});function a(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"local",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ju(Zu(n=i.call(this)),"pydio",null),Ju(Zu(n),"mode","book"),Ju(Zu(n),"teamsOnly",!1),Ju(Zu(n),"usersOnly",!1),Ju(Zu(n),"usersFrom","local"),Ju(Zu(n),"loading",!1),Ju(Zu(n),"root",null),Ju(Zu(n),"selectedItem",null),Ju(Zu(n),"rightPanelItem",null),Ju(Zu(n),"onItemSelected",null),Ju(Zu(n),"pendingCreateItem",null),Ju(Zu(n),"searchTerm",""),Ju(Zu(n),"searchMode",!1),Ju(Zu(n),"searchItem",null),Ju(Zu(n),"selectionMode",!1),Ju(Zu(n),"multipleSelection",[]),Ju(Zu(n),"reloadCurrentAtPage",(function(e){var t=n.selectedItem;t.leafLoaded=!1,t.collectionsLoaded=!1,-1===e?t.currentParams=null:-1!==e.indexOf("-")?t.range=e:(t.range=null,t.currentParams={alpha_pages:"true",value:e}),n.setContext(t)})),Ju(Zu(n),"reloadCurrentWithSearch",(function(e){if(e){var t=n.selectedItem;t.leafLoaded=!1,t.collectionsLoaded=!1,t.currentParams={has_search:!0,value:e,existing_only:!0},n.setContext(t)}else n.reloadCurrentAtPage(-1)})),Ju(Zu(n),"deleteItems",(function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||confirm(n.m(278)))switch(e.actions.type){case"users":Promise.all(t.map((function(e){return n.rightPanelItem===e&&(n.rightPanelItem=null),jr().getRestClient().getIdmApi().deleteIdmUser(e.IdmUser)}))).then((function(){n.reloadContext()}));break;case"teams":Promise.all(t.map((function(e){return n.rightPanelItem===e&&(n.rightPanelItem=null),jr().getRestClient().getIdmApi().deleteRole(e.IdmRole.Uuid)}))).then((function(){n.reloadContext()}));break;case"team":Promise.all(t.map((function(t){return jr().getRestClient().getIdmApi().removeUserFromTeam(e.IdmRole.Uuid,t.IdmUser.Login)}))).then((function(){n.reloadContext()}))}})),n.pydio=e,n.mode=t,n.teamsOnly=s,n.usersOnly=r,n.usersFrom=o,n.onItemSelected=c;var l=n.pydio.getPluginConfigs("core.auth");return n._teamsEditable=n.pydio.getController().actions.has("user_team_create"),n._externalsAllowed=l.get("USER_CREATE_USERS"),n}return t=a,n=[{key:"getRoot",value:function(){return this.searchMode&&this.searchItem?this.searchItem:this.root}},{key:"contextItem",value:function(){return this.selectedItem}},{key:"setContext",value:function(e,t){var n=this;return"selector"===this.mode&&e.IdmRole&&e.IdmRole.IsTeam?(this.leafItemClicked(e),Promise.resolve()):(this.loading=!0,this.notify("update"),Lu.childrenAsPromise(e,!1).then((function(){Lu.childrenAsPromise(e,!0).then((function(){n.selectedItem=e,n.loading=!1,n.notify("update")})).then((function(){t&&t()}))})))}},{key:"contextIsGroup",value:function(){return this.selectedItem&&(this.selectedItem.IdmUser&&this.selectedItem.IdmUser.IsGroup||"PYDIO_GRP_/"===this.selectedItem.id)}},{key:"contextIsTeam",value:function(){return this.selectedItem&&this.selectedItem.IdmRole&&this.selectedItem.IdmRole.IsTeam}},{key:"reloadContext",value:function(){var e=this;return this.selectedItem?(this.selectedItem.leafLoaded=!1,this.selectedItem.collectionsLoaded=!1,this.setContext(this.selectedItem,(function(){if(e.rightPanelItem){var t=e.rightPanelItem.id,n=null,r=e.selectedItem.leafs||[],o=e.selectedItem.collections||[];[].concat(zu(r),zu(o)).forEach((function(e){e.id===t&&(n=e)})),e.rightPanelItem=n,e.notify("update")}}))):Promise.resolve}},{key:"setGlobalSearch",value:function(e,t){var n=this;e!==this.searchMode&&(e?(this.searchItem||(this.searchItem={id:"search",label:this.m("583"),type:"root"}),this.savedContext=this.contextItem(),this.searchItem.collections=[],this.setContext(this.searchItem)):(this.searchItem.collections=[],this.setContext(this.savedContext))),this.searchMode=e,this.searchTerm=t,this.searchTerm&&Ku(t,(function(e){n.searchItem.collections=[];var t,r,o=n.prepareTopFolders(n.searchItem);e.users&&(t=e.users.filter((function(e){return e.external})),r=e.users.filter((function(e){return!e.external}))),void 0!==t&&n.searchItem.collections.push(Fu(Fu({},o.shared),{},{leafs:t})),e.teams&&n.searchItem.collections.push(Fu(Fu({},o.teams),{},{collections:e.teams})),(void 0!==r||e.groups)&&(r&&r.length,e.groups&&e.groups.length,n.searchItem.collections.push(Fu(Fu({},o.directory),{},{collections:e.groups,leafs:r})));var i=Fu({},o.results);n.searchItem.collections.forEach((function(e){var t,n;(t=i.collections).push.apply(t,zu(e.collections.map((function(t){return t._parent=e,Fu(Fu({},t),{},{_parent:i})})))),(n=i.leafs).push.apply(n,zu(e.leafs.map((function(t){return t._parent=e,Fu(Fu({},t),{},{_parent:i})})))),e.notExpandable=!0,e.label+=" (".concat(e.collections.length+e.leafs.length,")")})),i.label+=" (".concat(i.collections.length+i.leafs.length,")"),n.searchItem.collections.unshift(i),n.setContext(i),n.notify("update")}),0,50,this._externalsAllowed),this.notify("update")}},{key:"getSearchStatus",value:function(){return{searchMode:this.searchMode,searchTerm:this.searchTerm}}},{key:"rightItem",value:function(){return this.rightPanelItem}},{key:"leafItemClicked",value:function(e){if(this.onItemSelected){var t=new Nu.User(e.id,e.label,e.type,e.group,e.avatar,e.temporary,e.external);return e.trusted_server_id&&(t.trustedServerId=e.trusted_server_id,t.trustedServerLabel=e.trusted_server_label),t._uuid=e.uuid,e.IdmUser&&(t.IdmUser=e.IdmUser),e.IdmRole&&(t.IdmRole=e.IdmRole),void this.onItemSelected(t)}this.rightPanelItem=e,this.notify("update")}},{key:"clearRightItem",value:function(){this.rightPanelItem=null,this.notify("update")}},{key:"teamsEditable",value:function(){return this._teamsEditable}},{key:"deleteMultipleSelection",value:function(){this.selectionMode=!1,this.deleteItems(this.selectedItem,this.multipleSelection)}},{key:"setCreateItem",value:function(){this.pendingCreateItem=this.selectedItem,this.notify("update")}},{key:"clearCreateItem",value:function(){this.pendingCreateItem=null,this.notify("update")}},{key:"createItem",value:function(){return this.pendingCreateItem}},{key:"setSelectionMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.selectionMode=void 0===e?!this.selectionMode:e,this.multipleSelection=[],this.notify("update")}},{key:"getSelectionMode",value:function(){return this.selectionMode}},{key:"setMultipleSelection",value:function(e){this.multipleSelection=e,this.notify("update")}},{key:"getMultipleSelection",value:function(){return this.multipleSelection}},{key:"initTree",value:function(){var e={};if(this._teamsEditable&&(e={type:"teams",create:"+ "+this.m(569),remove:this.m(570),multiple:!0}),this.teamsOnly)return this.root=Fu(Fu({},this.prepareTopFolders(null).teams),{},{childrenLoader:Lu.loadTeams,actions:e}),void(this.selectedItem=this.root);this.root={id:"root",label:this.m(592),type:"root",collections:[]};var t=this.prepareTopFolders(this.root);"remote"!==this.usersFrom&&(this._externalsAllowed&&this.root.collections.push(Fu(Fu({},t.shared),{},{itemsLoader:Lu.loadExternalUsers,actions:{type:"users",create:"+ "+this.m(484),remove:this.m(582),multiple:!0}})),this.usersOnly||this.root.collections.push(Fu(Fu({},t.teams),{},{childrenLoader:Lu.loadTeams,actions:e})),this.root.collections.push(Fu(Fu({},t.directory),{},{childrenLoader:Lu.loadGroups,itemsLoader:Lu.loadGroupUsers}))),this.selectedItem="selector"===this.mode?this.root:this.root.collections[0]}},{key:"prepareTopFolders",value:function(e){return{shared:{id:"ext",label:this.m(593),icon:"mdi mdi-account-network",_parent:e,_notSelectable:!0,collections:[],leafs:[]},teams:{id:"teams",label:this.m(568),icon:"mdi mdi-account-multiple",_parent:e,_notSelectable:!0,collections:[],leafs:[]},directory:{id:"PYDIO_GRP_/",label:this.m(584),icon:"mdi mdi-account-box",_parent:e,_notSelectable:!0,collections:[],leafs:[]},results:{id:"results",label:this.m("599-a"),icon:"mdi mdi-magnify",_parent:e,notExpandable:!0,collections:[],leafs:[]}}}},{key:"m",value:function(e){return this.pydio.MessageHash[e]||e}}],n&&qu(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Cu());const Yu=$u;function Xu(e){return Xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(e)}function Qu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ed(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qu(Object(n),!0).forEach((function(t){td(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function td(e,t,n){return(t=ad(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nd(e){return function(e){if(Array.isArray(e))return rd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return rd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rd(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function od(){return od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},od.apply(this,arguments)}function id(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ad(r.key),r)}}function ad(e){var t=function(e,t){if("object"!==Xu(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Xu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Xu(t)?t:String(t)}function sd(e,t){return sd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sd(e,t)}function cd(e){return cd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cd(e)}var ld=a(10757).requireLib("boot"),ud=ld.Loader,dd=ld.PydioContextConsumer,pd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sd(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cd(o);if(i){var n=cd(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Xu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,e,t)}return n=s,r=[{key:"render",value:function(){var e=this.props,n=e.pydio,r=e.item,o=e.mode,i=e.loading,a=e.showAllParents,s=e.enableSearch,c=e.searchLabel,l=e.onSearch,u=e.getMessage,d=e.bookColumn,p=e.toolbar,f=e.style,h=this.props.model;h||(h=new Yu(n,"inner"));var m=h.getMultipleSelection(),y=h.getSelectionMode(),b=this.props.listStyles,v=void 0===b?{}:b;"selector"!==o&&"inner"!==o||(v=Pu);var S,w,k,O=v.className,P=v.avatar?v.avatar.avatarSize:36,E=r.collections||[],C=r.leafs||[],T=[],x=[],j={};"teams"===r.id?(j={paginatorFolder:r.pagination?"numeric":null,paginatorLabel:r.label,paginatorCallback:function(e){return h.reloadCurrentAtPage(e)}},h.teamsEditable()?(S=u(571,""),w=u(572,"")):(S=u("571.readonly",""),w=u("572.readonly",""))):"ext"===r.id?(S=u(585,""),w=u(586,""),r.pagination&&(k=!0,j={paginatorType:"alpha",paginatorCallback:function(e){return h.reloadCurrentAtPage(e)}})):(h.contextIsGroup()||h.contextIsTeam())&&(k=!0,j={paginatorType:!(r.currentParams&&r.currentParams.has_search)&&"alpha",paginatorCallback:function(e){return h.reloadCurrentAtPage(e)}}),j.paginatorFolder?T.push({subheader:t().createElement(nu,od({},this.props,j,{style:{lineHeight:"20px",padding:"14px 0"}}))}):E.length&&(C.length||k)&&T.push({subheader:u("532")}),j.paginatorType?x.push({subheader:t().createElement(nu,od({},this.props,j,{style:{lineHeight:"20px",padding:"14px 0"}}))}):k&&x.push({subheader:u("249")});var R,I=[].concat(T,nd(E),x,nd(C)),_=I.length,A=[];if("book"===o&&r._parent&&(r._parent._parent&&"teams"!==r._parent.id||a)&&(A.push(t().createElement(g.ListItem,od({key:"__parent__",primaryText:"..",onClick:function(e){e.stopPropagation(),h.setContext(r._parent)},leftAvatar:t().createElement(g.Avatar,{icon:t().createElement(g.FontIcon,{className:"mdi mdi-arrow-up"}),size:P})},v.listItem))),_&&A.push(t().createElement(g.Divider,{inset:!0,key:"parent-divider"}))),I.forEach(function(e,r){var i=this;if(e.subheader)A.push(t().createElement(g.Subheader,{key:e.subheader},e.subheader));else{var a,s=t().createElement(Qd,{avatarSize:P,pydio:this.props.pydio||n,userId:e.id,userLabel:e.label,avatar:e.avatar,icon:e.icon,idmUser:e.IdmUser,userType:e.type||"group",avatarOnly:!0,useDefaultAvatar:!0,style:v.avatar?v.avatar.style:{}}),c=function(t){t.stopPropagation(),i.props.onItemClicked(e)};if(E.indexOf(e)>-1?(c=function(t){t.stopPropagation(),h.setContext(e)},"selector"!==o||e._notSelectable||this.props.usersOnly||(a=t().createElement(g.IconButton,od({iconClassName:"mdi mdi-account-multiple-plus",tooltip:u("addressbook.pick.group"),tooltipPosition:"top-left",iconStyle:{color:"rgba(0,0,0,0.33)"},onClick:function(){i.props.onItemClicked(e)}},v.iconButton)))):"inner"===o&&this.props.onDeleteAction&&(a=t().createElement(g.IconButton,od({iconClassName:"mdi mdi-delete",tooltip:u(257),tooltipPosition:"top-left",iconStyle:{color:"rgba(0,0,0,0.13)",hoverColor:"rgba(0,0,0,0.53)"},onClick:function(){i.props.onDeleteAction(i.props.item,[e])}},v.iconButton))),d&&this.props.actionsForCell&&e.type){var l=new Ou(n,this.props.actionsForCell,null,e).renderItems();a=l.length?t().createElement(g.IconMenu,od({},v.iconMenu,{iconButtonElement:t().createElement(g.IconButton,od({iconClassName:"mdi mdi-dots-vertical",iconStyle:{color:"rgba(0,0,0,.33)"}},v.iconButton)),targetOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"top"},desktop:!0}),l):null}var p,f={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};e.secondaryText&&(f.fontWeight=500,p=t().createElement("span",{style:{fontSize:13,color:"var(--md-sys-color-on-surface-variant)"}},e.secondaryText)),A.push(t().createElement(g.ListItem,od({key:e.id,primaryText:t().createElement("div",{style:f},e.label),secondaryText:p,onClick:c,disabled:"inner"===o,leftAvatar:!y&&s,rightIconButton:a,leftCheckbox:y&&t().createElement(g.Checkbox,{checked:m.indexOf(e)>-1,onCheck:function(t,n){if(n)h.setMultipleSelection([].concat(nd(m),[e]));else{var r=[].concat(nd(m.slice(0,m.indexOf(e))),nd(m.slice(m.indexOf(e)+1)));h.setMultipleSelection(r)}}})},v.listItem))),"inner"!==o&&r<_-1&&A.push(t().createElement(g.Divider,od({inset:!0,key:e.id+"-divider"},v.divider)))}}.bind(this)),!A.length){var M={style:{backgroundColor:"transparent",minHeight:300},iconClassName:"mdi mdi-account-off",primaryTextId:S||u(629),secondaryTextId:"book"===o&&w||null};"book"===o&&r.actions&&r.actions.create&&(M=ed(ed({},M),{},{actionLabelId:u(r.actions.create),actionCallback:function(){return h.setCreateItem()}})),"compact"===O&&(M=ed(ed({},M),{},{style:{backgroundColor:"transparent",minHeight:150},iconStyle:{fontSize:40},legendStyle:{fontSize:13}})),R=t().createElement(fo,M)}return t().createElement("div",{style:ed({flex:1,flexDirection:"column",display:"flex",width:"100%",overflowX:"hidden"},f),onClick:this.props.onClick,className:O},p,!R&&!i&&t().createElement(g.List,{style:{flex:1,overflowY:"inner"!==o?"auto":"initial"}},this.props.subHeader&&t().createElement(g.Subheader,null,this.props.subHeader),A),i&&t().createElement(ud,{style:{flex:1}}),!i&&R,"selector"===o&&s&&d&&t().createElement(hu,{searchLabel:c,onSearch:l,style:{padding:"0 20px",minWidth:null},underlineShow:!1}))}}],r&&id(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function fd(e){return fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(e)}function hd(){return hd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hd.apply(this,arguments)}function md(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yd(r.key),r)}}function yd(e){var t=function(e,t){if("object"!==fd(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==fd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===fd(t)?t:String(t)}function bd(e,t){return bd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bd(e,t)}function vd(e){return vd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vd(e)}pd.propTypes={item:z().object,onDeleteAction:z().func,onItemClicked:z().func,onFolderClicked:z().func,onEditLabel:z().func,mode:z().oneOf(["book","selector","inner"]),bookColumn:z().bool},pd=dd(pd),pd=(0,$.muiThemeable)()(pd);var gd=a(16689).Component,Sd=a(39455),wd=Sd.Divider,kd=Sd.Subheader,Od=Sd.List,Pd=Sd.ListItem,Ed=Sd.FontIcon,Cd=Sd.Avatar,Td=a(56880),xd=a(10757).requireLib("boot").PydioContextConsumer,jd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bd(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vd(r);if(o){var n=vd(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===fd(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.graph,r=t.pydio,o=t.getMessage,i=t.muiTheme,a=t.reloadAction,s=r.getController().actions.has("user_team_create"),c=[];if(n.teams&&n.teams.length){var l=null;s&&(l=function(t,n){Td.getRestClient().getIdmApi().removeUserFromTeam(n[0].id,e.props.userId,(function(e){e&&e.message&&r.UI.displayMessage("SUCCESS",e.message),a()}))}),c.push(React.createElement("div",{key:"teams"},React.createElement(pd,{subHeader:o(581).replace("%s",n.teams.length),onItemClicked:function(){},item:{leafs:n.teams},mode:"inner",onDeleteAction:l})))}if(n.cells){var u=Object.values(n.cells).filter((function(e){return"ROOM"===e.Scope})),d="mui3"===i.userTheme?i.palette.mui3.tertiary:"#009688",p="mui3"===i.userTheme?i.palette.mui3["on-tertiary"]:"#fff";u.length&&c.push(React.createElement("div",null,c.length?React.createElement(wd,null):null,React.createElement(kd,null,1===u.length?o("601"):o("602").replace("%1",u.length)),React.createElement(Od,{style:{paddingTop:0}},u.map((function(e){return React.createElement(Pd,hd({disabled:!0,leftAvatar:React.createElement(Cd,{icon:React.createElement(Ed,{className:"mdi mdi-share-variant",style:{color:p}}),backgroundColor:d,size:Pu.avatar.avatarSize,style:Pu.avatar.style}),primaryText:e.Label,rightIconButton:React.createElement(g.IconButton,hd({iconClassName:"mdi mdi-open-in-new",tooltip:"Go to Cell",tooltipPosition:"top-left",onClick:function(){r.triggerRepositoryChange(e.UUID)}},Pu.iconButton))},Pu.listItem))})))))}return React.createElement("div",null,c)}}])&&md(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(gd);function Rd(e){return Rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(e)}jd=xd((0,$.muiThemeable)()(jd));var Id=["style"],_d=["style"];function Ad(){return Ad=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ad.apply(this,arguments)}function Md(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Dd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ld(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dd(Object(n),!0).forEach((function(t){Nd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nd(e,t,n){return(t=Bd(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ud(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bd(r.key),r)}}function Bd(e){var t=function(e,t){if("object"!==Rd(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Rd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rd(t)?t:String(t)}function Fd(e,t){return Fd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fd(e,t)}function zd(e){return zd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zd(e)}var Wd=a(4305),qd=a(39105),Hd=a(39455),Zd=Hd.FontIcon,Vd=Hd.Paper,Jd=Hd.Avatar,Gd=Hd.CardTitle,Kd=a(13173).muiThemeable,$d=a(85829),Yd=a(82702).UsersApi,Xd=q().requireLib("hoc").ThemedContainers.Popover,Qd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fd(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=zd(o);if(i){var n=zd(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Rd(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).state={user:null,avatar:null,graph:null,local:!1},n}return n=s,r=[{key:"componentDidMount",value:function(){this.loadPublicData(this.props.userId,this.props.idmUser)}},{key:"componentWillReceiveProps",value:function(e){this.props.userId&&this.props.userId===e.userId&&e.graphRand===this.props.graphRand||(this.setState({label:e.userId}),this.loadPublicData(e.userId,e.idmUser))}},{key:"componentWillUnmount",value:function(){this._userLoggedObs&&this.props.pydio.stopObserving("user_logged",this._userLoggedObs)}},{key:"loadPublicData",value:function(e,t){var n=this,r=this.props,o=r.userType,i=r.richCard,a=r.pydio;"group"!==o&&"team"!==o&&Yd.getUserPromise(e,t).then((function(t){t.isLocal()&&!n._userLoggedObs&&(n._userLoggedObs=function(t){null!==t&&n.loadPublicData(e)},a.observe("user_logged",n._userLoggedObs)),n.setState({user:t,avatar:t.getAvatar(),local:t.isLocal()}),i&&!t.isNotFound()&&jr().getRestClient().getIdmApi().loadUserGraph(e).then((function(e){var t={cells:{},teams:[]};e.SharedCells&&e.SharedCells.forEach((function(n){t.cells=e.SharedCells})),e.BelongsToTeams&&e.BelongsToTeams.forEach((function(e){t.teams.push({id:e.Uuid,label:e.Label,type:"team",IdmRole:e})})),n.setState({graph:t})}))})).catch((function(e){n.setState({loadError:!0})}))}},{key:"render",value:function(){var e=this,n=this.state,r=n.user,o=n.avatar,i=n.graph,a=n.local,c=n.loadError,l=this.props,u=l.pydio,d=l.userId,p=l.userType,f=l.icon,h=l.style,m=l.labelStyle,y=l.avatarLetters,b=l.avatarStyle,v=l.avatarSize,g=l.cardStyle,S=l.cardTitleStyle,w=l.cardSubtitleStyle,k=l.className,O=l.labelMaxChars,P=l.labelClassName,E=l.avatarClassName,C=l.displayLabel,T=l.displayLocalLabel,x=l.displayLabelChevron,j=l.labelChevronStyle,R=l.displayAvatar,I=l.useDefaultAvatar,_=l.richCard,A=l.muiTheme,M=l.noActionsPanel;if(!d)return t().createElement("div",null,"ERROR : empty userId ! ");var D,L,N,U,B,F,z,W,q,H,Z,V,J=this.state.label,G=c,K=!1;if(r?(J=r.getLabel(),G=r.isNotFound(),r.isPublic()&&(J=u.MessageHash.public_link_user,K=!0)):J||(J=this.props.userLabel||this.props.userId),a&&T&&(J=u.MessageHash[634]),O&&J&&J.length>O&&(J.split(" ").length>1?(D=J,J=J.split(" ").map((function(e){return e[0]})).join("")):J.split("@").length>1&&(D=J,J=J.split("@")[0].split(".").length>1?J.split("@")[0].split(".").map((function(e){return e[0]})).join(""):J.split("@")[0])),_&&(R=!0,I=!0,C=!0),R&&!o&&J&&(!C||I)){var $,Y=A.palette.avatarsColor;switch("group"!==p&&"team"!==p&&0!==d.indexOf("PYDIO_GRP_/")&&0!==d.indexOf("/USER_TEAM/")||(Y=qd(Y).darken(.2).toString()),p){case"group":$="mdi mdi-account-multiple",L="289",F="folder-avatar";break;case"team":$="mdi mdi-account-multiple-outline",L="603",F="folder-avatar";break;case"remote":$="mdi mdi-account-network",L="604",F="folder-avatar";break;default:$="mdi mdi-account",r?r.getExternal()?(L="589",r.isPublic()&&(L="589",J=u.MessageHash.public_link_user,$="mdi mdi-link")):L="590":L="288"}f&&($=f),L&&(L=u.MessageHash[L]),_?(B=t().createElement(Zd,{className:$,style:{color:Y}}),U="#f5f5f5"):(U=Y,$&&!y?B=t().createElement(Zd,{className:$}):(N=J.split(" ").map((function(e){return e[0]})).join("").substring(0,2)).length<2&&(N=J.substring(0,2)))}if(_){R=!0,h=Ld(Ld({},h),{},{flexDirection:"column"}),void 0===v&&(v=50),b=Ld({position:"absolute",right:16,top:12},b);var X=function(){$d.getInstance().deleteKey("user_public_data-graph",e.props.userId),e.loadPublicData(e.props.userId,e.props.idmUser)};z=function(){X(),e.props.reloadAction&&e.props.reloadAction()},W=function(){X(),e.props.onEditAction&&e.props.onEditAction()}}else if(a||G||K||!this.props.richOnHover){if(!a&&!G&&!K&&this.props.richOnClick){H=Wd(H=function(){e.lockedBySubPopover||e.setState({showPopover:!1})},350),Z=function(t){e.setState({showPopover:!0,popoverAnchor:t.currentTarget}),H.cancel()};var Q=function(t){e.setState({showPopover:!0}),H.cancel()},ee=this.props,te=(ee.style,Md(ee,_d));V=t().createElement(Xd,{open:this.state.showPopover,anchorEl:this.state.popoverAnchor,onRequestClose:function(t){"clickAway"===t&&e.lockedBySubPopover||e.setState({showPopover:!1})},anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},useLayerForClickAway:!1},t().createElement(Vd,{zDepth:2,style:{width:220,height:320,overflowY:"auto"},onMouseOver:Q,onMouseOut:H},t().createElement(s,Ad({},te,{richCard:!0,richOnHover:!1,cardSize:220,lockOnSubPopoverOpen:function(t){e.lockedBySubPopover=t,Q()}}))))}}else{H=Wd(H=function(){e.lockedBySubPopover||e.setState({showPopover:!1})},350),q=function(t){e.setState({showPopover:!0,popoverAnchor:t.currentTarget}),H.cancel()};var ne=function(t){e.setState({showPopover:!0}),H.cancel()},re=this.props,oe=(re.style,Md(re,Id));V=t().createElement(Xd,{open:this.state.showPopover,anchorEl:this.state.popoverAnchor,onRequestClose:function(t){"clickAway"===t&&e.lockedBySubPopover||e.setState({showPopover:!1})},anchorOrigin:{horizontal:"left",vertical:"center"},targetOrigin:{horizontal:"right",vertical:"center"},useLayerForClickAway:!1},t().createElement(Vd,{zDepth:2,style:{width:220,height:320,overflowY:"auto"},onMouseOver:ne,onMouseOut:H},t().createElement(s,Ad({},oe,{richCard:!0,richOnHover:!1,cardSize:220,lockOnSubPopoverOpen:function(t){e.lockedBySubPopover=t,ne()}}))))}if(o){var ie=o;ie.indexOf("?")>=0?ie+="&dim="+v:ie+="?dim="+v,B=t().createElement(Zd,{style:{backgroundImage:"url("+ie+")",backgroundSize:"cover",margin:0,width:"100%",height:"100%",borderRadius:"50%",backgroundPosition:"center"}})}var ae,se=t().createElement(Jd,{icon:B,size:v,style:this.props.avatarOnly?this.props.style:b,backgroundColor:U,className:F||E},N);return this.props.avatarOnly?se:(_?se=t().createElement("div",{style:{textAlign:"center"}},se):G&&(J=u.MessageHash["user.unknown"]),C&&x&&(ae=t().createElement("span",{className:"mdi mdi-chevron-down",style:Ld(Ld({},j),{},{marginLeft:4,fontSize:"0.8em"})})),t().createElement("div",{className:k,style:h,onMouseOver:q,onMouseOut:H,onClick:Z},R&&(o||N||B)&&se,C&&!_&&t().createElement("div",{title:D,className:P,style:m},J),ae,C&&_&&t().createElement(Gd,{style:Ld({textAlign:"center"},g),title:J,subtitle:L,titleStyle:Ld({},S),subtitleStyle:Ld({},w)}),_&&r&&this.props.actionsPanel,_&&i&&!M&&t().createElement(jd,Ad({graph:i},this.props,{userLabel:J,reloadAction:z,onEditAction:W})),this.props.children,V))}}],r&&Ud(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);Qd.propTypes={userId:z().string.isRequired,pydio:z().instanceOf(q()),userLabel:z().string,userType:z().oneOf(["user","group","remote","team"]),icon:z().string,richCard:z().bool,richOnHover:z().bool,richOnClick:z().bool,userEditable:z().bool,onEditAction:z().func,onDeleteAction:z().func,reloadAction:z().func,displayLabel:z().bool,displayLocalLabel:z().bool,displayAvatar:z().bool,avatarOnly:z().bool,useDefaultAvatar:z().bool,avatarSize:z().number,avatarLetters:z().bool,noActionsPanel:z().bool,className:z().string,labelClassName:z().string,avatarClassName:z().string,style:z().object,labelStyle:z().object,avatarStyle:z().object},Qd.defaultProps={displayLabel:!0,displayAvatar:!0,avatarSize:40,userType:"user",className:"user-avatar-widget",labelClassName:"user-label"},Qd=Kd()(Qd);var ep=a(7180),tp=a.n(ep);const np=require("pydio/util/pass");var rp=a.n(np);const op=require("pydio/http/policies");var ip=a.n(op);const ap=require("cells-sdk");function sp(e){return sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sp(e)}function cp(e){return function(e){if(Array.isArray(e))return lp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return lp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lp(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function up(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?up(Object(n),!0).forEach((function(t){pp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):up(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pp(e,t,n){return(t=hp(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hp(r.key),r)}}function hp(e){var t=function(e,t){if("object"!==sp(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==sp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===sp(t)?t:String(t)}function mp(e,t){return mp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mp(e,t)}function yp(e){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yp(e)}var bp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mp(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yp(o);if(i){var n=yp(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===sp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var n=dp({},e);return e.subjectsDisabled||(n.subjectsDisabled={READ:{},WRITE:{}}),e.cellAcls&&Object.keys(e.cellAcls).map((function(t){e.cellAcls[t].RoleId&&(n.subjectsDisabled.READ["role:"+e.cellAcls[t].RoleId]=!0)})),(t=a.call(this,n)).state={edit:!1,loading:!0,policies:[],diffPolicies:{add:{},remove:{}},hideGroups:!0===q().getInstance().getPluginConfigs("action.advanced_settings").get("DISABLE_SHARE_GROUPS")},t}return n=s,r=[{key:"componentDidMount",value:function(){this.setState({loading:!0}),this.reload()}},{key:"reload",value:function(){var e=this,t=this.props,n=t.resourceType,r=t.resourceId,o=pydio.user,i=[ip().loadPolicies(n,r),o.getIdmUser()];"team"!==n&&i.push(jr().getRestClient().getIdmApi().listTeams()),Promise.all(i).then((function(t){var r=t[0],o=r[0].Resource,i=t[1],a=[];"team"!==n&&t[2]&&(a=t[2].Teams),e.setState({policies:r,idmUser:i,userTeams:a,loading:!1,resourceUuid:o})})).catch((function(t){e.setState({error:t.message,loading:!1})}))}},{key:"revert",value:function(){this.setState({dirtyPolicies:null,diffPolicies:{add:{},remove:{}}})}},{key:"save",value:function(){var e=this,t=this.state,n=t.dirtyPolicies,r=t.diffPolicies,o=this.props,i=o.resourceType,a=o.resourceId,s=o.onSavePolicies;ip().savePolicies(i,a,n).then((function(t){e.setState({policies:t,dirtyPolicies:null,diffPolicies:{add:{},remove:{}}}),s&&s(r)})).catch((function(t){e.setState({error:t.message})}))}},{key:"removePolicy",value:function(e,t){var n=this.state,r=n.policies,o=n.dirtyPolicies,i=n.diffPolicies;o&&(r=o);var a=[];r.map((function(n){n.Action===e&&n.Subject===t||a.push(n)})),i.remove[e+"///"+t]=!0,i.add[e+"///"+t]&&delete i.add[e+"///"+t],this.setState({dirtyPolicies:a,diffPolicies:i})}},{key:"addPolicy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.state,o=r.policies,i=r.dirtyPolicies,a=r.resourceUuid,s=r.diffPolicies,c=cp(i||o),l=new ap.ServiceResourcePolicy;l.Resource=a,l.Effect="allow",l.Subject=t,l.Action=e,c.push(l),s.add[e+"///"+t]=!0,s.remove[e+"///"+t]&&delete s.remove[e+"///"+t],n?this.setState({dirtyPolicies:c,diffPolicies:s,pickedUser:null,pickedLabel:null}):this.setState({dirtyPolicies:c,diffPolicies:s})}},{key:"hasOneWrite",value:function(e){var t=this.state.idmUser,n=t.Roles.map((function(e){return"role:"+e.Uuid}));n.push("user:"+t.Login);for(var r=0;r<n.length;r++)for(var o=0;o<e.length;o++)if(e[o].Subject===n[r]&&"WRITE"===e[o].Action)return!0;return!1}},{key:"findCrtUserSubject",value:function(e){var t=this.state.idmUser,n=["user:"+t.Login,"role:"+t.Uuid],r=e.filter((function(e){return n.indexOf(e.Subject)>-1}));return r.length?r[0].Subject:n[0]}},{key:"listUserRoles",value:function(e){var t=this.state,n=t.hideGroups,r=t.idmUser,o=this.findCrtUserSubject(e),i=this.hasOneWrite(e),a={};r.Roles.map((function(e){e.GroupRole&&!n&&(a["role:"+e.Uuid]=e.Label)})),(a=dp(dp({},this.listOtherUsersSubjects(e,o)),a))[o]="You";for(var s=Object.keys(a),c=[],l=s.length-1;l>=0;l--){var u=s[l],d=a[u];c.push(this.renderLine(u,d,e,!i||u===o))}return{groupBlocks:c,hasWrite:i}}},{key:"listUserTeams",value:function(e,t,n){var r=this;return e.map((function(e){return r.renderLine("role:"+e.Uuid,e.Label,t,n)}))}},{key:"listOtherUsersSubjects",value:function(e,t){var n=this.props,r=n.resourceId,o=n.cellAcls,i=this.state.hideGroups,a={};return e.map((function(e){if(0===e.Subject.indexOf("user:")&&e.Subject!==t&&e.Subject!=="user:"+r&&(a[e.Subject]=e.Subject.substr("user:".length)),o&&0===e.Subject.indexOf("role:")&&o[e.Subject.substr("role:".length)]){var n=e.Subject.substr("role:".length);if(o[n].User){var s=o[n].User;t!=="user:"+s.Login&&t!=="role:"+s.Uuid&&(a[e.Subject]=s.Attributes&&s.Attributes.displayName?s.Attributes.displayName:s.Login)}else if(o[n].Group&&!i){var c=o[n].Group;a[e.Subject]=c.Attributes&&c.Attributes.displayName?c.Attributes.displayName:c.GroupLabel}}})),a}},{key:"pickUser",value:function(e){var t,n;if(e.IdmUser){var r=e.IdmUser,o=r.Attributes||{};r.IsGroup?(t="role:"+r.Uuid,n=o.displayName||r.GroupLabel):(t="user:"+r.Login,n=o.displayName||r.Login)}else{var i=e.IdmRole;t="role:"+i.Uuid,n=i.Label}this.setState({pickedUser:t,pickedLabel:n})}},{key:"renderLine",value:function(e,n,r,o){var i=this,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this.props,c=s.subjectsDisabled,l=s.subjectsHidden,u=s.readonly;if(l&&l[e])return null;var d=!1,p=!1,f=function(){i.addPolicy("READ",e,a)},h=function(){i.addPolicy("WRITE",e,a)};r.map((function(t){t.Subject===e&&("WRITE"===t.Action?(p="WRITE"===t.Action,h=function(){i.removePolicy("WRITE",e)}):"READ"===t.Action&&(d="READ"===t.Action,f=function(){i.removePolicy("READ",e)}))}));var m=o,y=o;return u?(y=!0,m=!0):(c&&c.READ&&c.READ[e]&&(y=!0),c&&c.WRITE&&c.WRITE[e]&&(m=!0)),t().createElement("div",{style:{display:"flex",margin:10,marginRight:0}},t().createElement("div",{style:{flex:1}},n),t().createElement(g.Checkbox,{checked:d,disabled:y,style:{width:40},onCheck:f}),t().createElement(g.Checkbox,{checked:p,disabled:m,style:{width:40},onCheck:h}))}},{key:"render",value:function(){var e=this,n=this.props.muiTheme,r=n.appBar,o=n.palette.mui3,i=void 0===o?{}:o,a={title:{paddingLeft:10,backgroundColor:r.color,display:"flex",alignItems:"center",fontSize:16,color:r.textColor},subheader:{margin:10,fontWeight:500,color:i["on-surface-variant"],display:"flex"},subject:{margin:10},head:{display:"inline-block",width:40,textAlign:"center",fontSize:10}},s=this.state,c=s.edit,l=s.policies,u=s.dirtyPolicies,d=s.error,p=s.idmUser,f=s.userTeams,h=s.loading,m=s.pickedUser,y=s.pickedLabel,b=this.props,v=b.onDismiss,S=b.style,w=b.skipTitle,k=b.resourceId,O=b.pydio,P=b.userListExcludes,E=void 0===P?[]:P,C=b.readonly,T=b.description,x=[],j=O.MessageHash;if(!c)return t().createElement("div",{style:S},!w&&t().createElement("div",{style:dp(dp({},a.title),{},{height:48})},t().createElement("span",{style:{flex:1}},j["visibility.panel.title"]),v&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-close",onClick:v,iconStyle:{color:r.textColor}})),t().createElement("div",{style:{padding:20,fontWeight:500,textAlign:"justify"}},t().createElement("div",{style:{paddingBottom:20}},T),t().createElement("div",{style:{textAlign:"center"}},t().createElement(g.RaisedButton,{label:j["visibility.panel.edit"],primary:!0,onClick:function(){e.setState({edit:!0})}}))));if(!h&&!d){var R=this.listUserRoles(u||l),I=R.groupBlocks,_=R.hasWrite,A=this.listUserTeams(f,u||l,!_),M=t().createElement("div",null,t().createElement("span",{style:a.head},j["visibility.panel.right-read"]),t().createElement("span",{style:a.head},j["visibility.panel.right-edit"]));if(I.length&&(x.push(t().createElement("div",{style:a.subheader},t().createElement("span",{style:{flex:1}},j["visibility.panel.list.users"]),M)),x.push(I),x.push(t().createElement(g.Divider,null))),A.length&&(x.push(t().createElement("div",{style:a.subheader},t().createElement("span",{style:{flex:1}},j["visibility.panel.list.teams"]),M)),x.push(A),x.push(t().createElement(g.Divider,null))),m)x.push(t().createElement("div",{style:a.subheader},j["visibility.panel.setvisible"])),x.push(this.renderLine(m,y,l,!1,!0)),x.push(t().createElement("div",{style:{textAlign:"right"}},t().createElement(g.FlatButton,{label:j[54],onClick:function(){e.setState({pickedUser:null,pickedLabel:null})}}))),x.push(t().createElement(g.Divider,null));else if(!C){var D="user:"+p.Login,L=this.listOtherUsersSubjects(u||l,D),N=[];Object.keys(L).map((function(e){N.push(L[e])})),x.push(t().createElement("div",{style:a.subheader},j["visibility.panel.setvisible"])),x.push(t().createElement("div",{style:{margin:"-10px 10px 0"}},t().createElement(om,{className:"share-form-users",fieldLabel:j["visibility.panel.pickuser"],renderSuggestion:function(e){return t().createElement("div",{style:{fontSize:13}},e.getExtendedLabel())},onValueSelected:this.pickUser.bind(this),usersOnly:!1,existingOnly:!0,excludes:[k].concat(cp(E),N),pydio:O,showAddressBook:!1,usersFrom:"local"}))),x.push(t().createElement(g.Divider,null))}x.pop()}return t().createElement("div",{style:S},t().createElement("div",{style:a.title},t().createElement("span",{style:{flex:1}},w?"":j["visibility.panel.title"]),u&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-undo-variant",tooltip:j["visibility.panel.revert"],onClick:this.revert.bind(this),iconStyle:{color:r.textColor}}),u&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-content-save",tooltip:j["visibility.panel.save"],onClick:this.save.bind(this),iconStyle:{color:r.textColor}}),!u&&v&&t().createElement(g.IconButton,{iconClassName:"mdi mdi-close",onClick:v,iconStyle:{color:r.textColor}})),d&&t().createElement("div",null,j["visibility.panel.error"],": ",d),t().createElement("div",null,x))}}],r&&fp(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function vp(e){return vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vp(e)}function gp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gp(Object(n),!0).forEach((function(t){wp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wp(e,t,n){return(t=Op(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Op(r.key),r)}}function Op(e){var t=function(e,t){if("object"!==vp(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==vp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===vp(t)?t:String(t)}function Pp(e,t){return Pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pp(e,t)}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ep(e)}bp.PropTypes={pydio:z().instanceOf(q()),resourceType:z().string.isRequired,resourceId:z().string.isRequired,description:z().string.isRequired,onSavePolicies:z().func,userListExcludes:z().array,subjectsDisabled:z().array,subjectsHidden:z().object,readonly:z().bool,cellAcls:z().object,onDismiss:z().func,style:z().object,skipTitle:z().bool},bp=(0,$.muiThemeable)()(bp);var Cp=a(16689),Tp=a(56880),xp=a(62610),jp=a(85829),Rp=a(39455).IconButton,Ip=a(13173).muiThemeable,_p=a(10757).requireLib("boot"),Ap=_p.PydioContextConsumer,Mp=_p.AsyncComponent,Dp=q().requireLib("hoc").ThemedContainers.Popover,Lp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pp(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ep(r);if(o){var n=Ep(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===vp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).state={showPicker:!1,pickerAnchor:null,showMailer:!1,mailerAnchor:null,showPolicies:!1,policiesAnchor:null},n}return t=a,n=[{key:"onTeamSelected",value:function(e){var t=this.props,n=t.userId,r=t.reloadAction;this.setState({showPicker:!1}),e.IdmRole&&e.IdmRole.IsTeam&&Tp.getRestClient().getIdmApi().addUserToTeam(e.IdmRole.Uuid,n,(function(){jp.getInstance().deleteKey("user_public_data-graph",n),r()}))}},{key:"onUserSelected",value:function(e){var t=this.props,n=t.team,r=t.reloadAction;Tp.getRestClient().getIdmApi().addUserToTeam(n.id,e.IdmUser.Login,r)}},{key:"openPicker",value:function(e){this.setState({showPicker:!0,pickerAnchor:e.currentTarget})}},{key:"openPolicies",value:function(e){this.setState({showPolicies:!0,policiesAnchor:e.currentTarget})}},{key:"openMailer",value:function(e){var t=this,n=e.currentTarget;xp.loadClassesAndApply(["PydioMailer"],(function(){t.setState({mailerLibLoaded:!0},(function(){t.setState({showMailer:!0,mailerAnchor:n})}))}))}},{key:"componentDidUpdate",value:function(e,t){this.props.lockOnSubPopoverOpen&&(!this.state.showPicker&&!this.state.showMailer||t.showPicker||t.showMailer?this.state.showPicker||this.state.showMailer||!t.showPicker&&!t.showMailer||this.props.lockOnSubPopoverOpen(!1):this.props.lockOnSubPopoverOpen(!0))}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.pydio,i=r.getMessage,a=r.muiTheme,s=r.userEditable,c=r.userId,l=r.style,u=r.otherPopoverMouseOver,d=r.team,p=r.user,f=r.onEditAction,h=r.onDeleteAction,m=r.buttonStyle,y=r.iconStyle,b=o.getController().actions.has("user_team_create"),v="mui3"===a.userTheme?a.palette.mui3.primary:a.palette.accent2Color,g={button:Sp({border:"0px solid "+v,backgroundColor:"mui3"===a.userTheme?a.palette.mui3["primary-container"]:"transparent",borderRadius:"50%",margin:"0 4px",width:36,height:36,padding:8},m),icon:Sp({fontSize:20,color:v},y)},S={},w=[];return p&&p.IdmUser&&p.IdmUser.Attributes&&(p.IdmUser.Attributes.hasEmail||p.IdmUser.Attributes.email)&&(w.push({key:"message",label:i(598),icon:"email",callback:this.openMailer.bind(this)}),S[p.IdmUser.Login]=p.IdmUser),d?(e="team",t=d.id,b&&w.push({key:"users",label:i(599),icon:"account-multiple-plus",callback:this.openPicker.bind(this)})):(e="user",t=c,b&&w.push({key:"teams",label:i(573),icon:"account-multiple-plus",callback:this.openPicker.bind(this)})),!s||d&&!b||(f&&w.push({key:"edit",label:i(d?580:600),icon:"pencil",callback:f}),w.push({key:"policies",label:i("visibility.panel.title"),icon:"security",callback:this.openPolicies.bind(this)}),h&&w.push({key:"delete",label:i(d?570:582),icon:"delete",callback:h})),0===w.length?null:Cp.createElement("div",{style:Sp({},l)},w.map((function(e){return Cp.createElement(Rp,{key:e.key,style:g.button,iconStyle:g.icon,tooltip:e.label,iconClassName:"mdi mdi-"+e.icon,onClick:e.callback})})),Cp.createElement(Dp,{open:this.state.showPicker,anchorEl:this.state.pickerAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){n.setState({showPicker:!1})},useLayerForClickAway:!1,style:{zIndex:2200}},Cp.createElement("div",{style:{width:256,height:320}},Cp.createElement(Hh,{mode:"selector",pydio:o,loaderStyle:{width:320,height:320},onItemSelected:d?this.onUserSelected.bind(this):this.onTeamSelected.bind(this),teamsOnly:!d,usersOnly:!!d}))),Cp.createElement(Dp,{open:this.state.showMailer,anchorEl:this.state.mailerAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},useLayerForClickAway:!1,style:{zIndex:2200}},Cp.createElement("div",{style:{width:256,height:320}},this.state.mailerLibLoaded&&Cp.createElement(Mp,{namespace:"PydioMailer",componentName:"Pane",pydio:o,zDepth:0,panelTitle:i(598),uniqueUserStyle:!0,users:S,templateId:"DM",templateData:{From:o.user.getPreference("displayName")||o.user.id},onDismiss:function(){n.setState({showMailer:!1})},onFieldFocus:u}))),Cp.createElement(Dp,{open:this.state.showPolicies,anchorEl:this.state.policiesAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},useLayerForClickAway:!1,style:{zIndex:2e3}},Cp.createElement("div",{style:{width:256,height:320}},Cp.createElement(bp,{description:o.MessageHash["visibility.users.advanced"],pydio:o,resourceType:e,resourceId:t,onDismiss:function(){n.setState({showPolicies:!1})}}))))}}],n&&kp(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Cp.Component);function Np(e){return Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Np(e)}Lp.propTypes={user:z().object,team:z().object,userEditable:z().bool,pydio:z().object,getMessage:z().func,userId:z().string,style:z().object,onEditAction:z().func,onDeleteAction:z().func,reloadAction:z().func},Lp=Ap(Lp),Lp=Ip()(Lp);var Up=["style"];function Bp(){return Bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bp.apply(this,arguments)}function Fp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fp(Object(n),!0).forEach((function(t){Wp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wp(e,t,n){return(t=Hp(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hp(r.key),r)}}function Hp(e){var t=function(e,t){if("object"!==Np(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Np(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Np(t)?t:String(t)}function Zp(e,t){return Zp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zp(e,t)}function Vp(e){return Vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vp(e)}var Jp=a(39455),Gp=Jp.TextField,Kp=Jp.FlatButton,$p=Jp.CardTitle,Yp=a(10757).requireLib("boot").PydioContextConsumer,Xp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zp(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vp(o);if(i){var n=Vp(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Np(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).state={label:n.props.item.label},n}return n=s,r=[{key:"loadMembers",value:function(e){var t=this;this.setState({loading:!0}),Lu.childrenAsPromise(e,!1).then((function(n){Lu.childrenAsPromise(e,!0).then((function(n){t.setState({members:e.leafs,loading:!1})}))}))}},{key:"componentWillMount",value:function(){this.loadMembers(this.props.item)}},{key:"componentWillReceiveProps",value:function(e){this.loadMembers(e.item),this.setState({label:e.item.label})}},{key:"onLabelChange",value:function(e,t){this.setState({label:t})}},{key:"updateLabel",value:function(){var e=this;this.state.label!==this.props.item.label&&jr().getRestClient().getIdmApi().updateTeamLabel(this.props.item.IdmRole.Uuid,this.state.label,(function(){e.props.onUpdateAction(e.props.item)})),(0,this.props.setEdit)(!1)}},{key:"render",value:function(){var e,n=this,r=this.props,o=r.model,i=r.item,a=r.onDeleteAction,s=r.getMessage,c=r.edit,l=r.setEdit,u=r.muiTheme,d={team:i,userEditable:this.props.item.IdmRole.PoliciesContextEditable,onDeleteAction:function(){n.props.onDeleteAction(i._parent,[i])},onEditAction:function(){l(!0)},reloadAction:function(){n.props.onUpdateAction(i)}};e=c?t().createElement("div",{style:{display:"flex",alignItems:"center",padding:12}},t().createElement(Gp,{style:{flex:1,fontSize:24},fullWidth:!0,disabled:!1,underlineShow:!1,value:this.state.label,onChange:this.onLabelChange.bind(this)}),t().createElement(Kp,{secondary:!0,label:s(48),onClick:function(){n.updateLabel()}})):t().createElement($p,{style:{padding:"12px 16px 4px"},title:this.state.label,subtitle:i.leafs&&i.leafs.length?s(576).replace("%s",i.leafs.length):s(577)});var p=this.props,f=(p.style,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(p,Up)),h={};return"mui3"!==u.userTheme&&(h={borderTop:"1px solid #e0e0e0",borderBottom:"1px solid #e0e0e0"}),t().createElement("div",null,t().createElement("div",{style:{paddingBottom:4}},e,t().createElement(Lp,Bp({},f,d,{style:zp({paddingLeft:8},h)}))),t().createElement(pd,{model:o,subHeader:s(575),onItemClicked:function(){},item:i,mode:"inner",onDeleteAction:a}))}}],r&&qp(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Qp(e){return Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qp(e)}function ef(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ef(Object(n),!0).forEach((function(t){nf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ef(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nf(e,t,n){return(t=of(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,of(r.key),r)}}function of(e){var t=function(e,t){if("object"!==Qp(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Qp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Qp(t)?t:String(t)}function af(e,t){return af=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},af(e,t)}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sf(e)}Xp.propTypes={pydio:z().instanceOf(Pydio),item:z().object,style:z().object,onRequestClose:z().func,onDeleteAction:z().func,onUpdateAction:z().func},Xp=Yp((0,$.muiThemeable)()(Xp));var cf=q().requireLib("form"),lf=cf.Manager,uf=cf.FormPanel,df=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&af(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=sf(o);if(i){var n=sf(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Qp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var r=(n=a.call(this,e,t)).props,o=r.pydio,i=r.newUserName,c=r.editMode,l=r.userData,u=o.getPluginConfigs("action.share").get("SHARED_USERS_TMP_PREFIX");u&&!i.startsWith(u)||(u="");var d={new_password:"",send_email:o.Parameters.get("validMailer")};if(c&&l&&l.IdmUser){var p=l.IdmUser;n.getParameters().forEach((function(e){var t,n=e.name,r=e.IdmUserField,o=e.scope,i=e.pluginId;r?t=p[r]:"user"===o&&p.Attributes?t=p.Attributes[n]:i&&p.Attributes["parameter:"+i+":"+n]&&(t=JSON.parse(p.Attributes["parameter:"+i+":"+n])),void 0!==t&&(d[n]=t)}))}else d.new_user_id=u+i,d.lang=o.currentLanguage;return n.state={values:d},n}return n=s,r=[{key:"getCreateUserParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],n=this.props.pydio,r=n.MessageHash,o=n.getPluginConfigs("action.share").get("SHARED_USERS_TMP_PREFIX");t.push({IdmUserField:"Login",description:r[533],readonly:e,expose:"true",label:r[522],name:e?"existing_user_id":"new_user_id",scope:"user",type:"valid-login",mandatory:!0,default:o||""},{IdmUserField:"Password",description:r[534],editable:"true",expose:"true",label:r[523],name:"new_password",scope:"user",type:"valid-password",mandatory:!0,direction:"column"});for(var i=n.getPluginConfigs("auth").get("NEWUSERS_EDIT_PARAMETERS").split(","),a=0;a<i.length;a++)i[a]="user/preferences/pref[@exposed]|//param[@name='"+i[a]+"']";var s=i.join("|");return lf.parseParameters(n.getXmlRegistry(),s).map((function(e){t.push(e)})),!e&&n.Parameters.get("validMailer")&&t.push({description:r[536],editable:"true",expose:"true",label:r[535],name:"send_email",scope:"user",type:"boolean",mandatory:!0}),t}},{key:"getDefaultProps",value:function(){return{editMode:!1}}},{key:"getParameters",value:function(){return this._parsedParameters||(this._parsedParameters=this.getCreateUserParameters(this.props.editMode)),this._parsedParameters}},{key:"getValuesForPost",value:function(e){return lf.getValuesForPOST(this.getParameters(),this.state.values,e)}},{key:"onValuesChange",value:function(e){this.setState({values:e})}},{key:"changeValidStatus",value:function(e){this.setState({valid:e})}},{key:"submitCreationForm",value:function(){var e,t=this,n=this.props,r=n.editMode,o=n.userData;r&&(e=o.IdmUser),jr().getRestClient().getIdmApi().putExternalUser(this.state.values,this.getParameters(),e).then((function(e){t.props.onUserCreated(Nu.User.fromIdmUser(e))}))}},{key:"cancelCreationForm",value:function(){this.props.onCancel()}},{key:"render",value:function(){var e=this.props,n=e.pydio,r=e.editMode,o=e.formShowLegends,i=void 0===o||o,a=this.state.valid;return a||!r||this.state.values.new_password||(a=!0),t().createElement(g.Paper,{zDepth:void 0===this.props.zDepth?2:this.props.zDepth,style:tf({minHeight:250,display:"flex",flexDirection:"column"},this.props.style)},t().createElement(uf,{className:"reset-pydio-forms",depth:-1,parameters:this.getParameters(),values:this.state.values,onChange:this.onValuesChange.bind(this),onValidStatusChange:this.changeValidStatus.bind(this),panelStyle:{overflowY:"auto",flex:1},variant:"v2",variantShowLegend:i}),t().createElement(g.Divider,{style:{flexShrink:0}}),t().createElement("div",{style:{padding:8,textAlign:"right"}},t().createElement(g.FlatButton,{label:n.MessageHash[54],onClick:this.cancelCreationForm.bind(this)}),t().createElement(g.FlatButton,{label:this.props.editMode?n.MessageHash[519]:n.MessageHash[484],primary:!0,onClick:this.submitCreationForm.bind(this),disabled:!a})))}}],r&&rf(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function pf(e){return pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pf(e)}function ff(){return ff=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ff.apply(this,arguments)}function hf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hf(Object(n),!0).forEach((function(t){yf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yf(e,t,n){return(t=vf(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vf(r.key),r)}}function vf(e){var t=function(e,t){if("object"!==pf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==pf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===pf(t)?t:String(t)}function gf(e,t){return gf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gf(e,t)}function Sf(e){return Sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sf(e)}df.propTypes={newUserName:z().string,onUserCreated:z().func.isRequired,onCancel:z().func.isRequired,editMode:z().bool,userData:z().object};var wf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gf(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sf(o);if(i){var n=Sf(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===pf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).state={},n}return n=s,r=[{key:"render",value:function(){var e,n=this,r=this.props,o=r.pydio,i=r.item,a=r.model,s=r.onDeleteAction,c=r.onUpdateAction,l=r.edit,u=r.setEdit,d=r.muiTheme,p=this.state.graphRand,f={avatarStyle:{zIndex:1}},h=i._parent&&"ext"===i._parent.id,m={};"mui3"!==d.userTheme&&(m={borderTop:"1px solid #e0e0e0",borderBottom:"1px solid #e0e0e0"});var y=t().createElement(Lp,{pydio:o,model:a,user:i,userId:i.id,userEditable:h&&i.IdmUser.PoliciesContextEditable,onDeleteAction:function(){s(i._parent,[i])},onEditAction:function(){u(!0)},reloadAction:function(){c(i),n.setState({graphRand:Math.random()})},style:mf({padding:8,textAlign:"center"},m)});return l&&(e=t().createElement(df,{pydio:o,zDepth:0,style:{flex:1,borderRadius:0,borderTop:"1px solid var(--md-sys-color-outline-variant-50)"},newUserName:i.id,editMode:!0,userData:i,onUserCreated:function(){c(i),u(!1)},onCancel:function(){u(!1)},formShowLegends:!0})),f=mf(mf({},f),{},{avatarSize:40,avatarStyle:{left:20,top:20,right:"inherit"},cardStyle:{textAlign:"left",padding:"20px 16px 24px 74px"},cardTitleStyle:{fontSize:14,fontWeight:500,lineHeight:"20px"},cardSubtitleStyle:{fontSize:13,fontWeight:400,lineHeight:"14px"}}),t().createElement("div",{style:l?{height:"100%",display:"flex",flexDirection:"column"}:{}},t().createElement(Qd,ff({userId:this.props.item.id,richCard:!0,pydio:this.props.pydio,cardSize:this.props.style.width,cardStyle:{textAlign:"left",padding:"12px 16px 4px"},actionsPanel:!l&&y,noActionsPanel:l,graphRand:p},f)),e)}}],r&&bf(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function kf(e){return kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kf(e)}function Of(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Of(Object(n),!0).forEach((function(t){Ef(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Of(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ef(e,t,n){return(t=Tf(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tf(r.key),r)}}function Tf(e){var t=function(e,t){if("object"!==kf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==kf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===kf(t)?t:String(t)}function xf(e,t){return xf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xf(e,t)}function jf(e){return jf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jf(e)}wf.propTypes={pydio:z().instanceOf(Pydio),item:z().object,style:z().object,onRequestClose:z().func,onDeleteAction:z().func,onUpdateAction:z().func},wf=(0,$.muiThemeable)()(wf);var Rf=a(580),If=a(16689),_f=a(39455),Af=_f.Paper,Mf=_f.IconButton,Df=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xf(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=jf(r);if(o){var n=jf(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===kf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).state={edit:!1},n.props.model.observe("update",(function(){return n.forceUpdate()})),n}return t=a,n=[{key:"componentWillReceiveProps",value:function(e){e.item!==this.props.item&&this.setState({edit:!1})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.model,o=n.style,i=n.zDepth,a=void 0===i?2:i,s=this.state.edit,c=r.rightItem(),l=function(){r.clearRightItem()},u=Pf(Pf({},this.props),{},{item:c,onRequestClose:l,onDeleteAction:function(e,t,n){return r.deleteItems(e,t,n)},onCreateAction:function(e){r.setCreateItem(e)},onUpdateAction:function(e){var n=t.props.model;e._parent&&e._parent===n.contextItem()&&n.reloadContext()},edit:s,setEdit:function(e){return t.setState({edit:e})}});return c&&"user"===c.type?e=If.createElement(wf,u):c&&c.IdmRole&&c.IdmRole.IsTeam&&(e=If.createElement(Xp,u)),If.createElement(Af,{zDepth:a,style:Pf({position:"relative",borderRadius:6},o)},If.createElement(Mf,{iconClassName:"mdi mdi-close",style:{position:"absolute",top:12,right:12,zIndex:2},iconStyle:{color:"#e0e0e0"},onClick:l}),e)}}],n&&Cf(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(If.Component);function Lf(e){return Lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lf(e)}function Nf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Uf(r.key),r)}}function Uf(e){var t=function(e,t){if("object"!==Lf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Lf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Lf(t)?t:String(t)}function Bf(e,t){return Bf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bf(e,t)}function Ff(e){return Ff=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ff(e)}Df.propTypes={pydio:Rf.instanceOf(Pydio),item:Rf.object,style:Rf.object,onRequestClose:Rf.func,onDeleteAction:Rf.func,onUpdateAction:Rf.func};var zf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bf(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ff(o);if(i){var n=Ff(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Lf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"onClick",value:function(){this.props.onClick(this.props.entry)}},{key:"buildNestedItems",value:function(e){var n=this.props,r=n.style,o=n.innerDivStyle,i=n.avatarSize;return e.map(function(e){return t().createElement(s,{nestedLevel:this.props.nestedLevel+1,entry:e,onClick:this.props.onClick,selected:this.props.selected,showIcons:!0,style:r,innerDivStyle:o,avatarSize:i})}.bind(this))}},{key:"render",value:function(){var e,n=this.props,r=n.showIcons,o=n.entry,i=(n.selected,n.style),a=n.innerDivStyle,s=n.avatarSize,c=void 0===s?36:s,l=o.id,u=o.label,d=o.icon,p=o.collections||[],f=this.buildNestedItems(p);return d&&r&&(g.FontIcon,e=t().createElement(g.Avatar,{icon:t().createElement(g.FontIcon,{className:d}),size:c})),t().createElement(g.ListItem,{nestedLevel:this.props.nestedLevel,key:l,primaryText:u,onClick:this.onClick.bind(this),nestedItems:f,initiallyOpen:!0,leftAvatar:e,innerDivStyle:a,style:i})}}])&&Nf(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.Component);function Wf(e){return Wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wf(e)}function qf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qf(Object(n),!0).forEach((function(t){Zf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zf(e,t,n){return(t=Gf(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vf.apply(this,arguments)}function Jf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gf(r.key),r)}}function Gf(e){var t=function(e,t){if("object"!==Wf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Wf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Wf(t)?t:String(t)}function Kf(e,t){return Kf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kf(e,t)}function $f(e){return $f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$f(e)}zf.propTypes={nestedLevel:z().number,selected:z().string,onClick:z().func};var Yf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kf(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$f(o);if(i){var n=$f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Wf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),e.model.observe("update",(function(){return t.forceUpdate()})),t}return n=s,r=[{key:"render",value:function(){var e=this.props,n=e.listStyles,r=void 0===n?{}:n,o=e.rootStyle,i=void 0===o?{}:o,a=e.model,s=[],c=a.contextItem();return a.getRoot().collections.map(function(e){s.push(t().createElement(zf,Vf({key:e.id,selected:c&&c.id,nestedLevel:0,entry:e,onClick:function(e,t){return a.setContext(e,t)}},r.listItem,{avatarSize:r.avatar?r.avatar.avatarSize:void 0,showIcons:!0}))),s.push(t().createElement(g.Divider,{key:e.id+"-divider"}))}.bind(this)),s.pop(),t().createElement("div",{style:Hf(Hf({},i),{},{zIndex:2})},t().createElement(g.List,null,s))}}],r&&Jf(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Xf(e){return Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xf(e)}function Qf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eh(r.key),r)}}function eh(e){var t=function(e,t){if("object"!==Xf(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Xf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Xf(t)?t:String(t)}function th(e,t){return th=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},th(e,t)}function nh(e){return nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nh(e)}var rh=q().requireLib("boot").PydioContextConsumer,oh=q().requireLib("hoc").ModernTextField,ih=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&th(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nh(r);if(o){var n=nh(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Xf(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).state={value:""},n}return t=a,n=[{key:"onChange",value:function(e,t){this.setState({value:t})}},{key:"submitCreationForm",value:function(){var e=this.state.value;jr().getRestClient().getIdmApi().saveSelectionAsTeam(e,[],this.props.onTeamCreated)}},{key:"render",value:function(){var e=this,t=this.props.getMessage;return React.createElement("div",null,React.createElement("div",{style:{padding:20}},React.createElement("div",null,t(591)),React.createElement(oh,{focusOnMount:!0,floatingLabelText:t(578),value:this.state.value,onChange:this.onChange.bind(this),fullWidth:!0,onKeyPress:function(t){"Enter"===t.key&&e.submitCreationForm()},variant:"v2"})),React.createElement("div",null,React.createElement("div",{style:{textAlign:"right",padding:8}},React.createElement(g.FlatButton,{label:t(49),onClick:this.props.onCancel.bind(this)}),React.createElement(g.FlatButton,{label:t(579),primary:!0,onClick:this.submitCreationForm.bind(this)}))))}}],n&&Qf(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(e.Component);function ah(e){return ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ah(e)}function sh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ch(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sh(Object(n),!0).forEach((function(t){lh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lh(e,t,n){return(t=dh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dh(r.key),r)}}function dh(e){var t=function(e,t){if("object"!==ah(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ah(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ah(t)?t:String(t)}function ph(e,t){return ph=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ph(e,t)}function fh(e){return fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fh(e)}ih.propTypes={onTeamCreated:z().func.isRequired,onCancel:z().func.isRequired},ih=rh(ih);var hh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ph(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fh(o);if(i){var n=fh(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ah(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e),e.model.observe("update",(function(){return t.forceUpdate()})),t}return n=s,(r=[{key:"render",value:function(){var e,n,r,o=this.props,i=o.pydio,a=o.model,s=o.onCancel,c=o.afterSubmit,l=a.createItem();l&&("users"===l.actions.type?(r={display:"flex",flexDirection:"column",overflow:"hidden"},e=a.m(484,""),n=t().createElement(df,{zDepth:0,style:{display:"flex",flexDirection:"column",flex:1,marginTop:-20},newUserName:"",onUserCreated:c,onCancel:s,pydio:i})):"teams"===l.actions.type?(e=a.m(569,""),n=t().createElement(ih,{onTeamCreated:c,onCancel:s})):"team"===l.actions.type&&(e=null,n=t().createElement(Hh,{pydio:i,mode:"selector",usersOnly:!0,disableSearch:!0,onItemSelected:function(e){jr().getRestClient().getIdmApi().addUserToTeam(e.IdmRole.Uuid,e.IdmUser.Login).then((function(){a.reloadContext()}))}})));var u=this.props.muiTheme,d="mui3"===u.userTheme?{style:{background:u.dialog.containerBackground}}:void 0;return t().createElement(g.Dialog,{contentStyle:{width:420,minWidth:380,maxWidth:"100%",padding:0},bodyStyle:ch({padding:0},r),title:t().createElement("div",{style:{padding:20}},e),actions:null,modal:!1,open:!!l,paperProps:d,onRequestClose:function(){s()}},n)}}])&&uh(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);const mh=hh=(0,$.muiThemeable)()(hh);function yh(e){return yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(e)}function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bh.apply(this,arguments)}function vh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vh(Object(n),!0).forEach((function(t){Ph(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Eh(r.key),r)}}function wh(e,t){return wh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wh(e,t)}function kh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oh(e){return Oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oh(e)}function Ph(e,t,n){return(t=Eh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eh(e){var t=function(e,t){if("object"!==yh(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==yh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===yh(t)?t:String(t)}var Ch=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wh(e,t)}(c,n);var r,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Oh(i);if(a){var n=Oh(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===yh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return kh(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ph(kh(e=s.call.apply(s,[this].concat(n))),"state",{editLabel:!1}),e}return r=c,o=[{key:"onLabelKeyEnter",value:function(e){"Enter"===e.key&&this.updateLabel()}},{key:"onLabelChange",value:function(e,t){this.setState({editValue:t})}},{key:"updateLabel",value:function(){var e=this.props.model,t=this.state.editValue;t!==e.contextItem().label&&jr().getRestClient().getIdmApi().updateTeamLabel(e.contextItem().IdmRole.Uuid,t,(function(){var t=e.contextItem()._parent;e.setContext(t,(function(){e.reloadContext().then((function(){}))}))})),this.setState({editLabel:!1})}},{key:"render",value:function(){var n=this,r=this.props,o=r.muiTheme,i=r.bookColumn,a=r.mode,s=r.getMessage,c=r.pydio,l=r.style,u=r.model,d=r.searchLabel,p=r.onSearch,f=r.searchTerm,h=r.setSearchTerm,m=r.searchMode,y=r.setSearchMode,b=r.enableSearch,v=u.contextItem(),S=u.getSelectionMode(),w=function(){return u.reloadContext()},k="mui3"===o.userTheme?o.palette.mui3.primary:o.palette.accent2Color,O={toolbarHeight:"book"===a?56:48,titleFontsize:"book"===a?20:16,titleFontWeight:400,titlePadding:10,button:{border:"1px solid "+k,backgroundColor:"transparent",borderRadius:"50%",margin:"0 4px",width:36,height:36,padding:6},icon:{fontSize:18,color:k}};i&&(O.titleFontsize=14,O.titleFontWeight=500,O.titlePadding="10px 6px 10px 16px",O.button.margin="0",O.button.border="0",O.icon.color=k);var P={searchLabel:d,onSearch:p,searchTerm:f,setSearchTerm:h,style:{flex:1,minWidth:110}};"selector"===a?(P.inputStyle={color:"white"},P.hintStyle={color:"rgba(255,255,255,.5)"},P.underlineStyle={borderColor:"rgba(255,255,255,.5)"},P.underlineFocusStyle={borderColor:"white"}):(P.underlineShow=!1,P.style=gh(gh({},P.style),{},{borderRadius:o.borderRadius,background:o.palette.mui3["surface-2"],height:38,display:"flex",alignItems:"center",paddingLeft:16,marginRight:8}));var E,C,T="mdi mdi-account-plus";if(v.actions&&"teams"===v.actions.type&&(T="mdi mdi-account-multiple-plus"),("book"===a||i)&&u.contextIsTeam()&&u.teamsEditable()){var x=u.contextItem();C=!0,E=t().createElement(Lp,bh({},this.props,{team:u.contextItem(),userEditable:!0,reloadAction:function(){u.reloadContext()},onDeleteAction:function(){if(confirm(n.props.getMessage(278))){var e=x._parent;u.setContext(e,(function(){u.deleteItems(e,[x],!0)}))}},style:{backgroundColor:"transparent",borderTop:0,borderBottom:0},buttonStyle:O.button,iconStyle:O.icon}))}var j=this.state,R=j.editLabel,I=j.editValue,_=v.label;C&&!S&&R&&(_=t().createElement("div",{style:{display:"flex",alignItems:"center",flex:1}},t().createElement(g.TextField,{style:{fontSize:20},value:I,onChange:this.onLabelChange.bind(this),onKeyDown:this.onLabelKeyEnter.bind(this),autoFocus:!0}),t().createElement(g.IconButton,{iconStyle:{color:o.palette.mui3.primary},secondary:!0,iconClassName:"mdi mdi-content-save",tooltip:s(48),onClick:function(){n.updateLabel()}})));var A="selector"===a&&v._parent,M="book"===a&&v.actions&&v.actions.multiple,D="book"===a,L=("book"===a||"selector"===a&&i)&&v.actions&&v.actions.create&&!S,N=i&&!v._parent&&c.user.getRepositoriesList().has("directory"),U="book"===a&&v.actions&&v.actions.remove&&S,B=b&&!i,F=w&&("book"===a||"selector"===a&&i),z=C&&!R&&!S;if("book"===a&&!i&&"xs"!==o.breakpoint&&"s"!==o.breakpoint){for(var W=[_],q=v;q._parent;)W.push(t().createElement("span",{className:"mdi mdi-chevron-right"}),t().createElement("span",null,q._parent.label)),q=q._parent;W.reverse(),_=t().createElement("div",{style:{display:"flex",alignItems:"center"}},W)}var H,Z=gh({color:o.palette.mui3["on-surface"],padding:O.titlePadding,height:O.toolbarHeight,minHeight:O.toolbarHeight,borderRadius:"2px 2px 0 0",display:"flex",alignItems:"center"},l);return N&&(H="mui3"===o.userTheme?function(){c.triggerRepositoryChange("directory")}:function(){c.Controller.fireAction("open_address_book")}),t().createElement("div",{style:Z},A&&t().createElement(g.IconButton,{style:{marginLeft:-10},iconStyle:{color:O.titleColor},iconClassName:"mdi mdi-chevron-left",onClick:function(){!function(e,t){u.setContext(e,void 0)}(v._parent)}}),D&&t().createElement(g.IconButton,{style:{marginLeft:-10},iconStyle:{color:O.titleColor},iconClassName:v.icon,onClick:function(){}}),t().createElement("div",{style:gh({flex:2,fontSize:O.titleFontsize,fontWeight:O.titleFontWeight},{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"})},_),B&&!S&&t().createElement(e.Fragment,null,t().createElement(hu,P),m&&t().createElement(g.IconButton,{style:O.button,iconStyle:O.icon,iconClassName:"mdi mdi-close",tooltipPosition:"bottom-left",tooltip:c.MessageHash[86],onClick:function(){return y(!1)}})),N&&t().createElement(g.IconButton,{style:O.button,iconStyle:O.icon,iconClassName:"mdi mdi-account-box-outline",tooltipPosition:"bottom-left",tooltip:c.MessageHash[411],onClick:H}),L&&t().createElement(g.IconButton,{style:O.button,iconStyle:O.icon,iconClassName:T,tooltipPosition:"bottom-left",tooltip:s(v.actions.create),onClick:function(){return u.setCreateItem()}}),U&&t().createElement(g.RaisedButton,{secondary:!0,label:s(v.actions.remove),disabled:!u.getMultipleSelection().length,onClick:function(){return u.deleteMultipleSelection()}}),z&&t().createElement(g.IconButton,{style:O.button,iconStyle:O.icon,iconClassName:"mdi mdi-pencil",tooltipPosition:"bottom-left",tooltip:c.MessageHash[6],onClick:function(){n.setState({editLabel:!0,editValue:v.label})},disabled:u.loading}),!S&&E,M&&t().createElement(g.IconButton,{style:O.button,iconStyle:O.icon,iconClassName:"mdi mdi-checkbox-multiple"+(S?"-marked-outline":"-blank-outline"),tooltipPosition:"bottom-left",tooltip:c.MessageHash["addressbook.pick.multiple"],onClick:function(){u.setSelectionMode()}}),F&&!m&&t().createElement(g.IconButton,{style:O.button,iconStyle:O.icon,iconClassName:"mdi mdi-refresh",tooltipPosition:"bottom-left",tooltip:c.MessageHash[149],onClick:w,disabled:u.loading}))}}],o&&Sh(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(t().Component);const Th=Ch=(0,$.muiThemeable)()(Ch);function xh(e){return xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xh(e)}function jh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jh(Object(n),!0).forEach((function(t){Lh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ih.apply(this,arguments)}function _h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Nh(r.key),r)}}function Ah(e,t){return Ah=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ah(e,t)}function Mh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dh(e){return Dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dh(e)}function Lh(e,t,n){return(t=Nh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nh(e){var t=function(e,t){if("object"!==xh(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xh(t)?t:String(t)}var Uh=q().requireLib("boot"),Bh=Uh.PydioContextConsumer,Fh=Uh.PydioContextProvider,zh=q().requireLib("hoc").ThemedContainers,Wh=zh.Popover,qh=zh.IconButton,Hh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ah(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Dh(o);if(i){var n=Dh(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===xh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Mh(e)}(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),Lh(Mh(t=a.call(this,e)),"openPopover",(function(e){t.setState({popoverOpen:!0,popoverAnchor:e.currentTarget})})),Lh(Mh(t),"closePopover",(function(){t.setState({popoverOpen:!1})}));var n=e.pydio,r=e.mode,o=e.usersOnly,i=e.usersFrom,c=e.teamsOnly,l=e.onItemSelected,u=new Yu(n,r,o,i,c,l);return u.initTree(),u.observe("update",(function(){t.forceUpdate()})),t.state={model:u},t}return n=s,r=[{key:"componentDidMount",value:function(){this.state.model.reloadContext()}},{key:"render",value:function(){var e=this.props,n=e.mode,r=e.getMessage,o=e.bookColumn,i=e.listStyles,a=e.pydio;if("popover"===n){var c=t().createElement(qh,{style:{position:"absolute",padding:15,zIndex:100,right:0,bottom:0,display:this.state.loading?"none":"initial"},iconStyle:{fontSize:19},iconClassName:"mdi mdi-book-open-variant",onClick:this.openPopover}),l=Fh(s,a,a.UI.themeBuilder);return t().createElement("span",null,c,t().createElement(Wh,{open:this.state.popoverOpen,anchorEl:this.state.popoverAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.closePopover,style:{marginLeft:20},zDepth:2},t().createElement("div",{style:{width:320,height:420}},t().createElement(l,Ih({},this.props,{mode:"selector",style:{height:420}})))))}var u,d,p,f=this.state.model,h=f.rightItem(),m=f.contextItem(),y={width:256,overflowY:"auto",overflowX:"hidden"},b=this.props.muiTheme.palette.mui3,v=void 0===b?{}:b,g={};!this.props.disableSearch&&f.contextIsGroup()&&(g={enableSearch:!0,searchLabel:r(595,""),onSearch:function(e){return f.reloadCurrentWithSearch(e)}}),"inner"!==n&&(p=t().createElement(Th,Ih({pydio:a,model:f,mode:n,bookColumn:o,getMessage:r},g))),u=t().createElement(pd,Ih({model:f,item:m,mode:n,bookColumn:o,toolbar:p,onItemClicked:function(e){return f.leafItemClicked(e)},onFolderClicked:function(e,t){return f.setContext(e,t)},onClick:function(){return f.clearRightItem()},loading:f.loading,emptyStatePrimaryText:void 0,emptyStateSecondaryText:void 0,actionsForCell:this.props.actionsForCell,usersOnly:this.props.usersOnly,listStyles:i},g)),d=t().createElement(Df,{pydio:this.props.pydio,model:f,style:Rh(Rh({},y),{},{position:"absolute",transformOrigin:"right",background:v["surface-3"],width:"book"===n?320:280,right:10,bottom:10,top:120,zIndex:2,transform:h?null:"scale(0)"})});var S=this.props.style||{},w={background:v["surface-3"],color:v["on-surface-variant"],borderRight:"1px solid #e0e0e0"};return t().createElement("div",{style:Rh({display:"flex",height:"selector"===n?320:450},S)},"book"===n&&t().createElement(Yf,{model:f,listStyles:i,rootStyle:Rh(Rh(Rh({},y),w),{},{zIndex:2})}),u,d,t().createElement(mh,{pydio:a,model:f,onCancel:function(){f.clearCreateItem()},afterSubmit:function(){f.clearCreateItem(),f.reloadContext()}}),t().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:(this.props.muiTheme.palette,"\n.folder-avatar::before {\n    content: '\\F24B';\n    font-family: 'Material Design Icons';\n    position: absolute;\n    color: rgb(54, 113, 143);\n    font-size: 40px;\n    top: 11px;\n    left: -2px;\n}\n.compact .folder-avatar::before {\n    font-size: 30px;\n    top: 5px;\n}\n.folder-avatar span.mdi {\n    font-size: 20px !important;\n    color: #fff !important;\n    height: 12.8px !important;\n    margin: 7.3px !important;\n}\n.compact .folder-avatar span.mdi {\n    font-size: 13px !important;\n}\n.folder-avatar {\n    background-color: transparent !important;\n}\n")}}))}}],r&&_h(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Zh(e){return Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(e)}function Vh(e){return function(e){if(Array.isArray(e))return Gh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Jh(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jh(e,t){if(e){if("string"==typeof e)return Gh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gh(e,t):void 0}}function Gh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,em(r.key),r)}}function $h(e,t){return $h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$h(e,t)}function Yh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xh(e){return Xh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xh(e)}function Qh(e,t,n){return(t=em(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function em(e){var t=function(e,t){if("object"!==Zh(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Zh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Zh(t)?t:String(t)}Lh(Hh,"propTypes",{pydio:z().instanceOf(q()),mode:z().oneOf(["book","selector","popover"]).isRequired,bookColumn:z().bool,onItemSelected:z().func,usersOnly:z().bool,usersFrom:z().oneOf(["local","remote","any"]),disableSearch:z().bool,muiTheme:z().object,popoverStyle:z().object,popoverButton:z().object,popoverContainerStyle:z().object,popoverIconButtonStyle:z().object}),Lh(Hh,"defaultProps",{mode:"book",usersOnly:!1,usersFrom:"any",teamsOnly:!1,disableSearch:!1}),Hh=Bh(Hh),Hh=(0,$.muiThemeable)()(Hh);var tm=q().requireLib("hoc"),nm=tm.ModernAutoComplete,rm=tm.ThemedContainers.Popover,om=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$h(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xh(o);if(i){var n=Xh(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Zh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Yh(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Qh(Yh(e=a.call.apply(a,[this].concat(r))),"state",{dataSource:[],loading:!1,searchText:"",minChars:parseInt(q().getInstance().getPluginConfigs("core.auth").get("USERS_LIST_COMPLETE_MIN_CHARS")),hideGroups:!0===q().getInstance().getPluginConfigs("action.advanced_settings").get("DISABLE_SHARE_GROUPS")}),Qh(Yh(e),"suggestionLoader",(function(t,n){var r=e.props,o=r.excludes,i=r.usersOnly,a=e.state.hideGroups;e.setState({loading:e.state.loading+1});var s=jr().getRestClient().getIdmApi(),c=[];c.push(s.listUsers("/",t,!0,0,20)),a||i?c.push(Promise.resolve({Groups:[]})):c.push(s.listGroups("/",t,!0,0,20)),i?c.push(Promise.resolve({Teams:[]})):c.push(s.listTeams(t,0,20)),Promise.all(c).then((function(t){e.setState({loading:e.state.loading-1});var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Jh(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,3),i=r[0],a=r[1],s=r[2];i=i.Users,a=a.Groups,s=s.Teams,o&&o.length&&(i=i.filter((function(e){return-1===o.indexOf(e.Login)})),a=a.filter((function(e){return-1===o.indexOf(e.GroupLabel)})),s=s.filter((function(e){return o.indexOf(-1===e.Label)}))),n([].concat(Vh(a.map((function(e){return{IdmUser:e}}))),Vh(s.map((function(e){return{IdmRole:e}}))),Vh(i.map((function(e){return{IdmUser:e}})))))}))})),Qh(Yh(e),"textFieldUpdate",(function(t){e.setState({searchText:t}),e.state.minChars&&t&&t.length<e.state.minChars||e.loadBuffered(t,350)})),Qh(Yh(e),"getPendingSearchText",(function(){return e.state.searchText||!1})),Qh(Yh(e),"loadBuffered",(function(n,r){if(n||!e._emptyValueList){var o=e.props,i=o.existingOnly,a=o.freeValueAllowed,s=o.excludes;tp().bufferCallback("remote_users_search",r,function(){this.setState({loading:!0});var e=[q().getInstance().user.id,"pydio.anon.user"];this.suggestionLoader(n,function(r){var o=!1,c=r.filter((function(t){return!(t.IdmUser&&!t.IdmUser.IsGroup&&e.indexOf(t.IdmUser.Login)>-1)})).filter((function(e){return!s||(e.IdmUser&&e.IdmUser.IsGroup?0===s.filter((function(t){return t===e.IdmUser.Uuid})).length:e.IdmUser?0===s.filter((function(t){return t===e.IdmUser.Login})).length:0===s.filter((function(t){return t===e.IdmRole.Uuid})).length)})).map((function(e){var r,i,a;return e.IdmUser&&e.IdmUser.IsGroup?(r=e.IdmUser.GroupLabel,a=e.IdmUser.Attributes&&e.IdmUser.Attributes.displayName?e.IdmUser.Attributes.displayName:r,i="mdi mdi-folder-account"):e.IdmUser?(r=e.IdmUser.Login,a=e.IdmUser.Attributes&&e.IdmUser.Attributes.displayName?e.IdmUser.Attributes.displayName:r,i=e.IdmUser.Attributes&&"shared"===e.IdmUser.Attributes.profile?"mdi mdi-account":"mdi mdi-account-box-outline"):(r=e.IdmRole.Uuid,a=e.IdmRole.Label,i="mdi mdi-account-multiple-outline"),o|=a===n,{userObject:e,text:r,value:t().createElement(g.MenuItem,{primaryText:a,leftIcon:t().createElement(g.FontIcon,{className:i,style:{margin:"0 12px"}})})}}));if(n||(this._emptyValueList=c),n&&!o&&(!i||a)){n=this.slugLogin(n);var l=q().getMessages()[448]||"create",u=t().createElement(g.MenuItem,{primaryText:n+(a?"":" ("+l+")"),leftIcon:t().createElement(g.FontIcon,{className:"mdi mdi-account-plus",style:{margin:"0 12px"}})});c=[{text:n,value:u}].concat(Vh(c))}this.setState({dataSource:c,loading:!1})}.bind(this))}.bind(Yh(e)))}else e.setState({dataSource:e._emptyValueList})})),Qh(Yh(e),"onCompleterRequest",(function(t,n){var r=e.props,o=r.freeValueAllowed,i=r.onValueSelected;if(-1===n&&(e.state.dataSource.map((function(e){e.text===t&&(t=e)})),t&&!t.userObject&&o))return i({FreeValue:t.text}),void e.setState({searchText:"",dataSource:[]});t&&(t.userObject?i(t.userObject):o?i({FreeValue:t.text}):e.setState({createUser:t.text}),e.setState({searchText:"",dataSource:[]}))})),Qh(Yh(e),"onUserCreated",(function(t){e.props.onValueSelected(t),e.setState({createUser:null})})),Qh(Yh(e),"onCreationCancelled",(function(){e.setState({createUser:null})})),Qh(Yh(e),"openAddressBook",(function(t){e.setState({addressBookOpen:!0,addressBookAnchor:t.currentTarget})})),Qh(Yh(e),"closeAddressBook",(function(){e.setState({addressBookOpen:!1})})),Qh(Yh(e),"onAddressBookItemSelected",(function(t){e.props.onValueSelected(t)})),e}return n=s,(r=[{key:"componentWillReceiveProps",value:function(){this._emptyValueList=null}},{key:"slugLogin",value:function(e){return e=e.toLowerCase(),""===rp().isValidLogin(e)?e:K().computeStringSlug(e)}},{key:"render",value:function(){var e=this,n=this.props,r=n.pydio,o=n.className,i=n.fieldLabel,a=n.underlineHide,s=n.showAddressBook,c=n.usersFrom,l=this.state,u=l.dataSource,d=l.createUser;return t().createElement("div",{style:{position:"relative",overflow:"visible"},ref:function(t){e._popoverAnchor=t}},t().createElement(nm,{filter:g.AutoComplete.noFilter,dataSource:u,searchText:this.state.searchText,onUpdateInput:this.textFieldUpdate,className:o,openOnFocus:!0,floatingLabelText:i,floatingLabelFixed:!0,underlineShow:!a,fullWidth:!0,onNewRequest:this.onCompleterRequest,listStyle:{maxHeight:350,overflowY:"auto"},onFocus:function(){e.loadBuffered(e.state.searchText,100)},disabled:d,hintText:d?r.MessageHash[485]+" ("+d+")":null}),!d&&t().createElement("div",{style:{position:"absolute",right:s?44:10,bottom:14,height:20,width:20}},t().createElement(g.RefreshIndicator,{size:20,left:0,top:0,status:this.state.loading?"loading":"hide"})),!d&&s&&t().createElement(Hh,{mode:"popover",pydio:r,loaderStyle:{width:320,height:420},onItemSelected:this.onAddressBookItemSelected,usersFrom:c,disableSearch:!0}),t().createElement(rm,{open:d,anchorEl:this._popoverAnchor,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.onCreationCancelled,canAutoPosition:!1,style:this._popoverAnchor?{width:this._popoverAnchor.clientWidth}:{},zDepth:3},d&&t().createElement(df,{onUserCreated:this.onUserCreated.bind(this),onCancel:this.onCreationCancelled.bind(this),style:{width:"100%",height:320},newUserName:d,pydio:r})))}}])&&Kh(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function im(e){return im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},im(e)}function am(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?am(Object(n),!0).forEach((function(t){cm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):am(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==im(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==im(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===im(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Qh(om,"propTypes",{renderSuggestion:z().func.isRequired,onValueSelected:z().func.isRequired,fieldLabel:z().string.isRequired,excludes:z().array.isRequired,usersOnly:z().bool,usersFrom:z().oneOf(["local","remote","any"]),existingOnly:z().bool,freeValueAllowed:z().bool,className:z().string});var lm=q().requireLib("boot").M3Tooltip;const um=(0,$.muiThemeable)()((function(e){var n,r=e.size,o=void 0===r?24:r,i=e.idmObject,a=e.type,s=e.muiTheme,c=e.tooltip,l=void 0!==c&&c,u=e.style,d=void 0===u?{}:u,p=s.palette.avatarsColor,f=sm({borderRadius:"50%",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:17,height:o,width:o},d);if(n="group"===a?t().createElement("span",{className:"mdi mdi-account-multiple",style:sm(sm({},f),{},{backgroundColor:p})}):"team"===a?t().createElement("span",{className:"mdi mdi-account-multiple-outline",style:sm(sm({},f),{},{backgroundColor:p})}):"temporary"===a?t().createElement("span",{className:"mdi mdi-account-plus",style:sm(sm({},f),{},{backgroundColor:p})}):"remote_user"===a?t().createElement("span",{className:"mdi mdi-account-network",style:sm(sm({},f),{},{backgroundColor:p})}):"more"===a?t().createElement("span",{style:sm(sm({},f),{},{backgroundColor:p})},"+ ",i):t().createElement("div",{style:{zIndex:f.zIndex}},t().createElement(Qd,{avatarSize:o,pydio:q().getInstance(),userId:i.Login,avatarOnly:!0,idmUser:i,userType:"user",useDefaultAvatar:!0,richOnClick:!1,richOnHover:!1,style:sm({padding:0,lineHeight:"16px"},d)})),l){var h,m=q().getMessages();return h="more"===a?i>1?m["share_center.cell.participant.other.multiple"].replace("%d",i):m["share_center.cell.participant.other.single"]:yu().extractLabelFromIdmObject(i),t().createElement(lm,{PopperProps:{style:{zIndex:2200}},placement:"bottom",title:t().createElement("div",{style:{padding:"0 6px"}},h)},n)}return n}));function dm(e){return dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dm(e)}function pm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pm(Object(n),!0).forEach((function(t){hm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==dm(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==dm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===dm(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mm=function(e){var n=e.acls,r=e.max,o=void 0===r?6:r,i=e.size,a=void 0===i?32:i,s=e.onlines,c=void 0===s?void 0:s,l={border:"2px solid var(--md-sys-color-surface-variant)"},u=Object.keys(n).map((function(e,t){var r,o,i,a=fm({},l),s=n[e];if(s.User)r="user",o=s.User,void 0!==c&&(i=c&&c.indexOf&&c.indexOf(s.User.Login)>-1)&&(a.border="2px solid #4caf50");else if(s.Group)r="group",o=s.Group;else{if(!s.Role)return null;r="team",o=s.Role}return{type:r,object:o,style:a,online:i}})).filter((function(e){return null!==e}));if(void 0!==c&&u.sort((function(e,t){return e.online?-1:t.online?1:0})),u=u.map((function(e,t){return t>0&&(e.style=fm(fm({},e.style),{},{marginLeft:-10,zIndex:2*t})),e})),u.length>o){var d=u.length-o;(u=u.slice(0,o)).push({type:"more",object:d,style:fm(fm({},l),{},{marginLeft:-10,zIndex:16,fontWeight:500,fontSize:14})})}return t().createElement("div",{style:{display:"flex",height:a}},u.map((function(e){var n=e.type,r=e.object,o=e.style;return t().createElement(um,{size:a,type:n,idmObject:r,style:o,tooltip:!0})})))};function ym(e){return ym="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ym(e)}function bm(){return bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bm.apply(this,arguments)}function vm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vm(Object(n),!0).forEach((function(t){Pm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Em(r.key),r)}}function wm(e,t){return wm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wm(e,t)}function km(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Om(e){return Om=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Om(e)}function Pm(e,t,n){return(t=Em(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Em(e){var t=function(e,t){if("object"!==ym(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ym(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ym(t)?t:String(t)}var Cm=q().requireLib("hoc").ThemedContainers.Popover,Tm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wm(e,t)}(c,e);var n,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Om(i);if(a){var n=Om(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ym(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return km(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Pm(km(e=s.call.apply(s,[this].concat(n))),"state",{showMenu:!1}),Pm(km(e),"showMenu",(function(t){var n;n=t?t.currentTarget:e._buttonDOM,e.setState({showMenu:!0,anchor:n})})),Pm(km(e),"menuClicked",(function(t,n,r){e.setState({showMenu:!1})})),e}return n=c,o=[{key:"componentDidMount",value:function(){var e=this;this.props.openOnEvent&&this.props.pydio.observe(this.props.openOnEvent,(function(){e.showMenu()}))}},{key:"render",value:function(){var e,n=this,o=this.state,i=o.showMenu,a=o.anchor,s=t().createElement("span",{style:{whiteSpace:"nowrap"}},this.props.buttonTitle," ",t().createElement("span",{className:"mdi mdi-menu-down"})),c=this.props.buttonHoverColor||"rgba(255,255,255,0.2)",l={primary:this.props.primary,secondary:this.props.secondary,disabled:this.props.disabled,label:s,onClick:this.showMenu,labelStyle:gm({},this.props.buttonLabelStyle),style:this.props.buttonStyle,backgroundColor:i?c:this.props.buttonBackgroundColor,hoverColor:this.props.buttonHoverColor},u=this.props.menuItems;return u.length&&(e=this.props.raised?t().createElement(g.RaisedButton,bm({},l,{ref:function(e){n._buttonDOM=r().findDOMNode(e)}})):t().createElement(g.FlatButton,bm({},l,{ref:function(e){n._buttonDOM=r().findDOMNode(e)}}))),t().createElement("span",{id:this.props.id,className:this.props.className},e,t().createElement(Cm,{className:"menuPopover",open:i,anchorEl:a,anchorOrigin:{horizontal:this.props.direction||"left",vertical:"bottom"},targetOrigin:{horizontal:this.props.direction||"left",vertical:"top"},onRequestClose:function(){n.setState({showMenu:!1})},style:{marginTop:1},useLayerForClickAway:!1},Bn.itemsToMenu(u,this.menuClicked)))}}],o&&Sm(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),c}(t().Component);Pm(Tm,"propTypes",{buttonTitle:z().oneOfType([z().string,z().object]).isRequired,menuItems:z().array.isRequired,className:z().string,raised:z().bool,direction:z().oneOf(["left","right"])});const xm=Kn(Tm),jm=require("pydio/model/context-menu");var Rm=a.n(jm);function Im(e){return Im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Im(e)}function _m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Am(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_m(Object(n),!0).forEach((function(t){Um(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bm(r.key),r)}}function Dm(e,t){return Dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dm(e,t)}function Lm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nm(e){return Nm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nm(e)}function Um(e,t,n){return(t=Bm(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bm(e){var t=function(e,t){if("object"!==Im(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Im(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Im(t)?t:String(t)}var Fm=a(580),zm=a(66405),Wm=q().requireLib("hoc").ThemedContainers.Paper,qm=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dm(e,t)}(c,n);var r,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Nm(i);if(a){var n=Nm(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Im(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Lm(e)}(this,e)});function c(t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),Um(Lm(n=s.call(this,t)),"showMenu",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.setState({showMenu:!0,style:e,menuItems:t||n.state.menuItems})})),Um(Lm(n),"hideMenu",(function(e){if(!e)return n.setState({showMenu:!1}),void(n.props.onMenuClosed&&n.props.onMenuClosed());if(void 0===e||2!==e.button||"contextmenu"===e.type){var t=zm.findDOMNode(n.menuRef.current);t&&t.contains(e.target)||t===e.target||(n.setState({showMenu:!1}),n.props.onMenuClosed&&n.props.onMenuClosed())}})),Um(Lm(n),"menuClicked",(function(e,t,r){n.hideMenu()})),n.menuRef=(0,e.createRef)(),n.state={showMenu:!1,menuItems:t.menuItems},n}return r=c,(o=[{key:"componentDidMount",value:function(){this._observer=this.hideMenu.bind(this)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this._observer,!1)}},{key:"componentWillReceiveProps",value:function(e){e.menuItems&&this.setState({menuItems:e.menuItems})}},{key:"componentDidUpdate",value:function(e,t){this.state.showMenu?document.addEventListener("click",this._observer,!1):document.removeEventListener("click",this._observer,!1)}},{key:"render",value:function(){var e=this.props,n=e.menuProps,r=e.zDepth,o=void 0===r?1:r,i=this.state,a=i.style,s=void 0===a?{}:a,c=i.menuItems,l=Am(Am({},s),{},{zIndex:1e3}),u=Bn.itemsToMenu(c,this.menuClicked.bind(this),!1,Am({ref:this.menuRef,desktop:!0,display:"right",width:250},n));return this.state.showMenu?t().createElement(Wm,{zDepth:o||1,ref:"menuContainer",className:"menu-positioner",style:l},u):null}}])&&Mm(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(t().Component);function Hm(e){return Hm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hm(e)}function Zm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vm(r.key),r)}}function Vm(e){var t=function(e,t){if("object"!==Hm(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Hm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Hm(t)?t:String(t)}function Jm(e,t){return Jm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jm(e,t)}function Gm(e){return Gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gm(e)}Um(qm,"propTypes",{menuItems:Fm.array.isRequired,onExternalClickCheckElements:Fm.func,className:Fm.string,style:Fm.object,onMenuClosed:Fm.func});var Km=a(16689),$m=Km.Component,Ym=Km.createRef,Xm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jm(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Gm(r);if(o){var n=Gm(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Hm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).menu=Ym(),t}return t=a,n=[{key:"modelOpen",value:function(e){var t=Rm().getInstance().getPosition(),n=this.props.pydio;if(e){var r=n.getContextHolder();-1===r.getSelectedNodes().indexOf(e)?(n.observeOnce("actions_refreshed",function(e){this.openMenu("selectionContext",t)}.bind(this)),r.setSelectedNodes([e])):this.openMenu("selectionContext",t)}else this.openMenu("genericContext",t)}},{key:"openMenu",value:function(e,t){var n=this.computeMenuItems(e);this._items=n,this.props.pydio.UI.MOBILE_EXTENSIONS?this.menu.current.showMenu({bottom:0,left:0,right:0,height:200,zIndex:1e4,overflowY:"auto"},n):(t=this.computeVisiblePosition(t,n),this.menu.current.showMenu({top:t.y,left:t.x},n))}},{key:"computeMenuItems",value:function(e){var t=this.props.pydio.Controller.getContextActions(e,["inline","info_panel","info_panel_share"]);return Bn.pydioActionsToItems(t)}},{key:"computeVisiblePosition",value:function(e,t){var n=16;t.map((function(e){e.separator?n+=16:n+=32}));var r=Math.max(document.documentElement.clientWidth,window.innerWidth||0),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return e.x+250>r?e.x=Math.max(e.x-250,10)-8:e.x+=8,e.y+n>o?e.y=Math.max(e.y-n,10)-8:e.y+=8,e}},{key:"componentDidMount",value:function(){this._modelOpen=this.modelOpen.bind(this),Rm().getInstance().observe("open",this._modelOpen)}},{key:"componentWillUnmount",value:function(){Rm().getInstance().stopObserving("open",this._modelOpen)}},{key:"render",value:function(){var e=this.props.pydio.UI.MOBILE_EXTENSIONS;return React.createElement(qm,{ref:this.menu,menuItems:this._items||[],onMenuClosed:this.props.onMenuClosed,menuProps:e?{width:600,autoWidth:!1,desktop:!1}:{},zDepth:e?2:1})}}],n&&Zm(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}($m);function Qm(e){return Qm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qm(e)}function ey(){return ey=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ey.apply(this,arguments)}function ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ny(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ty(Object(n),!0).forEach((function(t){sy(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ty(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ry(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cy(r.key),r)}}function oy(e,t){return oy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oy(e,t)}function iy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ay(e){return ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ay(e)}function sy(e,t,n){return(t=cy(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cy(e){var t=function(e,t){if("object"!==Qm(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Qm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Qm(t)?t:String(t)}var ly=q().requireLib("hoc").ThemedContainers.Popover,uy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oy(e,t)}(c,e);var n,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ay(i);if(a){var n=ay(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Qm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return iy(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return sy(iy(e=s.call.apply(s,[this].concat(n))),"state",{showMenu:!1}),sy(iy(e),"showMenu",(function(t){var n;n=t?t.currentTarget:e._buttonDOM,e.setState({showMenu:!0,anchor:n})})),sy(iy(e),"menuClicked",(function(t,n,r){e.setState({showMenu:!1})})),e}return n=c,o=[{key:"componentDidMount",value:function(){var e=this;this.props.openOnEvent&&this.props.pydio.observe(this.props.openOnEvent,(function(){e.showMenu()}))}},{key:"render",value:function(){var e,n,o=this,i=this.props,a=i.id,s=i.masterAction,c=i.buttonTitle,l=i.primary,u=i.secondary,d=i.disabled,p=i.raised,f=i.menuItems,h=i.buttonStyle,m=i.buttonLabelStyle,y=i.className,b=i.direction,v=i.muiTheme,S=ny({},m),w=ny({},m);S.paddingRight?S.paddingRight/=Math.floor(3):S.paddingRight=8,w.paddingLeft?w.paddingLeft/=Math.floor(3):w.paddingLeft=8,w.paddingRight=w.paddingLeft;var k={primary:l,secondary:u,disabled:d,label:c,style:ny(ny({},h),{},{minWidth:60,borderRadius:"".concat(v.borderRadius,"px 0 0 ").concat(v.borderRadius,"px")}),labelStyle:S,onClick:s},O={primary:l,secondary:u,disabled:d,label:t().createElement("span",{className:"mdi mdi-menu-down"}),style:ny(ny({},h),{},{minWidth:16,borderRadius:"0 ".concat(v.borderRadius,"px ").concat(v.borderRadius,"px 0")}),labelStyle:w,onClick:this.showMenu},P=this.state,E=P.showMenu,C=P.anchor,T=P.over;f.length&&(p?(n=t().createElement(g.RaisedButton,ey({},O,{ref:function(e){o._buttonDOM=r().findDOMNode(e)}})),e=t().createElement(g.RaisedButton,k)):(n=t().createElement(g.FlatButton,ey({},O,{ref:function(e){o._buttonDOM=r().findDOMNode(e)}})),e=t().createElement(g.FlatButton,k)));var x={whiteSpace:"nowrap",borderRadius:v.borderRadius};return t().createElement("span",{id:a,className:y,onMouseOver:function(){o.setState({over:!0})},onMouseOut:function(){o.setState({over:!1})},style:T||E?ny({backgroundColor:"rgba(153, 153, 153, 0.2)"},x):x},e,n,t().createElement(ly,{className:"menuPopover",open:E,anchorEl:C,anchorOrigin:{horizontal:b||"left",vertical:"bottom"},targetOrigin:{horizontal:b||"left",vertical:"top"},onRequestClose:function(){o.setState({showMenu:!1})},style:{marginTop:1},useLayerForClickAway:!1},Bn.itemsToMenu(f,this.menuClicked)))}}],o&&ry(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),c}(t().Component);sy(uy,"propTypes",{buttonTitle:z().oneOfType([z().string,z().object]).isRequired,masterAction:z().func.isRequired,menuItems:z().array.isRequired,className:z().string,raised:z().bool,direction:z().oneOf(["left","right"])});const dy=Kn((0,$.muiThemeable)()(uy));function py(e){return py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},py(e)}function fy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hy(r.key),r)}}function hy(e){var t=function(e,t){if("object"!==py(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==py(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===py(t)?t:String(t)}function my(e,t){return my=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},my(e,t)}function yy(e){return yy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yy(e)}var by=a(580),vy=a(16689),gy=q().requireLib("hoc").ThemedContainers,Sy=gy.Popover,wy=gy.IconButton,ky=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&my(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yy(r);if(o){var n=yy(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===py(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).state={showPopover:!1},n}return t=a,(n=[{key:"showPopover",value:function(e){this.setState({showPopover:!0,anchor:e.currentTarget})}},{key:"render",value:function(){var e=this;return vy.createElement("span",{className:"toolbars-button-menu "+(this.props.className?this.props.className:"")},vy.createElement(wy,{ref:"menuButton",tooltip:this.props.buttonTitle,iconClassName:this.props.buttonClassName,onClick:this.showPopover.bind(this),iconStyle:this.props.buttonStyle}),vy.createElement(Sy,{open:this.state.showPopover,anchorEl:this.state.anchor,anchorOrigin:{horizontal:this.props.direction||"right",vertical:"bottom"},targetOrigin:{horizontal:this.props.direction||"right",vertical:"top"},onRequestClose:function(){e.setState({showPopover:!1})},useLayerForClickAway:!1},this.props.popoverContent))}}])&&fy(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(vy.Component);ky.propTypes={buttonTitle:by.string.isRequired,buttonClassName:by.string.isRequired,className:by.string,direction:by.oneOf(["right","left"]),popoverContent:by.object.isRequired};const Oy=ky;function Py(e){return Py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Py(e)}function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ey(Object(n),!0).forEach((function(t){Ty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ty(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Py(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Py(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Py(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xy(e){return function(e){if(Array.isArray(e))return jy(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return jy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jy(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ry=q().requireLib("hoc").ThemedContainers.IconButton;const Iy=B()({displayName:"Toolbar",propTypes:{toolbars:z().array,groupOtherList:z().array,renderingType:z().string,controller:z().instanceOf(Controller),toolbarStyle:z().object,buttonStyle:z().object,fabAction:z().string,buttonMenuNoLabel:z().bool},componentDidMount:function(){var e=function(){this.isMounted()&&this.setState({groups:this.props.controller.getToolbarsActions(this.props.toolbars,this.props.groupOtherList)})}.bind(this);this._observer=(0,Fn.debounce)(e,50),this.props.controller===pydio.Controller?pydio.observe("actions_refreshed",this._observer):this.props.controller.observe("actions_refreshed",this._observer)},componentWillUnmount:function(){this.props.controller===pydio.Controller?pydio.stopObserving("actions_refreshed",this._observer):this.props.controller.stopObserving("actions_refreshed",this._observer)},componentWillReceiveProps:function(e){e.toolbars!==this.props.toolbars&&this.setState({groups:this.props.controller.getToolbarsActions(e.toolbars,e.groupOtherList)})},getInitialState:function(){return{groups:this.props.controller.getToolbarsActions(this.props.toolbars,this.props.groupOtherList)}},getDefaultProps:function(){return{controller:a.g.pydio.Controller,renderingType:"button",groupOtherList:[]}},render:function(){var e=this.state.groups,n=[],r=this.props,o=r.toolbars,i=r.renderingType,a=r.groupOtherList,s=r.buttonStyle,c=r.mergeItemsAsOneMenu,l=r.tooltipPosition,u=r.controller,d=r.fabAction,p=r.fabButtonStyle,f=void 0===p?{}:p,h=r.toolbarStyle,m=r.buttonMenuNoLabel,y=r.buttonMenuPopoverDirection,b=r.flatButtonStyle,v=xy(o);a.length&&(v=v.concat(["MORE_ACTION"]));var S=!1,w=[];if(v.map((function(r){e.has(r)&&e.get(r).map((function(e){if(!e.deny){var o,a,p,h,v,k=e.options.name;if(p=pydio.MessageHash[e.options.text_id]||e.options.text,h=e.options.icon_class,"MORE_ACTION"===r){var O=e.subMenuItems.dynamicItems,P=[];O.map((function(e){e.separator?P.push(e):e.actionId&&!e.actionId.deny&&P.push(e.actionId.getMenuData())})),o=Bn.pydioActionsToItems(P),h="mdi mdi-dots-vertical"}else e.subMenuItems.staticItems?o=Bn.pydioActionsToItems(e.subMenuItems.staticItems):e.subMenuItems.dynamicBuilder?o=Bn.pydioActionsToItems(e.subMenuItems.dynamicBuilder(u)):e.subMenuItems.popoverContent&&(a=e.subMenuItems.popoverContent);if(o&&e.subMenuItems.masterAction){var E=u.getActionByName(e.subMenuItems.masterAction);E&&!E.deny&&(v=function(){E.apply()})}if(c&&void 0!==o)w=[].concat(xy(w),[{subHeader:p}],xy(o),[{separator:!0}]);else{var C="action-"+e.options.name;if("button-icon"===i&&(p=t().createElement("span",{className:"button-icon"},t().createElement("span",{className:"button-icon-icon "+h}),t().createElement("span",{className:"button-icon-label"},p))),o)"button"===i||"button-icon"===i?v?n.push(t().createElement(dy,{key:k,className:C,buttonTitle:p,menuItems:o,masterAction:v,buttonStyle:b,buttonLabelStyle:s,direction:y})):n.push(t().createElement(xm,{key:k,className:C,buttonTitle:m?"":p,menuItems:o,buttonStyle:b,buttonLabelStyle:s,direction:y})):n.push(t().createElement(ar,{key:k,className:C,onMenuClicked:function(e){e.payload()},buttonClassName:h,buttonTitle:p,menuItems:o,buttonStyle:s,style:b,popoverDirection:y}));else if(a)n.push(t().createElement(Oy,{key:k,className:C,buttonClassName:h,buttonTitle:p,buttonStyle:s,popoverContent:a}));else{var T=function(){e.apply()};d&&d===k?(S=!0,n.push(t().createElement(g.FloatingActionButton,{key:k,onClick:T,iconClassName:h,mini:!0,backgroundColor:f.backgroundColor,iconStyle:f.color?{color:f.color}:null,style:{position:"absolute",top:-20,left:10}}))):"button-icon"===i||"button"===i?n.push(t().createElement(g.FlatButton,{key:k,className:C,onClick:T,label:p,labelStyle:s,style:b})):n.push(t().createElement(Ry,{key:k,iconClassName:h+" "+C,iconStyle:s,style:b,onClick:T,tooltip:p,tooltipPosition:l}))}}}}))})),c&&w.length){w.pop();var k=this.props,O=k.mergedMenuIcom,P=k.mergedMenuTitle;n.push(t().createElement(ar,{key:o.join("-"),className:"toolbar-"+o.join("-"),onMenuClicked:function(e){e.payload()},buttonClassName:O,buttonTitle:P,menuItems:w,buttonStyle:s,style:b,popoverDirection:y}))}var E=this.props.className?this.props.className:"";E+=" toolbar",n.length||(E+=" empty-toolbar");var C=Cy({},h);return S&&(C=Cy(Cy({},h),{},{minHeight:41})),t().createElement("div",{className:E,style:C,id:this.props.id},n)}});var _y=a(7522),Ay=a(1267),My=a(44305),Dy=a(1697);function Ly(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ny=["sx"],Uy=function(e){var t,n,r={systemProps:{},otherProps:{}},o=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:Dy.Z;return Object.keys(e).forEach((function(t){o[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r},By=a(74099),Fy=["className","component"],zy=a(21142),Wy=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.defaultTheme,r=t.defaultClassName,o=void 0===r?"MuiBox-root":r,i=t.generateClassName,a=(0,_y.ZP)("div",{shouldForwardProp:function(e){return"theme"!==e&&"sx"!==e&&"as"!==e}})(Ay.Z),s=e.forwardRef((function(e,t){var r=(0,By.Z)(n),s=function(e){var t,n,r=e.sx,o=(0,ge.Z)(e,Ny),i=Uy(o),a=i.systemProps,s=i.otherProps;return t=Array.isArray(r)?[a].concat(function(e){if(Array.isArray(e))return Ly(e)}(n=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Ly(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ly(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):"function"==typeof r?function(){var e=r.apply(void 0,arguments);return(0,My.P)(e)?(0,ve.Z)({},a,e):a}:(0,ve.Z)({},a,r),(0,ve.Z)({},s,{sx:t})}(e),c=s.className,l=s.component,u=void 0===l?"div":l,d=(0,ge.Z)(s,Fy);return(0,Bt.jsx)(a,(0,ve.Z)({as:u,ref:t,className:(0,Vt.Z)(c,i?i(o):o),theme:r},d))}));return s}({defaultTheme:(0,a(82013).Z)(),defaultClassName:"MuiBox-root",generateClassName:zy.Z.generate});const qy=Wy;var Hy=a(15785);function Zy(){return(0,By.Z)(Hy.Z)}function Vy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r={};return Object.keys(e).forEach((function(o){r[o]=e[o].reduce((function(e,r){if(r){var o=t(r);""!==o&&e.push(o),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}var Jy=a(9118),Gy=a(44880),Ky=a(90678),$y=a(92466);const Yy=e.createContext({});var Xy=a(43547);function Qy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eb(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tb=["element"],nb=e.createContext({}),rb=function(){};function ob(t){var n=t.children,r=t.id,o=Qy(e.useState([]),2),i=o[0],a=o[1],s=e.useCallback((function(e){var t=e.element,n=(0,ge.Z)(e,tb);a((function(e){var r;if(0===e.length)return[(0,ve.Z)({},n,{element:t,index:0})];var o=function(e,t){for(var n=0,r=e.length-1;n<=r;){var o=Math.floor((n+r)/2);if(e[o].element===t)return o;e[o].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?r=o-1:n=o+1}return n}(e,t);if(e[o]&&e[o].element===t)r=e;else{var i=(0,ve.Z)({},n,{element:t,index:o});(r=e.slice()).splice(o,0,i)}return r.forEach((function(e,t){e.index=t})),r}))}),[]),c=e.useCallback((function(e){a((function(t){return t.filter((function(t){return e!==t.element}))}))}),[]),l=e.useMemo((function(){return{descendants:i,registerDescendant:s,unregisterDescendant:c,parentId:r}}),[i,s,c,r]);return(0,Bt.jsx)(nb.Provider,{value:l,children:n})}function ib(e){return(0,Wt.Z)("MuiTreeView",e)}function ab(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return sb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sb(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,qt.Z)("MuiTreeView",["root"]);var cb=["children","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disabledItemsFocusable","disableSelection","expanded","id","multiSelect","onBlur","onFocus","onKeyDown","onNodeFocus","onNodeSelect","onNodeToggle","selected"],lb=(0,an.ZP)("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:function(e,t){return t.root}})({padding:0,margin:0,listStyle:"none",outline:0});function ub(e,t,n){for(var r=t;r<e.length;r+=1)if(n===e[r])return r;return-1}function db(){return!1}var pb=[],fb=[],hb=e.forwardRef((function(t,n){var r=(0,sn.Z)({props:t,name:"MuiTreeView"}),o=r.children,i=r.className,a=r.defaultCollapseIcon,s=r.defaultEndIcon,c=r.defaultExpanded,l=void 0===c?pb:c,u=r.defaultExpandIcon,d=r.defaultParentIcon,p=r.defaultSelected,f=void 0===p?fb:p,h=r.disabledItemsFocusable,m=void 0!==h&&h,y=r.disableSelection,b=void 0!==y&&y,v=r.expanded,g=r.id,S=r.multiSelect,w=void 0!==S&&S,k=r.onBlur,O=r.onFocus,P=r.onKeyDown,E=r.onNodeFocus,C=r.onNodeSelect,T=r.onNodeToggle,x=r.selected,j=(0,ge.Z)(r,cb),R="rtl"===Zy().direction,I=(0,ve.Z)({},r,{defaultExpanded:l,defaultSelected:f,disabledItemsFocusable:m,disableSelection:b,multiSelect:w}),_=function(e){return Vy({root:["root"]},ib,e.classes)}(I),A=(0,Jy.Z)(g),M=e.useRef(null),D=(0,Gy.Z)(M,n),L=ab(e.useState(null),2),N=L[0],U=L[1],B=e.useRef({}),F=e.useRef({}),z=ab((0,Ky.Z)({controlled:v,default:l,name:"TreeView",state:"expanded"}),2),W=z[0],q=z[1],H=ab((0,Ky.Z)({controlled:x,default:f,name:"TreeView",state:"selected"}),2),Z=H[0],V=H[1],J=e.useCallback((function(e){return!!Array.isArray(W)&&-1!==W.indexOf(e)}),[W]),G=e.useCallback((function(e){return B.current[e]&&B.current[e].expandable}),[]),K=e.useCallback((function(e){return Array.isArray(Z)?-1!==Z.indexOf(e):Z===e}),[Z]),$=e.useCallback((function(e){var t=B.current[e];if(!t)return!1;if(t.disabled)return!0;for(;null!=t.parentId;)if((t=B.current[t.parentId]).disabled)return!0;return!1}),[]),Y=function(e){return Object.keys(B.current).map((function(e){return B.current[e]})).filter((function(t){return t.parentId===e})).sort((function(e,t){return e.index-t.index})).map((function(e){return e.id}))},X=function(e){var t=Y(e);return m||(t=t.filter((function(e){return!$(e)}))),t},Q=function(e){if(J(e)&&X(e).length>0)return X(e)[0];for(var t=B.current[e];null!=t;){var n=X(t.parentId),r=n[n.indexOf(t.id)+1];if(r)return r;t=B.current[t.parentId]}return null},ee=function(e){var t=B.current[e],n=X(t.parentId),r=n.indexOf(e);if(0===r)return t.parentId;for(var o=n[r-1];J(o)&&X(o).length>0;)o=X(o).pop();return o},te=function(){for(var e=X(null).pop();J(e);)e=X(e).pop();return e},ne=function(){return X(null)[0]},re=function(e,t){t&&(U(t),E&&E(e,t))},oe=function(e,t){return re(e,Q(t))},ie=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N;t=-1!==W.indexOf(n)?W.filter((function(e){return e!==n})):[n].concat(W),T&&T(e,t),q(t)},ae=e.useRef(null),se=e.useRef(!1),ce=e.useRef([]),le=function(e,t){var n=Z.slice(),r=t.start,o=t.next,i=t.current;o&&i&&(-1===ce.current.indexOf(i)&&(ce.current=[]),se.current?-1!==ce.current.indexOf(o)?(n=n.filter((function(e){return e===r||e!==i})),ce.current=ce.current.filter((function(e){return e===r||e!==i}))):(n.push(o),ce.current.push(o)):(n.push(o),ce.current.push(i,o)),C&&C(e,n),V(n))},ue=function(e,t){var n=Z.slice(),r=t.start,o=t.end;se.current&&(n=n.filter((function(e){return-1===ce.current.indexOf(e)})));var i=function(e,t){for(var n=function(e,t){if(e===t)return[e,t];var n=B.current[e],r=B.current[t];if(n.parentId===r.id||r.parentId===n.id)return r.parentId===n.id?[n.id,r.id]:[r.id,n.id];for(var o=[n.id],i=[r.id],a=n.parentId,s=r.parentId,c=-1!==i.indexOf(a),l=-1!==o.indexOf(s),u=!0,d=!0;!l&&!c;)u&&(o.push(a),u=null!==a,!(c=-1!==i.indexOf(a))&&u&&(a=B.current[a].parentId)),d&&!c&&(i.push(s),d=null!==s,!(l=-1!==o.indexOf(s))&&d&&(s=B.current[s].parentId));var p=c?a:s,f=Y(p),h=o[o.indexOf(p)-1],m=i[i.indexOf(p)-1];return f.indexOf(h)<f.indexOf(m)?[e,t]:[t,e]}(e,t),r=ab(n,2),o=r[0],i=r[1],a=[o],s=o;s!==i;)s=Q(s),a.push(s);return a}(r,o);i=i.filter((function(e){return!$(e)})),ce.current=i;var a=n.concat(i);a=a.filter((function(e,t){return a.indexOf(e)===t})),C&&C(e,a),V(a)},de=function(e,t){var n;n=-1!==Z.indexOf(t)?Z.filter((function(e){return e!==t})):[t].concat(Z),C&&C(e,n),V(n)},pe=function(e,t){var n=w?[t]:t;C&&C(e,n),V(n)},fe=function(e,t){return!!t&&(arguments.length>2&&void 0!==arguments[2]&&arguments[2]?de(e,t):pe(e,t),ae.current=t,se.current=!1,ce.current=[],!0)},he=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.start,o=void 0===r?ae.current:r,i=t.end,a=t.current;n?le(e,{start:o,next:i,current:a}):null!=o&&null!=i&&ue(e,{start:o,end:i}),se.current=!0},me=e.useCallback((function(e){var t=e.id,n=e.index,r=e.parentId,o=e.expandable,i=e.idAttribute,a=e.disabled;B.current[t]={id:t,index:n,parentId:r,expandable:o,idAttribute:i,disabled:a}}),[]),ye=e.useCallback((function(e){var t=(0,ve.Z)({},B.current);delete t[e],B.current=t,U((function(t){return t===e&&M.current===(0,$y.Z)(M.current).activeElement?Y(null)[0]:t}))}),[]),be=e.useCallback((function(e,t){F.current[e]=t}),[]),Se=e.useCallback((function(e){var t=(0,ve.Z)({},F.current);delete t[e],F.current=t}),[]),we=function(e){return G(N)&&(J(N)?oe(e,N):$(N)||ie(e)),!0},ke=function(e){if(J(N)&&!$(N))return ie(e,N),!0;var t,n=(t=N,B.current[t].parentId);return!!n&&(re(e,n),!0)},Oe=B.current[N]?B.current[N].idAttribute:null;return(0,Bt.jsx)(Yy.Provider,{value:{icons:{defaultCollapseIcon:a,defaultExpandIcon:u,defaultParentIcon:d,defaultEndIcon:s},focus:re,toggleExpansion:ie,isExpanded:J,isExpandable:G,isFocused:function(e){return N===e},isSelected:K,isDisabled:$,selectNode:b?db:fe,selectRange:b?db:he,multiSelect:w,disabledItemsFocusable:m,mapFirstChar:be,unMapFirstChar:Se,registerNode:me,unregisterNode:ye,treeId:A},children:(0,Bt.jsx)(ob,{children:(0,Bt.jsx)(lb,(0,ve.Z)({role:"tree",id:A,"aria-activedescendant":Oe,"aria-multiselectable":w,className:(0,Vt.Z)(_.root,i),ref:D,tabIndex:0,onKeyDown:function(e){var t=!1,n=e.key;if(!e.altKey&&e.currentTarget===e.target&&N){var r,o=e.ctrlKey||e.metaKey;switch(n){case" ":b||$(N)||(w&&e.shiftKey?(he(e,{end:N}),t=!0):t=w?fe(e,N,!0):fe(e,N)),e.stopPropagation();break;case"Enter":$(N)||(G(N)?(ie(e),t=!0):t=w?fe(e,N,!0):fe(e,N)),e.stopPropagation();break;case"ArrowDown":w&&e.shiftKey&&!b&&function(e,t){$(Q(t))||he(e,{end:Q(t),current:t},!0)}(e,N),oe(e,N),t=!0;break;case"ArrowUp":w&&e.shiftKey&&!b&&function(e,t){$(ee(t))||he(e,{end:ee(t),current:t},!0)}(e,N),function(e,t){re(e,ee(t))}(e,N),t=!0;break;case"ArrowRight":t=R?ke(e):we(e);break;case"ArrowLeft":t=R?we(e):ke(e);break;case"Home":w&&o&&e.shiftKey&&!b&&!$(N)&&function(e,t){ae.current||(ae.current=t);var n=se.current?ae.current:t;he(e,{start:n,end:ne()})}(e,N),function(e){re(e,ne())}(e),t=!0;break;case"End":w&&o&&e.shiftKey&&!b&&!$(N)&&function(e,t){ae.current||(ae.current=t);var n=se.current?ae.current:t;he(e,{start:n,end:te()})}(e,N),function(e){re(e,te())}(e),t=!0;break;default:"*"===n?(function(e,t){var n=B.current[t],r=Y(n.parentId).filter((function(e){return G(e)&&!J(e)})),o=W.concat(r);r.length>0&&(q(o),T&&T(e,o))}(e,N),t=!0):w&&o&&"a"===n.toLowerCase()&&!b?(function(e){he(e,{start:ne(),end:te()})}(e),t=!0):!o&&!e.shiftKey&&(r=n)&&1===r.length&&r.match(/\S/)&&(function(e,t,n){var r,o,i=n.toLowerCase(),a=[],s=[];Object.keys(F.current).forEach((function(e){var t=F.current[e],n=B.current[e],r=!n.parentId||J(n.parentId),o=!m&&$(e);r&&!o&&(a.push(e),s.push(t))})),(r=a.indexOf(t)+1)>=a.length&&(r=0),-1===(o=ub(s,r,i))&&(o=ub(s,0,i)),o>-1&&re(e,a[o])}(e,N,n),t=!0)}t&&(e.preventDefault(),e.stopPropagation()),P&&P(e)}},onFocus:function(e){if(e.target===e.currentTarget){var t=Array.isArray(Z)?Z[0]:Z;re(e,t||X(null)[0])}O&&O(e)},onBlur:function(e){U(null),k&&k(e)},ownerState:I},j,{children:o}))})})}));const mb=hb;function yb(e,t){return yb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yb(e,t)}const bb=t().createContext(null);var vb="unmounted",gb="exited",Sb="entering",wb="entered",kb="exiting",Ob=function(e){var n,o;function i(t,n){var r;r=e.call(this,t,n)||this;var o,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(o=gb,r.appearStatus=Sb):o=wb:o=t.unmountOnExit||t.mountOnEnter?vb:gb,r.state={status:o},r.nextCallback=null,r}o=e,(n=i).prototype=Object.create(o.prototype),n.prototype.constructor=n,yb(n,o),i.getDerivedStateFromProps=function(e,t){return e.in&&t.status===vb?{status:gb}:null};var a=i.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Sb&&n!==wb&&(t=Sb):n!==Sb&&n!==wb||(t=kb)}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},a.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Sb){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:r().findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===gb&&this.setState({status:vb})},a.performEnter=function(e){var t=this,n=this.props.enter,o=this.context?this.context.isMounting:e,i=this.props.nodeRef?[o]:[r().findDOMNode(this),o],a=i[0],s=i[1],c=this.getTimeouts(),l=o?c.appear:c.enter;e||n?(this.props.onEnter(a,s),this.safeSetState({status:Sb},(function(){t.props.onEntering(a,s),t.onTransitionEnd(l,(function(){t.safeSetState({status:wb},(function(){t.props.onEntered(a,s)}))}))}))):this.safeSetState({status:wb},(function(){t.props.onEntered(a)}))},a.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),o=this.props.nodeRef?void 0:r().findDOMNode(this);t?(this.props.onExit(o),this.safeSetState({status:kb},(function(){e.props.onExiting(o),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:gb},(function(){e.props.onExited(o)}))}))}))):this.safeSetState({status:gb},(function(){e.props.onExited(o)}))},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},a.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},a.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:r().findDOMNode(this),o=null==e&&!this.props.addEndListener;if(n&&!o){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=i[0],s=i[1];this.props.addEndListener(a,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},a.render=function(){var e=this.state.status;if(e===vb)return null;var n=this.props,r=n.children,o=(n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef,(0,ge.Z)(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t().createElement(bb.Provider,{value:null},"function"==typeof r?r(e,o):t().cloneElement(t().Children.only(r),o))},i}(t().Component);function Pb(){}Ob.contextType=bb,Ob.propTypes={},Ob.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Pb,onEntering:Pb,onEntered:Pb,onExit:Pb,onExiting:Pb,onExited:Pb},Ob.UNMOUNTED=vb,Ob.EXITED=gb,Ob.ENTERING=Sb,Ob.ENTERED=wb,Ob.EXITING=kb;const Eb=Ob;var Cb=a(5197);function Tb(e){return Tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tb(e)}function xb(e,t){var n,r,o=e.timeout,i=e.easing,a=e.style,s=void 0===a?{}:a;return{duration:null!=(n=s.transitionDuration)?n:"number"==typeof o?o:o[t.mode]||0,easing:null!=(r=s.transitionTimingFunction)?r:"object"===Tb(i)?i[t.mode]:i,delay:s.transitionDelay}}function jb(e){return(0,Wt.Z)("MuiCollapse",e)}function Rb(e){return Rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rb(e)}function Ib(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Rb(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Rb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rb(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,qt.Z)("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);var _b=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],Ab=(0,an.ZP)("div",{name:"MuiCollapse",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.orientation],"entered"===n.state&&t.entered,"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&t.hidden]}})((function(e){var t=e.theme,n=e.ownerState;return(0,ye.Z)({height:0,overflow:"hidden",transition:t.transitions.create("height")},"horizontal"===n.orientation&&{height:"auto",width:0,transition:t.transitions.create("width")},"entered"===n.state&&(0,ye.Z)({height:"auto",overflow:"visible"},"horizontal"===n.orientation&&{width:"auto"}),"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&{visibility:"hidden"})})),Mb=(0,an.ZP)("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:function(e,t){return t.wrapper}})((function(e){var t=e.ownerState;return(0,ye.Z)({display:"flex",width:"100%"},"horizontal"===t.orientation&&{width:"auto",height:"100%"})})),Db=(0,an.ZP)("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:function(e,t){return t.wrapperInner}})((function(e){var t=e.ownerState;return(0,ye.Z)({width:"100%"},"horizontal"===t.orientation&&{width:"auto",height:"100%"})})),Lb=e.forwardRef((function(t,n){var r=(0,sn.Z)({props:t,name:"MuiCollapse"}),o=r.addEndListener,i=r.children,a=r.className,s=r.collapsedSize,c=void 0===s?"0px":s,l=r.component,u=r.easing,d=r.in,p=r.onEnter,f=r.onEntered,h=r.onEntering,m=r.onExit,y=r.onExited,b=r.onExiting,v=r.orientation,g=void 0===v?"vertical":v,S=r.style,w=r.timeout,k=void 0===w?Cb.x9.standard:w,O=r.TransitionComponent,P=void 0===O?Eb:O,E=(0,be.Z)(r,_b),C=(0,ye.Z)({},r,{orientation:g,collapsedSize:c}),T=function(e){var t=e.orientation,n=e.classes,r={root:["root","".concat(t)],entered:["entered"],hidden:["hidden"],wrapper:["wrapper","".concat(t)],wrapperInner:["wrapperInner","".concat(t)]};return(0,Nt.Z)(r,jb,n)}(C),x=Zy(),j=e.useRef(),R=e.useRef(null),I=e.useRef(),_="number"==typeof c?"".concat(c,"px"):c,A="horizontal"===g,M=A?"width":"height";e.useEffect((function(){return function(){clearTimeout(j.current)}}),[]);var D=e.useRef(null),L=(0,Gy.Z)(n,D),N=function(e){return function(t){if(e){var n=D.current;void 0===t?e(n):e(n,t)}}},U=function(){return R.current?R.current[A?"clientWidth":"clientHeight"]:0},B=N((function(e,t){R.current&&A&&(R.current.style.position="absolute"),e.style[M]=_,p&&p(e,t)})),F=N((function(e,t){var n=U();R.current&&A&&(R.current.style.position="");var r=xb({style:S,timeout:k,easing:u},{mode:"enter"}),o=r.duration,i=r.easing;if("auto"===k){var a=x.transitions.getAutoHeightDuration(n);e.style.transitionDuration="".concat(a,"ms"),I.current=a}else e.style.transitionDuration="string"==typeof o?o:"".concat(o,"ms");e.style[M]="".concat(n,"px"),e.style.transitionTimingFunction=i,h&&h(e,t)})),z=N((function(e,t){e.style[M]="auto",f&&f(e,t)})),W=N((function(e){e.style[M]="".concat(U(),"px"),m&&m(e)})),q=N(y),H=N((function(e){var t=U(),n=xb({style:S,timeout:k,easing:u},{mode:"exit"}),r=n.duration,o=n.easing;if("auto"===k){var i=x.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(i,"ms"),I.current=i}else e.style.transitionDuration="string"==typeof r?r:"".concat(r,"ms");e.style[M]=_,e.style.transitionTimingFunction=o,b&&b(e)}));return(0,Bt.jsx)(P,(0,ye.Z)({in:d,onEnter:B,onEntered:z,onEntering:F,onExit:W,onExited:q,onExiting:H,addEndListener:function(e){"auto"===k&&(j.current=setTimeout(e,I.current||0)),o&&o(D.current,e)},nodeRef:D,timeout:"auto"===k?null:k},E,{children:function(e,t){return(0,Bt.jsx)(Ab,(0,ye.Z)({as:l,className:(0,Vt.Z)(T.root,a,{entered:T.entered,exited:!d&&"0px"===_&&T.hidden}[e]),style:(0,ye.Z)(Ib({},A?"minWidth":"minHeight",_),S),ownerState:(0,ye.Z)({},C,{state:e}),ref:L},t,{children:(0,Bt.jsx)(Mb,{ownerState:(0,ye.Z)({},C,{state:e}),className:T.wrapper,ref:R,children:(0,Bt.jsx)(Db,{ownerState:(0,ye.Z)({},C,{state:e}),className:T.wrapperInner,children:i})})}))}}))}));Lb.muiSupportAuto=!0;const Nb=Lb;var Ub=a(83026),Bb=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"];const Fb=e.forwardRef((function(t,n){var r=t.classes,o=t.className,i=t.displayIcon,a=t.expansionIcon,s=t.icon,c=t.label,l=t.nodeId,u=t.onClick,d=t.onMouseDown,p=(0,ge.Z)(t,Bb),f=function(t){var n=e.useContext(Yy),r=n.focus,o=n.isExpanded,i=n.isExpandable,a=n.isFocused,s=n.isDisabled,c=n.isSelected,l=n.multiSelect,u=n.selectNode,d=n.selectRange,p=n.toggleExpansion,f=!!i&&i(t),h=!!o&&o(t),m=!!a&&a(t),y=!!s&&s(t),b=!!c&&c(t);return{disabled:y,expanded:h,selected:b,focused:m,handleExpansion:function(e){if(!y){m||r(e,t);var n=l&&(e.shiftKey||e.ctrlKey||e.metaKey);!f||n&&o(t)||p(e,t)}},handleSelection:function(e){y||(m||r(e,t),l&&(e.shiftKey||e.ctrlKey||e.metaKey)?e.shiftKey?d(e,{end:t}):u(e,t,!0):u(e,t))},preventSelection:function(e){(e.shiftKey||e.ctrlKey||e.metaKey||y)&&e.preventDefault()}}}(l),h=f.disabled,m=f.expanded,y=f.selected,b=f.focused,v=f.handleExpansion,g=f.handleSelection,S=f.preventSelection,w=s||a||i;return(0,Bt.jsxs)("div",(0,ve.Z)({className:(0,Vt.Z)(o,r.root,m&&r.expanded,y&&r.selected,b&&r.focused,h&&r.disabled),onClick:function(e){v(e),g(e),u&&u(e)},onMouseDown:function(e){S(e),d&&d(e)},ref:n},p,{children:[(0,Bt.jsx)("div",{className:r.iconContainer,children:w}),(0,Bt.jsx)("div",{className:r.label,children:c})]}))}));function zb(e){return(0,Wt.Z)("MuiTreeItem",e)}const Wb=(0,qt.Z)("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]);function qb(e){return qb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qb(e)}function Hb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==qb(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qb(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vb=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],Jb=(0,an.ZP)("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:function(e,t){return t.root}})({listStyle:"none",margin:0,padding:0,outline:0}),Gb=(0,an.ZP)(Fb,{name:"MuiTreeItem",slot:"Content",overridesResolver:function(e,t){return[t.content,t.iconContainer&&Zb({},"& .".concat(Wb.iconContainer),t.iconContainer),t.label&&Zb({},"& .".concat(Wb.label),t.label)]}})((function(e){var t,n=e.theme;return Zb(t={padding:"0 8px",width:"100%",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},"&.".concat(Wb.disabled),{opacity:(n.vars||n).palette.action.disabledOpacity,backgroundColor:"transparent"}),Zb(t,"&.".concat(Wb.focused),{backgroundColor:(n.vars||n).palette.action.focus}),Zb(t,"&.".concat(Wb.selected),Zb({backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / ").concat(n.vars.palette.action.selectedOpacity,")"):(0,Ub.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / calc(").concat(n.vars.palette.action.selectedOpacity," + ").concat(n.vars.palette.action.hoverOpacity,"))"):(0,Ub.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / ").concat(n.vars.palette.action.selectedOpacity,")"):(0,Ub.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity)}}},"&.".concat(Wb.focused),{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.primary.mainChannel," / calc(").concat(n.vars.palette.action.selectedOpacity," + ").concat(n.vars.palette.action.focusOpacity,"))"):(0,Ub.Fq)(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)})),Zb(t,"& .".concat(Wb.iconContainer),{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}}),Zb(t,"& .".concat(Wb.label),(0,ve.Z)({width:"100%",minWidth:0,paddingLeft:4,position:"relative"},n.typography.body1)),t})),Kb=(0,an.ZP)(Nb,{name:"MuiTreeItem",slot:"Group",overridesResolver:function(e,t){return t.group}})({margin:0,padding:0,marginLeft:17}),$b=e.forwardRef((function(t,n){var r=(0,sn.Z)({props:t,name:"MuiTreeItem"}),o=r.children,i=r.className,a=r.collapseIcon,s=r.ContentComponent,c=void 0===s?Fb:s,l=r.ContentProps,u=r.endIcon,d=r.expandIcon,p=r.disabled,f=r.icon,h=r.id,m=r.label,y=r.nodeId,b=r.onClick,v=r.onMouseDown,g=r.TransitionComponent,S=void 0===g?Nb:g,w=r.TransitionProps,k=(0,ge.Z)(r,Vb),O=e.useContext(Yy),P=O.icons,E=void 0===P?{}:P,C=O.focus,T=O.isExpanded,x=O.isFocused,j=O.isSelected,R=O.isDisabled,I=O.multiSelect,_=O.disabledItemsFocusable,A=O.mapFirstChar,M=O.unMapFirstChar,D=O.registerNode,L=O.unregisterNode,N=O.treeId,U=null;null!=h?U=h:N&&y&&(U="".concat(N,"-").concat(y));var B,F,z,W=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Hb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hb(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.useState(null),2),q=W[0],H=W[1],Z=e.useRef(null),V=(0,Gy.Z)(H,n),J=function(t){var n=Qy(e.useState(),2)[1],r=e.useContext(nb),o=r.registerDescendant,i=void 0===o?rb:o,a=r.unregisterDescendant,s=void 0===a?rb:a,c=r.descendants,l=void 0===c?[]:c,u=r.parentId,d=void 0===u?null:u,p=function(e,n){for(var r=0;r<e.length;r+=1)if(e[r].element===t.element)return r;return-1}(l),f=function(t){var n=e.useRef(null);return e.useEffect((function(){n.current=t}),[t]),n.current}(l),h=l.some((function(e,t){return f&&f[t]&&f[t].element!==e.element}));return(0,Xy.Z)((function(){if(t.element)return i((0,ve.Z)({},t,{index:p})),function(){s(t.element)};n({})}),[i,s,p,h,t]),{parentId:d,index:p}}(e.useMemo((function(){return{element:q,id:y}}),[y,q])),G=J.index,K=J.parentId,$=Boolean(Array.isArray(o)?o.length:o),Y=!!T&&T(y),X=!!x&&x(y),Q=!!j&&j(y),ee=!!R&&R(y),te=(0,ve.Z)({},r,{expanded:Y,focused:X,selected:Q,disabled:ee}),ne=function(e){return Vy({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},zb,e.classes)}(te);return $&&(F=Y?a||E.defaultCollapseIcon:d||E.defaultExpandIcon),B=$?E.defaultParentIcon:u||E.defaultEndIcon,e.useEffect((function(){if(D&&L&&-1!==G)return D({id:y,idAttribute:U,index:G,parentId:K,expandable:$,disabled:p}),function(){L(y)}}),[D,L,K,G,y,$,p,U]),e.useEffect((function(){if(A&&M&&m)return A(y,Z.current.textContent.substring(0,1).toLowerCase()),function(){M(y)}}),[A,M,y,m]),I?z=Q:Q&&(z=!0),(0,Bt.jsxs)(Jb,(0,ve.Z)({className:(0,Vt.Z)(ne.root,i),role:"treeitem","aria-expanded":$?Y:null,"aria-selected":z,"aria-disabled":ee||null,ref:V,id:U,tabIndex:-1},k,{ownerState:te,onFocus:function(e){e.target===e.currentTarget&&("function"==typeof e.target.getRootNode?e.target.getRootNode():(0,$y.Z)(e.target)).getElementById(N).focus({preventScroll:!0});var t=!_&&ee;X||e.currentTarget!==e.target||t||C(e,y)},children:[(0,Bt.jsx)(Gb,(0,ve.Z)({as:c,ref:Z,classes:{root:ne.content,expanded:ne.expanded,selected:ne.selected,focused:ne.focused,disabled:ne.disabled,iconContainer:ne.iconContainer,label:ne.label},label:m,nodeId:y,onClick:b,onMouseDown:v,icon:f,expansionIcon:F,displayIcon:B,ownerState:te},l)),o&&(0,Bt.jsx)(ob,{id:y,children:(0,Bt.jsx)(Kb,(0,ve.Z)({as:S,unmountOnExit:!0,className:ne.group,in:Y,component:"ul",role:"group"},w,{children:o}))})]}))}));const Yb=$b;var Xb=a(26454),Qb=a(14741),ev=["labelIcon","labelInfo","labelText"];function tv(e){return tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(e)}function nv(){return nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nv.apply(this,arguments)}function rv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==tv(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==tv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===tv(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ov=(0,an.ZP)(Yb)((function(e){e.theme;var t,n=e.muiTheme;return rv(t={color:n.palette.mui3.secondary},"& .".concat(Wb.content),rv({color:"inherit",borderRadius:20,paddingTop:8,paddingBottom:8,paddingRight:8,transition:"background-color 250ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&.Mui-expanded":{fontWeight:500},"&:hover":{backgroundColor:n.hoverBackgroundColor},"&.Mui-focused":{backgroundColor:"transparent"},"&.Mui-selected, &.Mui-selected.Mui-focused":{backgroundColor:n.palette.mui3["secondary-container"],color:n.palette.mui3["on-secondary-container"]}},"& .".concat(Wb.label),{fontSize:13,fontWeight:500,color:"inherit"})),rv(t,"& .".concat(Wb.group),rv({marginLeft:0},"& .".concat(Wb.content),{paddingLeft:16})),t}));function iv(e){var n=e.labelIcon,r=e.labelInfo,o=e.labelText,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ev);return t().createElement(ov,nv({label:t().createElement(qy,{sx:{display:"flex",alignItems:"center",p:.5,pr:0}},n,t().createElement("span",{style:{flex:1,fontWeight:"inherit",flexGrow:1}},o),t().createElement("span",null,r)),style:{color:"inherit"}},i))}function av(e){e.pydio;var n=e.muiTheme,r=e.style,o=e.model,i={},a=function e(r){return!r.collections||r.notExpandable?[]:r.collections.map((function(r){return i[r.id]=r,t().createElement(iv,{muiTheme:n,nodeId:r.id,labelText:r.label,labelIcon:t().createElement("span",{style:{fontSize:16,marginRight:10},className:r.icon})},e(r))}))}(o.getRoot());return t().createElement(mb,{"aria-label":"gmail",defaultExpanded:["3"],defaultCollapseIcon:t().createElement(Xb.Z,null),defaultExpandIcon:t().createElement(Qb.Z,null),defaultEndIcon:t().createElement("div",{style:{width:24}}),selected:o.contextItem().id,onNodeSelect:function(e,t){i[t]&&o.setContext(i[t])},style:r},a)}iv.propTypes={labelIcon:z().object.isRequired,labelInfo:z().string,labelText:z().string.isRequired};var sv=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),cv=function(){return cv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},cv.apply(this,arguments)},lv={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},uv={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},dv={width:"20px",height:"20px",position:"absolute"},pv={top:cv(cv({},lv),{top:"-5px"}),right:cv(cv({},uv),{left:void 0,right:"-5px"}),bottom:cv(cv({},lv),{top:void 0,bottom:"-5px"}),left:cv(cv({},uv),{left:"-5px"}),topRight:cv(cv({},dv),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:cv(cv({},dv),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:cv(cv({},dv),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:cv(cv({},dv),{left:"-10px",top:"-10px",cursor:"nw-resize"})},fv=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.onMouseDown=function(t){e.props.onResizeStart(t,e.props.direction)},e.onTouchStart=function(t){e.props.onResizeStart(t,e.props.direction)},e}return sv(n,t),n.prototype.render=function(){return e.createElement("div",{className:this.props.className||"",style:cv(cv({position:"absolute",userSelect:"none"},pv[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},n}(e.PureComponent),hv=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mv=function(){return mv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},mv.apply(this,arguments)},yv={width:"auto",height:"auto"},bv=function(e,t,n){return Math.max(Math.min(e,n),t)},vv=function(e,t){return Math.round(e/t)*t},gv=function(e,t){return new RegExp(e,"i").test(t)},Sv=function(e){return Boolean(e.touches&&e.touches.length)},wv=function(e,t,n){void 0===n&&(n=0);var r=t.reduce((function(n,r,o){return Math.abs(r-e)<Math.abs(t[n]-e)?o:n}),0),o=Math.abs(t[r]-e);return 0===n||o<n?t[r]:e},kv=function(e){return"auto"===(e=e.toString())||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},Ov=function(e,t,n,r){if(e&&"string"==typeof e){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%"))return t*(Number(e.replace("%",""))/100);if(e.endsWith("vw"))return n*(Number(e.replace("vw",""))/100);if(e.endsWith("vh"))return r*(Number(e.replace("vh",""))/100)}return e},Pv=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Ev="__resizable_base__",Cv=function(t){function r(e){var n=t.call(this,e)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableRight=0,n.resizableTop=0,n.resizableBottom=0,n.targetLeft=0,n.targetTop=0,n.appendBase=function(){if(!n.resizable||!n.window)return null;var e=n.parentNode;if(!e)return null;var t=n.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0 0 100%",t.classList?t.classList.add(Ev):t.className+=Ev,e.appendChild(t),t},n.removeBase=function(e){var t=n.parentNode;t&&t.removeChild(e)},n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return hv(r,t),Object.defineProperty(r.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||yv},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,r=this.resizable.offsetHeight,o=this.resizable.style.position;"relative"!==o&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:r,this.resizable.style.position=o}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&e.propsSize[t].toString().endsWith("%")){if(e.state[t].toString().endsWith("%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return kv(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?kv(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?kv(t.height):n("height")}},enumerable:!1,configurable:!0}),r.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,n=this.parentNode.style.flexWrap;"wrap"!==n&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var r={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=n),this.removeBase(e),r},r.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},r.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},r.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},r.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},r.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},r.prototype.calculateNewMaxFromBoundary=function(e,t){var n,r,o=this.props.boundsByDirection,i=this.state.direction,a=o&&gv("left",i),s=o&&gv("top",i);if("parent"===this.props.bounds){var c=this.parentNode;c&&(n=a?this.resizableRight-this.parentLeft:c.offsetWidth+(this.parentLeft-this.resizableLeft),r=s?this.resizableBottom-this.parentTop:c.offsetHeight+(this.parentTop-this.resizableTop))}else"window"===this.props.bounds?this.window&&(n=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,r=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(n=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),r=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return n&&Number.isFinite(n)&&(e=e&&e<n?e:n),r&&Number.isFinite(r)&&(t=t&&t<r?t:r),{maxWidth:e,maxHeight:t}},r.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,r=this.props.resizeRatio||1,o=this.state,i=o.direction,a=o.original,s=this.props,c=s.lockAspectRatio,l=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=a.width,p=a.height,f=l||0,h=u||0;return gv("right",i)&&(d=a.width+(e-a.x)*r/n,c&&(p=(d-h)/this.ratio+f)),gv("left",i)&&(d=a.width-(e-a.x)*r/n,c&&(p=(d-h)/this.ratio+f)),gv("bottom",i)&&(p=a.height+(t-a.y)*r/n,c&&(d=(p-f)*this.ratio+h)),gv("top",i)&&(p=a.height-(t-a.y)*r/n,c&&(d=(p-f)*this.ratio+h)),{newWidth:d,newHeight:p}},r.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,r){var o=this.props,i=o.lockAspectRatio,a=o.lockAspectRatioExtraHeight,s=o.lockAspectRatioExtraWidth,c=void 0===r.width?10:r.width,l=void 0===n.width||n.width<0?e:n.width,u=void 0===r.height?10:r.height,d=void 0===n.height||n.height<0?t:n.height,p=a||0,f=s||0;if(i){var h=(u-p)*this.ratio+f,m=(d-p)*this.ratio+f,y=(c-f)/this.ratio+p,b=(l-f)/this.ratio+p,v=Math.max(c,h),g=Math.min(l,m),S=Math.max(u,y),w=Math.min(d,b);e=bv(e,v,g),t=bv(t,S,w)}else e=bv(e,c,l),t=bv(t,u,d);return{newWidth:e,newHeight:t}},r.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var r=this.resizable.getBoundingClientRect(),o=r.left,i=r.top,a=r.right,s=r.bottom;this.resizableLeft=o,this.resizableRight=a,this.resizableTop=i,this.resizableBottom=s}},r.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,r=0,o=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)?(r=e.nativeEvent.clientX,o=e.nativeEvent.clientY):e.nativeEvent&&Sv(e.nativeEvent)&&(r=e.nativeEvent.touches[0].clientX,o=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var i=this.window.getComputedStyle(this.resizable);if("auto"!==i.flexBasis){var a=this.parentNode;if(a){var s=this.window.getComputedStyle(a).flexDirection;this.flexDir=s.startsWith("row")?"row":"column",n=i.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var c={original:{x:r,y:o,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:mv(mv({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(c)}},r.prototype.onMouseMove=function(e){var t=this;if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&Sv(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var r=this.props,o=r.maxWidth,i=r.maxHeight,a=r.minWidth,s=r.minHeight,c=Sv(e)?e.touches[0].clientX:e.clientX,l=Sv(e)?e.touches[0].clientY:e.clientY,u=this.state,d=u.direction,p=u.original,f=u.width,h=u.height,m=this.getParentSize(),y=function(e,t,n,r,o,i,a){return r=Ov(r,e.width,t,n),o=Ov(o,e.height,t,n),i=Ov(i,e.width,t,n),a=Ov(a,e.height,t,n),{maxWidth:void 0===r?void 0:Number(r),maxHeight:void 0===o?void 0:Number(o),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===a?void 0:Number(a)}}(m,this.window.innerWidth,this.window.innerHeight,o,i,a,s);o=y.maxWidth,i=y.maxHeight,a=y.minWidth,s=y.minHeight;var b=this.calculateNewSizeFromDirection(c,l),v=b.newHeight,g=b.newWidth,S=this.calculateNewMaxFromBoundary(o,i);this.props.snap&&this.props.snap.x&&(g=wv(g,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=wv(v,this.props.snap.y,this.props.snapGap));var w=this.calculateNewSizeFromAspectRatio(g,v,{width:S.maxWidth,height:S.maxHeight},{width:a,height:s});if(g=w.newWidth,v=w.newHeight,this.props.grid){var k=vv(g,this.props.grid[0]),O=vv(v,this.props.grid[1]),P=this.props.snapGap||0;g=0===P||Math.abs(k-g)<=P?k:g,v=0===P||Math.abs(O-v)<=P?O:v}var E={width:g-p.width,height:v-p.height};f&&"string"==typeof f&&(f.endsWith("%")?g=g/m.width*100+"%":f.endsWith("vw")?g=g/this.window.innerWidth*100+"vw":f.endsWith("vh")&&(g=g/this.window.innerHeight*100+"vh")),h&&"string"==typeof h&&(h.endsWith("%")?v=v/m.height*100+"%":h.endsWith("vw")?v=v/this.window.innerWidth*100+"vw":h.endsWith("vh")&&(v=v/this.window.innerHeight*100+"vh"));var C={width:this.createSizeForCssProperty(g,"width"),height:this.createSizeForCssProperty(v,"height")};"row"===this.flexDir?C.flexBasis=C.width:"column"===this.flexDir&&(C.flexBasis=C.height),(0,n.flushSync)((function(){t.setState(C)})),this.props.onResize&&this.props.onResize(e,d,this.resizable,E)}},r.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,r=t.direction,o=t.original;if(n&&this.resizable){var i={width:this.size.width-o.width,height:this.size.height-o.height};this.props.onResizeStop&&this.props.onResizeStop(e,r,this.resizable,i),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:mv(mv({},this.state.backgroundStyle),{cursor:"auto"})})}},r.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},r.prototype.renderResizer=function(){var t=this,n=this.props,r=n.enable,o=n.handleStyles,i=n.handleClasses,a=n.handleWrapperStyle,s=n.handleWrapperClass,c=n.handleComponent;if(!r)return null;var l=Object.keys(r).map((function(n){return!1!==r[n]?e.createElement(fv,{key:n,direction:n,onResizeStart:t.onResizeStart,replaceStyles:o&&o[n],className:i&&i[n]},c&&c[n]?c[n]:null):null}));return e.createElement("div",{className:s,style:a},l)},r.prototype.render=function(){var t=this,n=Object.keys(this.props).reduce((function(e,n){return-1!==Pv.indexOf(n)||(e[n]=t.props[n]),e}),{}),r=mv(mv(mv({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(r.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return e.createElement(o,mv({ref:this.ref,style:r,className:this.props.className},n),this.state.isResizing&&e.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},r.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},r}(e.PureComponent);const Tv={list:{},listItem:{style:{fontSize:14},innerDivStyle:{padding:"14px 56px 14px 62px"}},avatar:{avatarSize:26,style:{top:9}},iconMenu:{style:{top:2,right:8}},iconButton:{style:{width:26,height:26,padding:5,right:8},iconStyle:{color:"rgba(0,0,0,.33)",fontSize:20}},divider:{style:{marginLeft:62}},className:"medium"};function xv(e){return xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xv(e)}function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jv.apply(this,arguments)}function Rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Iv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rv(Object(n),!0).forEach((function(t){Dv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Lv(r.key),r)}}function Av(e,t){return Av=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Av(e,t)}function Mv(e){return Mv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mv(e)}function Dv(e,t,n){return(t=Lv(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lv(e){var t=function(e,t){if("object"!==xv(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==xv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===xv(t)?t:String(t)}var Nv=q().requireLib("boot").PydioContextConsumer,Uv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Av(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mv(o);if(i){var n=Mv(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===xv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e);var n=e.pydio,r=e.mode,o=e.usersOnly,i=e.usersFrom,c=e.teamsOnly,l=e.onItemSelected,u=new Yu(n,r,o,i,c,l);return u.initTree(),u.observe("update",(function(){t.forceUpdate()})),t.state={model:u},t}return n=s,r=[{key:"componentDidMount",value:function(){this.state.model.reloadContext()}},{key:"render",value:function(){var e=this,n=this.props,r=n.getMessage,o=n.pydio,i=n.style,a=n.muiTheme,s=this.state,c=s.model,l=s.rightPaneSize,u=void 0===l?256:l,d=c.rightItem(),p=c.contextItem(),f={width:"100%",height:"100%",overflowY:"auto",overflowX:"hidden"},h=Iv({enableSearch:!0,searchLabel:r(583,""),setSearchTerm:function(e){return c.setGlobalSearch(!!e,e)},setSearchMode:function(e){return c.setGlobalSearch(e,"")}},c.getSearchStatus()),m=a.palette.mui3,y="xs"===a.breakpoint||"s"===a.breakpoint,b=a.darkMode?"surface":"surface-variant",v=a.darkMode?"surface-variant":"surface";return t().createElement("div",{style:Iv({display:"flex",height:"100%",overflow:"hidden",flexDirection:"column",background:m[b]},i)},t().createElement("div",{style:{height:72,display:"flex",flexShrink:0,alignItems:"center"}},t().createElement(Th,jv({pydio:o,model:c,mode:"book",getMessage:r,style:{width:"100%"}},h))),t().createElement("div",{style:{display:"flex",flex:1,overflow:"hidden",margin:12,marginTop:0}},!y&&t().createElement(Cv,{defaultSize:{width:256},enable:{right:!0},style:{margin:0}},t().createElement(av,{pydio:o,model:c,listStyles:{},muiTheme:a,style:Iv(Iv({},f),{},{paddingRight:8,color:m["on-surface-variant"]})})),t().createElement(pd,jv({pydio:o,model:c,item:p,mode:"book",showAllParents:y,onItemClicked:function(e){return c.leafItemClicked(e)},onFolderClicked:function(e,t){return c.setContext(e,t)},onClick:function(){return c.clearRightItem()},loading:c.loading,actionsForCell:this.props.actionsForCell,usersOnly:this.props.usersOnly,listStyles:Tv,style:{borderRadius:a.borderRadius,backgroundColor:m[v]}},h)),t().createElement(Cv,{size:{width:d?u:0},onResizeStop:function(t,n,r,o){e.setState({rightPaneSize:u+o.width})},enable:{left:!!d},style:{marginLeft:d?12:0,transition:"width 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"}},t().createElement(Df,{pydio:o,model:c,zDepth:0,style:Iv(Iv({},f),{},{background:m[v],borderRadius:a.borderRadius})}))),t().createElement(mh,{pydio:o,model:c,onCancel:function(){c.clearCreateItem()},afterSubmit:function(){c.clearCreateItem(),c.reloadContext()}}),t().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:(this.props.muiTheme.palette,"\n.folder-avatar::before {\n    content: '\\F24B';\n    font-family: 'Material Design Icons';\n    position: absolute;\n    color: rgb(54, 113, 143);\n    font-size: 40px;\n    top: 11px;\n    left: -2px;\n}\n.compact .folder-avatar::before {\n    font-size: 30px;\n    top: 5px;\n}\n\n.medium .folder-avatar::before {\n    font-size: 26px;\n    top: 5px;\n}\n\n.folder-avatar span.mdi {\n    font-size: 20px !important;\n    color: #fff !important;\n    height: 12.8px !important;\n    margin: 7.3px !important;\n}\n.compact .folder-avatar span.mdi {\n    font-size: 13px !important;\n}\n.medium .folder-avatar span.mdi {\n    font-size: 13px !important;\n}\n.folder-avatar {\n    background-color: transparent !important;\n}\n.medium .folder-avatar {\n    left: 18px;\n}\n")}}))}}],r&&_v(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);Dv(Uv,"propTypes",{pydio:z().instanceOf(q()),onItemSelected:z().func,usersOnly:z().bool,usersFrom:z().oneOf(["local","remote","any"]),muiTheme:z().object}),Dv(Uv,"defaultProps",{mode:"book",usersOnly:!1,usersFrom:"any",teamsOnly:!1,disableSearch:!1}),Uv=Nv(Uv),Uv=(0,$.muiThemeable)()(Uv);const Bv=require("pydio/http/websocket");var Fv=a.n(Bv),zv=a(12590),Wv=a.n(zv);function qv(e){return qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qv(e)}function Hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Kv(r.key),r)}}function Vv(e,t){return Vv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vv(e,t)}function Jv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gv(e){return Gv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gv(e)}function Kv(e){var t=function(e,t){if("object"!==qv(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qv(t)?t:String(t)}var $v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vv(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Gv(o);if(i){var n=Gv(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===qv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Jv(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),function(e,t,n){(t=Kv(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Jv(t=a.call(this,e)),"subscriptions",void 0),t.currentRepo=e.repositoryId,t.subscriptions={},t.rooms={},t.roomInfos={},t.open(),t}return t=s,n=[{key:"getIdentifier",value:function(e,t){return e+":"+t}},{key:"getRoomInfoFromIdentifier",value:function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Hv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hv(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split(":"),2);return{roomType:t[0],objectId:t[1]}}},{key:"onRoomMessage",value:function(e){if(e){var t=e.Room,n=this.getIdentifier(t.Type,t.RoomTypeObject);this.roomInfos[n]=t}}},{key:"joinRoom",value:function(e,t,n,r){var o=this,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.getIdentifier(e,t);if(this.subscriptions[a]){var s=!1;return this.subscriptions[a].map((function(e){e.messageHandler===n&&(s=!0)})),s||this.subscriptions[a].push({messageHandler:n,roomUpdateHandler:r}),this.roomInfos[a]}if(this.connecting){if(i<3)return setTimeout((function(){o.joinRoom(e,t,n,r,i+1)}),1500),null}else if(!this.connOpen)return this.open(),setTimeout((function(){o.joinRoom(e,t,n,r,i+1)}),1500),null;this.subscriptions[e+":"+t]=[{messageHandler:n,roomUpdateHandler:r}];var c={"@type":"JOIN",Room:{Type:e,RoomTypeObject:t}};return this.ws.send(JSON.stringify(c)),this.roomInfos[a]}},{key:"loadHistory",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(this.connecting&&i<3)setTimeout((function(){n.loadHistory(e,t,r,o,i+1)}),1500);else{var a={"@type":"HISTORY",Room:{Type:e,RoomTypeObject:t},Message:{Message:JSON.stringify({Offset:r,Limit:o})}};this.ws.send(JSON.stringify(a))}}},{key:"leaveRoom",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=!1,i=this.getIdentifier(e,t);if(this.subscriptions[i]&&(r?(this.subscriptions[i]=this.subscriptions[i].filter((function(e){return e.messageHandler!==r})),this.subscriptions[i].length?o=!0:delete this.subscriptions[i]):delete this.subscriptions[i]),!o&&(Object.keys(this.rooms).map((function(e){n.rooms[e]===i&&delete n.rooms[e]})),this.connOpen)){var a={"@type":"LEAVE",Room:{Type:e,RoomTypeObject:t}};this.ws.send(JSON.stringify(a))}}},{key:"handleMessageReceived",value:function(e){var t=JSON.parse(e.data);if("ROOM_UPDATE"===t["@type"]){var n=this.getIdentifier(t.Room.Type,t.Room.RoomTypeObject);this.subscriptions[n]&&(this.rooms[t.Room.Uuid]||(this.rooms[t.Room.Uuid]=n),this.onRoomMessage(t),this.subscriptions[n].map((function(e){if(e.roomUpdateHandler)try{e.roomUpdateHandler(t)}catch(e){}})))}else{var r,o=!1;if("DELETE_MSG"===t["@type"]?(o=!0,r=t.Message):r=t,r.RoomUuid&&this.rooms[r.RoomUuid]){var i=this.subscriptions[this.rooms[r.RoomUuid]],a=i.filter((function(e){return e.roomUpdateHandler}));a.length&&(i=a),i.map((function(e){try{e.messageHandler(r,o)}catch(e){}}))}}}},{key:"send",value:function(e){this.ws.send(e)}},{key:"open",value:function(){var e=this;if(this.close(),this.currentRepo){var t=this.pydio.Parameters.get("ENDPOINT_WEBSOCKET").replace("/event","/chat");t&&"/"===t[0]&&(t=t.substr(1));var n=this.pydio.getFrontendUrl(),r="https:"===n.protocol?"wss":"ws",o="".concat(r,"://").concat(n.host,"/")+t;this.ws=new(Wv())(o,[],{maxReconnectionDelay:6e4,reconnectionDelayGrowFactor:1.6,maxRetries:10}),this.connecting=!0,this.ws.addEventListener("open",(function(){Fv().subscribeJWT(e.ws).then((function(){e.connecting=!1,e.connOpen=!0})).catch((function(){e.connecting=!1,e.connOpen=!1}))})),this.ws.addEventListener("message",(function(t){e.handleMessageReceived(t)})),this.ws.addEventListener("close",(function(t){e.connOpen=!1,e.connecting=!1,Fv().logClose(t)})),this.ws.addEventListener("error",(function(e){"EHOSTDOWN"===e.code&&console.error("WebSocket maxRetries reached, host is down!")})),this.hbInterval=setInterval((function(){return e.heartbeat()}),15e3),window.onbeforeunload=function(){e.close()}}}},{key:"close",value:function(){var e=this;null!==this.ws&&(Object.keys(this.subscriptions).map((function(t){var n=e.getRoomInfoFromIdentifier(t),r=n.roomType,o=n.objectId;e.leaveRoom(r,o)})),this.ws.close(1e3,"Closing",{keepClosed:!0}),this.hbInterval&&clearInterval(this.hbInterval))}},{key:"heartbeat",value:function(){var e=this;Object.keys(this.subscriptions).map((function(t){var n=e.getRoomInfoFromIdentifier(t),r={"@type":"JOIN",Room:{Type:n.roomType,RoomTypeObject:n.objectId},Message:{Message:"PING"}};try{e.ws.send(JSON.stringify(r))}catch(e){}}))}}],r=[{key:"getInstance",value:function(e){return void 0!==s._instance||(s._instance=new s(e)),s._instance}}],n&&Zv(t.prototype,n),r&&Zv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(Fv());const Yv=require("pydio/util/dom");var Xv=a.n(Yv);const Qv=require("react-markdown");var eg=a.n(Qv);function tg(e){return tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tg(e)}function ng(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ng(Object(n),!0).forEach((function(t){og(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ng(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function og(e,t,n){return(t=ag(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ig(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ag(r.key),r)}}function ag(e){var t=function(e,t){if("object"!==tg(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==tg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===tg(t)?t:String(t)}function sg(e,t){return sg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sg(e,t)}function cg(e){return cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cg(e)}var lg=q().requireLib("boot"),ug=lg.PydioContextConsumer,dg=lg.moment,pg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sg(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cg(o);if(i){var n=cg(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===tg(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={hover:!1},t}return n=s,r=[{key:"render",value:function(){var e=this,n=this.props,r=n.message,o=n.pydio,i=n.hideDate,a=n.sameAuthor,s=n.onDeleteMessage,c=n.moreLoader,l=dg(1e3*parseFloat(r.Timestamp)),u={date:{opacity:.53,textAlign:"center",display:"flex",margin:"5px 0"},dateLine:{flex:1,margin:"10px 20px",borderBottom:"1px solid",opacity:.3},loader:{paddingTop:8,opacity:.8,textAlign:"center"},comment:{padding:"6px 16px",display:"flex",alignItems:"flex-start"},commentContent:{flex:"1",backgroundColor:"transparent",position:"relative",padding:"5px 10px",userSelect:"text",webkitUserSelect:"text"},commentTitle:{fontSize:15,fontWeight:500,padding:"2px 0px 6px"},commentDeleteBox:{position:"absolute",top:5,right:0,cursor:"pointer",fontSize:16,opacity:0,transition:Xv().getBeziersTransition()}},d=!1;o.user.id===r.Author&&(d=!0);var p,f=t().createElement("div",{style:a?{visibility:"hidden"}:{paddingTop:2}},t().createElement(Qd,{avatarSize:30,pydio:o,userId:r.Author,displayLabel:!1,richOnHover:!1,avatarLetters:!0})),h=rg({},u.commentContent);d&&(this.state.hover&&(u.commentDeleteBox.opacity=1),p=t().createElement("span",{onClick:s,className:"mdi mdi-close",style:u.commentDeleteBox,title:o.MessageHash[7]}));var m=t().createElement("div",{style:h},p," ",t().createElement(eg(),{className:"chat-message-md",source:r.Message,skipHtml:!0}));a||(m=t().createElement("div",{style:h},t().createElement("div",null,t().createElement(Qd,{labelStyle:u.commentTitle,pydio:o,displayLabel:!0,displayAvatar:!1,userId:r.Author})),t().createElement("div",null,p,t().createElement(eg(),{className:"chat-message-md",source:r.Message,skipHtml:!0}))));var y={},b=rg({},u.comment);return a&&(y=rg(rg({},y),{},{marginTop:-16})),this.state.hover&&(b=rg(rg({},b),{},{backgroundColor:"rgba(0,0,0,.01)"})),t().createElement("div",{style:y,onMouseOver:function(){e.setState({hover:!0})},onMouseOut:function(){e.setState({hover:!1})},onContextMenu:function(e){e.stopPropagation()}},c&&t().createElement("div",{style:u.loader},t().createElement(g.FlatButton,{primary:!0,label:q().getMessages()["chat.load-older"],onClick:c})),!i&&t().createElement("div",{style:u.date},t().createElement("span",{style:u.dateLine}),t().createElement("span",{className:"date-from"},l.fromNow()),t().createElement("span",{style:u.dateLine})),t().createElement("div",{style:b},f," ",m))}}],r&&ig(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function fg(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}function hg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}pg.PropTypes={message:z().object,hideDate:z().bool,sameAuthor:z().bool},pg=ug(pg);var mg,yg,bg,vg={exports:{}};yg="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},bg=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function s(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function c(r,a,c){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?i:void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):e)}(r)||s.apply(this,arguments)}function l(e,n,o){var i,s=this;n=null==n?"WARN":n;var l="loglevel";function u(){var e;if(typeof window!==t&&l){try{e=window.localStorage[l]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(l)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}"string"==typeof e?l+=":"+e:"symbol"==typeof e&&(l=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=o||c,s.getLevel=function(){return i},s.setLevel=function(n,o){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(i=n,!1!==o&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&l){try{return void(window.localStorage[l]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"="+n+";"}catch(e){}}}(n),a.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,u()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),function(){if(typeof window!==t&&l){try{return void window.localStorage.removeItem(l)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var d=u();null==d&&(d=n),s.setLevel(d,!1)}var u=new l,d={};u.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new l(e,u.getLevel(),u.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return u.noConflict=function(){return typeof window!==t&&window.log===u&&(window.log=p),u},u.getLoggers=function(){return d},u.default=u,u},(mg=vg).exports?mg.exports=bg():yg.log=bg();var gg,Sg=vg.exports;!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(gg||(gg={}));const wg=Sg.getLogger("livekit");function kg(e,t){if(!e)throw new Error(t)}wg.setDefaultLevel(gg.info),Sg.getLogger("lk-e2ee");const Og=34028234663852886e22,Pg=-34028234663852886e22,Eg=4294967295,Cg=2147483647,Tg=-2147483648;function xg(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>Cg||e<Tg)throw new Error("invalid int 32: "+e)}function jg(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>Eg||e<0)throw new Error("invalid uint 32: "+e)}function Rg(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>Og||e<Pg))throw new Error("invalid float 32: "+e)}const Ig=Symbol("@bufbuild/protobuf/enum-type");function _g(e,t,n,r){e[Ig]=Ag(t,n.map((t=>({no:t.no,name:t.name,localName:e[t.no]}))))}function Ag(e,t,n){const r=Object.create(null),o=Object.create(null),i=[];for(const e of t){const t=Mg(e);i.push(t),r[e.name]=t,o[e.no]=t}return{typeName:e,values:i,findName:e=>r[e],findNumber:e=>o[e]}}function Mg(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class Dg{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,r=n.makeReadOptions(t);return n.readMessage(this,r.readerFactory(e),e.byteLength,r),this}fromJson(e,t){const n=this.getType(),r=n.runtime.json,o=r.makeReadOptions(t);return r.readMessage(n,e,o,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(e){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(e instanceof Error?e.message:String(e)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),r=n.writerFactory();return t.writeMessage(this,r,n),r.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}var Lg;function Ng(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,0==(128&r))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,0==(128&r))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Ug(e,t,n){for(let r=0;r<28;r+=7){const o=e>>>r,i=!(o>>>7==0&&0==t),a=255&(i?128|o:o);if(n.push(a),!i)return}const r=e>>>28&15|(7&t)<<4,o=!(t>>3==0);if(n.push(255&(o?128|r:r)),o){for(let e=3;e<31;e+=7){const r=t>>>e,o=!(r>>>7==0),i=255&(o?128|r:r);if(n.push(i),!o)return}n.push(t>>>31&1)}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Lg||(Lg={}));const Bg=4294967296;function Fg(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let r=0,o=0;function i(t,i){const a=Number(e.slice(t,i));o*=n,r=r*n+a,r>=Bg&&(o+=r/Bg|0,r%=Bg)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),t?qg(r,o):Wg(r,o)}function zg(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(Bg*t+e);const n=16777215&(e>>>24|t<<8),r=t>>16&65535;let o=(16777215&e)+6777216*n+6710656*r,i=n+8147497*r,a=2*r;const s=1e7;return o>=s&&(i+=Math.floor(o/s),o%=s),i>=s&&(a+=Math.floor(i/s),i%=s),a.toString()+Hg(i)+Hg(o)}function Wg(e,t){return{lo:0|e,hi:0|t}}function qg(e,t){return t=~t,e?e=1+~e:t+=1,Wg(e,t)}const Hg=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Zg(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Vg(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;0!=(128&e)&&t<10;t++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const Jg=function(){const e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),r=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw new Error("int64 invalid: ".concat(e));return r},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>o||t<r)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>kg(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>kg(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),Fg(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),Fg(e)),dec:(e,t)=>function(e,t){let n=Wg(e,t);const r=2147483648&n.hi;r&&(n=qg(n.lo,n.hi));const o=zg(n.lo,n.hi);return r?"-"+o:o}(e,t),uDec:(e,t)=>zg(e,t)}}();var Gg;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Gg||(Gg={}));class Kg{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(jg(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return xg(e),Zg(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Rg(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){jg(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){xg(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return xg(e),Zg(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=Jg.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=Jg.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=Jg.enc(e);return Ug(t.lo,t.hi,this.buf),this}sint64(e){let t=Jg.enc(e),n=t.hi>>31;return Ug(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Jg.uEnc(e);return Ug(t.lo,t.hi,this.buf),this}}class $g{constructor(e,t){this.varint64=Ng,this.uint32=Vg,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case Gg.Varint:for(;128&this.buf[this.pos++];);break;case Gg.Bit64:this.pos+=4;case Gg.Bit32:this.pos+=4;break;case Gg.LengthDelimited:let t=this.uint32();this.pos+=t;break;case Gg.StartGroup:let n;for(;(n=this.tag()[1])!==Gg.EndGroup;)this.skip(n);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Jg.dec(...this.varint64())}uint64(){return Jg.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,Jg.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Jg.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Jg.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Yg(e,t){return t instanceof Dg||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}function Xg(e,t,n){if(t===n)return!0;if(e==Lg.BYTES){if(!(t instanceof Uint8Array&&n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Lg.UINT64:case Lg.FIXED64:case Lg.INT64:case Lg.SFIXED64:case Lg.SINT64:return t==n}return!1}function Qg(e){switch(e){case Lg.BOOL:return!1;case Lg.UINT64:case Lg.FIXED64:case Lg.INT64:case Lg.SFIXED64:case Lg.SINT64:return Jg.zero;case Lg.DOUBLE:case Lg.FLOAT:return 0;case Lg.BYTES:return new Uint8Array(0);case Lg.STRING:return"";default:return 0}}function eS(e,t){const n=void 0===t;let r=Gg.Varint,o=0===t;switch(e){case Lg.STRING:o=n||!t.length,r=Gg.LengthDelimited;break;case Lg.BOOL:o=!1===t;break;case Lg.DOUBLE:r=Gg.Bit64;break;case Lg.FLOAT:r=Gg.Bit32;break;case Lg.INT64:case Lg.UINT64:o=n||0==t;break;case Lg.FIXED64:o=n||0==t,r=Gg.Bit64;break;case Lg.BYTES:o=n||!t.byteLength,r=Gg.LengthDelimited;break;case Lg.FIXED32:case Lg.SFIXED32:r=Gg.Bit32;break;case Lg.SFIXED64:o=n||0==t,r=Gg.Bit64;break;case Lg.SINT64:o=n||0==t}return[r,Lg[e].toLowerCase(),n||o]}Lg.DOUBLE,Lg.FLOAT,Lg.INT64,Lg.UINT64,Lg.INT32,Lg.UINT32,Lg.BOOL,Lg.STRING,Lg.BYTES;const tS=Symbol("@bufbuild/protobuf/unknown-fields"),nS={readUnknownFields:!0,readerFactory:e=>new $g(e)},rS={writeUnknownFields:!0,writerFactory:()=>new Kg};function oS(e,t,n){return t.getType().runtime.bin.readMessage(t,e,e.uint32(),n),t}function iS(e,t,n){const r=t.uint32(),o=t.pos+r;let i,a;for(;t.pos<o;){let[r]=t.tag();switch(r){case 1:i=aS(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=aS(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=oS(t,new e.V.T,n)}}}if(void 0===i){let t=Qg(e.K);i=e.K==Lg.BOOL?t.toString():t}if("string"!=typeof i&&"number"!=typeof i&&(i=i.toString()),void 0===a)switch(e.V.kind){case"scalar":a=Qg(e.V.T);break;case"enum":a=0;break;case"message":a=new e.V.T}return[i,a]}function aS(e,t){switch(t){case Lg.STRING:return e.string();case Lg.BOOL:return e.bool();case Lg.DOUBLE:return e.double();case Lg.FLOAT:return e.float();case Lg.INT32:return e.int32();case Lg.INT64:return e.int64();case Lg.UINT64:return e.uint64();case Lg.FIXED64:return e.fixed64();case Lg.BYTES:return e.bytes();case Lg.FIXED32:return e.fixed32();case Lg.SFIXED32:return e.sfixed32();case Lg.SFIXED64:return e.sfixed64();case Lg.SINT64:return e.sint64();case Lg.UINT32:return e.uint32();case Lg.SINT32:return e.sint32()}}function sS(e,t,n,r,o){e.tag(n.no,Gg.LengthDelimited),e.fork();let i=r;switch(n.K){case Lg.INT32:case Lg.FIXED32:case Lg.UINT32:case Lg.SFIXED32:case Lg.SINT32:i=Number.parseInt(r);break;case Lg.BOOL:kg("true"==r||"false"==r),i="true"==r}switch(lS(e,n.K,1,i,!0),n.V.kind){case"scalar":lS(e,n.V.T,2,o,!0);break;case"enum":lS(e,Lg.INT32,2,o,!0);break;case"message":cS(e,t,n.V.T,2,o)}e.join()}function cS(e,t,n,r,o){if(void 0!==o){const i=Yg(n,o);e.tag(r,Gg.LengthDelimited).bytes(i.toBinary(t))}}function lS(e,t,n,r,o){let[i,a,s]=eS(t,r);s&&!o||e.tag(n,i)[a](r)}function uS(e,t,n,r){if(!r.length)return;e.tag(n,Gg.LengthDelimited).fork();let[,o]=eS(t);for(let t=0;t<r.length;t++)e[o](r[t]);e.join()}let dS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),pS=[];for(let e=0;e<dS.length;e++)pS[dS[e].charCodeAt(0)]=e;pS["-".charCodeAt(0)]=dS.indexOf("+"),pS["_".charCodeAt(0)]=dS.indexOf("/");const fS={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,r=new Uint8Array(t),o=0,i=0,a=0;for(let t=0;t<e.length;t++){if(n=pS[e.charCodeAt(t)],void 0===n)switch(e[t]){case"=":i=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=n,i=1;break;case 1:r[o++]=a<<2|(48&n)>>4,a=n,i=2;break;case 2:r[o++]=(15&a)<<4|(60&n)>>2,a=n,i=3;break;case 3:r[o++]=(3&a)<<6|n,i=0}}if(1==i)throw Error("invalid base64 string.");return r.subarray(0,o)},enc(e){let t,n="",r=0,o=0;for(let i=0;i<e.length;i++)switch(t=e[i],r){case 0:n+=dS[t>>2],o=(3&t)<<4,r=1;break;case 1:n+=dS[o|t>>4],o=(15&t)<<2,r=2;break;case 2:n+=dS[o|t>>6],n+=dS[63&t],r=0}return r&&(n+=dS[o],n+="=",1==r&&(n+="=")),n}},hS={ignoreUnknownFields:!1},mS={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function yS(e){return e?Object.assign(Object.assign({},hS),e):hS}function bS(e){return e?Object.assign(Object.assign({},mS),e):mS}function vS(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function gS(e,t){switch(e){case Lg.DOUBLE:case Lg.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const n=Number(t);if(Number.isNaN(n))break;if(!Number.isFinite(n))break;return e==Lg.FLOAT&&Rg(n),n;case Lg.INT32:case Lg.FIXED32:case Lg.SFIXED32:case Lg.SINT32:case Lg.UINT32:if(null===t)return 0;let r;if("number"==typeof t?r=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(r=Number(t)),void 0===r)break;return e==Lg.UINT32?jg(r):xg(r),r;case Lg.INT64:case Lg.SFIXED64:case Lg.SINT64:if(null===t)return Jg.zero;if("number"!=typeof t&&"string"!=typeof t)break;return Jg.parse(t);case Lg.FIXED64:case Lg.UINT64:if(null===t)return Jg.zero;if("number"!=typeof t&&"string"!=typeof t)break;return Jg.uParse(t);case Lg.BOOL:if(null===t)return!1;if("boolean"!=typeof t)break;return t;case Lg.STRING:if(null===t)return"";if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case Lg.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!=typeof t)break;return fS.dec(t)}throw new Error}function SS(e,t,n){if(null===t)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const r=e.findName(t);if(r||n)return null==r?void 0:r.no}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(vS(t)))}function wS(e,t,n,r){var o;if(void 0===t)return t;if(0===t&&!n)return;if(r)return t;if("google.protobuf.NullValue"==e.typeName)return null;const i=e.findNumber(t);return null!==(o=null==i?void 0:i.name)&&void 0!==o?o:t}function kS(e,t,n){if(void 0!==t)switch(e){case Lg.INT32:case Lg.SFIXED32:case Lg.SINT32:case Lg.FIXED32:case Lg.UINT32:return kg("number"==typeof t),0!=t||n?t:void 0;case Lg.FLOAT:case Lg.DOUBLE:return kg("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":0!==t||n?t:void 0;case Lg.STRING:return kg("string"==typeof t),t.length>0||n?t:void 0;case Lg.BOOL:return kg("boolean"==typeof t),t||n?t:void 0;case Lg.UINT64:case Lg.FIXED64:case Lg.INT64:case Lg.SFIXED64:case Lg.SINT64:return kg("bigint"==typeof t||"string"==typeof t||"number"==typeof t),n||0!=t?t.toString(10):void 0;case Lg.BYTES:return kg(t instanceof Uint8Array),n||t.byteLength>0?fS.enc(t):void 0}}function OS(e){if(void 0===e)return e;if(e instanceof Dg)return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function PS(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class ES{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort(((e,t)=>e.no-t.no))),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function CS(e,t){const n=xS(e);return t?n:AS(_S(n))}const TS=xS;function xS(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let o=e.charAt(r);switch(o){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(o),t=!1;break;default:t&&(t=!1,o=o.toUpperCase()),n.push(o)}}return n.join("")}const jS=new Set(["constructor","toString","toJSON","valueOf"]),RS=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),IS=e=>"".concat(e,"$"),_S=e=>RS.has(e)?IS(e):e,AS=e=>jS.has(e)?IS(e):e;class MS{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=CS(e,!1)}addField(e){kg(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const DS=("proto3",LS=function(e){const t=((e,t)=>function(n,r,o){if("map"==n.kind){const i={};switch(n.V.kind){case"scalar":for(const[e,o]of Object.entries(r)){const r=t(n.V.T,o,!0);kg(void 0!==r),i[e.toString()]=r}break;case"message":for(const[e,t]of Object.entries(r))i[e.toString()]=t.toJson(o);break;case"enum":const a=n.V.T;for(const[t,n]of Object.entries(r)){kg(void 0===n||"number"==typeof n);const r=e(a,n,!0,o.enumAsInteger);kg(void 0!==r),i[t.toString()]=r}}return o.emitDefaultValues||Object.keys(i).length>0?i:void 0}if(n.repeated){const i=[];switch(n.kind){case"scalar":for(let e=0;e<r.length;e++)i.push(t(n.T,r[e],!0));break;case"enum":for(let t=0;t<r.length;t++)i.push(e(n.T,r[t],!0,o.enumAsInteger));break;case"message":for(let e=0;e<r.length;e++)i.push(Yg(n.T,r[e]).toJson(o))}return o.emitDefaultValues||i.length>0?i:void 0}switch(n.kind){case"scalar":return t(n.T,r,!!n.oneof||n.opt||o.emitDefaultValues);case"enum":return e(n.T,r,!!n.oneof||n.opt||o.emitDefaultValues,o.enumAsInteger);case"message":return void 0!==r?Yg(n.T,r).toJson(o):void 0}})(wS,kS);return{makeReadOptions:yS,makeWriteOptions:bS,readMessage(e,t,n,r){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(this.debug(t)));r=null!=r?r:new e;const o={};for(const[i,a]of Object.entries(t)){const t=e.fields.findJsonName(i);if(!t){if(!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(i,'" is unknown'));continue}let s=t.localName,c=r;if(t.oneof){if(null===a&&"scalar"==t.kind)continue;const n=o[t.oneof.localName];if(n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(i,'"'));o[t.oneof.localName]=i,c=c[t.oneof.localName]={case:s},s="value"}if(t.repeated){if(null===a)continue;if(!Array.isArray(a))throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a)));const r=c[s];for(const o of a){if(null===o)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(o)));let i;switch(t.kind){case"message":i=t.T.fromJson(o,n);break;case"enum":if(i=SS(t.T,o,n.ignoreUnknownFields),void 0===i)continue;break;case"scalar":try{i=gS(t.T,o)}catch(n){let r="cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(o));throw n instanceof Error&&n.message.length>0&&(r+=": ".concat(n.message)),new Error(r)}}r.push(i)}}else if("map"==t.kind){if(null===a)continue;if(Array.isArray(a)||"object"!=typeof a)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a)));const r=c[s];for(const[o,i]of Object.entries(a)){if(null===i)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: map value null"));let s;switch(t.V.kind){case"message":s=t.V.T.fromJson(i,n);break;case"enum":if(s=SS(t.V.T,i,n.ignoreUnknownFields),void 0===s)continue;break;case"scalar":try{s=gS(t.V.T,i)}catch(n){let r="cannot decode map value for field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a));throw n instanceof Error&&n.message.length>0&&(r+=": ".concat(n.message)),new Error(r)}}try{r[gS(t.K,t.K==Lg.BOOL?"true"==o||"false"!=o&&o:o).toString()]=s}catch(n){let r="cannot decode map key for field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a));throw n instanceof Error&&n.message.length>0&&(r+=": ".concat(n.message)),new Error(r)}}}else switch(t.kind){case"message":const r=t.T;if(null===a&&"google.protobuf.Value"!=r.typeName){if(t.oneof)throw new Error("cannot decode field ".concat(e.typeName,".").concat(t.name,' from JSON: null is invalid for oneof field "').concat(i,'"'));continue}c[s]instanceof Dg?c[s].fromJson(a,n):(c[s]=r.fromJson(a,n),r.fieldWrapper&&!t.oneof&&(c[s]=r.fieldWrapper.unwrapField(c[s])));break;case"enum":const o=SS(t.T,a,n.ignoreUnknownFields);void 0!==o&&(c[s]=o);break;case"scalar":try{c[s]=gS(t.T,a)}catch(n){let r="cannot decode field ".concat(e.typeName,".").concat(t.name," from JSON: ").concat(this.debug(a));throw n instanceof Error&&n.message.length>0&&(r+=": ".concat(n.message)),new Error(r)}}}return r},writeMessage(e,n){const r=e.getType(),o={};let i;try{for(const a of r.fields.byMember()){let r;if("oneof"==a.kind){const o=e[a.localName];if(void 0===o.value)continue;if(i=a.findField(o.case),!i)throw"oneof case not found: "+o.case;r=t(i,o.value,n)}else i=a,r=t(i,e[i.localName],n);void 0!==r&&(o[n.useProtoFieldName?i.name:i.jsonName]=r)}}catch(e){const t=i?"cannot encode field ".concat(r.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(r.typeName," to JSON"),n=e instanceof Error?e.message:String(e);throw new Error(t+(n.length>0?": ".concat(n):""))}return o},readScalar:gS,writeScalar:kS,debug:vS}}(),NS=Object.assign(Object.assign({},{makeReadOptions:function(e){return e?Object.assign(Object.assign({},nS),e):nS},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},rS),e):rS},listUnknownFields(e){var t;return null!==(t=e[tS])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[tS]},writeUnknownFields(e,t){const n=e[tS];if(n)for(const e of n)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,n,r){const o=e;Array.isArray(o[tS])||(o[tS]=[]),o[tS].push({no:t,wireType:n,data:r})},readMessage(e,t,n,r){const o=e.getType(),i=void 0===n?t.len:t.pos+n;for(;t.pos<i;){const[n,i]=t.tag(),a=o.fields.find(n);if(!a){const o=t.skip(i);r.readUnknownFields&&this.onUnknownField(e,n,i,o);continue}let s=e,c=a.repeated,l=a.localName;switch(a.oneof&&(s=s[a.oneof.localName],s.case!=l&&delete s.value,s.case=l,l="value"),a.kind){case"scalar":case"enum":const e="enum"==a.kind?Lg.INT32:a.T;if(c){let n=s[l];if(i==Gg.LengthDelimited&&e!=Lg.STRING&&e!=Lg.BYTES){let r=t.uint32()+t.pos;for(;t.pos<r;)n.push(aS(t,e))}else n.push(aS(t,e))}else s[l]=aS(t,e);break;case"message":const n=a.T;c?s[l].push(oS(t,new n,r)):s[l]instanceof Dg?oS(t,s[l],r):(s[l]=oS(t,new n,r),!n.fieldWrapper||a.oneof||a.repeated||(s[l]=n.fieldWrapper.unwrapField(s[l])));break;case"map":let[o,u]=iS(a,t,r);s[l][o]=u}}}}),{writeMessage(e,t,n){const r=e.getType();for(const o of r.fields.byNumber()){let r,i=o.repeated,a=o.localName;if(o.oneof){const t=e[o.oneof.localName];if(t.case!==a)continue;r=t.value}else r=e[a];switch(o.kind){case"scalar":case"enum":let e="enum"==o.kind?Lg.INT32:o.T;if(i)if(o.packed)uS(t,e,o.no,r);else for(const n of r)lS(t,e,o.no,n,!0);else void 0!==r&&lS(t,e,o.no,r,!!o.oneof||o.opt);break;case"message":if(i)for(const e of r)cS(t,n,o.T,o.no,e);else cS(t,n,o.T,o.no,r);break;case"map":for(const[e,i]of Object.entries(r))sS(t,n,o,e,i)}}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),US=Object.assign(Object.assign({},{setEnumType:_g,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const r of n.fields.byMember()){const n=r.localName,o=t,i=e;if(void 0!==i[n])switch(r.kind){case"oneof":const e=i[n].case;if(void 0===e)continue;const t=r.findField(e);let a=i[n].value;!t||"message"!=t.kind||a instanceof t.T?t&&"scalar"===t.kind&&t.T===Lg.BYTES&&(a=PS(a)):a=new t.T(a),o[n]={case:e,value:a};break;case"scalar":case"enum":let s=i[n];r.T===Lg.BYTES&&(s=r.repeated?s.map(PS):PS(s)),o[n]=s;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Lg.BYTES)for(const[e,t]of Object.entries(i[n]))o[n][e]=PS(t);else Object.assign(o[n],i[n]);break;case"message":const e=r.V.T;for(const t of Object.keys(i[n])){let r=i[n][t];e.fieldWrapper||(r=new e(r)),o[n][t]=r}}break;case"message":const c=r.T;if(r.repeated)o[n]=i[n].map((e=>e instanceof c?e:new c(e)));else if(void 0!==i[n]){const e=i[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?o[n]=PS(e):o[n]=e:o[n]=e instanceof c?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every((e=>{const r=t[e.localName],o=n[e.localName];if(e.repeated){if(r.length!==o.length)return!1;switch(e.kind){case"message":return r.every(((t,n)=>e.T.equals(t,o[n])));case"scalar":return r.every(((t,n)=>Xg(e.T,t,o[n])));case"enum":return r.every(((e,t)=>Xg(Lg.INT32,e,o[t])))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":return e.T.equals(r,o);case"enum":return Xg(Lg.INT32,r,o);case"scalar":return Xg(e.T,r,o);case"oneof":if(r.case!==o.case)return!1;const t=e.findField(r.case);if(void 0===t)return!0;switch(t.kind){case"message":return t.T.equals(r.value,o.value);case"enum":return Xg(Lg.INT32,r.value,o.value);case"scalar":return Xg(t.T,r.value,o.value)}throw new Error("oneof cannot contain ".concat(t.kind));case"map":const n=Object.keys(r).concat(Object.keys(o));switch(e.V.kind){case"message":const t=e.V.T;return n.every((e=>t.equals(r[e],o[e])));case"enum":return n.every((e=>Xg(Lg.INT32,r[e],o[e])));case"scalar":const i=e.V.T;return n.every((e=>Xg(i,r[e],o[e])))}}})),clone(e){const t=e.getType(),n=new t,r=n;for(const n of t.fields.byMember()){const t=e[n.localName];let o;if(n.repeated)o=t.map(OS);else if("map"==n.kind){o=r[n.localName];for(const[e,n]of Object.entries(t))o[e]=OS(n)}else o="oneof"==n.kind?n.findField(t.case)?{case:t.case,value:OS(t.value)}:{case:void 0}:OS(t);r[n.localName]=o}return n}}),{newFieldList:e=>new ES(e,KS),initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,r=e;if(t.repeated)r[n]=[];else switch(t.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=Qg(t.T)}}}}),{syntax:"proto3",json:LS,bin:NS,util:US,makeMessageType(e,t,n){return function(e,t,n,r){var o;const i=null!==(o=null==r?void 0:r.localName)&&void 0!==o?o:t.substring(t.lastIndexOf(".")+1),a={[i]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[i];return Object.setPrototypeOf(a.prototype,new Dg),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new a).fromBinary(e,t),fromJson:(e,t)=>(new a).fromJson(e,t),fromJsonString:(e,t)=>(new a).fromJsonString(e,t),equals:(t,n)=>e.util.equals(a,t,n)}),a}(this,e,t,n)},makeEnum:function(e,t,n){const r={};for(const e of t){const t=Mg(e);r[t.localName]=t.no,r[t.no]=t.localName}return _g(r,e,t),r},makeEnumType:Ag,getEnumType:function(e){const t=e[Ig];return kg(t,"missing enum type on enum object"),t}});var LS,NS,US,BS,FS,zS,WS,qS,HS,ZS,VS,JS,GS;function KS(e){var t,n,r;const o=[];let i;for(const a of"function"==typeof e?e():e){const e=a;if(e.localName=CS(a.name,void 0!==a.oneof),e.jsonName=null!==(t=a.jsonName)&&void 0!==t?t:TS(a.name),e.repeated=null!==(n=a.repeated)&&void 0!==n&&n,e.packed=null!==(r=a.packed)&&void 0!==r?r:"enum"==a.kind||"scalar"==a.kind&&a.T!=Lg.BYTES&&a.T!=Lg.STRING,void 0!==a.oneof){const t="string"==typeof a.oneof?a.oneof:a.oneof.name;i&&i.name==t||(i=new MS(t)),e.oneof=i,i.addField(e)}o.push(e)}return o}class $S extends Dg{constructor(e){super(),this.seconds=Jg.zero,this.nanos=0,DS.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(DS.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Jg.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return $S.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new $S({seconds:Jg.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new $S).fromBinary(e,t)}static fromJson(e,t){return(new $S).fromJson(e,t)}static fromJsonString(e,t){return(new $S).fromJsonString(e,t)}static equals(e,t){return DS.util.equals($S,e,t)}}$S.runtime=DS,$S.typeName="google.protobuf.Timestamp",$S.fields=DS.util.newFieldList((()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])),function(e){e[e.DEFAULT_AC=0]="DEFAULT_AC",e[e.OPUS=1]="OPUS",e[e.AAC=2]="AAC"}(BS||(BS={})),DS.util.setEnumType(BS,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]),function(e){e[e.DEFAULT_VC=0]="DEFAULT_VC",e[e.H264_BASELINE=1]="H264_BASELINE",e[e.H264_MAIN=2]="H264_MAIN",e[e.H264_HIGH=3]="H264_HIGH",e[e.VP8=4]="VP8"}(FS||(FS={})),DS.util.setEnumType(FS,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA"}(zS||(zS={})),DS.util.setEnumType(zS,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"}(WS||(WS={})),DS.util.setEnumType(WS,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF"}(qS||(qS={})),DS.util.setEnumType(qS,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT"}(HS||(HS={})),DS.util.setEnumType(HS,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"}]),function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"}(ZS||(ZS={})),DS.util.setEnumType(ZS,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),function(e){e[e.UNKNOWN_REASON=0]="UNKNOWN_REASON",e[e.CLIENT_INITIATED=1]="CLIENT_INITIATED",e[e.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",e[e.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",e[e.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",e[e.ROOM_DELETED=5]="ROOM_DELETED",e[e.STATE_MISMATCH=6]="STATE_MISMATCH",e[e.JOIN_FAILURE=7]="JOIN_FAILURE"}(VS||(VS={})),DS.util.setEnumType(VS,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]),function(e){e[e.RR_UNKNOWN=0]="RR_UNKNOWN",e[e.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",e[e.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",e[e.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",e[e.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"}(JS||(JS={})),DS.util.setEnumType(JS,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),function(e){e[e.SE_UNKNOWN=0]="SE_UNKNOWN",e[e.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",e[e.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"}(GS||(GS={})),DS.util.setEnumType(GS,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let YS=class e extends Dg{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=Jg.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,DS.util.initPartial(e,this)}static fromBinary(t,n){return(new e).fromBinary(t,n)}static fromJson(t,n){return(new e).fromJson(t,n)}static fromJsonString(t,n){return(new e).fromJsonString(t,n)}static equals(t,n){return DS.util.equals(e,t,n)}};YS.runtime=DS,YS.typeName="livekit.Room",YS.fields=DS.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:XS,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:12,name:"playout_delay",kind:"message",T:QS}]));class XS extends Dg{constructor(e){super(),this.mime="",this.fmtpLine="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new XS).fromBinary(e,t)}static fromJson(e,t){return(new XS).fromJson(e,t)}static fromJsonString(e,t){return(new XS).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(XS,e,t)}}XS.runtime=DS,XS.typeName="livekit.Codec",XS.fields=DS.util.newFieldList((()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]));class QS extends Dg{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new QS).fromBinary(e,t)}static fromJson(e,t){return(new QS).fromJson(e,t)}static fromJsonString(e,t){return(new QS).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(QS,e,t)}}QS.runtime=DS,QS.typeName="livekit.PlayoutDelay",QS.fields=DS.util.newFieldList((()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]));class ew extends Dg{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new ew).fromBinary(e,t)}static fromJson(e,t){return(new ew).fromJson(e,t)}static fromJsonString(e,t){return(new ew).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(ew,e,t)}}ew.runtime=DS,ew.typeName="livekit.ParticipantPermission",ew.fields=DS.util.newFieldList((()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:DS.getEnumType(WS),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8}]));class tw extends Dg{constructor(e){super(),this.sid="",this.identity="",this.state=nw.JOINING,this.tracks=[],this.metadata="",this.joinedAt=Jg.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new tw).fromBinary(e,t)}static fromJson(e,t){return(new tw).fromJson(e,t)}static fromJsonString(e,t){return(new tw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(tw,e,t)}}var nw,rw,ow,iw,aw,sw;tw.runtime=DS,tw.typeName="livekit.ParticipantInfo",tw.fields=DS.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:DS.getEnumType(nw)},{no:4,name:"tracks",kind:"message",T:uw,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:ew},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}])),function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED"}(nw||(nw={})),DS.util.setEnumType(nw,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class cw extends Dg{constructor(e){super(),DS.util.initPartial(e,this)}static fromBinary(e,t){return(new cw).fromBinary(e,t)}static fromJson(e,t){return(new cw).fromJson(e,t)}static fromJsonString(e,t){return(new cw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(cw,e,t)}}cw.runtime=DS,cw.typeName="livekit.Encryption",cw.fields=DS.util.newFieldList((()=>[])),function(e){e[e.NONE=0]="NONE",e[e.GCM=1]="GCM",e[e.CUSTOM=2]="CUSTOM"}(rw||(rw={})),DS.util.setEnumType(rw,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class lw extends Dg{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new lw).fromBinary(e,t)}static fromJson(e,t){return(new lw).fromJson(e,t)}static fromJsonString(e,t){return(new lw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(lw,e,t)}}lw.runtime=DS,lw.typeName="livekit.SimulcastCodecInfo",lw.fields=DS.util.newFieldList((()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:dw,repeated:!0}]));class uw extends Dg{constructor(e){super(),this.sid="",this.type=zS.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=WS.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=rw.NONE,this.stream="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new uw).fromBinary(e,t)}static fromJson(e,t){return(new uw).fromJson(e,t)}static fromJsonString(e,t){return(new uw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(uw,e,t)}}uw.runtime=DS,uw.typeName="livekit.TrackInfo",uw.fields=DS.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:DS.getEnumType(zS)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:DS.getEnumType(WS)},{no:10,name:"layers",kind:"message",T:dw,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:lw,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:DS.getEnumType(rw)},{no:17,name:"stream",kind:"scalar",T:9}]));class dw extends Dg{constructor(e){super(),this.quality=qS.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new dw).fromBinary(e,t)}static fromJson(e,t){return(new dw).fromJson(e,t)}static fromJsonString(e,t){return(new dw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(dw,e,t)}}dw.runtime=DS,dw.typeName="livekit.VideoLayer",dw.fields=DS.util.newFieldList((()=>[{no:1,name:"quality",kind:"enum",T:DS.getEnumType(qS)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]));class pw extends Dg{constructor(e){super(),this.kind=ow.RELIABLE,this.value={case:void 0},DS.util.initPartial(e,this)}static fromBinary(e,t){return(new pw).fromBinary(e,t)}static fromJson(e,t){return(new pw).fromJson(e,t)}static fromJsonString(e,t){return(new pw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(pw,e,t)}}pw.runtime=DS,pw.typeName="livekit.DataPacket",pw.fields=DS.util.newFieldList((()=>[{no:1,name:"kind",kind:"enum",T:DS.getEnumType(ow)},{no:2,name:"user",kind:"message",T:mw,oneof:"value"},{no:3,name:"speaker",kind:"message",T:fw,oneof:"value"}])),(sw=ow||(ow={}))[sw.RELIABLE=0]="RELIABLE",sw[sw.LOSSY=1]="LOSSY",DS.util.setEnumType(ow,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class fw extends Dg{constructor(e){super(),this.speakers=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new fw).fromBinary(e,t)}static fromJson(e,t){return(new fw).fromJson(e,t)}static fromJsonString(e,t){return(new fw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(fw,e,t)}}fw.runtime=DS,fw.typeName="livekit.ActiveSpeakerUpdate",fw.fields=DS.util.newFieldList((()=>[{no:1,name:"speakers",kind:"message",T:hw,repeated:!0}]));class hw extends Dg{constructor(e){super(),this.sid="",this.level=0,this.active=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new hw).fromBinary(e,t)}static fromJson(e,t){return(new hw).fromJson(e,t)}static fromJsonString(e,t){return(new hw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(hw,e,t)}}hw.runtime=DS,hw.typeName="livekit.SpeakerInfo",hw.fields=DS.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]));class mw extends Dg{constructor(e){super(),this.participantSid="",this.payload=new Uint8Array(0),this.destinationSids=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new mw).fromBinary(e,t)}static fromJson(e,t){return(new mw).fromJson(e,t)}static fromJsonString(e,t){return(new mw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(mw,e,t)}}mw.runtime=DS,mw.typeName="livekit.UserPacket",mw.fields=DS.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]));class yw extends Dg{constructor(e){super(),this.participantSid="",this.trackSids=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new yw).fromBinary(e,t)}static fromJson(e,t){return(new yw).fromJson(e,t)}static fromJsonString(e,t){return(new yw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(yw,e,t)}}yw.runtime=DS,yw.typeName="livekit.ParticipantTracks",yw.fields=DS.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]));class bw extends Dg{constructor(e){super(),this.edition=iw.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new bw).fromBinary(e,t)}static fromJson(e,t){return(new bw).fromJson(e,t)}static fromJsonString(e,t){return(new bw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(bw,e,t)}}bw.runtime=DS,bw.typeName="livekit.ServerInfo",bw.fields=DS.util.newFieldList((()=>[{no:1,name:"edition",kind:"enum",T:DS.getEnumType(iw)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}])),function(e){e[e.Standard=0]="Standard",e[e.Cloud=1]="Cloud"}(iw||(iw={})),DS.util.setEnumType(iw,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class vw extends Dg{constructor(e){super(),this.sdk=aw.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new vw).fromBinary(e,t)}static fromJson(e,t){return(new vw).fromJson(e,t)}static fromJsonString(e,t){return(new vw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(vw,e,t)}}vw.runtime=DS,vw.typeName="livekit.ClientInfo",vw.fields=DS.util.newFieldList((()=>[{no:1,name:"sdk",kind:"enum",T:DS.getEnumType(aw)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}])),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.REACT_NATIVE=7]="REACT_NATIVE",e[e.RUST=8]="RUST"}(aw||(aw={})),DS.util.setEnumType(aw,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"}]);class gw extends Dg{constructor(e){super(),this.resumeConnection=ZS.UNSET,this.forceRelay=ZS.UNSET,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new gw).fromBinary(e,t)}static fromJson(e,t){return(new gw).fromJson(e,t)}static fromJsonString(e,t){return(new gw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(gw,e,t)}}gw.runtime=DS,gw.typeName="livekit.ClientConfiguration",gw.fields=DS.util.newFieldList((()=>[{no:1,name:"video",kind:"message",T:Sw},{no:2,name:"screen",kind:"message",T:Sw},{no:3,name:"resume_connection",kind:"enum",T:DS.getEnumType(ZS)},{no:4,name:"disabled_codecs",kind:"message",T:ww},{no:5,name:"force_relay",kind:"enum",T:DS.getEnumType(ZS)}]));class Sw extends Dg{constructor(e){super(),this.hardwareEncoder=ZS.UNSET,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new Sw).fromBinary(e,t)}static fromJson(e,t){return(new Sw).fromJson(e,t)}static fromJsonString(e,t){return(new Sw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(Sw,e,t)}}Sw.runtime=DS,Sw.typeName="livekit.VideoConfiguration",Sw.fields=DS.util.newFieldList((()=>[{no:1,name:"hardware_encoder",kind:"enum",T:DS.getEnumType(ZS)}]));class ww extends Dg{constructor(e){super(),this.codecs=[],this.publish=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new ww).fromBinary(e,t)}static fromJson(e,t){return(new ww).fromJson(e,t)}static fromJsonString(e,t){return(new ww).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(ww,e,t)}}ww.runtime=DS,ww.typeName="livekit.DisabledCodecs",ww.fields=DS.util.newFieldList((()=>[{no:1,name:"codecs",kind:"message",T:XS,repeated:!0},{no:2,name:"publish",kind:"message",T:XS,repeated:!0}]));class kw extends Dg{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=Jg.zero,this.headerBytes=Jg.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=Jg.zero,this.headerBytesDuplicate=Jg.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=Jg.zero,this.headerBytesPadding=Jg.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,this.sampleRate=0,this.driftMs=0,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new kw).fromBinary(e,t)}static fromJson(e,t){return(new kw).fromJson(e,t)}static fromJsonString(e,t){return(new kw).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(kw,e,t)}}kw.runtime=DS,kw.typeName="livekit.RTPStats",kw.fields=DS.util.newFieldList((()=>[{no:1,name:"start_time",kind:"message",T:$S},{no:2,name:"end_time",kind:"message",T:$S},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:$S},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:$S},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:$S},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:$S},{no:42,name:"sample_rate",kind:"scalar",T:1},{no:43,name:"drift_ms",kind:"scalar",T:1}]));class Ow extends Dg{constructor(e){super(),this.unixMicro=Jg.zero,this.ticks=0,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new Ow).fromBinary(e,t)}static fromJson(e,t){return(new Ow).fromJson(e,t)}static fromJsonString(e,t){return(new Ow).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(Ow,e,t)}}Ow.runtime=DS,Ow.typeName="livekit.TimedVersion",Ow.fields=DS.util.newFieldList((()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]));const Pw=7e3,Ew=[0,300,1200,2700,4800,Pw,Pw,Pw,Pw,Pw];function Cw(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function Tw(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}var xw,jw={exports:{}},Rw="object"==typeof Reflect?Reflect:null,Iw=Rw&&"function"==typeof Rw.apply?Rw.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};xw=Rw&&"function"==typeof Rw.ownKeys?Rw.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var _w=Number.isNaN||function(e){return e!=e};function Aw(){Aw.init.call(this)}jw.exports=Aw,jw.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}qw(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&qw(e,"error",t,{once:!0})}(e,o)}))},Aw.EventEmitter=Aw,Aw.prototype._events=void 0,Aw.prototype._eventsCount=0,Aw.prototype._maxListeners=void 0;var Mw=10;function Dw(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Lw(e){return void 0===e._maxListeners?Aw.defaultMaxListeners:e._maxListeners}function Nw(e,t,n,r){var o,i,a,s;if(Dw(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(o=Lw(e))>0&&a.length>o&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function Uw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Bw(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=Uw.bind(r);return o.listener=n,r.wrapFn=o,o}function Fw(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):Ww(o,o.length)}function zw(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function Ww(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function qw(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(Aw,"defaultMaxListeners",{enumerable:!0,get:function(){return Mw},set:function(e){if("number"!=typeof e||e<0||_w(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Mw=e}}),Aw.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Aw.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||_w(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Aw.prototype.getMaxListeners=function(){return Lw(this)},Aw.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var s=o[e];if(void 0===s)return!1;if("function"==typeof s)Iw(s,this,t);else{var c=s.length,l=Ww(s,c);for(n=0;n<c;++n)Iw(l[n],this,t)}return!0},Aw.prototype.addListener=function(e,t){return Nw(this,e,t,!1)},Aw.prototype.on=Aw.prototype.addListener,Aw.prototype.prependListener=function(e,t){return Nw(this,e,t,!0)},Aw.prototype.once=function(e,t){return Dw(t),this.on(e,Bw(this,e,t)),this},Aw.prototype.prependOnceListener=function(e,t){return Dw(t),this.prependListener(e,Bw(this,e,t)),this},Aw.prototype.removeListener=function(e,t){var n,r,o,i,a;if(Dw(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},Aw.prototype.off=Aw.prototype.removeListener,Aw.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},Aw.prototype.listeners=function(e){return Fw(this,e,!0)},Aw.prototype.rawListeners=function(e){return Fw(this,e,!1)},Aw.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):zw.call(e,t)},Aw.prototype.listenerCount=zw,Aw.prototype.eventNames=function(){return this._eventsCount>0?xw(this._events):[]};var Hw=jw.exports;let Zw=!0,Vw=!0;function Jw(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function Gw(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);const i=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,i),o.apply(this,[e,i])};const i=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return i.apply(this,arguments);if(!this._eventMap[t].has(n))return i.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,i.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Kw(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Zw=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function $w(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Vw=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Yw(){if("object"==typeof window){if(Zw)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function Xw(e,t){Vw&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Qw(e){return"[object Object]"===Object.prototype.toString.call(e)}function ek(e){return Qw(e)?Object.keys(e).reduce((function(t,n){const r=Qw(e[n]),o=r?ek(e[n]):e[n],i=r&&!Object.keys(o).length;return void 0===o||i?t:Object.assign(t,{[n]:o})}),{}):e}function tk(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((r=>{r.endsWith("Id")?tk(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((t=>{tk(e,e.get(t),n)}))})))}function nk(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;const i=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)})),i.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&tk(e,n,o)}))})),o}const rk=Yw;function ok(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[o("min",n)]=r.ideal,t.optional.push(e),e={},e[o("max",n)]=r.ideal,t.optional.push(e)):(e[o("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,o){if(t.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let i=e.video.facingMode;i=i&&("object"==typeof i?i:{ideal:i});const a=t.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===i.exact||"environment"===i.ideal?t=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let a=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!a&&n.length&&t.includes("back")&&(a=n[n.length-1]),a&&(e.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=r(e.video),rk("chrome: "+JSON.stringify(e)),o(e)}))}e.video=r(e.video)}return rk("chrome: "+JSON.stringify(e)),o(e)},i=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){o(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(i(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return o(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(i(e))))))}}}function ik(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function ak(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const o=new Event("track");o.track=n.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],this.dispatchEvent(o)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],this.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Gw(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function sk(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ck(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const o=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},i=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(i(o(e)))};return t.apply(this,[r,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(i(o(t)))},n])})).then(n,r)}}function lk(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>nk(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Gw(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>nk(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function uk(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),o.apply(this,arguments)}}function dk(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return uk(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const o=e.RTCPeerConnection.prototype.removeStream;function i(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(o.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const o=this.getSenders().find((e=>e.track===t));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const i=this._streams[n.id];if(i)i.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=i(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>i(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:i(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function pk(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function fk(e,t){Gw(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var hk=Object.freeze({__proto__:null,fixNegotiationNeeded:fk,shimAddTrackRemoveTrack:dk,shimAddTrackRemoveTrackWithNative:uk,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,o=n.video&&n.video.height,i=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}},r&&(n.video.mandatory.maxWidth=r),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:sk,shimGetStats:ck,shimGetUserMedia:ok,shimMediaStream:ik,shimOnTrack:ak,shimPeerConnection:pk,shimSenderReceiverGetStats:lk});function mk(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){Xw("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function yk(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function bk(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,o,i]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!o)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(o,i)}}function vk(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function gk(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Gw(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Sk(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){Xw("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function wk(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function kk(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function Ok(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Pk(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Ek(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var Ck=Object.freeze({__proto__:null,shimAddTransceiver:kk,shimCreateAnswer:Ek,shimCreateOffer:Pk,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:Ok,shimGetUserMedia:mk,shimOnTrack:yk,shimPeerConnection:bk,shimRTCDataChannel:wk,shimReceiverGetStats:gk,shimRemoveStream:Sk,shimSenderGetStats:vk});function Tk(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r&&r.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function xk(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function jk(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,i=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};let s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}function Rk(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Ik(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function Ik(e){return e&&void 0!==e.video?Object.assign({},e,{video:ek(e.video)}):e}function _k(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];void 0===r.urls&&r.url?(Xw("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Ak(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mk(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Dk(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Lk=Object.freeze({__proto__:null,shimAudioContext:Dk,shimCallbacksAPI:jk,shimConstraints:Ik,shimCreateOfferLegacy:Mk,shimGetUserMedia:Rk,shimLocalStreamsAPI:Tk,shimRTCIceServerUrls:_k,shimRemoteStreamsAPI:xk,shimTrackEventTransceiver:Ak}),Nk={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const r=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<r.length;e++)n=r[e].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],o=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&o?{usernameFragment:r.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" ");n.profile=r[2];for(let o=3;o<r.length;o++){const i=r[o],a=t.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){const r=t.parseRtpMap(a),o=t.matchPrefix(e,"a=fmtp:"+i+" ");switch(r.parameters=o.length?t.parseFmtp(o[0]):{},r.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(t.parseRtcpFb),n.codecs.push(r),r.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(r.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const o=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{o.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));let o=0;return n.codecs.forEach((e=>{e.maxptime>o&&(o=e.maxptime)})),o>0&&(r+="a=maxptime:"+o+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){const n=[],r=t.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),i=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),r.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),o&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:i?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const o=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=0===o.length;const i=t.matchPrefix(e,"a=rtcp-mux");return n.mux=i.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const r=t.matchPrefix(e,"a=msid:");if(1===r.length)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const o=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return o.length>0?(n=o[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");let o;r.length>0&&(o=parseInt(r[0].substring(19),10)),isNaN(o)&&(o=65536);const i=t.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:o}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,r){let o;const i=void 0!==n?n:2;return o=e||t.generateSessionId(),"v=0\r\no="+(r||"thisisadapterortc")+" "+o+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const r=t.splitLines(e);for(let e=0;e<r.length;e++)switch(r[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[e].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let e=0;e<n.length;e++)if(n[e].length<2||"="!==n[e].charAt(1))return!1;return!0},e.exports=t}(Nk);var Uk=Nk.exports,Bk=hg(Uk),Fk=fg({__proto__:null,default:Bk},[Uk]);function zk(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),r=Bk.parseCandidate(e.candidate);for(const e in r)e in n||Object.defineProperty(n,e,{value:r[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Gw(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Wk(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Gw(e,"icecandidate",(e=>{if(e.candidate){const t=Bk.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function qk(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=Bk.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Bk.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},o=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},i=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const o=Bk.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?r=parseInt(o[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=o(e),n=i(arguments[0],e);let a;a=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const s={};Object.defineProperty(s,"maxMessageSize",{get:()=>a}),this._sctp=s}return a.apply(this,arguments)}}function Hk(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],o=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Gw(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Zk(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Vk(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Jk(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Gk(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}var Kk,$k,Yk,Xk,Qk=Object.freeze({__proto__:null,removeExtmapAllowMixed:Vk,shimAddIceCandidateNullOrEmpty:Jk,shimConnectionState:Zk,shimMaxMessageSize:qk,shimParameterlessSetLocalDescription:Gk,shimRTCIceCandidate:zk,shimRTCIceCandidateRelayProtocol:Wk,shimSendThrowTypeError:Hk});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Yw,r=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Jw(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Jw(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Jw(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),o={browserDetails:r,commonShim:Qk,extractVersion:Jw,disableLog:Kw,disableWarnings:$w,sdp:Fk};switch(r.browser){case"chrome":if(!hk||!pk||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=hk,Jk(e,r),Gk(e),ok(e,r),ik(e),pk(e,r),ak(e),dk(e,r),sk(e),ck(e),lk(e),fk(e,r),zk(e),Wk(e),Zk(e),qk(e,r),Hk(e),Vk(e,r);break;case"firefox":if(!Ck||!bk||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=Ck,Jk(e,r),Gk(e),mk(e,r),bk(e,r),yk(e),Sk(e),vk(e),gk(e),wk(e),kk(e),Ok(e),Pk(e),Ek(e),zk(e),Zk(e),qk(e,r),Hk(e);break;case"safari":if(!Lk||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=Lk,Jk(e,r),Gk(e),_k(e),Mk(e),jk(e),Tk(e),xk(e),Ak(e),Rk(e),Dk(e),zk(e),Wk(e),qk(e,r),Hk(e),Vk(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window}),function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER"}(Kk||(Kk={})),DS.util.setEnumType(Kk,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED"}($k||($k={})),DS.util.setEnumType($k,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.TLS=2]="TLS"}(Yk||(Yk={})),DS.util.setEnumType(Yk,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class eO extends Dg{constructor(e){super(),this.message={case:void 0},DS.util.initPartial(e,this)}static fromBinary(e,t){return(new eO).fromBinary(e,t)}static fromJson(e,t){return(new eO).fromJson(e,t)}static fromJsonString(e,t){return(new eO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(eO,e,t)}}eO.runtime=DS,eO.typeName="livekit.SignalRequest",eO.fields=DS.util.newFieldList((()=>[{no:1,name:"offer",kind:"message",T:uO,oneof:"message"},{no:2,name:"answer",kind:"message",T:uO,oneof:"message"},{no:3,name:"trickle",kind:"message",T:oO,oneof:"message"},{no:4,name:"add_track",kind:"message",T:rO,oneof:"message"},{no:5,name:"mute",kind:"message",T:iO,oneof:"message"},{no:6,name:"subscription",kind:"message",T:pO,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:fO,oneof:"message"},{no:8,name:"leave",kind:"message",T:hO,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:mO,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:xO,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:RO,oneof:"message"},{no:13,name:"simulate",kind:"message",T:_O,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:yO,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:AO,oneof:"message"}]));class tO extends Dg{constructor(e){super(),this.message={case:void 0},DS.util.initPartial(e,this)}static fromBinary(e,t){return(new tO).fromBinary(e,t)}static fromJson(e,t){return(new tO).fromJson(e,t)}static fromJsonString(e,t){return(new tO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(tO,e,t)}}tO.runtime=DS,tO.typeName="livekit.SignalResponse",tO.fields=DS.util.newFieldList((()=>[{no:1,name:"join",kind:"message",T:aO,oneof:"message"},{no:2,name:"answer",kind:"message",T:uO,oneof:"message"},{no:3,name:"offer",kind:"message",T:uO,oneof:"message"},{no:4,name:"trickle",kind:"message",T:oO,oneof:"message"},{no:5,name:"update",kind:"message",T:dO,oneof:"message"},{no:6,name:"track_published",kind:"message",T:cO,oneof:"message"},{no:8,name:"leave",kind:"message",T:hO,oneof:"message"},{no:9,name:"mute",kind:"message",T:iO,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:vO,oneof:"message"},{no:11,name:"room_update",kind:"message",T:gO,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:wO,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:OO,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:CO,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:jO,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:lO,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:sO,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:MO,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:NO,oneof:"message"}]));class nO extends Dg{constructor(e){super(),this.codec="",this.cid="",this.enableSimulcastLayers=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new nO).fromBinary(e,t)}static fromJson(e,t){return(new nO).fromJson(e,t)}static fromJsonString(e,t){return(new nO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(nO,e,t)}}nO.runtime=DS,nO.typeName="livekit.SimulcastCodec",nO.fields=DS.util.newFieldList((()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:3,name:"enable_simulcast_layers",kind:"scalar",T:8}]));class rO extends Dg{constructor(e){super(),this.cid="",this.name="",this.type=zS.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=WS.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=rw.NONE,this.stream="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new rO).fromBinary(e,t)}static fromJson(e,t){return(new rO).fromJson(e,t)}static fromJsonString(e,t){return(new rO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(rO,e,t)}}rO.runtime=DS,rO.typeName="livekit.AddTrackRequest",rO.fields=DS.util.newFieldList((()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:DS.getEnumType(zS)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:DS.getEnumType(WS)},{no:9,name:"layers",kind:"message",T:dw,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:nO,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:DS.getEnumType(rw)},{no:15,name:"stream",kind:"scalar",T:9}]));class oO extends Dg{constructor(e){super(),this.candidateInit="",this.target=Kk.PUBLISHER,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new oO).fromBinary(e,t)}static fromJson(e,t){return(new oO).fromJson(e,t)}static fromJsonString(e,t){return(new oO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(oO,e,t)}}oO.runtime=DS,oO.typeName="livekit.TrickleRequest",oO.fields=DS.util.newFieldList((()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:DS.getEnumType(Kk)}]));class iO extends Dg{constructor(e){super(),this.sid="",this.muted=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new iO).fromBinary(e,t)}static fromJson(e,t){return(new iO).fromJson(e,t)}static fromJsonString(e,t){return(new iO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(iO,e,t)}}iO.runtime=DS,iO.typeName="livekit.MuteTrackRequest",iO.fields=DS.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]));class aO extends Dg{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),DS.util.initPartial(e,this)}static fromBinary(e,t){return(new aO).fromBinary(e,t)}static fromJson(e,t){return(new aO).fromJson(e,t)}static fromJsonString(e,t){return(new aO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(aO,e,t)}}aO.runtime=DS,aO.typeName="livekit.JoinResponse",aO.fields=DS.util.newFieldList((()=>[{no:1,name:"room",kind:"message",T:YS},{no:2,name:"participant",kind:"message",T:tw},{no:3,name:"other_participants",kind:"message",T:tw,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:bO,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:gw},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:bw},{no:13,name:"sif_trailer",kind:"scalar",T:12}]));class sO extends Dg{constructor(e){super(),this.iceServers=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new sO).fromBinary(e,t)}static fromJson(e,t){return(new sO).fromJson(e,t)}static fromJsonString(e,t){return(new sO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(sO,e,t)}}sO.runtime=DS,sO.typeName="livekit.ReconnectResponse",sO.fields=DS.util.newFieldList((()=>[{no:1,name:"ice_servers",kind:"message",T:bO,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:gw}]));class cO extends Dg{constructor(e){super(),this.cid="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new cO).fromBinary(e,t)}static fromJson(e,t){return(new cO).fromJson(e,t)}static fromJsonString(e,t){return(new cO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(cO,e,t)}}cO.runtime=DS,cO.typeName="livekit.TrackPublishedResponse",cO.fields=DS.util.newFieldList((()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:uw}]));class lO extends Dg{constructor(e){super(),this.trackSid="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new lO).fromBinary(e,t)}static fromJson(e,t){return(new lO).fromJson(e,t)}static fromJsonString(e,t){return(new lO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(lO,e,t)}}lO.runtime=DS,lO.typeName="livekit.TrackUnpublishedResponse",lO.fields=DS.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]));class uO extends Dg{constructor(e){super(),this.type="",this.sdp="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new uO).fromBinary(e,t)}static fromJson(e,t){return(new uO).fromJson(e,t)}static fromJsonString(e,t){return(new uO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(uO,e,t)}}uO.runtime=DS,uO.typeName="livekit.SessionDescription",uO.fields=DS.util.newFieldList((()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]));class dO extends Dg{constructor(e){super(),this.participants=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new dO).fromBinary(e,t)}static fromJson(e,t){return(new dO).fromJson(e,t)}static fromJsonString(e,t){return(new dO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(dO,e,t)}}dO.runtime=DS,dO.typeName="livekit.ParticipantUpdate",dO.fields=DS.util.newFieldList((()=>[{no:1,name:"participants",kind:"message",T:tw,repeated:!0}]));class pO extends Dg{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new pO).fromBinary(e,t)}static fromJson(e,t){return(new pO).fromJson(e,t)}static fromJsonString(e,t){return(new pO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(pO,e,t)}}pO.runtime=DS,pO.typeName="livekit.UpdateSubscription",pO.fields=DS.util.newFieldList((()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:yw,repeated:!0}]));class fO extends Dg{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=qS.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new fO).fromBinary(e,t)}static fromJson(e,t){return(new fO).fromJson(e,t)}static fromJsonString(e,t){return(new fO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(fO,e,t)}}fO.runtime=DS,fO.typeName="livekit.UpdateTrackSettings",fO.fields=DS.util.newFieldList((()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:DS.getEnumType(qS)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]));class hO extends Dg{constructor(e){super(),this.canReconnect=!1,this.reason=VS.UNKNOWN_REASON,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new hO).fromBinary(e,t)}static fromJson(e,t){return(new hO).fromJson(e,t)}static fromJsonString(e,t){return(new hO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(hO,e,t)}}hO.runtime=DS,hO.typeName="livekit.LeaveRequest",hO.fields=DS.util.newFieldList((()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:DS.getEnumType(VS)}]));class mO extends Dg{constructor(e){super(),this.trackSid="",this.layers=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new mO).fromBinary(e,t)}static fromJson(e,t){return(new mO).fromJson(e,t)}static fromJsonString(e,t){return(new mO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(mO,e,t)}}mO.runtime=DS,mO.typeName="livekit.UpdateVideoLayers",mO.fields=DS.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:dw,repeated:!0}]));class yO extends Dg{constructor(e){super(),this.metadata="",this.name="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new yO).fromBinary(e,t)}static fromJson(e,t){return(new yO).fromJson(e,t)}static fromJsonString(e,t){return(new yO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(yO,e,t)}}yO.runtime=DS,yO.typeName="livekit.UpdateParticipantMetadata",yO.fields=DS.util.newFieldList((()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]));class bO extends Dg{constructor(e){super(),this.urls=[],this.username="",this.credential="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new bO).fromBinary(e,t)}static fromJson(e,t){return(new bO).fromJson(e,t)}static fromJsonString(e,t){return(new bO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(bO,e,t)}}bO.runtime=DS,bO.typeName="livekit.ICEServer",bO.fields=DS.util.newFieldList((()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]));class vO extends Dg{constructor(e){super(),this.speakers=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new vO).fromBinary(e,t)}static fromJson(e,t){return(new vO).fromJson(e,t)}static fromJsonString(e,t){return(new vO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(vO,e,t)}}vO.runtime=DS,vO.typeName="livekit.SpeakersChanged",vO.fields=DS.util.newFieldList((()=>[{no:1,name:"speakers",kind:"message",T:hw,repeated:!0}]));class gO extends Dg{constructor(e){super(),DS.util.initPartial(e,this)}static fromBinary(e,t){return(new gO).fromBinary(e,t)}static fromJson(e,t){return(new gO).fromJson(e,t)}static fromJsonString(e,t){return(new gO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(gO,e,t)}}gO.runtime=DS,gO.typeName="livekit.RoomUpdate",gO.fields=DS.util.newFieldList((()=>[{no:1,name:"room",kind:"message",T:YS}]));class SO extends Dg{constructor(e){super(),this.participantSid="",this.quality=HS.POOR,this.score=0,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new SO).fromBinary(e,t)}static fromJson(e,t){return(new SO).fromJson(e,t)}static fromJsonString(e,t){return(new SO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(SO,e,t)}}SO.runtime=DS,SO.typeName="livekit.ConnectionQualityInfo",SO.fields=DS.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:DS.getEnumType(HS)},{no:3,name:"score",kind:"scalar",T:2}]));class wO extends Dg{constructor(e){super(),this.updates=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new wO).fromBinary(e,t)}static fromJson(e,t){return(new wO).fromJson(e,t)}static fromJsonString(e,t){return(new wO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(wO,e,t)}}wO.runtime=DS,wO.typeName="livekit.ConnectionQualityUpdate",wO.fields=DS.util.newFieldList((()=>[{no:1,name:"updates",kind:"message",T:SO,repeated:!0}]));class kO extends Dg{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=$k.ACTIVE,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new kO).fromBinary(e,t)}static fromJson(e,t){return(new kO).fromJson(e,t)}static fromJsonString(e,t){return(new kO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(kO,e,t)}}kO.runtime=DS,kO.typeName="livekit.StreamStateInfo",kO.fields=DS.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:DS.getEnumType($k)}]));class OO extends Dg{constructor(e){super(),this.streamStates=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new OO).fromBinary(e,t)}static fromJson(e,t){return(new OO).fromJson(e,t)}static fromJsonString(e,t){return(new OO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(OO,e,t)}}OO.runtime=DS,OO.typeName="livekit.StreamStateUpdate",OO.fields=DS.util.newFieldList((()=>[{no:1,name:"stream_states",kind:"message",T:kO,repeated:!0}]));class PO extends Dg{constructor(e){super(),this.quality=qS.LOW,this.enabled=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new PO).fromBinary(e,t)}static fromJson(e,t){return(new PO).fromJson(e,t)}static fromJsonString(e,t){return(new PO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(PO,e,t)}}PO.runtime=DS,PO.typeName="livekit.SubscribedQuality",PO.fields=DS.util.newFieldList((()=>[{no:1,name:"quality",kind:"enum",T:DS.getEnumType(qS)},{no:2,name:"enabled",kind:"scalar",T:8}]));class EO extends Dg{constructor(e){super(),this.codec="",this.qualities=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new EO).fromBinary(e,t)}static fromJson(e,t){return(new EO).fromJson(e,t)}static fromJsonString(e,t){return(new EO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(EO,e,t)}}EO.runtime=DS,EO.typeName="livekit.SubscribedCodec",EO.fields=DS.util.newFieldList((()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:PO,repeated:!0}]));class CO extends Dg{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new CO).fromBinary(e,t)}static fromJson(e,t){return(new CO).fromJson(e,t)}static fromJsonString(e,t){return(new CO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(CO,e,t)}}CO.runtime=DS,CO.typeName="livekit.SubscribedQualityUpdate",CO.fields=DS.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:PO,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:EO,repeated:!0}]));class TO extends Dg{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",DS.util.initPartial(e,this)}static fromBinary(e,t){return(new TO).fromBinary(e,t)}static fromJson(e,t){return(new TO).fromJson(e,t)}static fromJsonString(e,t){return(new TO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(TO,e,t)}}TO.runtime=DS,TO.typeName="livekit.TrackPermission",TO.fields=DS.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]));class xO extends Dg{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new xO).fromBinary(e,t)}static fromJson(e,t){return(new xO).fromJson(e,t)}static fromJsonString(e,t){return(new xO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(xO,e,t)}}xO.runtime=DS,xO.typeName="livekit.SubscriptionPermission",xO.fields=DS.util.newFieldList((()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:TO,repeated:!0}]));class jO extends Dg{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new jO).fromBinary(e,t)}static fromJson(e,t){return(new jO).fromJson(e,t)}static fromJsonString(e,t){return(new jO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(jO,e,t)}}jO.runtime=DS,jO.typeName="livekit.SubscriptionPermissionUpdate",jO.fields=DS.util.newFieldList((()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]));class RO extends Dg{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new RO).fromBinary(e,t)}static fromJson(e,t){return(new RO).fromJson(e,t)}static fromJsonString(e,t){return(new RO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(RO,e,t)}}RO.runtime=DS,RO.typeName="livekit.SyncState",RO.fields=DS.util.newFieldList((()=>[{no:1,name:"answer",kind:"message",T:uO},{no:2,name:"subscription",kind:"message",T:pO},{no:3,name:"publish_tracks",kind:"message",T:cO,repeated:!0},{no:4,name:"data_channels",kind:"message",T:IO,repeated:!0},{no:5,name:"offer",kind:"message",T:uO}]));class IO extends Dg{constructor(e){super(),this.label="",this.id=0,this.target=Kk.PUBLISHER,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new IO).fromBinary(e,t)}static fromJson(e,t){return(new IO).fromJson(e,t)}static fromJsonString(e,t){return(new IO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(IO,e,t)}}IO.runtime=DS,IO.typeName="livekit.DataChannelInfo",IO.fields=DS.util.newFieldList((()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:DS.getEnumType(Kk)}]));class _O extends Dg{constructor(e){super(),this.scenario={case:void 0},DS.util.initPartial(e,this)}static fromBinary(e,t){return(new _O).fromBinary(e,t)}static fromJson(e,t){return(new _O).fromJson(e,t)}static fromJsonString(e,t){return(new _O).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(_O,e,t)}}_O.runtime=DS,_O.typeName="livekit.SimulateScenario",_O.fields=DS.util.newFieldList((()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:DS.getEnumType(Yk),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"}]));class AO extends Dg{constructor(e){super(),this.timestamp=Jg.zero,this.rtt=Jg.zero,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new AO).fromBinary(e,t)}static fromJson(e,t){return(new AO).fromJson(e,t)}static fromJsonString(e,t){return(new AO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(AO,e,t)}}AO.runtime=DS,AO.typeName="livekit.Ping",AO.fields=DS.util.newFieldList((()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]));class MO extends Dg{constructor(e){super(),this.lastPingTimestamp=Jg.zero,this.timestamp=Jg.zero,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new MO).fromBinary(e,t)}static fromJson(e,t){return(new MO).fromJson(e,t)}static fromJsonString(e,t){return(new MO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(MO,e,t)}}MO.runtime=DS,MO.typeName="livekit.Pong",MO.fields=DS.util.newFieldList((()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]));class DO extends Dg{constructor(e){super(),this.regions=[],DS.util.initPartial(e,this)}static fromBinary(e,t){return(new DO).fromBinary(e,t)}static fromJson(e,t){return(new DO).fromJson(e,t)}static fromJsonString(e,t){return(new DO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(DO,e,t)}}DO.runtime=DS,DO.typeName="livekit.RegionSettings",DO.fields=DS.util.newFieldList((()=>[{no:1,name:"regions",kind:"message",T:LO,repeated:!0}]));class LO extends Dg{constructor(e){super(),this.region="",this.url="",this.distance=Jg.zero,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new LO).fromBinary(e,t)}static fromJson(e,t){return(new LO).fromJson(e,t)}static fromJsonString(e,t){return(new LO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(LO,e,t)}}LO.runtime=DS,LO.typeName="livekit.RegionInfo",LO.fields=DS.util.newFieldList((()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]));class NO extends Dg{constructor(e){super(),this.trackSid="",this.err=GS.SE_UNKNOWN,DS.util.initPartial(e,this)}static fromBinary(e,t){return(new NO).fromBinary(e,t)}static fromJson(e,t){return(new NO).fromJson(e,t)}static fromJsonString(e,t){return(new NO).fromJsonString(e,t)}static equals(e,t){return DS.util.equals(NO,e,t)}}NO.runtime=DS,NO.typeName="livekit.SubscriptionResponse",NO.fields=DS.util.newFieldList((()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:DS.getEnumType(GS)}]));class UO extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}class BO extends UO{constructor(e,t,n){super(1,e),this.status=n,this.reason=t}}class FO extends UO{constructor(e){super(21,null!=e?e:"device is unsupported")}}class zO extends UO{constructor(e){super(20,null!=e?e:"track is invalid")}}class WO extends UO{constructor(e){super(10,null!=e?e:"unsupported server")}}class qO extends UO{constructor(e){super(12,null!=e?e:"unexpected connection state")}}class HO extends UO{constructor(e){super(13,null!=e?e:"unable to negotiate")}}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(Xk||(Xk={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(Xk||(Xk={}));class ZO{}ZO.setTimeout=function(){return setTimeout(...arguments)},ZO.setInterval=function(){return setInterval(...arguments)},ZO.clearTimeout=function(){return clearTimeout(...arguments)},ZO.clearInterval=function(){return clearInterval(...arguments)};const VO=/version\/(\d+(\.?_?\d+)+)/i;let JO;function GO(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===e&&"undefined"==typeof navigator)return;const n=(null!=e?e:navigator.userAgent).toLowerCase();if(void 0===JO||t){const e=KO.find((e=>{let{test:t}=e;return t.test(n)}));JO=null==e?void 0:e.describe(n)}return JO}const KO=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:$O(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:$O(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:$O(VO,e),os:e.includes("mobile/")?"iOS":"macOS"})}];function $O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=t.match(e);return r&&r.length>=n&&r[n]||""}class YO{constructor(e,t,n,r,o){this.width=e,this.height=t,this.encoding={maxBitrate:n,maxFramerate:r,priority:o}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const XO=["vp8","h264"],QO=["vp8","h264","vp9","av1"];function eP(e){return!!XO.find((t=>t===e))}function tP(e,t){return(null==e?void 0:e.toLowerCase().replace(/audio\/|video\//y,""))===(null==t?void 0:t.toLowerCase().replace(/audio\/|video\//y,""))}var nP;!function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3},e.musicStereo={maxBitrate:48e3},e.musicHighQuality={maxBitrate:64e3},e.musicHighQualityStereo={maxBitrate:96e3}}(nP||(nP={}));const rP={h90:new YO(160,90,9e4,20),h180:new YO(320,180,16e4,20),h216:new YO(384,216,18e4,20),h360:new YO(640,360,45e4,20),h540:new YO(960,540,8e5,25),h720:new YO(1280,720,17e5,30),h1080:new YO(1920,1080,3e6,30),h1440:new YO(2560,1440,5e6,30),h2160:new YO(3840,2160,8e6,30)},oP={h120:new YO(160,120,7e4,20),h180:new YO(240,180,125e3,20),h240:new YO(320,240,14e4,20),h360:new YO(480,360,33e4,20),h480:new YO(640,480,5e5,20),h540:new YO(720,540,6e5,25),h720:new YO(960,720,13e5,30),h1080:new YO(1440,1080,23e5,30),h1440:new YO(1920,1440,38e5,30)},iP={h360fps3:new YO(640,360,2e5,3,"medium"),h720fps5:new YO(1280,720,4e5,5,"medium"),h720fps15:new YO(1280,720,15e5,15,"medium"),h720fps30:new YO(1280,720,2e6,30,"medium"),h1080fps15:new YO(1920,1080,25e5,15,"medium"),h1080fps30:new YO(1920,1080,4e6,30,"medium")};var aP,sP,cP,lP,uP;!function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.StateChanged="connectionStateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged"}(aP||(aP={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded"}(sP||(sP={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate"}(cP||(cP={})),(uP=lP||(lP={})).Message="message",uP.Muted="muted",uP.Unmuted="unmuted",uP.Restarted="restarted",uP.Ended="ended",uP.Subscribed="subscribed",uP.Unsubscribed="unsubscribed",uP.UpdateSettings="updateSettings",uP.UpdateSubscription="updateSubscription",uP.AudioPlaybackStarted="audioPlaybackStarted",uP.AudioPlaybackFailed="audioPlaybackFailed",uP.AudioSilenceDetected="audioSilenceDetected",uP.VisibilityChanged="visibilityChanged",uP.VideoDimensionsChanged="videoDimensionsChanged",uP.ElementAttached="elementAttached",uP.ElementDetached="elementDetached",uP.UpstreamPaused="upstreamPaused",uP.UpstreamResumed="upstreamResumed",uP.SubscriptionPermissionChanged="subscriptionPermissionChanged",uP.SubscriptionStatusChanged="subscriptionStatusChanged",uP.SubscriptionFailed="subscriptionFailed";const dP=[];class pP extends Hw.EventEmitter{constructor(e,t){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=pP.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout((()=>this.handleAppVisibilityChanged()),5e3):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=pP.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===pP.Kind.Video&&(t="video"),0===this.attachedElements.length&&pP.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(dP.forEach((t=>{null!==t.parentElement||e||(e=t)})),e&&dP.splice(dP.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),fP(this.mediaStreamTrack,e);const n=e.srcObject.getTracks();return n.some((e=>"audio"===e.kind))&&e.play().then((()=>{this.emit(lP.AudioPlaybackStarted)})).catch((t=>{"NotAllowedError"===t.name?this.emit(lP.AudioPlaybackFailed,t):wg.warn("could not playback audio",t),e&&n.some((e=>"video"===e.kind))&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch((()=>{})))})),this.emit(lP.ElementAttached,e),e}detach(e){try{if(e){hP(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(lP.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach((e=>{hP(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(lP.ElementDetached,e)})),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),dP.forEach((e=>{e.parentElement||(t=!1)})),t&&dP.push(e)}}handleAppVisibilityChanged(){return Cw(this,void 0,void 0,(function*(){this.isInBackground="hidden"===document.visibilityState}))}addAppVisibilityListener(){xP()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){xP()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function fP(e,t){let n,r;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,r="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),r.includes(e)||(r.forEach((e=>{n.removeTrack(e)})),n.addTrack(e)),t.autoplay=!0,t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(CP()||EP())&&t instanceof HTMLVideoElement&&setTimeout((()=>{t.srcObject=n,t.play().catch((()=>{}))}),0))}function hP(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}function mP(e,t){return Object.keys(t).forEach((n=>{void 0===e[n]&&(e[n]=t[n])})),e}function yP(e){const t={};if(e.video)if("object"==typeof e.video){const n={},r=n,o=e.video;Object.keys(o).forEach((e=>{"resolution"===e?mP(r,o.resolution):r[e]=o[e]})),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?"object"==typeof e.audio?t.audio=e.audio:t.audio=!0:t.audio=!1,t}function bP(){const e="undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext);if(e)return new e({latencyHint:"interactive"})}!function(e){let t,n,r;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(r=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return zS.AUDIO;case t.Video:return zS.VIDEO;default:return zS.DATA}},e.kindFromProto=function(e){switch(e){case zS.AUDIO:return t.Audio;case zS.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return WS.CAMERA;case n.Microphone:return WS.MICROPHONE;case n.ScreenShare:return WS.SCREEN_SHARE;case n.ScreenShareAudio:return WS.SCREEN_SHARE_AUDIO;default:return WS.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case WS.CAMERA:return n.Camera;case WS.MICROPHONE:return n.Microphone;case WS.SCREEN_SHARE:return n.ScreenShare;case WS.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case $k.ACTIVE:return r.Active;case $k.PAUSED:return r.Paused;default:return r.Unknown}}}(pP||(pP={}));const vP="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function gP(e){return Cw(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}function SP(){return"addTransceiver"in RTCPeerConnection.prototype}function wP(){return"addTrack"in RTCPeerConnection.prototype}function kP(e){return"av1"===e||"vp9"===e}function OP(e){return!!document&&(e||(e=document.createElement("audio")),"setSinkId"in e)}const PP={Chrome:"100",Safari:"15",Firefox:"100"};function EP(){var e;return"Firefox"===(null===(e=GO())||void 0===e?void 0:e.name)}function CP(){var e;return"Safari"===(null===(e=GO())||void 0===e?void 0:e.name)}function TP(){return!!xP()&&/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent)}function xP(){return"undefined"!=typeof document}function jP(){return"ReactNative"==navigator.product}function RP(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function IP(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function _P(){if(!jP())return;let e=IP();return e?e.platform:void 0}function AP(){if(xP())return window.devicePixelRatio;if(jP()){let e=IP();if(e)return e.devicePixelRatio}return 1}function MP(e,t){const n=e.split("."),r=t.split("."),o=Math.min(n.length,r.length);for(let e=0;e<o;++e){const t=parseInt(n[e],10),i=parseInt(r[e],10);if(t>i)return 1;if(t<i)return-1;if(e===o-1&&t===i)return 0}return""===e&&""!==t?-1:""===t?1:n.length==r.length?0:n.length<r.length?-1:1}function DP(e){for(const t of e)t.target.handleResize(t)}function LP(e){for(const t of e)t.target.handleVisibilityChanged(t)}let NP=null;const UP=()=>(NP||(NP=new ResizeObserver(DP)),NP);let BP=null;const FP=()=>(BP||(BP=new IntersectionObserver(LP,{root:null,rootMargin:"0px"})),BP);let zP;function WP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=document.createElement("canvas");o.width=e,o.height=t;const i=o.getContext("2d");null==i||i.fillRect(0,0,o.width,o.height),r&&i&&(i.beginPath(),i.arc(e/2,t/2,50,0,2*Math.PI,!0),i.closePath(),i.fillStyle="grey",i.fill());const a=o.captureStream(),[s]=a.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}function qP(){if(!zP){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const r=e.createMediaStreamDestination();if(t.connect(n),n.connect(r),t.start(),[zP]=r.stream.getAudioTracks(),!zP)throw Error("Could not get empty media stream audio track");zP.enabled=!1}return zP.clone()}class HP{constructor(e,t){this.onFinally=t,this.promise=new Promise(((t,n)=>Cw(this,void 0,void 0,(function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})))).finally((()=>{var e;return null===(e=this.onFinally)||void 0===e?void 0:e.call(this)}))}}class ZP{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise((t=>e=()=>{this._locks-=1,t()})),n=this._locking.then((()=>e));return this._locking=this._locking.then((()=>t)),n}}function VP(e){if("string"==typeof e)return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function JP(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}var GP;!function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(GP||(GP={}));class KP{constructor(){this.pendingTasks=new Map,this.taskMutex=new ZP,this.nextTaskIndex=0}run(e){return Cw(this,void 0,void 0,(function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:GP.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=GP.RUNNING,yield e()}finally{t.status=GP.COMPLETED,this.pendingTasks.delete(t.id),n()}}))}flush(){return Cw(this,void 0,void 0,(function*(){return this.run((()=>Cw(this,void 0,void 0,(function*(){}))))}))}snapshot(){return Array.from(this.pendingTasks.values())}}const $P=["syncState","trickle","offer","answer","simulate","leave"];class YP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rtt=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.isConnected=!1,this.isReconnecting=!1,this.useJSON=e,this.requestQueue=new KP,this.queuedRequests=[],this.closingLock=new ZP}join(e,t,n,r){return Cw(this,void 0,void 0,(function*(){return this.isConnected=!1,this.options=n,yield this.connect(e,t,n,r)}))}reconnect(e,t,n,r){return Cw(this,void 0,void 0,(function*(){if(this.options)return this.isReconnecting=!0,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:r}));wg.warn("attempted to reconnect without signal options being set, ignoring")}))}connect(e,t,n,r){this.connectOptions=n,e=(e=function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e)).replace(/\/$/,""),e+="/rtc";const o=function(e,t,n){var r;const o=new URLSearchParams;return o.set("access_token",e),n.reconnect&&(o.set("reconnect","1"),n.sid&&o.set("sid",n.sid)),o.set("auto_subscribe",n.autoSubscribe?"1":"0"),o.set("sdk",jP()?"reactnative":"js"),o.set("version",t.version),o.set("protocol",t.protocol.toString()),t.deviceModel&&o.set("device_model",t.deviceModel),t.os&&o.set("os",t.os),t.osVersion&&o.set("os_version",t.osVersion),t.browser&&o.set("browser",t.browser),t.browserVersion&&o.set("browser_version",t.browserVersion),void 0!==n.publishOnly&&o.set("publish",n.publishOnly),n.adaptiveStream&&o.set("adaptive_stream","1"),n.reconnectReason&&o.set("reconnect_reason",n.reconnectReason.toString()),(null===(r=navigator.connection)||void 0===r?void 0:r.type)&&o.set("network",navigator.connection.type),"?".concat(o.toString())}(t,function(){var e;const t=new vw({sdk:aw.JS,protocol:9,version:"1.13.4"});return jP()&&(t.os=null!==(e=_P())&&void 0!==e?e:""),t}(),n);return new Promise(((t,i)=>Cw(this,void 0,void 0,(function*(){const a=()=>Cw(this,void 0,void 0,(function*(){this.close(),clearTimeout(s),i(new BO("room connection has been cancelled (signal)"))})),s=setTimeout((()=>{this.close(),i(new BO("room connection has timed out (signal)"))}),n.websocketTimeout);(null==r?void 0:r.aborted)&&a(),null==r||r.addEventListener("abort",a),wg.debug("connecting to ".concat(e+o)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(s)},this.ws.onerror=t=>Cw(this,void 0,void 0,(function*(){if(this.isConnected)this.handleWSError(t);else{clearTimeout(s);try{const t=yield fetch("http".concat(e.substring(2),"/validate").concat(o));if(t.status.toFixed(0).startsWith("4")){const e=yield t.text();i(new BO(e,0,t.status))}else i(new BO("Internal error",2,t.status))}catch(e){i(new BO("server was not reachable",1))}}})),this.ws.onmessage=e=>Cw(this,void 0,void 0,(function*(){var o,s,c,l;let u;if("string"==typeof e.data){const t=JSON.parse(e.data);u=tO.fromJson(t)}else{if(!(e.data instanceof ArrayBuffer))return void wg.error("could not decode websocket message: ".concat(typeof e.data));u=tO.fromBinary(new Uint8Array(e.data))}if(!this.isConnected){let e=!1;if("join"===(null===(o=u.message)||void 0===o?void 0:o.case)?(this.isConnected=!0,null==r||r.removeEventListener("abort",a),this.pingTimeoutDuration=u.message.value.pingTimeout,this.pingIntervalDuration=u.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(wg.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),t(u.message.value)):n.reconnect?(this.isConnected=!0,null==r||r.removeEventListener("abort",a),this.startPingInterval(),"reconnect"===(null===(s=u.message)||void 0===s?void 0:s.case)?t(null===(c=u.message)||void 0===c?void 0:c.value):(t(),e=!0)):n.reconnect||i(new BO("did not receive join response, got ".concat(null===(l=u.message)||void 0===l?void 0:l.case," instead"))),!e)return}this.signalLatency&&(yield gP(this.signalLatency)),this.handleSignalResponse(u)})),this.ws.onclose=e=>{wg.warn("websocket closed",{ev:e}),this.handleOnClose(e.reason)}}))))}close(){return Cw(this,void 0,void 0,(function*(){const e=yield this.closingLock.lock();try{if(this.isConnected=!1,this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const e=new Promise((e=>{this.ws?this.ws.onclose=()=>{e()}:e()}));this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([e,gP(250)])),this.ws=void 0}}finally{this.clearPingInterval(),e()}}))}sendOffer(e){wg.debug("sending offer",e),this.sendRequest({case:"offer",value:QP(e)})}sendAnswer(e){return wg.debug("sending answer"),this.sendRequest({case:"answer",value:QP(e)})}sendIceCandidate(e,t){return wg.trace("sending ice candidate",e),this.sendRequest({case:"trickle",value:new oO({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new iO({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return this.sendRequest({case:"updateMetadata",value:new yO({metadata:e,name:t})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new mO({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new xO({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Jg.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new AO({timestamp:Jg.parse(Date.now()),rtt:Jg.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new hO({canReconnect:!1,reason:VS.CLIENT_INITIATED})})}sendRequest(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Cw(this,void 0,void 0,(function*(){const n=!t&&!function(e){const t=$P.indexOf(e.case)>=0;return wg.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(n&&this.isReconnecting)return void this.queuedRequests.push((()=>Cw(this,void 0,void 0,(function*(){yield this.sendRequest(e,!0)}))));if(t||(yield this.requestQueue.flush()),this.signalLatency&&(yield gP(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN)return void wg.error("cannot send signal request before connected, type: ".concat(null==e?void 0:e.case));const r=new eO({message:e});try{this.useJSON?this.ws.send(r.toJsonString()):this.ws.send(r.toBinary())}catch(e){wg.error("error sending signal message",{error:e})}}))}handleSignalResponse(e){var t,n;const r=e.message;if(null!=r)if("answer"===r.case){const e=XP(r.value);this.onAnswer&&this.onAnswer(e)}else if("offer"===r.case){const e=XP(r.value);this.onOffer&&this.onOffer(e)}else if("trickle"===r.case){const e=JSON.parse(r.value.candidateInit);this.onTrickle&&this.onTrickle(e,r.value.target)}else"update"===r.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=r.value.participants)&&void 0!==t?t:[]):"trackPublished"===r.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(r.value):"speakersChanged"===r.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=r.value.speakers)&&void 0!==n?n:[]):"leave"===r.case?this.onLeave&&this.onLeave(r.value):"mute"===r.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(r.value.sid,r.value.muted):"roomUpdate"===r.case?this.onRoomUpdate&&r.value.room&&this.onRoomUpdate(r.value.room):"connectionQuality"===r.case?this.onConnectionQuality&&this.onConnectionQuality(r.value):"streamStateUpdate"===r.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(r.value):"subscribedQualityUpdate"===r.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(r.value):"subscriptionPermissionUpdate"===r.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(r.value):"refreshToken"===r.case?this.onTokenRefresh&&this.onTokenRefresh(r.value):"trackUnpublished"===r.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(r.value):"subscriptionResponse"===r.case?this.onSubscriptionError&&this.onSubscriptionError(r.value):"pong"===r.case?this.resetPingTimeout():"pongResp"===r.case?(this.rtt=Date.now()-Number.parseInt(r.value.lastPingTimestamp.toString()),this.resetPingTimeout()):wg.debug("unsupported message",r);else wg.debug("received unsupported message")}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}this.isReconnecting=!1}handleOnClose(e){return Cw(this,void 0,void 0,(function*(){if(!this.isConnected)return;const t=this.onClose;yield this.close(),wg.debug("websocket connection closed: ".concat(e)),t&&t(e)}))}handleWSError(e){wg.error("websocket error",e)}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=ZO.setTimeout((()=>{wg.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString())),this.handleOnClose("ping timeout")}),1e3*this.pingTimeoutDuration):wg.warn("ping timeout duration not set")}clearPingTimeout(){this.pingTimeout&&ZO.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(wg.debug("start ping interval"),this.pingInterval=ZO.setInterval((()=>{this.sendPing()}),1e3*this.pingIntervalDuration)):wg.warn("ping interval duration not set")}clearPingInterval(){wg.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&ZO.clearInterval(this.pingInterval)}}function XP(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function QP(e){return new uO({sdp:e.sdp,type:e.type})}const eE="lk_e2ee";var tE,nE,rE,oE;function iE(){return void 0!==window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(tE||(tE={})),function(e){e.KeyRatcheted="keyRatcheted"}(nE||(nE={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(rE||(rE={})),function(e){e.Error="cryptorError"}(oE||(oE={}));class aE extends Hw.EventEmitter{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.onKeyRatcheted=(e,t)=>{wg.debug("key ratcheted event received",{material:e,keyIndex:t})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},KEY_PROVIDER_DEFAULTS),e),this.on(tE.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,t,n){const r={key:e,participantIdentity:t,keyIndex:n};this.keyInfoMap.set("".concat(null!=t?t:"shared","-").concat(null!=n?n:0),r),this.emit(tE.SetKey,r)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,t){this.emit(tE.RatchetRequest,e,t)}}function sE(e,t,n){var r,o,i;void 0===t&&(t=50),void 0===n&&(n={});var a=null!=(r=n.isImmediate)&&r,s=null!=(o=n.callback)&&o,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var p=function(){var t=[].slice.call(arguments),n=this;return new Promise((function(r,o){var c=a&&void 0===i;if(void 0!==i&&clearTimeout(i),i=setTimeout((function(){if(i=void 0,l=Date.now(),!a){var r=e.apply(n,t);s&&s(r),u.forEach((function(e){return(0,e.resolve)(r)})),u=[]}}),d()),c){var p=e.apply(n,t);return s&&s(p),r(p)}u.push({resolve:r,reject:o})}))};return p.cancel=function(e){void 0!==i&&clearTimeout(i),u.forEach((function(t){return(0,t.reject)(e)})),u=[]},p}const cE="default";class lE{static getInstance(){return void 0===this.instance&&(this.instance=new lE),this.instance}getDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n;return Cw(this,void 0,void 0,(function*(){if((null===(n=lE.userMediaPromiseMap)||void 0===n?void 0:n.size)>0){wg.debug("awaiting getUserMedia promise");try{e?yield lE.userMediaPromiseMap.get(e):yield Promise.all(lE.userMediaPromiseMap.values())}catch(e){wg.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(t&&(!CP()||!this.hasDeviceInUse(e))&&(0===r.length||r.some((t=>{const n=""===t.label,r=!e||t.kind===e;return n&&r})))){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e},n=yield navigator.mediaDevices.getUserMedia(t);r=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach((e=>{e.stop()}))}return e&&(r=r.filter((t=>t.kind===e))),r}))}normalizeDeviceId(e,t,n){return Cw(this,void 0,void 0,(function*(){if(t!==cE)return t;const r=(yield this.getDevices(e)).find((e=>e.groupId===n&&e.deviceId!==cE));return null==r?void 0:r.deviceId}))}hasDeviceInUse(e){return e?lE.userMediaPromiseMap.has(e):lE.userMediaPromiseMap.size>0}}lE.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],lE.userMediaPromiseMap=new Map;class uE extends pP{get constraints(){return this._constraints}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch((()=>wg.debug("track mute bounce got cancelled by an unmute event"))),this.debouncedTrackMuteHandler=sE((()=>Cw(this,void 0,void 0,(function*(){yield this.pauseUpstream()}))),5e3),this.handleTrackUnmuteEvent=()=>Cw(this,void 0,void 0,(function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()})),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(lP.Ended,this)},this.reacquireTrack=!1,this.providedByUser=r,this.muteLock=new ZP,this.pauseUpstreamLock=new ZP,this.processorLock=new ZP,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==pP.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}setMediaStreamTrack(e,t){return Cw(this,void 0,void 0,(function*(){if(e===this._mediaStreamTrack&&!t)return;let n;if(this._mediaStreamTrack&&(this.attachedElements.forEach((e=>{hP(this._mediaStreamTrack,e)})),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop()),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e&&this.processorElement){if(wg.debug("restarting processor"),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");fP(e,this.processorElement),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),n=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(null!=n?n:e)),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach((t=>{fP(null!=n?n:e,t)})))}))}waitForDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return Cw(this,void 0,void 0,(function*(){if(this.kind===pP.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");const t=Date.now();for(;Date.now()-t<e;){const e=this.dimensions;if(e)return e;yield gP(50)}throw new zO("unable to get track dimensions after timeout")}))}getDeviceId(){return Cw(this,void 0,void 0,(function*(){if(this.source===pP.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this._mediaStreamTrack.getSettings(),n=this.kind===pP.Kind.Audio?"audioinput":"videoinput";return lE.getInstance().normalizeDeviceId(n,e,t)}))}mute(){return Cw(this,void 0,void 0,(function*(){return this.setTrackMuted(!0),this}))}unmute(){return Cw(this,void 0,void 0,(function*(){return this.setTrackMuted(!1),this}))}replaceTrack(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Cw(this,void 0,void 0,(function*(){if(!this.sender)throw new zO("unable to replace an unpublished track");return wg.debug("replace MediaStreamTrack"),yield this.setMediaStreamTrack(e),this.providedByUser=t,this.processor&&(yield this.stopProcessor()),this}))}restart(e){return Cw(this,void 0,void 0,(function*(){e||(e=this._constraints),wg.debug("restarting track with constraints",e);const t={audio:!1,video:!1};this.kind===pP.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach((e=>{hP(this.mediaStreamTrack,e)})),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const n=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return n.addEventListener("ended",this.handleEnded),wg.debug("re-acquired MediaStreamTrack"),yield this.setMediaStreamTrack(n),this._constraints=e,this.emit(lP.Restarted,this),this}))}setTrackMuted(e){wg.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?lP.Muted:lP.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Cw(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),TP()&&(wg.debug("visibility changed, is in Background: ".concat(this.isInBackground)),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(wg.debug("track needs to be reacquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))}))}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return Cw(this,void 0,void 0,(function*(){const e=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void wg.warn("unable to pause upstream for an unpublished track");this._isUpstreamPaused=!0,this.emit(lP.UpstreamPaused,this);const t=GO();if("Safari"===(null==t?void 0:t.name)&&MP(t.version,"12.0")<0)throw new FO("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}}))}resumeUpstream(){return Cw(this,void 0,void 0,(function*(){const e=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void wg.warn("unable to resume upstream for an unpublished track");this._isUpstreamPaused=!1,this.emit(lP.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}}))}getRTCStatsReport(){var e;return Cw(this,void 0,void 0,(function*(){if(null===(e=this.sender)||void 0===e?void 0:e.getStats)return yield this.sender.getStats()}))}setProcessor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n,r;return Cw(this,void 0,void 0,(function*(){const o=yield this.processorLock.lock();try{if(wg.debug("setting up processor"),this.processor&&(yield this.stopProcessor()),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement=null!==(n=this.processorElement)&&void 0!==n?n:document.createElement(this.kind),this.processorElement.muted=!0,fP(this._mediaStreamTrack,this.processorElement),this.processorElement.play().catch((e=>wg.error("failed to play processor element",{error:e})));const i={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(i),this.processor=e,this.processor.processedTrack){for(const e of this.attachedElements)e!==this.processorElement&&t&&(hP(this._mediaStreamTrack,e),fP(this.processor.processedTrack,e));yield null===(r=this.sender)||void 0===r?void 0:r.replaceTrack(this.processor.processedTrack)}}finally{o()}}))}getProcessor(){return this.processor}stopProcessor(){var e,t;return Cw(this,void 0,void 0,(function*(){this.processor&&(wg.debug("stopping processor"),null===(e=this.processor.processedTrack)||void 0===e||e.stop(),yield this.processor.destroy(),this.processor=void 0,null===(t=this.processorElement)||void 0===t||t.remove(),this.processorElement=void 0,yield this.restart())}))}}class dE extends Hw.EventEmitter{constructor(e){super(),this.onWorkerMessage=e=>{var t,n;const{kind:r,data:o}=e.data;switch(r){case"error":wg.error(o.error.message),this.emit(rE.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"enable":if(this.encryptionEnabled!==o.enabled&&o.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(rE.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(o.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(rE.ParticipantEncryptionStatusChanged,o.enabled,e)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"ratchetKey":this.keyProvider.emit(tE.KeyRatcheted,o.material,o.keyIndex)}},this.onWorkerError=e=>{wg.error("e2ee worker encountered an error:",{error:e.error}),this.emit(rE.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!(void 0!==window.RTCRtpSender&&void 0!==window.RTCRtpSender.prototype.createEncodedStreams||iE()))throw new FO("tried to setup end-to-end encryption on an unsupported browser");if(wg.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(wg.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){wg.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):wg.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(cP.RTPVideoMapUpdate,(e=>{this.postRTPMap(e)}))}setupEventListeners(e,t){e.on(aP.TrackPublished,((e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==rw.NONE,t.identity))),e.on(aP.ConnectionStateChanged,(t=>{t===mC.Connected&&e.participants.forEach((e=>{e.tracks.forEach((t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==rw.NONE,e.identity)}))}))})).on(aP.TrackUnsubscribed,((e,t,n)=>{var r;const o={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(r=this.worker)||void 0===r||r.postMessage(o)})).on(aP.TrackSubscribed,((e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)})).on(aP.SignalConnected,(()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),t.getKeys().forEach((e=>{this.postKey(e)}))})),e.localParticipant.on(sP.LocalTrackPublished,(e=>Cw(this,void 0,void 0,(function*(){this.setupE2EESender(e.track,e.track.sender)})))),t.on(tE.SetKey,(e=>this.postKey(e))).on(tE.RatchetRequest,((e,t)=>this.postRatchetRequest(e,t)))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:r}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const i={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(o=this.room)||void 0===o?void 0:o.localParticipant.identity),key:t,keyIndex:r}};this.worker.postMessage(i)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null==n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?function(e){const t=e.split("/")[1].toLowerCase();if(!QO.includes(t))throw Error("Video codec not supported: ".concat(t));return t}(n.mimeType):void 0)}}setupE2EESender(e,t){e instanceof uE&&t?this.handleSender(t,e.mediaStreamID,void 0):t||wg.warn("early return because sender is not ready")}handleReceiver(e,t,n,r){return Cw(this,void 0,void 0,(function*(){if(this.worker){if(iE()){const o={kind:"decode",participantIdentity:n,trackId:t,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(eE in e&&r){const e={kind:"updateCodec",data:{trackId:t,codec:r,participantIdentity:n}};return void this.worker.postMessage(e)}let o=e.writableStream,i=e.readableStream;if(!o||!i){const t=e.createEncodedStreams();e.writableStream=t.writable,o=t.writable,e.readableStream=t.readable,i=t.readable}const a={kind:"decode",data:{readableStream:i,writableStream:o,trackId:t,codec:r,participantIdentity:n}};this.worker.postMessage(a,[i,o])}e[eE]=!0}}))}handleSender(e,t,n){var r;if(!(eE in e)&&this.worker){if(!(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(iE()){wg.info("initialize script transform");const r={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{wg.info("initialize encoded streams");const r=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:r.readable,writableStream:r.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[r.readable,r.writable])}e[eE]=!0}}}var pE={},fE={exports:{}},hE=fE.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(hE).forEach((function(e){hE[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}));var mE=fE.exports;!function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,r){var o=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:o&&!n[e.name]&&(n[e.name]={});var i=e.push?{}:o?n[e.name]:n;!function(e,n,r,o){if(o&&!r)n[o]=t(e[1]);else for(var i=0;i<r.length;i+=1)null!=e[i+1]&&(n[r[i]]=t(e[i+1]))}(r.match(e.reg),i,e.names,e.name),e.push&&n[e.push].push(i)},r=mE,o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},i=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(i.push({rtp:[],fmtp:[]}),a=i[i.length-1]);for(var s=0;s<(r[t]||[]).length;s+=1){var c=r[t][s];if(c.reg.test(o))return n(c,a,o)}})),t.media=i,t};var i=function(e,n){var r=n.split(/=(.+)/,2);return 2===r.length?e[r[0]]=t(r[1]):1===r.length&&n.length>1&&(e[r[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(i,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],r=e.split(" ").map(t),o=0;o<r.length;o+=3)n.push({component:r[o],ip:r[o+1],port:r[o+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(i,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var n,r=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),r=!0),{scid:n,paused:r}}))}))}}(pE);var yE=mE,bE=/%[sdv%]/g,vE=function(e){var t=1,n=arguments,r=n.length;return e.replace(bE,(function(e){if(t>=r)return e;var o=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}}))},gE=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var i=t.names[o];t.name?r.push(n[t.name][i]):r.push(n[t.names[o]])}else r.push(n[t.name]);return vE.apply(null,r)},SE=["v","o","s","i","u","e","p","c","b","t","r","z","a"],wE=["i","c","b","a"],kE=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||SE,r=t.innerOrder||wE,o=[];return n.forEach((function(t){yE[t].forEach((function(n){n.name in e&&null!=e[n.name]?o.push(gE(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){o.push(gE(t,n,e))}))}))})),e.media.forEach((function(e){o.push(gE("m",yE.m[0],e)),r.forEach((function(t){yE[t].forEach((function(n){n.name in e&&null!=e[n.name]?o.push(gE(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){o.push(gE(t,n,e))}))}))}))})),o.join("\r\n")+"\r\n"},OE=pE.parse;const PE="negotiationStarted",EE="negotiationComplete",CE="rtpVideoPayloadTypes";class TE extends Hw.EventEmitter{get pc(){if(this._pc)return this._pc;throw new qO("Expected peer connection to be available")}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=sE((e=>{this.emit(PE);try{this.createAndSendOffer()}catch(t){if(!e)throw t;e(t)}}),100),this._pc="Chrome"===(null===(n=GO())||void 0===n?void 0:n.name)?new RTCPeerConnection(e,t):new RTCPeerConnection(e)}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return Cw(this,void 0,void 0,(function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)}))}setRemoteDescription(e){var t;return Cw(this,void 0,void 0,(function*(){let n;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],r=[],o=OE(null!==(t=e.sdp)&&void 0!==t?t:"");let i=0;return o.media.forEach((e=>{var t;"audio"===e.type&&(e.rtp.some((e=>"opus"===e.codec&&(i=e.payload,!0))),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some((e=>e.payload===i&&"nack"===e.type)))&&r.push(e.mid),e.fmtp.some((t=>t.payload===i&&(t.config.includes("sprop-stereo=1")&&n.push(e.mid),!0))))})),{stereoMids:n,nackMids:r}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const r=OE(null!==(t=e.sdp)&&void 0!==t?t:"");r.media.forEach((e=>{"audio"===e.type&&this.trackBitrates.some((t=>{if(!t.transceiver||e.mid!=t.transceiver.mid)return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let r=!1;for(const o of e.fmtp)if(o.payload===n){o.config=o.config.split(";").filter((e=>!e.includes("maxaveragebitrate"))).join(";"),t.maxbr>0&&(o.config+=";maxaveragebitrate=".concat(1e3*t.maxbr)),r=!0;break}return r||t.maxbr>0&&e.fmtp.push({payload:n,config:"maxaveragebitrate=".concat(1e3*t.maxbr)}),!0}))})),n=kE(r)}yield this.setMungedSDP(e,n,!0),this.pendingCandidates.forEach((e=>{this.pc.addIceCandidate(e)})),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,this.createAndSendOffer()):"answer"===e.type&&(this.emit(EE),e.sdp)&&OE(e.sdp).media.forEach((e=>{"video"===e.type&&this.emit(CE,e.rtp)}))}))}createAndSendOffer(e){var t;return Cw(this,void 0,void 0,(function*(){if(void 0===this.onOffer)return;if((null==e?void 0:e.iceRestart)&&(wg.debug("restarting ICE"),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this.pc.remoteDescription;if(!(null==e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this.pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void wg.warn("could not createOffer with closed peer connection");wg.debug("starting to negotiate");const n=yield this.pc.createOffer(e),r=OE(null!==(t=n.sdp)&&void 0!==t?t:"");r.media.forEach((e=>{"audio"===e.type?xE(e,[],[]):"video"===e.type&&(function(e){var t,n,r,o;if(!kP(null===(n=null===(t=e.rtp[0])||void 0===t?void 0:t.codec)||void 0===n?void 0:n.toLowerCase()))return;let i=0;(null===(r=e.ext)||void 0===r?void 0:r.some((e=>e.uri===vP||(e.value>i&&(i=e.value),!1))))||null===(o=e.ext)||void 0===o||o.push({value:i+1,uri:vP})}(e),this.trackBitrates.some((t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let r=!1;for(const o of e.fmtp)if(o.payload===n){o.config.includes("x-google-start-bitrate")||(o.config+=";x-google-start-bitrate=".concat(.7*t.maxbr)),o.config.includes("x-google-max-bitrate")||(o.config+=";x-google-max-bitrate=".concat(t.maxbr)),r=!0;break}return r||e.fmtp.push({payload:n,config:"x-google-start-bitrate=".concat(.7*t.maxbr,";x-google-max-bitrate=").concat(t.maxbr)}),!0})))})),yield this.setMungedSDP(n,kE(r)),this.onOffer(n)}))}createAndSetAnswer(){var e;return Cw(this,void 0,void 0,(function*(){const t=yield this.pc.createAnswer(),n=OE(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach((e=>{"audio"===e.type&&xE(e,this.remoteStereoMids,this.remoteNackMids)})),yield this.setMungedSDP(t,kE(n)),t}))}setTrackCodecBitrate(e){this.trackBitrates.push(e)}close(){this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)}setMungedSDP(e,t,n){return Cw(this,void 0,void 0,(function*(){if(t){const r=e.sdp;e.sdp=t;try{return wg.debug("setting munged ".concat(n?"remote":"local"," description")),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(n){wg.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:n,sdp:t}),e.sdp=r}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(t){let r="unknown error";t instanceof Error?r=t.message:"string"==typeof t&&(r=t);const o={error:r,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),wg.error("unable to set ".concat(e.type),o),new HO(r)}}))}}function xE(e,t,n){let r=0;e.rtp.some((e=>"opus"===e.codec&&(r=e.payload,!0))),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some((e=>e.payload===r&&"nack"===e.type))&&e.rtcpFb.push({payload:r,type:"nack"}),t.includes(e.mid)&&e.fmtp.some((e=>e.payload===r&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0))))}const jE={audioBitrate:nP.music.maxBitrate,audioPreset:nP.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:iP.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:"vp8",backupCodec:!1},RE={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},IE={resolution:rP.h720.resolution},_E={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:Ew}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,expWebAudioMix:!1},AE={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3},ME="_lossy",DE="_reliable",LE="leave-reconnect";var NE;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(NE||(NE={}));class UE extends Hw.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=AE.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=NE.New,this._isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=e=>{let{channel:t}=e;return Cw(this,void 0,void 0,(function*(){if(t){if(t.label===DE)this.reliableDCSub=t;else{if(t.label!==ME)return;this.lossyDCSub=t}wg.debug("on data channel ".concat(t.id,", ").concat(t.label)),t.onmessage=this.handleDataMessage}}))},this.handleDataMessage=e=>Cw(this,void 0,void 0,(function*(){var t,n;const r=yield this.dataProcessLock.lock();try{let o;if(e.data instanceof ArrayBuffer)o=e.data;else{if(!(e.data instanceof Blob))return void wg.error("unsupported data type",e.data);o=yield e.data.arrayBuffer()}const i=pw.fromBinary(new Uint8Array(o));"speaker"===(null===(t=i.value)||void 0===t?void 0:t.case)?this.emit(cP.ActiveSpeakersUpdate,i.value.value.speakers):"user"===(null===(n=i.value)||void 0===n?void 0:n.case)&&this.emit(cP.DataPacketReceived,i.value.value,i.kind)}finally{r()}})),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;wg.error("DataChannel error on ".concat(t,": ").concat(e.message),n)}else wg.error("Unknown DataChannel error on ".concat(t),e)},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?ow.LOSSY:ow.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;wg.warn("".concat(e," disconnected")),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=Date.now()-this.reconnectStart;let r=this.getNextRetryDelay({elapsedMs:n,retryCount:this.reconnectAttempts});null!==r?(e===LE&&(r=0),wg.debug("reconnecting in ".concat(r,"ms")),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ZO.setTimeout((()=>this.attemptReconnect(t)),r)):(e=>{wg.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up")),this.emit(cP.Disconnected),this.close()})(n)},this.waitForRestarted=()=>new Promise(((e,t)=>{this.pcState===NE.Connected&&e();const n=()=>{this.off(cP.Disconnected,r),e()},r=()=>{this.off(cP.Restarted,n),t()};this.once(cP.Restarted,n),this.once(cP.Disconnected,r)})),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);void 0!==t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(cP.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.isReconnecting&&(this.clearReconnectTimeout(),this.attemptReconnect(JS.RR_SIGNAL_DISCONNECTED))},this.client=new YP,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new ZP,this.dataProcessLock=new ZP,this.dcBufferStatus=new Map([[ow.LOSSY,!0],[ow.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(cP.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(cP.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(cP.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(cP.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(cP.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(cP.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(cP.StreamStateChanged,e)}join(e,t,n,r){return Cw(this,void 0,void 0,(function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,t,n,r);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.publisher||this.configure(o),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,o}catch(o){if(o instanceof BO&&1===o.reason&&(wg.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,r);throw o}}))}close(){return Cw(this,void 0,void 0,(function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.emit(cP.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}}))}cleanupPeerConnections(){return Cw(this,void 0,void 0,(function*(){this.publisher&&"closed"!==this.publisher.pc.signalingState&&this.publisher.pc.getSenders().forEach((e=>{var t,n;try{(null===(t=this.publisher)||void 0===t?void 0:t.pc.removeTrack)&&(null===(n=this.publisher)||void 0===n||n.pc.removeTrack(e))}catch(e){wg.warn("could not removeTrack",{error:e})}})),this.publisher&&(this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.hasPublished=!1,this.primaryPC=void 0;const e=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};e(this.lossyDC),e(this.lossyDCSub),e(this.reliableDC),e(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0}))}cleanupClient(){return Cw(this,void 0,void 0,(function*(){yield this.client.close(),this.client.resetCallbacks()}))}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new zO("a track with the same ID has already been published");return new Promise(((t,n)=>{const r=setTimeout((()=>{delete this.pendingTrackResolvers[e.cid],n(new BO("publication of local track timed out, no response from server"))}),1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(r),t(e)},reject:()=>{clearTimeout(r),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)}))}removeTrack(e){var t;if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return null===(t=this.publisher)||void 0===t||t.pc.removeTrack(e),!0}catch(e){wg.warn("failed to remove track",{error:e,method:"removeTrack"})}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){return Cw(this,void 0,void 0,(function*(){if(void 0!==this.primaryPC)return function(e){var t;return Cw(this,void 0,void 0,(function*(){let n="";const r=new Map,o=new Map;if((yield e.getStats()).forEach((e=>{switch(e.type){case"transport":n=e.selectedCandidatePairId;break;case"candidate-pair":""===n&&e.selected&&(n=e.id),r.set(e.id,e);break;case"remote-candidate":o.set(e.id,"".concat(e.address,":").concat(e.port))}})),""===n)return;const i=null===(t=r.get(n))||void 0===t?void 0:t.remoteCandidateId;return void 0!==i?o.get(i):void 0}))}(this.primaryPC)}))}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var t,n;if(this.publisher||this.subscriber)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const r=this.makeRTCConfiguration(e);(null===(n=this.signalOpts)||void 0===n?void 0:n.e2eeEnabled)&&(wg.debug("E2EE - setting up transports with insertable streams"),r.encodedInsertableStreams=!0),this.publisher=new TE(r,{optional:[{googDscp:!0}]}),this.subscriber=new TE(r),this.emit(cP.TransportsCreated,this.publisher,this.subscriber),this.publisher.pc.onicecandidate=e=>{e.candidate&&(wg.trace("adding ICE candidate for peer",e.candidate),this.client.sendIceCandidate(e.candidate,Kk.PUBLISHER))},this.subscriber.pc.onicecandidate=e=>{e.candidate&&this.client.sendIceCandidate(e.candidate,Kk.SUBSCRIBER)},this.publisher.onOffer=e=>{this.client.sendOffer(e)};let o=this.publisher.pc,i=this.subscriber.pc,a=e.subscriberPrimary;a&&(o=this.subscriber.pc,i=this.publisher.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),this.primaryPC=o,o.onconnectionstatechange=()=>Cw(this,void 0,void 0,(function*(){if(wg.debug("primary PC state changed ".concat(o.connectionState)),"connected"===o.connectionState){const t=this.pcState===NE.New;this.pcState=NE.Connected,t&&this.emit(cP.Connected,e)}else"failed"===o.connectionState&&this.pcState===NE.Connected&&(this.pcState=NE.Disconnected,this.handleDisconnect("primary peerconnection",a?JS.RR_SUBSCRIBER_FAILED:JS.RR_PUBLISHER_FAILED))})),i.onconnectionstatechange=()=>Cw(this,void 0,void 0,(function*(){wg.debug("secondary PC state changed ".concat(i.connectionState)),"failed"===i.connectionState&&this.handleDisconnect("secondary peerconnection",a?JS.RR_PUBLISHER_FAILED:JS.RR_SUBSCRIBER_FAILED)})),this.subscriber.pc.ontrack=e=>{this.emit(cP.MediaTrackAdded,e.track,e.streams[0],e.receiver)},this.createDataChannels()}setupSignalClientCallbacks(){this.client.onAnswer=e=>Cw(this,void 0,void 0,(function*(){this.publisher&&(wg.debug("received server answer",{RTCSdpType:e.type,signalingState:this.publisher.pc.signalingState.toString()}),yield this.publisher.setRemoteDescription(e))})),this.client.onTrickle=(e,t)=>{this.publisher&&this.subscriber&&(wg.trace("got ICE candidate from peer",{candidate:e,target:t}),t===Kk.PUBLISHER?this.publisher.addIceCandidate(e):this.subscriber.addIceCandidate(e))},this.client.onOffer=e=>Cw(this,void 0,void 0,(function*(){if(!this.subscriber)return;wg.debug("received server offer",{RTCSdpType:e.type,signalingState:this.subscriber.pc.signalingState.toString()}),yield this.subscriber.setRemoteDescription(e);const t=yield this.subscriber.createAndSetAnswer();this.client.sendAnswer(t)})),this.client.onLocalTrackPublished=e=>{if(wg.debug("received trackPublishedResponse",e),!this.pendingTrackResolvers[e.cid])return void wg.error("missing track resolver for ".concat(e.cid));const{resolve:t}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],t(e.track)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onClose=()=>{this.handleDisconnect("signal",JS.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{(null==e?void 0:e.canReconnect)?(this.fullReconnectOnNext=!0,this.primaryPC=void 0,this.handleDisconnect(LE)):(this.emit(cP.Disconnected,null==e?void 0:e.reason),this.close()),wg.trace("leave request",{leave:e})}}makeRTCConfiguration(e){const t=Object.assign({},this.rtcConfig);if(e.iceServers&&!t.iceServers){const n=[];e.iceServers.forEach((e=>{const t={urls:e.urls};e.username&&(t.username=e.username),e.credential&&(t.credential=e.credential),n.push(t)})),t.iceServers=n}return e.clientConfiguration&&e.clientConfiguration.forceRelay===ZS.ENABLED&&(t.iceTransportPolicy="relay"),t.sdpSemantics="unified-plan",t.continualGatheringPolicy="gather_continually",t}createDataChannels(){this.publisher&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.publisher.pc.createDataChannel(ME,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(DE,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,t,n){if(!("getCapabilities"in RTCRtpSender))return;const r=RTCRtpSender.getCapabilities(t);if(!r)return;wg.debug("get capabilities",r);const o=[],i=[],a=[];r.codecs.forEach((e=>{const t=e.mimeType.toLowerCase();"audio/opus"!==t?t==="video/".concat(n)?"h264"!==n||e.sdpFmtpLine&&e.sdpFmtpLine.includes("profile-level-id=42e01f")?o.push(e):i.push(e):a.push(e):o.push(e)})),function(e){if(!xP())return!1;if(!("setCodecPreferences"in e))return!1;const t=GO();if(!(null==t?void 0:t.name)||!t.version)return!1;const n=PP[t.name];return!!n&&MP(t.version,n)>=0}(e)&&e.setCodecPreferences(o.concat(i,a))}createSender(e,t,n){return Cw(this,void 0,void 0,(function*(){if(SP())return yield this.createTransceiverRTCRtpSender(e,t,n);if(wP())return wg.warn("using add-track fallback"),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new qO("Required webRTC APIs not supported on this device")}))}createSimulcastSender(e,t,n,r){return Cw(this,void 0,void 0,(function*(){if(SP())return this.createSimulcastTransceiverSender(e,t,n,r);if(wP())return wg.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new qO("Cannot stream on this device")}))}createTransceiverRTCRtpSender(e,t,n){return Cw(this,void 0,void 0,(function*(){if(!this.publisher)throw new qO("publisher is closed");const r=[];e.mediaStream&&r.push(e.mediaStream);const o={direction:"sendonly",streams:r};n&&(o.sendEncodings=n);const i=yield this.publisher.pc.addTransceiver(e.mediaStreamTrack,o);return e.kind===pP.Kind.Video&&t.videoCodec&&(this.setPreferredCodec(i,e.kind,t.videoCodec),e.codec=t.videoCodec),i.sender}))}createSimulcastTransceiverSender(e,t,n,r){return Cw(this,void 0,void 0,(function*(){if(!this.publisher)throw new qO("publisher is closed");const o={direction:"sendonly"};r&&(o.sendEncodings=r);const i=yield this.publisher.pc.addTransceiver(t.mediaStreamTrack,o);if(n.videoCodec)return this.setPreferredCodec(i,e.kind,n.videoCodec),e.setSimulcastTrackSender(n.videoCodec,i.sender),i.sender}))}createRTCRtpSender(e){return Cw(this,void 0,void 0,(function*(){if(!this.publisher)throw new qO("publisher is closed");return this.publisher.pc.addTrack(e)}))}attemptReconnect(e){var t,n,r;return Cw(this,void 0,void 0,(function*(){if(!this._isClosed&&!this.attemptingReconnect){(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==ZS.DISABLED&&"closed"!==(null!==(r=null===(n=this.primaryPC)||void 0===n?void 0:n.signalingState)&&void 0!==r?r:"closed")||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(e){this.reconnectAttempts+=1;let t=!0;e instanceof qO?(wg.debug("received unrecoverable error",{error:e}),t=!1):e instanceof BE||(this.fullReconnectOnNext=!0),t?this.handleDisconnect("reconnect",JS.RR_UNKNOWN):(wg.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(cP.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}}))}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(e){wg.warn("encountered error in reconnect policy",{error:e})}return null}restartConnection(e){var t,n,r;return Cw(this,void 0,void 0,(function*(){try{if(!this.url||!this.token)throw new qO("could not reconnect, url or token not saved");let n;wg.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(cP.Restarting),this.client.isConnected&&(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw wg.warn("attempted connection restart, without signal options present"),new BE;n=yield this.join(null!=e?e:this.url,this.token,this.signalOpts)}catch(e){if(e instanceof BO&&0===e.reason)throw new qO("could not reconnect, token might be expired");throw new BE}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(cP.SignalRestarted,n),yield this.waitForPCReconnected(),null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(cP.Restarted)}catch(e){const t=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(t)return void(yield this.restartConnection(t));throw null===(r=this.regionUrlProvider)||void 0===r||r.resetAttempts(),e}}))}resumeConnection(e){var t;return Cw(this,void 0,void 0,(function*(){if(!this.url||!this.token)throw new qO("could not reconnect, url or token not saved");if(!this.publisher||!this.subscriber)throw new qO("publisher and subscriber connections unset");wg.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(cP.Resuming);try{this.setupSignalClientCallbacks();const t=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(t){const e=this.makeRTCConfiguration(t);this.publisher.pc.setConfiguration(e),this.subscriber.pc.setConfiguration(e)}}catch(e){let t="";if(e instanceof Error&&(t=e.message),e instanceof BO&&0===e.reason)throw new qO("could not reconnect, token might be expired");throw new BE(t)}if(this.emit(cP.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0})),yield this.waitForPCReconnected(),this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),this.emit(cP.Resumed)}))}waitForPCInitialConnection(e,t){return Cw(this,void 0,void 0,(function*(){if(this.pcState!==NE.Connected){if(this.pcState!==NE.New)throw new qO("Expected peer connection to be new on initial connection");return new Promise(((n,r)=>{const o=()=>{wg.warn("closing engine"),ZO.clearTimeout(a),r(new BO("room connection has been cancelled",3))};(null==t?void 0:t.signal.aborted)&&o(),null==t||t.signal.addEventListener("abort",o);const i=()=>{ZO.clearTimeout(a),null==t||t.signal.removeEventListener("abort",o),n()},a=ZO.setTimeout((()=>{this.off(cP.Connected,i),r(new BO("could not establish pc connection"))}),null!=e?e:this.peerConnectionTimeout);this.once(cP.Connected,i)}))}}))}waitForPCReconnected(){var e,t;return Cw(this,void 0,void 0,(function*(){const n=Date.now();let r=n;for(this.pcState=NE.Reconnecting,wg.debug("waiting for peer connection to reconnect");r-n<this.peerConnectionTimeout&&void 0!==this.primaryPC;){if(r-n>2e3&&"connected"===(null===(e=this.primaryPC)||void 0===e?void 0:e.connectionState)&&(!this.hasPublished||"connected"===(null===(t=this.publisher)||void 0===t?void 0:t.pc.connectionState))&&(this.pcState=NE.Connected),this.pcState===NE.Connected)return;yield gP(100),r=Date.now()}throw new BO("could not establish PC connection")}))}sendDataPacket(e,t){return Cw(this,void 0,void 0,(function*(){const n=e.toBinary();yield this.ensurePublisherConnected(t);const r=this.dataChannelForKind(t);r&&r.send(n),this.updateAndEmitDCBufferStatus(t)}))}ensureDataTransportConnected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;var n,r,o;return Cw(this,void 0,void 0,(function*(){const i=t?this.subscriber:this.publisher,a=t?"Subscriber":"Publisher";if(!i)throw new BO("".concat(a," connection not set"));t||(null===(n=this.publisher)||void 0===n?void 0:n.isICEConnected)||"checking"===(null===(r=this.publisher)||void 0===r?void 0:r.pc.iceConnectionState)||this.negotiate();const s=this.dataChannelForKind(e,t);if("open"===(null==s?void 0:s.readyState))return;const c=(new Date).getTime()+this.peerConnectionTimeout;for(;(new Date).getTime()<c;){if(i.isICEConnected&&"open"===(null===(o=this.dataChannelForKind(e,t))||void 0===o?void 0:o.readyState))return;yield gP(50)}throw new BO("could not establish ".concat(a," connection, state: ").concat(i.pc.iceConnectionState))}))}ensurePublisherConnected(e){return Cw(this,void 0,void 0,(function*(){yield this.ensureDataTransportConnected(e,!1)}))}verifyTransport(){if(!this.primaryPC)return!1;if("closed"===this.primaryPC.connectionState||"failed"===this.primaryPC.connectionState)return!1;if(this.hasPublished&&this.subscriberPrimary){if(!this.publisher)return!1;if("closed"===this.publisher.pc.connectionState||"failed"===this.publisher.pc.connectionState)return!1}return!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return new Promise(((e,t)=>{if(!this.publisher)return void t(new HO("publisher is not defined"));this.hasPublished=!0;const n=()=>{wg.debug("engine disconnected while negotiation was ongoing"),o(),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(cP.Closing,n);const r=setTimeout((()=>{t("negotiation timed out"),this.handleDisconnect("negotiation",JS.RR_SIGNAL_DISCONNECTED)}),this.peerConnectionTimeout),o=()=>{clearTimeout(r),this.off(cP.Closing,n)};this.publisher.once(PE,(()=>{var t;null===(t=this.publisher)||void 0===t||t.once(EE,(()=>{o(),e()}))})),this.publisher.once(CE,(e=>{const t=new Map;e.forEach((e=>{const n=e.codec.toLowerCase();var r;r=n,QO.includes(r)&&t.set(e.payload,n)})),this.emit(cP.RTPVideoMapUpdate,t)})),this.publisher.negotiate((e=>{o(),t(e),e instanceof HO&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",JS.RR_UNKNOWN)}))}))}dataChannelForKind(e,t){if(t){if(e===ow.LOSSY)return this.lossyDCSub;if(e===ow.RELIABLE)return this.reliableDCSub}else{if(e===ow.LOSSY)return this.lossyDC;if(e===ow.RELIABLE)return this.reliableDC}}failNext(){this.shouldFailNext=!0}clearReconnectTimeout(){this.reconnectTimeout&&ZO.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){xP()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){xP()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class BE extends Error{}class FE{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return RP(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return Cw(this,void 0,void 0,(function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter((e=>!this.attemptedRegions.find((t=>t.url===e.url))));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),wg.debug("next region: ".concat(e.region)),e.url}return null}))}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return Cw(this,void 0,void 0,(function*(){const t=yield fetch("".concat((n=this.serverUrl,"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});var n;if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new BO("Could not fetch region settings: ".concat(t.statusText),401===t.status?0:void 0,t.status)}))}}const zE=2e3;function WE(e,t){if(!t)return 0;let n,r;return"bytesReceived"in e?(n=e.bytesReceived,r=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,r=t.bytesSent),void 0===n||void 0===r||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-r)*1e3/(e.timestamp-t.timestamp)}class qE extends uE{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;super(e,pP.Kind.Audio,t,n),this.stopOnMute=!1,this.monitorSender=()=>Cw(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void wg.error("could not get audio sender stats",{error:e})}e&&this.prevStats&&(this._currentBitrate=WE(e,this.prevStats)),this.prevStats=e})),this.audioContext=r,this.checkForSilence()}setDeviceId(e){return Cw(this,void 0,void 0,(function*(){return this._constraints.deviceId===e||(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||VP(e)===this.mediaStreamTrack.getSettings().deviceId)}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Cw(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source===pP.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(wg.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Cw(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{const n=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==VP(this._constraints.deviceId);return this.source!==pP.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!n||this.isUserProvided||(wg.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}restartTrack(e){return Cw(this,void 0,void 0,(function*(){let t;if(e){const n=yP({audio:e});"boolean"!=typeof n.audio&&(t=n.audio)}yield this.restart(t)}))}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return Cw(this,void 0,void 0,(function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n}))}startMonitor(){xP()&&(this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),zE)))}setProcessor(e){var t;return Cw(this,void 0,void 0,(function*(){const n=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");const r={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};wg.debug("setting up audio processor ".concat(e.name)),yield e.init(r),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack))}finally{n()}}))}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return Cw(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach((e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})})),t}))}checkForSilence(){return Cw(this,void 0,void 0,(function*(){const e=yield function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return Cw(this,void 0,void 0,(function*(){const n=bP();if(n){const r=n.createAnalyser();r.fftSize=2048;const o=r.frequencyBinCount,i=new Uint8Array(o);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(r),yield gP(t),r.getByteTimeDomainData(i);const a=i.some((e=>128!==e&&0!==e));return n.close(),!a}return!1}))}(this);return e&&(this.isMuted||wg.warn("silence detected on local audio track"),this.emit(lP.AudioSilenceDetected)),e}))}}const HE=Object.values(rP),ZE=Object.values(oP),VE=Object.values(iP),JE=[rP.h180,rP.h360],GE=[oP.h180,oP.h360],KE=e=>[{scaleResolutionDownBy:2,fps:3}].map((t=>{var n;return new YO(Math.floor(e.width/t.scaleResolutionDownBy),Math.floor(e.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(e.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*((null!==(n=e.encoding.maxFramerate)&&void 0!==n?n:30)/t.fps)))),t.fps,e.encoding.priority)})),$E=["q","h","f"];function YE(e,t,n,r){var o,i;let a=null==r?void 0:r.videoEncoding;e&&(a=null==r?void 0:r.screenShareEncoding);const s=null==r?void 0:r.simulcast,c=null==r?void 0:r.scalabilityMode,l=null==r?void 0:r.videoCodec;if(!a&&!s&&!c||!t||!n)return[{}];a||(a=function(e,t,n,r){const o=function(e,t,n){if(e)return VE;const r=t>n?t/n:n/t;return Math.abs(r-16/9)<Math.abs(r-4/3)?HE:ZE}(e,t,n);let{encoding:i}=o[0];const a=Math.max(t,n);for(let e=0;e<o.length;e+=1){const t=o[e];if(i=t.encoding,t.width>=a)break}if(r)switch(r){case"av1":i=Object.assign({},i),i.maxBitrate=.7*i.maxBitrate;break;case"vp9":i=Object.assign({},i),i.maxBitrate=.85*i.maxBitrate}return i}(e,t,n,l),wg.debug("using video encoding",a));const u=new YO(t,n,a.maxBitrate,a.maxFramerate,a.priority);if(c&&kP(l)){wg.debug("using svc with scalabilityMode ".concat(c));const e=new nC(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));for(let n=0;n<e.spatial;n+=1)t.push({rid:$E[2-n],maxBitrate:a.maxBitrate/Math.pow(3,n),maxFramerate:u.encoding.maxFramerate});return t[0].scalabilityMode=c,wg.debug("encodings",t),t}if(!s)return[a];let d,p=[];if(p=e?null!==(o=tC(null==r?void 0:r.screenShareSimulcastLayers))&&void 0!==o?o:QE(e,u):null!==(i=tC(null==r?void 0:r.videoSimulcastLayers))&&void 0!==i?i:QE(e,u),p.length>0){const e=p[0];p.length>1&&([,d]=p);const r=Math.max(t,n);if(r>=960&&d)return eC(t,n,[e,d,u]);if(r>=480)return eC(t,n,[e,u])}return eC(t,n,[u])}function XE(e,t,n){var r,o,i,a;if(!n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&wg.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const s=e.mediaStreamTrack.getSettings(),c=null!==(r=s.width)&&void 0!==r?r:null===(o=e.dimensions)||void 0===o?void 0:o.width,l=null!==(i=s.height)&&void 0!==i?i:null===(a=e.dimensions)||void 0===a?void 0:a.height;return YE(e.source===pP.Source.ScreenShare,c,l,n)}function QE(e,t){if(e)return KE(t);const{width:n,height:r}=t,o=n>r?n/r:r/n;return Math.abs(o-16/9)<Math.abs(o-4/3)?JE:GE}function eC(e,t,n){const r=[];if(n.forEach(((n,o)=>{if(o>=$E.length)return;const i=Math.min(e,t),a={rid:$E[o],scaleResolutionDownBy:Math.max(1,i/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate};n.encoding.maxFramerate&&(a.maxFramerate=n.encoding.maxFramerate);const s=EP()||0===o;n.encoding.priority&&s&&(a.priority=n.encoding.priority,a.networkPriority=n.encoding.priority),r.push(a)})),jP()&&"ios"===_P()){let e;r.forEach((t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate}));let t=!0;r.forEach((n=>{var r;n.maxFramerate!=e&&(t&&(t=!1,wg.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),wg.info('Setting framerate of encoding "'.concat(null!==(r=n.rid)&&void 0!==r?r:"",'" to ').concat(e)),n.maxFramerate=e)}))}return r}function tC(e){if(e)return e.sort(((e,t)=>{const{encoding:n}=e,{encoding:r}=t;return n.maxBitrate>r.maxBitrate?1:n.maxBitrate<r.maxBitrate?-1:n.maxBitrate===r.maxBitrate&&n.maxFramerate&&r.maxFramerate?n.maxFramerate>r.maxFramerate?1:-1:0}))}class nC{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class rC extends uE{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,pP.Kind.Video,t,n),this.simulcastCodecs=new Map,this.monitorSender=()=>Cw(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void wg.error("could not get audio sender stats",{error:e})}const t=new Map(e.map((e=>[e.rid,e])));if(this.prevStats){let e=0;t.forEach(((t,n)=>{var r;const o=null===(r=this.prevStats)||void 0===r?void 0:r.get(n);e+=WE(t,o)})),this._currentBitrate=e}this.prevStats=t})),this.senderLock=new ZP}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!xP())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),zE))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach((e=>{e.mediaStreamTrack.stop()})),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var t,n,r,o,i;return Cw(this,void 0,void 0,(function*(){yield e.pauseUpstream.call(this);try{for(var a,s=!0,c=Tw(this.simulcastCodecs.values());a=yield c.next(),!(t=a.done);s=!0){o=a.value,s=!1;const e=o;yield null===(i=e.sender)||void 0===i?void 0:i.replaceTrack(null)}}catch(e){n={error:e}}finally{try{s||t||!(r=c.return)||(yield r.call(c))}finally{if(n)throw n.error}}}))}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var t,n,r,o,i;return Cw(this,void 0,void 0,(function*(){yield e.resumeUpstream.call(this);try{for(var a,s=!0,c=Tw(this.simulcastCodecs.values());a=yield c.next(),!(t=a.done);s=!0){o=a.value,s=!1;const e=o;yield null===(i=e.sender)||void 0===i?void 0:i.replaceTrack(e.mediaStreamTrack)}}catch(e){n={error:e}}finally{try{s||t||!(r=c.return)||(yield r.call(c))}finally{if(n)throw n.error}}}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return Cw(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source!==pP.Source.Camera||this.isUserProvided||(wg.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return Cw(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.source!==pP.Source.Camera||this.isUserProvided||(wg.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return Cw(this,void 0,void 0,(function*(){if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach((e=>{var r;if("outbound-rtp"===e.type){const o={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,framesSent:e.framesSent,timestamp:e.timestamp,rid:null!==(r=e.rid)&&void 0!==r?r:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges},i=n.get(e.remoteId);i&&(o.jitter=i.jitter,o.packetsLost=i.packetsLost,o.roundTripTime=i.roundTripTime),t.push(o)}})),t}))}setPublishingQuality(e){const t=[];for(let n=qS.LOW;n<=qS.HIGH;n+=1)t.push(new PO({quality:n,enabled:n<=e}));wg.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(t)}setDeviceId(e){return Cw(this,void 0,void 0,(function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===VP(e)||(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||VP(e)===this._mediaStreamTrack.getSettings().deviceId)}))}restartTrack(e){var t,n,r,o;return Cw(this,void 0,void 0,(function*(){let i;if(e){const t=yP({video:e});"boolean"!=typeof t.video&&(i=t.video)}yield this.restart(i);try{for(var a,s=!0,c=Tw(this.simulcastCodecs.values());a=yield c.next(),!(t=a.done);s=!0){o=a.value,s=!1;const e=o;e.sender&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(e){n={error:e}}finally{try{s||t||!(r=c.return)||(yield r.call(c))}finally{if(n)throw n.error}}}))}setProcessor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var r,o,i,a,s,c;return Cw(this,void 0,void 0,(function*(){if(yield n.setProcessor.call(this,e,t),null===(s=this.processor)||void 0===s?void 0:s.processedTrack)try{for(var l,u=!0,d=Tw(this.simulcastCodecs.values());l=yield d.next(),!(r=l.done);u=!0){a=l.value,u=!1;const e=a;yield null===(c=e.sender)||void 0===c?void 0:c.replaceTrack(this.processor.processedTrack)}}catch(e){o={error:e}}finally{try{u||r||!(i=d.return)||(yield i.call(d))}finally{if(o)throw o.error}}}))}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout((()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)}),5e3))}setPublishingCodecs(e){var t,n,r,o,i,a,s;return Cw(this,void 0,void 0,(function*(){if(wg.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=Tw(e);r=yield n.next(),!(o=r.done);t=!0){s=r.value,t=!1;const e=s;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(wg.debug("try setPublishingCodec for ".concat(e.codec),t),t&&t.sender)t.encodings&&(wg.debug("try setPublishingLayersForSender ".concat(e.codec)),yield oC(t.sender,t.encodings,e.qualities,this.senderLock));else for(const t of e.qualities)if(t.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(e.qualities)}}catch(e){i={error:e}}finally{try{t||o||!(a=n.return)||(yield a.call(n))}finally{if(i)throw i.error}}return c}))}setPublishingLayers(e){return Cw(this,void 0,void 0,(function*(){wg.debug("setting publishing layers",e),this.sender&&this.encodings&&(yield oC(this.sender,this.encodings,e,this.senderLock))}))}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Cw(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),TP()&&this.isInBackground&&this.source===pP.Source.Camera&&(this._mediaStreamTrack.enabled=!1)}))}}function oC(e,t,n,r){return Cw(this,void 0,void 0,(function*(){const o=yield r.lock();wg.debug("setPublishingLayersForSender",{sender:e,qualities:n,senderEncodings:t});try{const r=e.getParameters(),{encodings:i}=r;if(!i)return;if(i.length!==t.length)return void wg.warn("cannot set publishing layers, encodings mismatch");let a=!1;i.forEach(((e,r)=>{var o;let i=null!==(o=e.rid)&&void 0!==o?o:"";""===i&&(i="q");const s=iC(i),c=n.find((e=>e.quality===s));c&&e.active!==c.enabled&&(a=!0,e.active=c.enabled,wg.debug("setting layer ".concat(c.quality," to ").concat(e.active?"enabled":"disabled")),EP()&&(c.enabled?(e.scaleResolutionDownBy=t[r].scaleResolutionDownBy,e.maxBitrate=t[r].maxBitrate,e.maxFrameRate=t[r].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})),a&&(r.encodings=i,wg.debug("setting encodings",r.encodings),yield e.setParameters(r))}finally{o()}}))}function iC(e){switch(e){case"f":default:return qS.HIGH;case"h":return qS.MEDIUM;case"q":return qS.LOW}}function aC(e,t,n,r){if(!n)return[new dw({quality:qS.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(r){const r=n[0].scalabilityMode,o=new nC(r),i=[];for(let r=0;r<o.spatial;r+=1)i.push(new dw({quality:qS.HIGH-r,width:Math.ceil(e/Math.pow(2,r)),height:Math.ceil(t/Math.pow(2,r)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,r)):0,ssrc:0}));return i}return n.map((n=>{var r,o,i;const a=null!==(r=n.scaleResolutionDownBy)&&void 0!==r?r:1;let s=iC(null!==(o=n.rid)&&void 0!==o?o:"");return new dw({quality:s,width:Math.ceil(e/a),height:Math.ceil(t/a),bitrate:null!==(i=n.maxBitrate)&&void 0!==i?i:0,ssrc:0})}))}class sC extends pP{constructor(e,t,n,r){super(e,n),this.sid=t,this.receiver=r}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?lP.Muted:lP.Unmuted,this))}setMediaStream(e){this.mediaStream=e,e.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(lP.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return Cw(this,void 0,void 0,(function*(){if(null===(e=this.receiver)||void 0===e?void 0:e.getStats)return yield this.receiver.getStats()}))}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval((()=>this.monitorReceiver()),zE))}}class cC extends sC{constructor(e,t,n,r,o){super(e,t,pP.Kind.Audio,n),this.monitorReceiver=()=>Cw(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=WE(e,this.prevStats)),this.prevStats=e})),this.audioContext=r,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;jP()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(jP())return 1;let e=0;return this.attachedElements.forEach((t=>{t.volume>e&&(e=t.volume)})),e}setSinkId(e){return Cw(this,void 0,void 0,(function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map((t=>{if(OP(t))return t.setSinkId(e)})))}))}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.elementVolume&&(e.volume=this.elementVolume),this.sinkId&&OP(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&(wg.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach((e=>{n.connect(e),n=e})),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then((()=>{"running"!==e.state&&this.emit(lP.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))})).catch((e=>{this.emit(lP.AudioPlaybackFailed,e)}))}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return Cw(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"audio",timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})})),e}))}}class lC extends sC{constructor(e,t,n,r){super(e,t,pP.Kind.Video,n),this.elementInfos=[],this.monitorReceiver=()=>Cw(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=WE(e,this.prevStats)),this.prevStats=e})),this.debouncedHandleResize=sE((()=>{this.updateDimensions()}),100),this.adaptiveStreamSettings=r}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach((t=>{e?hP(this._mediaStreamTrack,t):fP(this._mediaStreamTrack,t)}))}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t.element===e))){const t=new uC(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t===e))?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):wg.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void wg.warn("stopObservingElementInfo ignored");const t=this.elementInfos.filter((t=>t===e));for(const e of t)e.stopObserving();this.elementInfos=this.elementInfos.filter((t=>t!==e)),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const e of t)this.stopObservingElement(e);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return Cw(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"video",framesDecoded:t.framesDecoded,framesDropped:t.framesDropped,framesReceived:t.framesReceived,packetsReceived:t.packetsReceived,packetsLost:t.packetsLost,frameWidth:t.frameWidth,frameHeight:t.frameHeight,pliCount:t.pliCount,firCount:t.firCount,nackCount:t.nackCount,jitter:t.jitter,timestamp:t.timestamp,bytesReceived:t.bytesReceived,decoderImplementation:t.decoderImplementation})})),e}))}stopObservingElement(e){const t=this.elementInfos.filter((t=>t.element===e));for(const e of t)this.stopObservingElementInfo(e)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return Cw(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()}))}updateVisibility(){var e,t;const n=this.elementInfos.reduce(((e,t)=>Math.max(e,t.visibilityChangedAt||0)),0),r=!(null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pauseVideoInBackground)&&void 0!==t&&!t)&&this.isInBackground,o=this.elementInfos.some((e=>e.pictureInPicture)),i=this.elementInfos.some((e=>e.visible))&&!r||o;this.lastVisible!==i&&(!i&&Date.now()-n<100?ZO.setTimeout((()=>{this.updateVisibility()}),100):(this.lastVisible=i,this.emit(lP.VisibilityChanged,i,this)))}updateDimensions(){var e,t;let n=0,r=0;const o=this.getPixelDensity();for(const e of this.elementInfos){const t=e.width()*o,i=e.height()*o;t+i>n+r&&(n=t,r=i)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===r||(this.lastDimensions={width:n,height:r},this.emit(lP.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;return"screen"===t?AP():t||(AP()>2?2:1)}}class uC{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:r}=e;n===this.element&&(this.isIntersecting=r,this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e;this.isPiP=!0,null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=!1,null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!=t?t:dC(e),this.isPiP=xP()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=dC(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,FP().observe(this.element),UP().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,t;null===(e=FP())||void 0===e||e.unobserve(this.element),null===(t=UP())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function dC(e){let t=e.offsetTop,n=e.offsetLeft;const r=e.offsetWidth,o=e.offsetHeight,{hidden:i}=e,{opacity:a,display:s}=getComputedStyle(e);for(;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+o>window.pageYOffset&&n+r>window.pageXOffset&&!i&&(""===a||parseFloat(a)>0)&&"none"!==s}class pC extends Hw.EventEmitter{constructor(e,t,n){super(),this.metadataMuted=!1,this.encryption=rw.NONE,this.handleMuted=()=>{this.emit(lP.Muted)},this.handleUnmuted=()=>{this.emit(lP.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=pP.Source.Unknown}setTrack(e){this.track&&(this.track.off(lP.Muted,this.handleMuted),this.track.off(lP.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(lP.Muted,this.handleMuted),e.on(lP.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==rw.NONE}get audioTrack(){if(this.track instanceof qE||this.track instanceof cC)return this.track}get videoTrack(){if(this.track instanceof rC||this.track instanceof lC)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=pP.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===pP.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,wg.debug("update publication info",{info:e})}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(pC||(pC={}));class fC extends pC{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n){super(e,t.sid,t.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(lP.Ended)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&this.track.off(lP.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(lP.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return Cw(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.mute()}))}unmute(){var e;return Cw(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.unmute()}))}pauseUpstream(){var e;return Cw(this,void 0,void 0,(function*(){yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()}))}resumeUpstream(){var e;return Cw(this,void 0,void 0,(function*(){yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()}))}}var hC,mC,yC;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Unknown="unknown"}(hC||(hC={}));class bC extends Hw.EventEmitter{get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every((e=>e.isEncrypted))}constructor(e,t,n,r){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=hC.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=r,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,t]of this.tracks)if(t.source===e)return t}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(pP.Source.Camera);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(pP.Source.Microphone);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrack(pP.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version||(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,wg.trace("update participant info",{info:e}),0))}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(sP.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(sP.ParticipantNameChanged,e)}setPermissions(e){var t,n,r,o,i;const a=this.permissions,s=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(r=this.permissions)||void 0===r?void 0:r.canPublishData)||e.hidden!==(null===(o=this.permissions)||void 0===o?void 0:o.hidden)||e.recorder!==(null===(i=this.permissions)||void 0===i?void 0:i.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some(((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])}));return this.permissions=e,s&&this.emit(sP.ParticipantPermissionsChanged,a),s}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(sP.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case HS.EXCELLENT:return hC.Excellent;case HS.GOOD:return hC.Good;case HS.POOR:return hC.Poor;default:return hC.Unknown}}(e),t!==this._connectionQuality&&this.emit(sP.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach((t=>(t.track instanceof cC||t.track instanceof qE)&&t.track.setAudioContext(e)))}addTrackPublication(e){e.on(lP.Muted,(()=>{this.emit(sP.TrackMuted,e)})),e.on(lP.Unmuted,(()=>{this.emit(sP.TrackUnmuted,e)}));const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case pP.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case pP.Kind.Video:this.videoTracks.set(e.trackSid,e)}}}class vC extends pC{constructor(e,t,n){super(e,t.sid,t.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=qS.HIGH,this.handleEnded=e=>{this.setTrack(void 0),this.emit(lP.Ended,e)},this.handleVisibilityChange=e=>{wg.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),{trackSid:this.trackSid}),this.disabled=!e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{wg.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),{trackSid:this.trackSid}),this.videoDimensions=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const r=new pO({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new yw({participantSid:"",trackSids:[this.trackSid]})]});this.emit(lP.UpdateSubscription,r),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?pC.SubscriptionStatus.Unsubscribed:super.isSubscribed?pC.SubscriptionStatus.Subscribed:pC.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?pC.PermissionStatus.Allowed:pC.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return!this.disabled}setEnabled(e){this.isManualOperationAllowed()&&this.disabled!==!e&&(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.currentVideoQuality!==e&&(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.videoDimensions)||void 0===n?void 0:n.height)===e.height||(this.track instanceof lC&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof lC&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,r=this.track;r!==e&&(r&&(r.off(lP.VideoDimensionsChanged,this.handleVideoDimensionsChange),r.off(lP.VisibilityChanged,this.handleVisibilityChange),r.off(lP.Ended,this.handleEnded),r.detach(),r.stopMonitor(),this.emit(lP.Unsubscribed,r)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(lP.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(lP.VisibilityChanged,this.handleVisibilityChange),e.on(lP.Ended,this.handleEnded),this.emit(lP.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(lP.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?lP.Muted:lP.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(lP.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(lP.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===pP.Kind.Video&&this.isAdaptiveStream?(wg.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):!!this.isDesired||(wg.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof lC&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new fO({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):void 0!==this.currentVideoQuality?e.quality=this.currentVideoQuality:e.quality=qS.HIGH,this.emit(lP.UpdateSettings,e)}}class gC extends bC{static fromParticipantInfo(e,t){return new gC(e,t.sid,t.identity,t.name,t.metadata)}constructor(e,t,n,r,o){super(t,n||"",r,o),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(lP.UpdateSettings,(e=>{wg.debug("send update settings",e),this.signalClient.sendUpdateTrackSettings(e)})),e.on(lP.UpdateSubscription,(e=>{e.participantTracks.forEach((e=>{e.participantSid=this.sid})),this.signalClient.sendUpdateSubscription(e)})),e.on(lP.SubscriptionPermissionChanged,(t=>{this.emit(sP.TrackSubscriptionPermissionChanged,e,t)})),e.on(lP.SubscriptionStatusChanged,(t=>{this.emit(sP.TrackSubscriptionStatusChanged,e,t)})),e.on(lP.Subscribed,(t=>{this.emit(sP.TrackSubscribed,t,e)})),e.on(lP.Unsubscribed,(t=>{this.emit(sP.TrackUnsubscribed,t,e)})),e.on(lP.SubscriptionFailed,(t=>{this.emit(sP.TrackSubscriptionFailed,e.trackSid,t)}))}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pP.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrack(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pP.Source.Microphone;const t=this.getTrack(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,r,o,i){let a,s=this.getTrackPublication(t);return s||t.startsWith("TR")||this.tracks.forEach((t=>{s||e.kind!==t.kind.toString()||(s=t)})),s?"ended"===e.readyState?(wg.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:t}),void this.emit(sP.TrackSubscriptionFailed,t)):(a="video"===e.kind?new lC(e,t,r,o):new cC(e,t,r,this.audioContext,this.audioOutput),a.source=s.source,a.isMuted=s.isMuted,a.setMediaStream(n),a.start(),s.setTrack(a),this.volumeMap.has(s.source)&&a instanceof cC&&a.setVolume(this.volumeMap.get(s.source)),s):0===i?(wg.error("could not find published track",{participant:this.sid,trackSid:t}),void this.emit(sP.TrackSubscriptionFailed,t)):(void 0===i&&(i=20),void setTimeout((()=>{this.addSubscribedMediaTrack(e,t,n,r,o,i-1)}),150))}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach((r=>{var o;let i=this.getTrackPublication(r.sid);if(i)i.updateInfo(r);else{const t=pP.kindFromProto(r.type);if(!t)return;i=new vC(t,r,null===(o=this.signalClient.connectOptions)||void 0===o?void 0:o.autoSubscribe),i.updateInfo(r),n.set(r.sid,i);const a=Array.from(this.tracks.values()).find((e=>e.source===(null==i?void 0:i.source)));a&&i.source!==pP.Source.Unknown&&wg.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(i.source),{oldTrack:a,newTrack:i,participant:this,participantInfo:e}),this.addTrackPublication(i)}t.set(r.sid,i)})),this.tracks.forEach((e=>{t.has(e.trackSid)||(wg.trace("detected removed track on remote participant, unpublishing",{publication:e,participantSid:this.sid}),this.unpublishTrack(e.trackSid,!0))})),n.forEach((e=>{this.emit(sP.TrackPublished,e)})),!0}unpublishTrack(e,t){const n=this.tracks.get(e);if(!n)return;const{track:r}=n;switch(r&&(r.stop(),n.setTrack(void 0)),this.tracks.delete(e),n.kind){case pP.Kind.Audio:this.audioTracks.delete(e);break;case pP.Kind.Video:this.videoTracks.delete(e)}t&&this.emit(sP.TrackUnpublished,n)}setAudioOutput(e){return Cw(this,void 0,void 0,(function*(){this.audioOutput=e;const t=[];this.audioTracks.forEach((n=>{var r;n.track instanceof cC&&t.push(n.track.setSinkId(null!==(r=e.deviceId)&&void 0!==r?r:"default"))})),yield Promise.all(t)}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wg.trace("participant event",{participant:this.sid,event:e,args:n}),super.emit(e,...n)}}class SC extends bC{constructor(e,t,n,r){super(e,t),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=rw.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new HP)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var e,t;this.reconnectFuture&&(this.reconnectFuture.promise.catch((e=>wg.warn(e))),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{wg.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map((e=>function(e){var t,n,r;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new TO({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(r=e.allowAll)&&void 0!==r&&r,trackSids:e.allowedTrackSids||[]})}(e))))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):wg.error("could not update mute status for unpublished track",e)},this.onTrackUpstreamPaused=e=>{wg.debug("upstream paused"),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{wg.debug("upstream resumed"),this.onTrackMuted(e,e.isMuted)},this.handleSubscribedQualityUpdate=e=>Cw(this,void 0,void 0,(function*(){var t,n,r,o,i,a;if(!(null===(i=this.roomOptions)||void 0===i?void 0:i.dynacast))return;const s=this.videoTracks.get(e.trackSid);if(s)if(e.subscribedCodecs.length>0){if(!s.videoTrack)return;const i=yield s.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=Tw(i);!(t=(c=yield u.next()).done);l=!0){o=c.value,l=!1;const e=o;eP(e)&&(wg.debug("publish ".concat(e," for ").concat(s.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(s.videoTrack,e,s.options))}}catch(e){n={error:e}}finally{try{l||t||!(r=u.return)||(yield r.call(u))}finally{if(n)throw n.error}}}else e.subscribedQualities.length>0&&(yield null===(a=s.videoTrack)||void 0===a?void 0:a.setPublishingLayers(e.subscribedQualities));else wg.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:e.trackSid})})),this.handleLocalTrackUnpublished=e=>{const t=this.tracks.get(e.trackSid);t?this.unpublishTrack(t.track):wg.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:e.trackSid})},this.handleTrackEnded=e=>Cw(this,void 0,void 0,(function*(){if(e.source===pP.Source.ScreenShare||e.source===pP.Source.ScreenShareAudio)wg.debug("unpublishing local track due to TrackEnded",{track:e.sid}),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(e instanceof qE||e instanceof rC)try{if(xP())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===pP.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw wg.warn("user has revoked access to ".concat(e.source)),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(e){}e.isMuted||(wg.debug("track ended, attempting to use a different device"),yield e.restartTrack())}catch(t){wg.warn("could not restart track, muting instead"),yield e.mute()}})),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=n,this.roomOptions=r,this.setupEngine(n),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==rw.NONE}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.client.onRemoteMuteChanged=(e,t)=>{const n=this.tracks.get(e);n&&n.track&&(t?n.mute():n.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished,this.engine.on(cP.Connected,this.handleReconnected).on(cP.SignalRestarted,this.handleReconnected).on(cP.SignalResumed,this.handleReconnected).on(cP.Restarting,this.handleReconnecting).on(cP.Resuming,this.handleReconnecting).on(cP.Disconnected,this.handleDisconnected)}setMetadata(e){var t;this.engine.client.sendUpdateLocalMetadata(e,null!==(t=this.name)&&void 0!==t?t:"")}setName(e){var t;this.engine.client.sendUpdateLocalMetadata(null!==(t=this.metadata)&&void 0!==t?t:"",e)}setCameraEnabled(e,t,n){return this.setTrackEnabled(pP.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(pP.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(pP.Source.ScreenShare,e,t,n)}setPermissions(e){const t=this.permissions,n=super.setPermissions(e);return n&&t&&this.emit(sP.ParticipantPermissionsChanged,t),n}setE2EEEnabled(e){return Cw(this,void 0,void 0,(function*(){this.encryptionType=e?rw.GCM:rw.NONE,yield this.republishAllTracks(void 0,!1)}))}setTrackEnabled(e,t,n,r){var o,i;return Cw(this,void 0,void 0,(function*(){wg.debug("setTrackEnabled",{source:e,enabled:t});let a=this.getTrack(e);if(t)if(a)yield a.unmute();else{let t;if(this.pendingPublishing.has(e))return void wg.info("skipping duplicate published source",{source:e});this.pendingPublishing.add(e);try{switch(e){case pP.Source.Camera:t=yield this.createTracks({video:null===(o=n)||void 0===o||o});break;case pP.Source.Microphone:t=yield this.createTracks({audio:null===(i=n)||void 0===i||i});break;case pP.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new zO(e)}const s=[];for(const e of t)wg.info("publishing track",{localTrack:e}),s.push(this.publishTrack(e,r));const c=yield Promise.all(s);[a]=c}catch(e){throw null==t||t.forEach((e=>{e.stop()})),e instanceof Error&&!(e instanceof zO)&&this.emit(sP.MediaDevicesError,e),e}finally{this.pendingPublishing.delete(e)}}else if(a&&a.track)if(e===pP.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const e=this.getTrack(pP.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield a.mute();return a}))}enableCameraAndMicrophone(){return Cw(this,void 0,void 0,(function*(){if(!this.pendingPublishing.has(pP.Source.Camera)&&!this.pendingPublishing.has(pP.Source.Microphone)){this.pendingPublishing.add(pP.Source.Camera),this.pendingPublishing.add(pP.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map((e=>this.publishTrack(e))))}finally{this.pendingPublishing.delete(pP.Source.Camera),this.pendingPublishing.delete(pP.Source.Microphone)}}}))}createTracks(e){var t,n;return Cw(this,void 0,void 0,(function*(){const r=yP(function(e,t,n){const r=Object.assign({},e);return!0===r.audio&&(r.audio={}),!0===r.video&&(r.video={}),r.audio&&mP(r.audio,t),r.video&&mP(r.video,n),r}(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults));let o;try{o=yield navigator.mediaDevices.getUserMedia(r)}catch(e){throw e instanceof Error&&(r.audio&&(this.microphoneError=e),r.video&&(this.cameraError=e)),e}return r.audio&&(this.microphoneError=void 0),r.video&&(this.cameraError=void 0),o.getTracks().map((t=>{const n="audio"===t.kind;let i;n?e.audio:e.video;const a=n?r.audio:r.video;"boolean"!=typeof a&&(i=a);const s=function(e,t){switch(e.kind){case"audio":return new qE(e,t,!1);case"video":return new rC(e,t,!1);default:throw new zO("unsupported track type: ".concat(e.kind))}}(t,i);return s.kind===pP.Kind.Video?s.source=pP.Source.Camera:s.kind===pP.Kind.Audio&&(s.source=pP.Source.Microphone),s.mediaStream=o,s}))}))}createScreenTracks(e){return Cw(this,void 0,void 0,(function*(){if(void 0===e&&(e={}),void 0===e.resolution&&(e.resolution=iP.h1080fps15.resolution),void 0===navigator.mediaDevices.getDisplayMedia)throw new FO("getDisplayMedia not supported");const t=function(e){var t,n;let r=null===(t=e.video)||void 0===t||t;return e.resolution&&(r="boolean"==typeof r?{}:r,r=CP()?Object.assign(Object.assign({},r),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},r),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:r,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio}}(e),n=yield navigator.mediaDevices.getDisplayMedia(t),r=n.getVideoTracks();if(0===r.length)throw new zO("no video track found");const o=new rC(r[0],void 0,!1);o.source=pP.Source.ScreenShare;const i=[o];if(n.getAudioTracks().length>0){const e=new qE(n.getAudioTracks()[0],void 0,!1,this.audioContext);e.source=pP.Source.ScreenShareAudio,i.push(e)}return i}))}publishTrack(e,t){var n,r,o,i;return Cw(this,void 0,void 0,(function*(){let a,s;if(yield null===(n=this.reconnectFuture)||void 0===n?void 0:n.promise,e instanceof uE&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)a=e.getConstraints();else{let t;switch(a=e.constraints,e.source){case pP.Source.Microphone:t="audioinput";break;case pP.Source.Camera:t="videoinput"}t&&this.activeDeviceMap.has(t)&&(a=Object.assign(Object.assign({},a),{deviceId:this.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new qE(e,a,!0,this.audioContext);break;case"video":e=new rC(e,a,!0);break;default:throw new zO("unsupported MediaStreamTrack kind ".concat(e.kind))}if(e instanceof qE&&e.setAudioContext(this.audioContext),this.tracks.forEach((t=>{t.track&&t.track===e&&(s=t)})),s)return wg.warn("track has already been published, skipping"),s;const c="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,l=null!==(r=null==t?void 0:t.forceStereo)&&void 0!==r?r:c;l&&(t||(t={}),void 0===t.dtx&&wg.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),void 0===t.red&&wg.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(o=t.dtx)&&void 0!==o||(t.dtx=!1),null!==(i=t.red)&&void 0!==i||(t.red=!1));const u=Object.assign(Object.assign({},this.roomOptions.publishDefaults),t);CP()&&this.roomOptions.e2ee&&(wg.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari"),u.simulcast=!1),u.source&&(e.source=u.source);const d=this.publish(e,u,l);this.pendingPublishPromises.set(e,d);try{return yield d}catch(e){throw e}finally{this.pendingPublishPromises.delete(e)}}))}publish(e,t,n){var r,o,i,a,s,c,l,u,d,p,f,h,m,y;return Cw(this,void 0,void 0,(function*(){const b=Array.from(this.tracks.values()).find((t=>e instanceof uE&&t.source===e.source));if(b&&e.source!==pP.Source.Unknown)try{throw Error("publishing a second track with the same source: ".concat(e.source))}catch(t){t instanceof Error&&wg.warn(t.message,{oldTrack:b,newTrack:e,trace:t.stack})}t.stopMicTrackOnMute&&e instanceof qE&&(e.stopOnMute=!0),e.source===pP.Source.ScreenShare&&EP()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/AV1"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/VP9"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),e.on(lP.Muted,this.onTrackMuted),e.on(lP.Unmuted,this.onTrackUnmuted),e.on(lP.Ended,this.handleTrackEnded),e.on(lP.UpstreamPaused,this.onTrackUpstreamPaused),e.on(lP.UpstreamResumed,this.onTrackUpstreamResumed);const v=new rO({cid:e.mediaStreamTrack.id,name:t.name,type:pP.kindToProto(e.kind),muted:e.isMuted,source:pP.sourceToProto(e.source),disableDtx:!(null===(r=t.dtx)||void 0===r||r),encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(o=t.red)||void 0===o||o)});let g,S;if(e.kind===pP.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(e){const t=null!==(a=null===(i=this.roomOptions.videoCaptureDefaults)||void 0===i?void 0:i.resolution)&&void 0!==a?a:rP.h720.resolution;n={width:t.width,height:t.height},wg.error("could not determine track dimensions, using defaults",n)}if(v.width=n.width,v.height=n.height,e instanceof rC)if(kP(t.videoCodec)&&(t.scalabilityMode=null!==(s=t.scalabilityMode)&&void 0!==s?s:"L3T3_KEY"),t.videoCodec&&t.backupCodec&&t.videoCodec!==t.backupCodec.codec){this.roomOptions.dynacast||(this.roomOptions.dynacast=!0);const n=Object.assign({},t);n.simulcast=!0,S=XE(e,t.backupCodec.codec,n),v.simulcastCodecs=[new nO({codec:t.videoCodec,cid:e.mediaStreamTrack.id,enableSimulcastLayers:!0}),new nO({codec:t.backupCodec.codec,cid:"",enableSimulcastLayers:!0})]}else t.videoCodec&&(v.simulcastCodecs=[new nO({codec:t.videoCodec,cid:e.mediaStreamTrack.id,enableSimulcastLayers:null!==(c=t.simulcast)&&void 0!==c&&c})]);g=YE(e.source===pP.Source.ScreenShare,n.width,n.height,t),v.layers=aC(v.width,v.height,g,kP(t.videoCodec))}else e.kind===pP.Kind.Audio&&(g=[{maxBitrate:null!==(u=null===(l=t.audioPreset)||void 0===l?void 0:l.maxBitrate)&&void 0!==u?u:t.audioBitrate,priority:null!==(p=null===(d=t.audioPreset)||void 0===d?void 0:d.priority)&&void 0!==p?p:"high",networkPriority:null!==(h=null===(f=t.audioPreset)||void 0===f?void 0:f.priority)&&void 0!==h?h:"high"}]);if(!this.engine||this.engine.isClosed)throw new qO("cannot publish track when not connected");const w=yield this.engine.addTrack(v);let k=!1,O=!1;if(w.codecs.forEach((e=>{tP(e.mimeType,t.videoCodec)?k=!0:t.backupCodec&&tP(e.mimeType,t.backupCodec.codec)&&(O=!0)})),v.simulcastCodecs.length>0){if(!k&&!O)throw Error("cannot publish track, codec not supported by server");if(!k&&t.backupCodec){const e=t.backupCodec;t=Object.assign({},t),wg.debug("primary codec ".concat(t.videoCodec," not supported, fallback to ").concat(e.codec)),t.videoCodec=e.codec,t.videoEncoding=e.encoding,g=S}}const P=new fC(e.kind,w,e);if(P.options=t,e.sid=w.sid,!this.engine.publisher)throw new qO("publisher is closed");if(wg.debug("publishing ".concat(e.kind," with encodings"),{encodings:g,trackInfo:w}),e.sender=yield this.engine.createSender(e,t,g),g)if(EP()&&e.kind===pP.Kind.Audio){let t;for(const n of this.engine.publisher.pc.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(m=g[0])||void 0===m?void 0:m.maxBitrate)?g[0].maxBitrate/1e3:0})}else e.codec&&kP(e.codec)&&(null===(y=g[0])||void 0===y?void 0:y.maxBitrate)&&this.engine.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:g[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof rC?e.startMonitor(this.engine.client):e instanceof qE&&e.startMonitor(),this.addTrackPublication(P),this.emit(sP.LocalTrackPublished,P),P}))}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){var r;return Cw(this,void 0,void 0,(function*(){let o;if(this.tracks.forEach((t=>{t.track&&t.track===e&&(o=t)})),!o)throw new zO("track is not published");if(!(e instanceof rC))throw new zO("track is not a video track");const i=Object.assign(Object.assign({},null===(r=this.roomOptions)||void 0===r?void 0:r.publishDefaults),n),a=XE(e,t,i);if(!a)return void wg.info("backup codec has been disabled, ignoring request to add additional codec for track");const s=e.addSimulcastTrack(t,a),c=new rO({cid:s.mediaStreamTrack.id,type:pP.kindToProto(e.kind),muted:e.isMuted,source:pP.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:i.videoCodec,cid:s.mediaStreamTrack.id,enableSimulcastLayers:i.simulcast}]});if(c.layers=aC(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new qO("cannot publish track when not connected");const l=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,s,i,a),yield this.engine.negotiate(),wg.debug("published ".concat(t," for track ").concat(e.sid),{encodings:a,trackInfo:l})}))}unpublishTrack(e,t){var n,r;return Cw(this,void 0,void 0,(function*(){const o=this.getPublicationForTrack(e);if(wg.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!o||!o.track)return void wg.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});(e=o.track).off(lP.Muted,this.onTrackMuted),e.off(lP.Unmuted,this.onTrackUnmuted),e.off(lP.Ended,this.handleTrackEnded),e.off(lP.UpstreamPaused,this.onTrackUpstreamPaused),e.off(lP.UpstreamResumed,this.onTrackUpstreamResumed),void 0===t&&(t=null===(r=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===r||r),t&&e.stop();let i=!1;const a=e.sender;if(e.sender=void 0,this.engine.publisher&&"closed"!==this.engine.publisher.pc.connectionState&&a)try{for(const e of this.engine.publisher.pc.getTransceivers())e.sender===a&&(e.direction="inactive",i=!0);if(this.engine.removeTrack(a)&&(i=!0),e instanceof rC){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(i=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(e){wg.warn("failed to unpublish track",{error:e,method:"unpublishTrack"})}switch(this.tracks.delete(o.trackSid),o.kind){case pP.Kind.Audio:this.audioTracks.delete(o.trackSid);break;case pP.Kind.Video:this.videoTracks.delete(o.trackSid)}return this.emit(sP.LocalTrackUnpublished,o),o.setTrack(void 0),i&&(yield this.engine.negotiate()),o}))}unpublishTracks(e){return Cw(this,void 0,void 0,(function*(){return(yield Promise.all(e.map((e=>this.unpublishTrack(e))))).filter((e=>e instanceof fC))}))}republishAllTracks(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Cw(this,void 0,void 0,(function*(){const n=[];this.tracks.forEach((t=>{t.track&&(e&&(t.options=Object.assign(Object.assign({},t.options),e)),n.push(t))})),yield Promise.all(n.map((e=>Cw(this,void 0,void 0,(function*(){const n=e.track;yield this.unpublishTrack(n,!1),t&&!n.isMuted&&(n instanceof qE||n instanceof rC)&&!n.isUserProvided&&(wg.debug("restarting existing track",{track:e.trackSid}),yield n.restartTrack()),yield this.publishTrack(n,e.options)})))))}))}publishData(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Cw(this,void 0,void 0,(function*(){const r=Array.isArray(n)?n:null==n?void 0:n.destination,o=[],i=Array.isArray(n)?void 0:n.topic;void 0!==r&&r.forEach((e=>{e instanceof gC?o.push(e.sid):o.push(e)}));const a=new pw({kind:t,value:{case:"user",value:new mw({participantSid:this.sid,payload:e,destinationSids:o,topic:i})}});yield this.engine.sendDataPacket(a,t)}))}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isConnected&&this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid===this.sid&&!!super.updateInfo(e)&&(e.tracks.forEach((e=>{var t,n;const r=this.tracks.get(e.sid);if(r){const o=r.isMuted||null!==(n=null===(t=r.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;o!==e.muted&&(wg.debug("updating server mute state after reconcile",{sid:e.sid,muted:o}),this.engine.client.sendMuteTrack(e.sid,o))}})),!0)}getPublicationForTrack(e){let t;return this.tracks.forEach((n=>{const r=n.track;r&&(e instanceof MediaStreamTrack?(r instanceof qE||r instanceof rC)&&r.mediaStreamTrack===e&&(t=n):e===r&&(t=n))})),t}publishedTracksInfo(){const e=[];return this.tracks.forEach((t=>{void 0!==t.track&&e.push(new cO({cid:t.track.mediaStreamID,track:t.trackInfo}))})),e}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null==t?void 0:t.id)&&null!==t.id&&e.push(new IO({label:t.label,id:t.id,target:n}))};return t(this.engine.dataChannelForKind(ow.LOSSY),Kk.PUBLISHER),t(this.engine.dataChannelForKind(ow.RELIABLE),Kk.PUBLISHER),t(this.engine.dataChannelForKind(ow.LOSSY,!0),Kk.SUBSCRIBER),t(this.engine.dataChannelForKind(ow.RELIABLE,!0),Kk.SUBSCRIBER),e}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting"}(mC||(mC={}));class wC extends Hw.EventEmitter{constructor(e){var t,n;super(),t=this,this.state=mC.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.connect=(e,t,n)=>Cw(this,void 0,void 0,(function*(){var r;const o=yield this.disconnectLock.lock();if(this.state===mC.Connected)return wg.info("already connected to room ".concat(this.name)),o(),Promise.resolve();if(this.connectFuture)return o(),this.connectFuture.promise;this.setAndEmitConnectionState(mC.Connecting),(null===(r=this.regionUrlProvider)||void 0===r?void 0:r.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),RP(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new FE(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().catch((e=>{wg.warn("could not fetch region settings",{error:e})})));const i=(r,a,s)=>Cw(this,void 0,void 0,(function*(){var c;this.abortController&&this.abortController.abort();const l=new AbortController;this.abortController=l,null==o||o();try{yield this.attemptConnection(null!=s?s:e,t,n,l),this.abortController=void 0,r()}catch(e){if(this.regionUrlProvider&&e instanceof BO&&3!==e.reason&&0!==e.reason){let t=null;try{t=yield this.regionUrlProvider.getNextBestRegionUrl(null===(c=this.abortController)||void 0===c?void 0:c.signal)}catch(e){if(e instanceof BO&&(401===e.status||3===e.reason))return void a(e)}t?(wg.info("Initial connection failed with ConnectionError: ".concat(e.message,". Retrying with another region: ").concat(t)),yield i(r,a,t)):a(e)}else a(e)}})),a=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new HP(((e,t)=>{i(e,t,a)}),(()=>{this.clearConnectionFutures()})),this.connectFuture.promise})),this.connectSignal=(e,t,n,r,o,i)=>Cw(this,void 0,void 0,(function*(){const a=yield n.join(e,t,{autoSubscribe:r.autoSubscribe,publishOnly:r.publishOnly,adaptiveStream:"object"==typeof o.adaptiveStream||o.adaptiveStream,maxRetries:r.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:r.websocketTimeout},i.signal);let s=a.serverInfo;if(s||(s={version:a.serverVersion,region:a.serverRegion}),wg.debug("connected to Livekit Server ".concat(Object.entries(s).map((e=>{let[t,n]=e;return"".concat(t,": ").concat(n)})).join(", "))),!a.serverVersion)throw new WO("unknown server version");return"0.15.1"===a.serverVersion&&this.options.dynacast&&(wg.debug("disabling dynacast due to server version"),o.dynacast=!1),a})),this.applyJoinResponse=e=>{const t=e.participant;this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(e.sifTrailer)},this.attemptConnection=(e,t,n,r)=>Cw(this,void 0,void 0,(function*(){var o,i;this.state===mC.Reconnecting?(wg.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),(null===(o=this.regionUrlProvider)||void 0===o?void 0:o.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},AE),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,r);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(aP.SignalConnected)}catch(e){this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish);const t=new BO("could not establish signal connection");throw e instanceof Error&&(t.message="".concat(t.message,": ").concat(e.message)),e instanceof BO&&(t.reason=e.reason,t.status=e.status),wg.debug("error trying to establish signal connection",{error:e}),t}if(r.signal.aborted)throw this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),new BO("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,r)}catch(e){throw this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),e}xP()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),xP()&&(document.addEventListener("freeze",this.onPageLeave),null===(i=navigator.mediaDevices)||void 0===i||i.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(mC.Connected),this.emit(aP.Connected),this.registerConnectionReconcile()})),this.disconnect=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Cw(t,void 0,void 0,(function*(){var t,n,r,o;const i=yield this.disconnectLock.lock();try{if(this.state===mC.Disconnected)return void wg.debug("already disconnected");wg.info("disconnect from room",{identity:this.localParticipant.identity}),this.state!==mC.Connecting&&this.state!==mC.Reconnecting||(wg.warn("abort connection attempt"),null===(t=this.abortController)||void 0===t||t.abort(),null===(r=null===(n=this.connectFuture)||void 0===n?void 0:n.reject)||void 0===r||r.call(n,new BO("Client initiated disconnect")),this.connectFuture=void 0),(null===(o=this.engine)||void 0===o?void 0:o.client.isConnected)&&(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(e,VS.CLIENT_INITIATED),this.engine=void 0}finally{i()}}))},this.onPageLeave=()=>Cw(this,void 0,void 0,(function*(){yield this.disconnect()})),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const e of this.participants.values())this.handleParticipantDisconnected(e.sid,e);this.setAndEmitConnectionState(mC.Reconnecting)&&this.emit(aP.Reconnecting)},this.handleSignalRestarted=e=>Cw(this,void 0,void 0,(function*(){wg.debug("signal reconnected to server",{region:e.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(e);try{const e=[];this.localParticipant.tracks.forEach((t=>{t.track&&e.push(t)})),yield Promise.all(e.map((e=>Cw(this,void 0,void 0,(function*(){const t=e.track;this.localParticipant.unpublishTrack(t,!1),t.isMuted||((t instanceof qE||t instanceof rC)&&t.source!==pP.Source.ScreenShare&&t.source!==pP.Source.ScreenShareAudio&&!t.isUserProvided&&(wg.debug("restarting existing track",{track:e.trackSid}),yield t.restartTrack()),wg.debug("publishing new track",{track:e.trackSid}),yield this.localParticipant.publishTrack(t,e.options))})))))}catch(e){wg.error("error trying to re-publish tracks after reconnection",{error:e})}try{yield this.engine.waitForRestarted(),wg.debug("fully reconnected to server",{region:e.serverRegion})}catch(e){return}this.setAndEmitConnectionState(mC.Connected),this.emit(aP.Reconnected),this.registerConnectionReconcile(),this.participants.forEach((e=>{this.emit(aP.ParticipantConnected,e)}))})),this.handleParticipantUpdates=e=>{e.forEach((e=>{if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);const t=this.identityToSid.get(e.identity);t&&t!==e.sid&&this.handleParticipantDisconnected(t,this.participants.get(t));let n=this.participants.get(e.sid);const r=!n;e.state===nw.DISCONNECTED?this.handleParticipantDisconnected(e.sid,n):(n=this.getOrCreateParticipant(e.sid,e),r||n.updateInfo(e))}))},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach((e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.participants.get(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}})),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach((e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))})),this.activeSpeakers=t,this.emitWhenConnected(aP.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach((e=>{t.set(e.sid,e)})),e.forEach((e=>{let n=this.participants.get(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))}));const n=Array.from(t.values());n.sort(((e,t)=>t.audioLevel-e.audioLevel)),this.activeSpeakers=n,this.emitWhenConnected(aP.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach((e=>{const t=this.participants.get(e.participantSid);if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.track&&(n.track.streamState=pP.streamStateFromProto(e.state),t.emit(sP.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(aP.TrackStreamStateChanged,n,n.track.streamState,t))}))},this.handleSubscriptionPermissionUpdate=e=>{const t=this.participants.get(e.participantSid);if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.participants.values()).find((t=>t.tracks.has(e.trackSid)));if(!t)return;const n=t.getTrackPublication(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=(e,t)=>{const n=this.participants.get(e.participantSid);this.emit(aP.DataReceived,e.payload,n,t,e.topic),null==n||n.emit(sP.DataReceived,e.payload,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(aP.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{wg.warn("could not playback audio",e),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(aP.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>Cw(this,void 0,void 0,(function*(){this.emit(aP.MediaDevicesChanged)})),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(aP.RoomMetadataChanged,e.metadata),(null==t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(aP.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach((e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.participants.get(e.participantSid);t&&t.setConnectionQuality(e.quality)}))},this.onLocalParticipantMetadataChanged=e=>{this.emit(aP.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(aP.ParticipantNameChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(aP.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(aP.TrackUnmuted,e,this.localParticipant)},this.onLocalTrackPublished=e=>Cw(this,void 0,void 0,(function*(){var t;this.emit(aP.LocalTrackPublished,e,this.localParticipant),e.track instanceof qE&&(yield e.track.checkForSilence())&&this.emit(aP.LocalAudioSilenceDetected,e);const n=yield null===(t=e.track)||void 0===t?void 0:t.getDeviceId(),r=(o=e.source)===pP.Source.Microphone?"audioinput":o===pP.Source.Camera?"videoinput":void 0;var o;r&&n&&n!==this.localParticipant.activeDeviceMap.get(r)&&(this.localParticipant.activeDeviceMap.set(r,n),this.emit(aP.ActiveDeviceChanged,r,n))})),this.onLocalTrackUnpublished=e=>{this.emit(aP.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalConnectionQualityChanged=e=>{this.emit(aP.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=e=>{this.emit(aP.MediaDevicesError,e)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(aP.ParticipantPermissionsChanged,e,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},_E),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},RE),null==e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},IE),null==e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},jE),null==e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new ZP,this.localParticipant=new SC("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",VP(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",VP(this.options.audioCaptureDefaults.deviceId)),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&this.switchActiveDevice("audiooutput",VP(this.options.audioOutput.deviceId)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return Cw(this,void 0,void 0,(function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)}))}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new dE(this.options.e2ee),this.e2eeManager.on(rE.ParticipantEncryptionStatusChanged,((e,t)=>{t instanceof SC&&(this.isE2EEEnabled=e),this.emit(aP.ParticipantEncryptionStatusChanged,e,t)})),this.e2eeManager.on(rE.EncryptionError,(e=>this.emit(aP.EncryptionError,e))),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}get sid(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.sid)&&void 0!==t?t:""}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new UE(this.options),this.engine.on(cP.ParticipantUpdate,this.handleParticipantUpdates).on(cP.RoomUpdate,this.handleRoomUpdate).on(cP.SpeakersChanged,this.handleSpeakersChanged).on(cP.StreamStateChanged,this.handleStreamStateUpdate).on(cP.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(cP.SubscriptionError,this.handleSubscriptionError).on(cP.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(cP.MediaTrackAdded,((e,t,n)=>{this.onTrackAdded(e,t,n)})).on(cP.Disconnected,(e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)})).on(cP.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(cP.DataPacketReceived,this.handleDataPacket).on(cP.Resuming,(()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(mC.Reconnecting)&&this.emit(aP.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())})).on(cP.Resumed,(()=>{this.setAndEmitConnectionState(mC.Connected),this.emit(aP.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions();const e=Array.from(this.participants.values()).filter((e=>!this.cachedParticipantSids.includes(e.sid)));e.forEach((e=>this.emit(aP.ParticipantConnected,e))),this.cachedParticipantSids=[]})).on(cP.SignalResumed,(()=>{this.state===mC.Reconnecting&&this.sendSyncState()})).on(cP.Restarting,this.handleRestarting).on(cP.SignalRestarted,this.handleSignalRestarted).on(cP.DCBufferStatusChanged,((e,t)=>{this.emit(aP.DCBufferStatusChanged,e,t)})),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return lE.getInstance().getDevices(e,t)}prepareConnection(e,t){return Cw(this,void 0,void 0,(function*(){if(this.state===mC.Disconnected){wg.debug("prepareConnection to ".concat(e));try{if(RP(new URL(e))&&t){this.regionUrlProvider=new FE(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===mC.Disconnected&&(this.regionUrl=n,yield fetch(JP(n),{method:"HEAD"}),wg.debug("prepared connection to ".concat(n)))}else yield fetch(JP(e),{method:"HEAD"})}catch(e){wg.warn("could not prepare connection",{error:e})}}}))}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const t=this.identityToSid.get(e);return t?this.participants.get(t):void 0}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return Cw(this,void 0,void 0,(function*(){let n,r=()=>{};switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new _O({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new _O({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new _O({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new _O({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new _O({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),r=()=>Cw(this,void 0,void 0,(function*(){const e=this.engine.client.onLeave;e&&e(new hO({reason:VS.CLIENT_INITIATED,canReconnect:!0}))}));break;case"subscriber-bandwidth":if(void 0===t||"number"!=typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new _O({scenario:{case:"subscriberBandwidth",value:BigInt(t)}})}n&&(this.engine.client.sendSimulateScenario(n),r())}))}startAudio(){return Cw(this,void 0,void 0,(function*(){const e=[],t=GO();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=qP();e.enabled=!0;const r=new MediaStream([e]);n.srcObject=r,document.addEventListener("visibilitychange",(()=>{n&&(n.srcObject=document.hidden?null:r)})),document.body.append(n),this.once(aP.Disconnected,(()=>{null==n||n.remove()}))}e.push(n)}this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))}));try{yield Promise.all([this.acquireAudioContext(),...e.map((e=>(e.muted=!1,e.play())))]),this.handleAudioPlaybackStarted()}catch(e){throw this.handleAudioPlaybackFailed(e),e}}))}get canPlaybackAudio(){return this.audioEnabled}getActiveAudioOutputDevice(){var e,t;return null!==(t=null===(e=this.options.audioOutput)||void 0===e?void 0:e.deviceId)&&void 0!==t?t:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var r,o,i;return Cw(this,void 0,void 0,(function*(){let a=!1,s=!0;const c=n?{exact:t}:t;if("audioinput"===e){const e=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,a=e!==c;const t=Array.from(this.localParticipant.audioTracks.values()).filter((e=>e.source===pP.Source.Microphone));try{s=(yield Promise.all(t.map((e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(c)})))).every((e=>!0===e))}catch(t){throw this.options.audioCaptureDefaults.deviceId=e,t}}else if("videoinput"===e){const e=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,a=e!==c;const t=Array.from(this.localParticipant.videoTracks.values()).filter((e=>e.source===pP.Source.Camera));try{s=(yield Promise.all(t.map((e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(c)})))).every((e=>!0===e))}catch(t){throw this.options.videoCaptureDefaults.deviceId=e,t}}else if("audiooutput"===e){if(!OP()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");null!==(r=(i=this.options).audioOutput)&&void 0!==r||(i.audioOutput={});const e=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=t,a=e!==c;try{this.options.expWebAudioMix?null===(o=this.audioContext)||void 0===o||o.setSinkId(t):yield Promise.all(Array.from(this.participants.values()).map((e=>e.setAudioOutput({deviceId:t}))))}catch(t){throw this.options.audioOutput.deviceId=e,t}}return a&&s&&(this.localParticipant.activeDeviceMap.set(e,t),this.emit(aP.ActiveDeviceChanged,e,t)),s}))}setupLocalParticipantEvents(){this.localParticipant.on(sP.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(sP.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(sP.TrackMuted,this.onLocalTrackMuted).on(sP.TrackUnmuted,this.onLocalTrackUnmuted).on(sP.LocalTrackPublished,this.onLocalTrackPublished).on(sP.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(sP.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(sP.MediaDevicesError,this.onMediaDevicesError).on(sP.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===mC.Connecting||this.state===mC.Reconnecting){const r=()=>{this.onTrackAdded(e,t,n),o()},o=()=>{this.off(aP.Reconnected,r),this.off(aP.Connected,r),this.off(aP.Disconnected,o)};return this.once(aP.Reconnected,r),this.once(aP.Connected,r),void this.once(aP.Disconnected,o)}if(this.state===mC.Disconnected)return void wg.warn("skipping incoming track after Room disconnected");const r=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),o=r[0];let i=r[1];if(i&&""!==i||(i=e.id),o===this.localParticipant.sid)return void wg.warn("tried to create RemoteParticipant for local participant");const a=this.participants.get(o);if(!a)return void wg.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o));let s;this.options.adaptiveStream&&(s="object"==typeof this.options.adaptiveStream?this.options.adaptiveStream:{}),a.addSubscribedMediaTrack(e,i,t,n,s)}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.state!==mC.Disconnected){this.regionUrl=void 0;try{this.participants.forEach((e=>{e.tracks.forEach((t=>{e.unpublishTrack(t.trackSid)}))})),this.localParticipant.tracks.forEach((t=>{var n,r;t.track&&this.localParticipant.unpublishTrack(t.track,e),e&&(null===(n=t.track)||void 0===n||n.detach(),null===(r=t.track)||void 0===r||r.stop())})),this.localParticipant.off(sP.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(sP.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(sP.TrackMuted,this.onLocalTrackMuted).off(sP.TrackUnmuted,this.onLocalTrackUnmuted).off(sP.LocalTrackPublished,this.onLocalTrackPublished).off(sP.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(sP.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(sP.MediaDevicesError,this.onMediaDevicesError).off(sP.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"==typeof this.options.expWebAudioMix&&(this.audioContext.close(),this.audioContext=void 0),xP()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(mC.Disconnected),this.emit(aP.Disconnected,t)}}}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach((e=>{t.unpublishTrack(e.trackSid,!0)})),this.emit(aP.ParticipantDisconnected,t))}acquireAudioContext(){var e,t;return Cw(this,void 0,void 0,(function*(){if("boolean"!=typeof this.options.expWebAudioMix&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=bP())&&void 0!==e?e:void 0),this.audioContext&&"suspended"===this.audioContext.state)try{yield this.audioContext.resume()}catch(e){wg.warn(e)}this.options.expWebAudioMix&&this.participants.forEach((e=>e.setAudioContext(this.audioContext))),this.localParticipant.setAudioContext(this.audioContext);const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(aP.AudioPlaybackStatusChanged,n))}))}createParticipant(e,t){let n;return n=t?gC.fromParticipantInfo(this.engine.client,t):new gC(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&n.setAudioContext(this.audioContext),n}getOrCreateParticipant(e,t){if(this.participants.has(e))return this.participants.get(e);const n=this.createParticipant(e,t);return this.participants.set(e,n),this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected(aP.ParticipantConnected,n),n.on(sP.TrackPublished,(e=>{this.emitWhenConnected(aP.TrackPublished,e,n)})).on(sP.TrackSubscribed,((e,t)=>{e.kind===pP.Kind.Audio&&(e.on(lP.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(lP.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(aP.TrackSubscribed,e,t,n)})).on(sP.TrackUnpublished,(e=>{this.emit(aP.TrackUnpublished,e,n)})).on(sP.TrackUnsubscribed,((e,t)=>{this.emit(aP.TrackUnsubscribed,e,t,n)})).on(sP.TrackSubscriptionFailed,(e=>{this.emit(aP.TrackSubscriptionFailed,e,n)})).on(sP.TrackMuted,(e=>{this.emitWhenConnected(aP.TrackMuted,e,n)})).on(sP.TrackUnmuted,(e=>{this.emitWhenConnected(aP.TrackUnmuted,e,n)})).on(sP.ParticipantMetadataChanged,(e=>{this.emitWhenConnected(aP.ParticipantMetadataChanged,e,n)})).on(sP.ParticipantNameChanged,(e=>{this.emitWhenConnected(aP.ParticipantNameChanged,e,n)})).on(sP.ConnectionQualityChanged,(e=>{this.emitWhenConnected(aP.ConnectionQualityChanged,e,n)})).on(sP.ParticipantPermissionsChanged,(e=>{this.emitWhenConnected(aP.ParticipantPermissionsChanged,e,n)})).on(sP.TrackSubscriptionStatusChanged,((e,t)=>{this.emitWhenConnected(aP.TrackSubscriptionStatusChanged,e,t,n)})).on(sP.TrackSubscriptionFailed,((e,t)=>{this.emit(aP.TrackSubscriptionFailed,e,n,t)})).on(sP.TrackSubscriptionPermissionChanged,((e,t)=>{this.emitWhenConnected(aP.TrackSubscriptionPermissionChanged,e,t,n)})),t&&n.updateInfo(t),n}sendSyncState(){var e,t;if(void 0===this.engine.subscriber||null===this.engine.subscriber.pc.localDescription)return;const n=this.engine.subscriber.pc.localDescription,r=this.engine.subscriber.pc.remoteDescription,o=null===(t=null===(e=this.connOptions)||void 0===e?void 0:e.autoSubscribe)||void 0===t||t,i=new Array;this.participants.forEach((e=>{e.tracks.forEach((e=>{e.isDesired!==o&&i.push(e.trackSid)}))})),this.engine.client.sendSyncState(new RO({answer:QP({sdp:n.sdp,type:n.type}),offer:r?QP({sdp:r.sdp,type:r.type}):void 0,subscription:new pO({trackSids:i,subscribe:!o,participantTracks:[]}),publishTracks:this.localParticipant.publishedTracksInfo(),dataChannels:this.localParticipant.dataChannelsInfo()}))}updateSubscriptions(){for(const e of this.participants.values())for(const t of e.videoTracks.values())t.isSubscribed&&t instanceof vC&&t.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ZO.setInterval((()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,wg.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,VS.STATE_MISMATCH)))}),2e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&ZO.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(aP.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===mC.Connected){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.emit(e,...n)}return!1}simulateParticipants(e){var t,n;return Cw(this,void 0,void 0,(function*(){const r=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new YS({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Jg.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new tw({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(aP.SignalConnected),this.emit(aP.Connected),this.setAndEmitConnectionState(mC.Connected),r.video){const e=new fC(pP.Kind.Video,new uw({source:WS.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:zS.AUDIO,name:"video-dummy"}),new rC(r.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:WP(null!==(t=160*o.aspectRatios[0])&&void 0!==t?t:1,160,!0,!0)));this.localParticipant.addTrackPublication(e),this.localParticipant.emit(sP.LocalTrackPublished,e)}if(r.audio){const e=new fC(pP.Kind.Audio,new uw({source:WS.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:zS.AUDIO}),new qE(r.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:qP()));this.localParticipant.addTrackPublication(e),this.localParticipant.emit(sP.LocalTrackPublished,e)}for(let e=0;e<o.count-1;e+=1){let t=new tw({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:nw.ACTIVE,tracks:[],joinedAt:Jg.parse(Date.now())});const r=this.getOrCreateParticipant(t.identity,t);if(o.video){const i=WP(null!==(n=160*o.aspectRatios[e%o.aspectRatios.length])&&void 0!==n?n:1,160,!1,!0),a=new uw({source:WS.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:zS.AUDIO});r.addSubscribedMediaTrack(i,a.sid,new MediaStream([i])),t.tracks=[...t.tracks,a]}if(o.audio){const e=qP(),n=new uw({source:WS.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:zS.AUDIO});r.addSubscribedMediaTrack(e,n.sid,new MediaStream([e])),t.tracks=[...t.tracks,n]}r.updateInfo(t)}}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e!==aP.ActiveSpeakersChanged&&wg.debug("room event ".concat(e),{event:e,args:n}),super.emit(e,...n)}}!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(yC||(yC={}));class kC extends Hw.EventEmitter{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.status=yC.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=t,this.name=this.constructor.name,this.room=new wC(n.roomOptions),this.connectOptions=n.connectOptions,n.errorsAsWarnings&&(this.errorsAsWarnings=n.errorsAsWarnings)}run(e){return Cw(this,void 0,void 0,(function*(){if(this.status!==yC.IDLE)throw Error("check is running already");this.setStatus(yC.RUNNING);try{yield this.perform()}catch(e){e instanceof Error&&(this.errorsAsWarnings?this.appendWarning(e.message):this.appendError(e.message))}return yield this.disconnect(),yield new Promise((e=>setTimeout(e,500))),this.status!==yC.SKIPPED&&this.setStatus(this.isSuccess()?yC.SUCCESS:yC.FAILED),e&&e(),this.getInfo()}))}isSuccess(){return!this.logs.some((e=>"error"===e.level))}connect(){return Cw(this,void 0,void 0,(function*(){return this.room.state===mC.Connected||(yield this.room.connect(this.url,this.token)),this.room}))}disconnect(){return Cw(this,void 0,void 0,(function*(){this.room&&this.room.state!==mC.Disconnected&&(yield this.room.disconnect(),yield new Promise((e=>setTimeout(e,500))))}))}skip(){this.setStatus(yC.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){return this.room,void 0}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class OC extends Hw.EventEmitter{constructor(e,t){super(),this.checkResults=new Map,this.url=e,this.token=t}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:yC.IDLE,name:"",description:""}),e}updateCheck(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}isSuccess(){return Array.from(this.checkResults.values()).every((e=>e.status!==yC.FAILED))}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return Cw(this,void 0,void 0,(function*(){const t=this.getNextCheckId(),n=new e(this.url,this.token),r=e=>{this.updateCheck(t,e)};n.on("update",r);const o=yield n.run();return n.off("update",r),o}))}checkWebsocket(){return Cw(this,void 0,void 0,(function*(){return this.createAndRunCheck(WebSocketCheck)}))}checkWebRTC(){return Cw(this,void 0,void 0,(function*(){return this.createAndRunCheck(WebRTCCheck)}))}checkTURN(){return Cw(this,void 0,void 0,(function*(){return this.createAndRunCheck(TURNCheck)}))}checkReconnect(){return Cw(this,void 0,void 0,(function*(){return this.createAndRunCheck(ReconnectCheck)}))}checkPublishAudio(){return Cw(this,void 0,void 0,(function*(){return this.createAndRunCheck(PublishAudioCheck)}))}checkPublishVideo(){return Cw(this,void 0,void 0,(function*(){return this.createAndRunCheck(PublishVideoCheck)}))}}function PC(e){return e.split("-")[1]}function EC(e){return"y"===e?"height":"width"}function CC(e){return e.split("-")[0]}function TC(e){return["top","bottom"].includes(CC(e))?"x":"y"}function xC(e,t,n){let{reference:r,floating:o}=e;const i=r.x+r.width/2-o.width/2,a=r.y+r.height/2-o.height/2,s=TC(t),c=EC(s),l=r[c]/2-o[c]/2,u="x"===s;let d;switch(CC(t)){case"top":d={x:i,y:r.y-o.height};break;case"bottom":d={x:i,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:a};break;case"left":d={x:r.x-o.width,y:a};break;default:d={x:r.x,y:r.y}}switch(PC(t)){case"start":d[s]-=l*(n&&u?-1:1);break;case"end":d[s]+=l*(n&&u?-1:1)}return d}new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]),a(1865);const jC=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),c=await(null==a.isRTL?void 0:a.isRTL(t));let l=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:d}=xC(l,r,c),p=r,f={},h=0;for(let n=0;n<s.length;n++){const{name:i,fn:m}=s[n],{x:y,y:b,data:v,reset:g}=await m({x:u,y:d,initialPlacement:r,placement:p,strategy:o,middlewareData:f,rects:l,platform:a,elements:{reference:e,floating:t}});u=null!=y?y:u,d=null!=b?b:d,f={...f,[i]:{...f[i],...v}},g&&h<=50&&(h++,"object"==typeof g&&(g.placement&&(p=g.placement),g.rects&&(l=!0===g.rects?await a.getElementRects({reference:e,floating:t,strategy:o}):g.rects),({x:u,y:d}=xC(l,p,c))),n=-1)}return{x:u,y:d,placement:p,strategy:o,middlewareData:f}};function RC(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function IC(e,t){var n;void 0===t&&(t={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=t,h=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(f),m=s[p?"floating"===d?"reference":"floating":d],y=RC(await i.getClippingRect({element:null==(n=await(null==i.isElement?void 0:i.isElement(m)))||n?m:m.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),b="floating"===d?{...a.floating,x:r,y:o}:a.reference,v=await(null==i.getOffsetParent?void 0:i.getOffsetParent(s.floating)),g=await(null==i.isElement?void 0:i.isElement(v))&&await(null==i.getScale?void 0:i.getScale(v))||{x:1,y:1},S=RC(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:v,strategy:c}):b);return{top:(y.top-S.top+h.top)/g.y,bottom:(S.bottom-y.bottom+h.bottom)/g.y,left:(y.left-S.left+h.left)/g.x,right:(S.right-y.right+h.right)/g.x}}const _C=Math.min,AC=Math.max;function MC(e,t,n){return AC(e,_C(t,n))}const DC=(["top","right","bottom","left"].reduce(((e,t)=>e.concat(t,t+"-start",t+"-end")),[]),{left:"right",right:"left",bottom:"top",top:"bottom"});function LC(e){return e.replace(/left|right|bottom|top/g,(e=>DC[e]))}function NC(e,t,n){void 0===n&&(n=!1);const r=PC(e),o=TC(e),i=EC(o);let a="x"===o?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=LC(a)),{main:a,cross:LC(a)}}const UC={start:"end",end:"start"};function BC(e){return e.replace(/start|end/g,(e=>UC[e]))}const FC=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n;const{placement:r,middlewareData:o,rects:i,initialPlacement:a,platform:s,elements:c}=t,{mainAxis:l=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:h=!0,...m}=e,y=CC(r),b=CC(a)===a,v=await(null==s.isRTL?void 0:s.isRTL(c.floating)),g=d||(b||!h?[LC(a)]:function(e){const t=LC(e);return[BC(e),t,BC(t)]}(a));d||"none"===f||g.push(...function(e,t,n,r){const o=PC(e);let i=function(e,t,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?i:a;default:return[]}}(CC(e),"start"===n,r);return o&&(i=i.map((e=>e+"-"+o)),t&&(i=i.concat(i.map(BC)))),i}(a,h,f,v));const S=[a,...g],w=await IC(t,m),k=[];let O=(null==(n=o.flip)?void 0:n.overflows)||[];if(l&&k.push(w[y]),u){const{main:e,cross:t}=NC(r,i,v);k.push(w[e],w[t])}if(O=[...O,{placement:r,overflows:k}],!k.every((e=>e<=0))){var P,E;const e=((null==(P=o.flip)?void 0:P.index)||0)+1,t=S[e];if(t)return{data:{index:e,overflows:O},reset:{placement:t}};let n=null==(E=O.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:E.placement;if(!n)switch(p){case"bestFit":{var C;const e=null==(C=O.map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:C[0];e&&(n=e);break}case"initialPlacement":n=a}if(r!==n)return{reset:{placement:n}}}return{}}}},zC=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,o=await async function(e,t){const{placement:n,platform:r,elements:o}=e,i=await(null==r.isRTL?void 0:r.isRTL(o.floating)),a=CC(n),s=PC(n),c="x"===TC(n),l=["left","top"].includes(a)?-1:1,u=i&&c?-1:1,d="function"==typeof t?t(e):t;let{mainAxis:p,crossAxis:f,alignmentAxis:h}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&"number"==typeof h&&(f="end"===s?-1*h:h),c?{x:f*u,y:p*l}:{x:p*l,y:f*u}}(t,e);return{x:n+o.x,y:r+o.y,data:o}}}};const WC=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...c}=e,l={x:n,y:r},u=await IC(t,c),d=TC(CC(o)),p=function(e){return"x"===e?"y":"x"}(d);let f=l[d],h=l[p];if(i){const e="y"===d?"bottom":"right";f=MC(f+u["y"===d?"top":"left"],f,f-u[e])}if(a){const e="y"===p?"bottom":"right";h=MC(h+u["y"===p?"top":"left"],h,h-u[e])}const m=s.fn({...t,[d]:f,[p]:h});return{...m,data:{x:m.x-n,y:m.y-r}}}}};function qC(e){var t;return(null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function HC(e){return qC(e).getComputedStyle(e)}function ZC(e){return e instanceof qC(e).Node}function VC(e){return ZC(e)?(e.nodeName||"").toLowerCase():""}let JC;function GC(){if(JC)return JC;const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?(JC=e.brands.map((e=>e.brand+"/"+e.version)).join(" "),JC):navigator.userAgent}function KC(e){return e instanceof qC(e).HTMLElement}function $C(e){return e instanceof qC(e).Element}function YC(e){return"undefined"!=typeof ShadowRoot&&(e instanceof qC(e).ShadowRoot||e instanceof ShadowRoot)}function XC(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=HC(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function QC(e){return["table","td","th"].includes(VC(e))}function eT(e){const t=/firefox/i.test(GC()),n=HC(e),r=n.backdropFilter||n.WebkitBackdropFilter;return"none"!==n.transform||"none"!==n.perspective||!!r&&"none"!==r||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter||["transform","perspective"].some((e=>n.willChange.includes(e)))||["paint","layout","strict","content"].some((e=>{const t=n.contain;return null!=t&&t.includes(e)}))}function tT(){return/^((?!chrome|android).)*safari/i.test(GC())}function nT(e){return["html","body","#document"].includes(VC(e))}const rT=Math.min,oT=Math.max,iT=Math.round;function aT(e){const t=HC(e);let n=parseFloat(t.width),r=parseFloat(t.height);const o=KC(e),i=o?e.offsetWidth:n,a=o?e.offsetHeight:r,s=iT(n)!==i||iT(r)!==a;return s&&(n=i,r=a),{width:n,height:r,fallback:s}}function sT(e){return $C(e)?e:e.contextElement}const cT={x:1,y:1};function lT(e){const t=sT(e);if(!KC(t))return cT;const n=t.getBoundingClientRect(),{width:r,height:o,fallback:i}=aT(t);let a=(i?iT(n.width):n.width)/r,s=(i?iT(n.height):n.height)/o;return a&&Number.isFinite(a)||(a=1),s&&Number.isFinite(s)||(s=1),{x:a,y:s}}function uT(e,t,n,r){var o,i;void 0===t&&(t=!1),void 0===n&&(n=!1);const a=e.getBoundingClientRect(),s=sT(e);let c=cT;t&&(r?$C(r)&&(c=lT(r)):c=lT(e));const l=s?qC(s):window,u=tT()&&n;let d=(a.left+(u&&(null==(o=l.visualViewport)?void 0:o.offsetLeft)||0))/c.x,p=(a.top+(u&&(null==(i=l.visualViewport)?void 0:i.offsetTop)||0))/c.y,f=a.width/c.x,h=a.height/c.y;if(s){const e=qC(s),t=r&&$C(r)?qC(r):r;let n=e.frameElement;for(;n&&r&&t!==e;){const e=lT(n),t=n.getBoundingClientRect(),r=getComputedStyle(n);t.x+=(n.clientLeft+parseFloat(r.paddingLeft))*e.x,t.y+=(n.clientTop+parseFloat(r.paddingTop))*e.y,d*=e.x,p*=e.y,f*=e.x,h*=e.y,d+=t.x,p+=t.y,n=qC(n).frameElement}}return RC({width:f,height:h,x:d,y:p})}function dT(e){return((ZC(e)?e.ownerDocument:e.document)||window.document).documentElement}function pT(e){return $C(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function fT(e){return uT(dT(e)).left+pT(e).scrollLeft}function hT(e){if("html"===VC(e))return e;const t=e.assignedSlot||e.parentNode||YC(e)&&e.host||dT(e);return YC(t)?t.host:t}function mT(e){const t=hT(e);return nT(t)?t.ownerDocument.body:KC(t)&&XC(t)?t:mT(t)}function yT(e,t){var n;void 0===t&&(t=[]);const r=mT(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=qC(r);return o?t.concat(i,i.visualViewport||[],XC(r)?r:[]):t.concat(r,yT(r))}function bT(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=qC(e),r=dT(e),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,c=0;if(o){i=o.width,a=o.height;const e=tT();(!e||e&&"fixed"===t)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:i,height:a,x:s,y:c}}(e,n);else if("document"===t)r=function(e){const t=dT(e),n=pT(e),r=e.ownerDocument.body,o=oT(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=oT(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+fT(e);const s=-n.scrollTop;return"rtl"===HC(r).direction&&(a+=oT(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}(dT(e));else if($C(t))r=function(e,t){const n=uT(e,!0,"fixed"===t),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=KC(e)?lT(e):{x:1,y:1};return{width:e.clientWidth*i.x,height:e.clientHeight*i.y,x:o*i.x,y:r*i.y}}(t,n);else{const n={...t};if(tT()){var o,i;const t=qC(e);n.x-=(null==(o=t.visualViewport)?void 0:o.offsetLeft)||0,n.y-=(null==(i=t.visualViewport)?void 0:i.offsetTop)||0}r=n}return RC(r)}function vT(e,t){return KC(e)&&"fixed"!==HC(e).position?t?t(e):e.offsetParent:null}function gT(e,t){const n=qC(e);if(!KC(e))return n;let r=vT(e,t);for(;r&&QC(r)&&"static"===HC(r).position;)r=vT(r,t);return r&&("html"===VC(r)||"body"===VC(r)&&"static"===HC(r).position&&!eT(r))?n:r||function(e){let t=hT(e);for(;KC(t)&&!nT(t);){if(eT(t))return t;t=hT(t)}return null}(e)||n}function ST(e,t,n){const r=KC(t),o=dT(t),i=uT(e,!0,"fixed"===n,t);let a={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(r||!r&&"fixed"!==n)if(("body"!==VC(t)||XC(o))&&(a=pT(t)),KC(t)){const e=uT(t,!0);s.x=e.x+t.clientLeft,s.y=e.y+t.clientTop}else o&&(s.x=fT(o));return{x:i.left+a.scrollLeft-s.x,y:i.top+a.scrollTop-s.y,width:i.width,height:i.height}}const wT={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i="clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let r=yT(e).filter((e=>$C(e)&&"body"!==VC(e))),o=null;const i="fixed"===HC(e).position;let a=i?hT(e):e;for(;$C(a)&&!nT(a);){const e=HC(a),t=eT(a);"fixed"===e.position&&(o=null),(i?t||o:t||"static"!==e.position||!o||!["absolute","fixed"].includes(o.position))?o=e:r=r.filter((e=>e!==a)),a=hT(a)}return t.set(e,r),r}(t,this._c):[].concat(n),a=[...i,r],s=a[0],c=a.reduce(((e,n)=>{const r=bT(t,n,o);return e.top=oT(r.top,e.top),e.right=rT(r.right,e.right),e.bottom=rT(r.bottom,e.bottom),e.left=oT(r.left,e.left),e}),bT(t,s,o));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e;const o=KC(n),i=dT(n);if(n===i)return t;let a={scrollLeft:0,scrollTop:0},s={x:1,y:1};const c={x:0,y:0};if((o||!o&&"fixed"!==r)&&(("body"!==VC(n)||XC(i))&&(a=pT(n)),KC(n))){const e=uT(n);s=lT(n),c.x=e.x+n.clientLeft,c.y=e.y+n.clientTop}return{width:t.width*s.x,height:t.height*s.y,x:t.x*s.x-a.scrollLeft*s.x+c.x,y:t.y*s.y-a.scrollTop*s.y+c.y}},isElement:$C,getDimensions:function(e){return aT(e)},getOffsetParent:gT,getDocumentElement:dT,getScale:lT,async getElementRects(e){let{reference:t,floating:n,strategy:r}=e;const o=this.getOffsetParent||gT,i=this.getDimensions;return{reference:ST(t,await o(n),r),floating:{x:0,y:0,...await i(n)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===HC(e).direction};var kT=a(87856);function OT(e){return"function"==typeof e}function PT(e){return function(t){if(function(e){return OT(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var ET=function(e,t){return ET=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ET(e,t)};function CT(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ET(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function TT(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function xT(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function jT(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function RT(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function IT(e){return this instanceof IT?(this.v=e,this):new IT(e)}function _T(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var AT=_T((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function MT(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var DT=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=xT(i),s=a.next();!s.done;s=a.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(OT(c))try{c()}catch(e){o=e instanceof AT?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=xT(l),d=u.next();!d.done;d=u.next()){var p=d.value;try{UT(p)}catch(e){o=null!=o?o:[],e instanceof AT?o=RT(RT([],jT(o)),jT(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(o)throw new AT(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)UT(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&MT(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&MT(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),LT=DT.EMPTY;function NT(e){return e instanceof DT||e&&"closed"in e&&OT(e.remove)&&OT(e.add)&&OT(e.unsubscribe)}function UT(e){OT(e)?e():e.unsubscribe()}var BT={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},FT={setTimeout:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=FT.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,RT([e,t],jT(n))):setTimeout.apply(void 0,RT([e,t],jT(n)))})),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=FT.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)})),delegate:void 0};function zT(e){FT.setTimeout((function(){var t=BT.onUnhandledError;if(!t)throw e;t(e)}))}function WT(){}var qT=HT("C",void 0,void 0);function HT(e,t,n){return{kind:e,value:t,error:n}}var ZT=null;function VT(e){if(BT.useDeprecatedSynchronousErrorHandling){var t=!ZT;if(t&&(ZT={errorThrown:!1,error:null}),e(),t){var n=ZT,r=n.errorThrown,o=n.error;if(ZT=null,r)throw o}}else e()}var JT=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,NT(t)&&t.add(n)):n.destination=ex,n}return CT(t,e),t.create=function(e,t,n){return new YT(e,t,n)},t.prototype.next=function(e){this.isStopped?QT(function(e){return HT("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?QT(HT("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?QT(qT,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(DT),GT=Function.prototype.bind;function KT(e,t){return GT.call(e,t)}var $T=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){XT(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){XT(e)}else XT(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){XT(e)}},e}(),YT=function(e){function t(t,n,r){var o,i,a=e.call(this)||this;return OT(t)||!t?o={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:a&&BT.useDeprecatedNextContext?((i=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},o={next:t.next&&KT(t.next,i),error:t.error&&KT(t.error,i),complete:t.complete&&KT(t.complete,i)}):o=t,a.destination=new $T(o),a}return CT(t,e),t}(JT);function XT(e){var t;BT.useDeprecatedSynchronousErrorHandling?(t=e,BT.useDeprecatedSynchronousErrorHandling&&ZT&&(ZT.errorThrown=!0,ZT.error=t)):zT(e)}function QT(e,t){var n=BT.onStoppedNotification;n&&FT.setTimeout((function(){return n(e,t)}))}var ex={closed:!0,next:WT,error:function(e){throw e},complete:WT};function tx(e,t,n,r,o){return new nx(e,t,n,r,o)}var nx=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t)||this;return s.onFinalize=i,s.shouldUnsubscribe=a,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return CT(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(JT);function rx(e,t){return PT((function(n,r){var o=0;n.subscribe(tx(r,(function(n){r.next(e.call(t,n,o++))})))}))}var ox=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function ix(e){return OT(null==e?void 0:e.then)}var ax="function"==typeof Symbol&&Symbol.observable||"@@observable";function sx(e){return e}var cx=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this,o=function(e){return e&&e instanceof JT||function(e){return e&&OT(e.next)&&OT(e.error)&&OT(e.complete)}(e)&&NT(e)}(e)?e:new YT(e,t,n);return VT((function(){var e=r,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?r._subscribe(o):r._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=lx(t))((function(t,r){var o=new YT({next:function(t){try{e(t)}catch(e){r(e),o.unsubscribe()}},error:r,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[ax]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?sx:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=lx(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function lx(e){var t;return null!==(t=null!=e?e:BT.Promise)&&void 0!==t?t:Promise}function ux(e){return OT(e[ax])}function dx(e){return Symbol.asyncIterator&&OT(null==e?void 0:e[Symbol.asyncIterator])}function px(e){return px="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},px(e)}function fx(e){return new TypeError("You provided "+(null!==e&&"object"===px(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var hx="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function mx(e){return OT(null==e?void 0:e[hx])}function yx(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{!function(e){e.value instanceof IT?Promise.resolve(e.value.v).then(c,l):u(i[0][2],e)}(o[e](t))}catch(e){u(i[0][3],e)}}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}(this,arguments,(function(){var t,n,r;return TT(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,IT(t.read())];case 3:return n=o.sent(),r=n.value,n.done?[4,IT(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,IT(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function bx(e){return OT(null==e?void 0:e.getReader)}function vx(e){if(e instanceof cx)return e;if(null!=e){if(ux(e))return function(e){return new cx((function(t){var n=e[ax]();if(OT(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}(e);if(ox(e))return r=e,new cx((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(ix(e))return n=e,new cx((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,zT)}));if(dx(e))return gx(e);if(mx(e))return t=e,new cx((function(e){var n,r;try{for(var o=xT(t),i=o.next();!i.done;i=o.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.complete()}));if(bx(e))return gx(yx(e))}var t,n,r;throw fx(e)}function gx(e){return new cx((function(t){(function(e,t){var n,r,o,i,a,s,c,l;return a=this,s=void 0,l=function(){var a,s;return TT(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=xT(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),o={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function r(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):function(e){return e instanceof c?e:new c((function(t){t(e)}))}(t.value).then(n,r)}o((l=l.apply(a,s||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Sx(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=!1);var i=t.schedule((function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(i),!o)return i}function wx(e,t,n){return void 0===n&&(n=1/0),OT(t)?wx((function(n,r){return rx((function(e,o){return t(n,e,r,o)}))(vx(e(n,r)))}),n):("number"==typeof t&&(n=t),PT((function(t,r){return function(e,t,n,r,o,i,a,s){var c=[],l=0,u=0,d=!1,p=function(){!d||c.length||l||t.complete()},f=function(e){return l<r?h(e):c.push(e)},h=function e(o){l++;var i=!1;vx(n(o,u++)).subscribe(tx(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{l--;for(;c.length&&l<r;)n=void 0,n=c.shift(),e(n);p()}catch(e){t.error(e)}var n})))};return e.subscribe(tx(t,f,(function(){d=!0,p()}))),function(){}}(t,r,e,n)})))}function kx(e){return void 0===e&&(e=1/0),wx(sx,e)}function Ox(e){return e[e.length-1]}function Px(e){return function(e){return e&&OT(e.schedule)}(Ox(e))?e.pop():void 0}function Ex(e,t){return void 0===t&&(t=0),PT((function(n,r){n.subscribe(tx(r,(function(n){return Sx(r,e,(function(){return r.next(n)}),t)}),(function(){return Sx(r,e,(function(){return r.complete()}),t)}),(function(n){return Sx(r,e,(function(){return r.error(n)}),t)})))}))}function Cx(e,t){return void 0===t&&(t=0),PT((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function Tx(e,t){if(!e)throw new Error("Iterable cannot be null");return new cx((function(n){Sx(n,t,(function(){var r=e[Symbol.asyncIterator]();Sx(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function xx(e,t){return t?function(e,t){if(null!=e){if(ux(e))return function(e,t){return vx(e).pipe(Cx(t),Ex(t))}(e,t);if(ox(e))return function(e,t){return new cx((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(ix(e))return function(e,t){return vx(e).pipe(Cx(t),Ex(t))}(e,t);if(dx(e))return Tx(e,t);if(mx(e))return function(e,t){return new cx((function(n){var r;return Sx(n,t,(function(){r=e[hx](),Sx(n,t,(function(){var e,t,o;try{t=(e=r.next()).value,o=e.done}catch(e){return void n.error(e)}o?n.complete():n.next(t)}),0,!0)})),function(){return OT(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(bx(e))return function(e,t){return Tx(yx(e),t)}(e,t)}throw fx(e)}(e,t):vx(e)}function jx(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return kx(1)(xx(e,Px(e)))}function Rx(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Px(e);return PT((function(t,r){(n?jx(e,t,n):jx(e,t)).subscribe(r)}))}var Ix=_T((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),_x=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return CT(t,e),t.prototype.lift=function(e){var t=new Ax(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Ix},t.prototype.next=function(e){var t=this;VT((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=xT(t.currentObservers),i=o.next();!i.done;i=o.next())i.value.next(e)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;VT((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;VT((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,o=n.isStopped,i=n.observers;return r||o?LT:(this.currentObservers=null,i.push(e),new DT((function(){t.currentObservers=null,MT(i,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,o=t.isStopped;n?e.error(r):o&&e.complete()},t.prototype.asObservable=function(){var e=new cx;return e.source=this,e},t.create=function(e,t){return new Ax(e,t)},t}(cx),Ax=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return CT(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:LT},t}(_x),Mx=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return CT(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(_x),Dx=Array.isArray;function Lx(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Px(e),r=function(e,t){return"number"==typeof Ox(e)?e.pop():1/0}(e);return e=function(e){return 1===e.length&&Dx(e[0])?e[0]:e}(e),PT((function(t,o){kx(r)(xx(RT([t],jT(e)),n)).subscribe(o)}))}function Nx(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return xx(e,Px(e))}var Ux=Array.isArray;var Bx=["addListener","removeListener"],Fx=["addEventListener","removeEventListener"],zx=["on","off"];function Wx(e,t,n,r){if(OT(n)&&(r=n,n=void 0),r)return Wx(e,t,n).pipe((o=r,rx((function(e){return function(e,t){return Ux(t)?e.apply(void 0,RT([],jT(t))):e(t)}(o,e)}))));var o,i=jT(function(e){return OT(e.addEventListener)&&OT(e.removeEventListener)}(e)?Fx.map((function(r){return function(o){return e[r](t,o,n)}})):function(e){return OT(e.addListener)&&OT(e.removeListener)}(e)?Bx.map(qx(e,t)):function(e){return OT(e.on)&&OT(e.off)}(e)?zx.map(qx(e,t)):[],2),a=i[0],s=i[1];if(!a&&ox(e))return wx((function(e){return Wx(e,t,n)}))(vx(e));if(!a)throw new TypeError("Invalid event target");return new cx((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return a(t),function(){return s(t)}}))}function qx(e,t){return function(n){return function(r){return e[n](t,r)}}}var Hx=function(e){function t(t,n){return e.call(this)||this}return CT(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(DT),Zx={setInterval:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=Zx.delegate;return(null==o?void 0:o.setInterval)?o.setInterval.apply(o,RT([e,t],jT(n))):setInterval.apply(void 0,RT([e,t],jT(n)))})),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=Zx.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)})),delegate:void 0},Vx=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return CT(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Zx.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Zx.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,MT(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Hx),Jx={now:function(){return(Jx.delegate||Date).now()},delegate:void 0},Gx=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Jx.now,e}(),Kx=function(e){function t(t,n){void 0===n&&(n=Gx.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return CT(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Gx),$x=new Kx(Vx),Yx=_T((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function Xx(e){throw new Yx(e)}function Qx(e,t){return e===t}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var ej=(e,t,n)=>new Promise(((r,o)=>{var i=e=>{try{s(n.next(e))}catch(e){o(e)}},a=e=>{try{s(n.throw(e))}catch(e){o(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,a);s((n=n.apply(e,t)).next())})),tj="lk";var nj=[aP.ConnectionStateChanged,aP.RoomMetadataChanged,aP.ActiveSpeakersChanged,aP.ConnectionQualityChanged,aP.ParticipantConnected,aP.ParticipantDisconnected,aP.ParticipantPermissionsChanged,aP.ParticipantMetadataChanged,aP.TrackMuted,aP.TrackUnmuted,aP.TrackPublished,aP.TrackUnpublished,aP.TrackStreamStateChanged,aP.TrackSubscriptionFailed,aP.TrackSubscriptionPermissionChanged,aP.TrackSubscriptionStatusChanged,aP.LocalTrackPublished,aP.LocalTrackUnpublished],rj=(sP.ConnectionQualityChanged,sP.IsSpeakingChanged,sP.ParticipantMetadataChanged,sP.ParticipantPermissionsChanged,sP.TrackMuted,sP.TrackUnmuted,sP.TrackPublished,sP.TrackUnpublished,sP.TrackStreamStateChanged,sP.TrackSubscriptionFailed,sP.TrackSubscriptionPermissionChanged,sP.TrackSubscriptionStatusChanged,sP.LocalTrackPublished,sP.LocalTrackUnpublished,kT.getLogger("lk-components-js"));rj.setDefaultLevel("WARN");var oj=rj,ij=[{columns:1,rows:1,name:"1x1",minTiles:1,maxTiles:1,minWidth:0,minHeight:0},{columns:1,rows:2,name:"1x2",minTiles:2,maxTiles:2,minWidth:0,minHeight:0},{columns:2,rows:1,name:"2x1",minTiles:2,maxTiles:2,minWidth:800,minHeight:0},{columns:2,rows:2,name:"2x2",minTiles:3,maxTiles:4,minWidth:560,minHeight:0},{columns:3,rows:3,name:"3x3",minTiles:5,maxTiles:9,minWidth:700,minHeight:0},{columns:4,rows:4,name:"4x4",minTiles:10,maxTiles:16,minWidth:960,minHeight:0},{columns:5,rows:5,name:"5x5",minTiles:17,maxTiles:25,minWidth:1100,minHeight:0}];function aj(e,t,n,r){let o=0,i=e.find(((e,n,r)=>{o=n;const i=-1!==r.findIndex(((t,r)=>{const o=r>n,i=t.maxTiles===e.maxTiles;return o&&i}));return e.maxTiles>=t&&!i}));if(void 0===i){if(i=e[e.length-1],!i)throw new Error("No layout or fallback layout found.");oj.warn(`No layout found for: participantCount: ${t}, width/height: ${n}/${r} fallback to biggest available layout (${i.name}).`)}if((n<i.minWidth||r<i.minHeight)&&o>0){const t=e[o-1];i=aj(e.slice(0,o),t.maxTiles,n,r)}return i}function sj(e){return"object"==typeof e}function cj(e){return Array.isArray(e)&&e.filter(sj).length>0}function lj(e){return void 0!==e&&(function(e){var t;return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&void 0!==(null==(t=e.publication)?void 0:t.track))}(e)||function(e){return!!e&&(e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&void 0!==e.publication)}(e))}function uj(e){return!!e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&void 0===e.publication}function dj(e){return"string"==typeof e||"number"==typeof e?`${e}`:lj(e)?`${e.participant.identity}_${e.publication.source}`:`${e.participant.identity}_${e.source}`}function pj(e,t){var n,r,o,i;return(null!=(r=null==(n=e.joinedAt)?void 0:n.getTime())?r:0)-(null!=(i=null==(o=t.joinedAt)?void 0:o.getTime())?i:0)}function fj(e,t){const n=Math.max(e.length,t.length);return new Array(n).fill([]).map(((n,r)=>[e[r],t[r]]))}function hj(e,t,n){return e.filter((e=>!t.map((e=>n(e))).includes(n(e))))}function mj(e){return e.map((e=>"string"==typeof e||"number"==typeof e?`${e}`:dj(e)))}function yj(e,t){const n=t.findIndex((t=>dj(t)===dj(e)));if(-1===n)throw new Error(`Element not part of the array: ${dj(e)} not in ${mj(t)}`);return n}function bj(e,t){var n;return n=t,e.reduce(((e,t,r)=>r%n==0?[...e,[t]]:[...e.slice(0,-1),[...e.slice(-1)[0],t]]),[])}function vj(e,...t){return new cx((n=>{const r=()=>{n.next(e)};return t.forEach((t=>{e.on(t,r)})),()=>{t.forEach((t=>{e.off(t,r)}))}})).pipe(Rx(e))}function gj(e){return`${tj}-${e}`}function Sj(e){if(lj(e))return e.publication;{const{source:t,name:n,participant:r}=e;if(t&&n)return r.getTracks().find((e=>e.source===t&&e.trackName===n));if(n)return r.getTrackByName(n);if(t)return r.getTrack(t);throw new Error("At least one of source and name needs to be defined")}}function wj(e,...t){return new cx((n=>{const r=()=>{n.next(e)};return t.forEach((t=>{e.on(t,r)})),()=>{t.forEach((t=>{e.off(t,r)}))}})).pipe(Rx(e))}function kj(e){const t=wj(e,sP.TrackMuted,sP.TrackUnmuted,sP.ParticipantPermissionsChanged,sP.TrackPublished,sP.TrackUnpublished,sP.TrackSubscribed,sP.TrackUnsubscribed,sP.LocalTrackPublished,sP.LocalTrackUnpublished).pipe(rx((e=>{const{isMicrophoneEnabled:t,isCameraEnabled:n,isScreenShareEnabled:r}=e,o=e.getTrack(pP.Source.Microphone);return{isCameraEnabled:n,isMicrophoneEnabled:t,isScreenShareEnabled:r,cameraTrack:e.getTrack(pP.Source.Camera),microphoneTrack:o,participant:e}})));return t}function Oj(e,t){return new cx((n=>{const r=(...e)=>{n.next(e)};return e.on(t,r),()=>{e.off(t,r)}}))}function Pj(e,t){var n,r;return wj(e,sP.TrackMuted,sP.TrackUnmuted,sP.TrackSubscribed,sP.TrackUnsubscribed,sP.LocalTrackPublished,sP.LocalTrackUnpublished).pipe(rx((e=>{var n;const r=e.getTrack(t);return null==(n=null==r?void 0:r.isMuted)||n})),Rx(null==(r=null==(n=e.getTrack(t))?void 0:n.isMuted)||r))}function Ej(e,t){const n=new Mx(void 0),r=t?kj(t.localParticipant).pipe(rx((t=>{var n,r,o;let i;switch(e){case"videoinput":i=null==(n=t.cameraTrack)?void 0:n.track;break;case"audioinput":i=null==(r=t.microphoneTrack)?void 0:r.track;break;default:i=void 0}return null==(o=null==i?void 0:i.mediaStreamTrack.getSettings())?void 0:o.deviceId})),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Lx.apply(void 0,RT([],jT(e)))}(n)):n.asObservable();return{className:gj("media-device-select"),activeDeviceObservable:r,setActiveMediaDevice:r=>ej(this,null,(function*(){var o,i,a,s;if(t){oj.debug(`Switching active device of kind "${e}" with id ${r}.`),yield t.switchActiveDevice(e,r);let c=r;"videoinput"===e?c=yield null==(i=null==(o=t.localParticipant.getTrack(pP.Source.Camera))?void 0:o.track)?void 0:i.getDeviceId():"audioinput"===e&&(c=yield null==(s=null==(a=t.localParticipant.getTrack(pP.Source.Microphone))?void 0:a.track)?void 0:s.getDeviceId()),c!==r&&"default"!==r&&oj.warn(`Failed to select the desired device. Desired: ${r}. Actual: ${c}`),n.next("default"===r?r:c)}else oj.debug("Skip the device switch because the room object is not available. "),n.next(r)}))}}function Cj(e){return vj(e,aP.AudioPlaybackStatusChanged).pipe(rx((e=>({canPlayAudio:e.canPlaybackAudio}))))}function Tj(){return{className:gj("start-audio-button"),roomAudioPlaybackAllowedObservable:Cj,handleStartAudioPlayback:e=>ej(this,null,(function*(){oj.info("Start Audio for room: ",e),yield e.startAudio()}))}}function xj(e,t,n=!0){const r=[e.localParticipant,...Array.from(e.participants.values())],o=[];return r.forEach((e=>{t.forEach((t=>{const r=Array.from(e.tracks.values()).filter((e=>e.source===t&&(!n||e.track))).map((t=>({participant:e,publication:t,track:t.track,source:t.source})));o.push(...r)}))})),{trackReferences:o,participants:r}}function jj(e,t=1e3){if(null===e)return Nx(!1);const n=Wx(e,"mousemove").pipe(rx((()=>!0))),r=n.pipe(function(e,t){var n=function(e){return e instanceof Date&&!isNaN(e)}(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,o=n.each,i=n.with,a=void 0===i?Xx:i,s=n.scheduler,c=void 0===s?null!=t?t:$x:s,l=n.meta,u=void 0===l?null:l;if(null==r&&null==o)throw new TypeError("No timeout provided.");return PT((function(e,t){var n,i,s=null,l=0,d=function(e){i=Sx(t,c,(function(){try{n.unsubscribe(),vx(a({meta:u,lastValue:s,seen:l})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(tx(t,(function(e){null==i||i.unsubscribe(),l++,t.next(s=e),o>0&&d(o)}),void 0,void 0,(function(){(null==i?void 0:i.closed)||null==i||i.unsubscribe(),s=null}))),!l&&d(null!=r?"number"==typeof r?r:+r-c.now():o)}))}({each:t,with:()=>{return jx(Nx(!1),r.pipe((e=n,PT((function(t,n){var r=!1,o=tx(n,(function(){null==o||o.unsubscribe(),r=!0}),WT);vx(e).subscribe(o),t.subscribe(tx(n,(function(e){return r&&n.next(e)})))})))));var e}}),(void 0===i&&(i=sx),o=null!=o?o:Qx,PT((function(e,t){var n,r=!0;e.subscribe(tx(t,(function(e){var a=i(e);!r&&o(n,a)||(r=!1,n=a,t.next(e))})))}))));var o,i;return r}new TextEncoder,new TextDecoder;var Rj=oj,Ij=Object.defineProperty,_j=Object.defineProperties,Aj=Object.getOwnPropertyDescriptors,Mj=Object.getOwnPropertySymbols,Dj=Object.prototype.hasOwnProperty,Lj=Object.prototype.propertyIsEnumerable,Nj=(e,t,n)=>t in e?Ij(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Uj=(e,t)=>{for(var n in t||(t={}))Dj.call(t,n)&&Nj(e,n,t[n]);if(Mj)for(var n of Mj(t))Lj.call(t,n)&&Nj(e,n,t[n]);return e},Bj=(e,t)=>_j(e,Aj(t)),Fj=(e,t)=>{var n={};for(var r in e)Dj.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Mj)for(var r of Mj(e))t.indexOf(r)<0&&Lj.call(e,r)&&(n[r]=e[r]);return n},zj=(e,t,n)=>new Promise(((r,o)=>{var i=e=>{try{s(n.next(e))}catch(e){o(e)}},a=e=>{try{s(n.throw(e))}catch(e){o(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,a);s((n=n.apply(e,t)).next())}));function Wj(...e){return(...t)=>{for(const n of e)"function"==typeof n&&n(...t)}}function qj(...e){const t=Uj({},e[0]);for(let n=1;n<e.length;n++){const r=e[n];for(const e in r){const n=t[e],o=r[e];"function"==typeof n&&"function"==typeof o&&"o"===e[0]&&"n"===e[1]&&e.charCodeAt(2)>=65&&e.charCodeAt(2)<=90?t[e]=Wj(n,o):t[e]="className"!==e&&"UNSAFE_className"!==e||"string"!=typeof n||"string"!=typeof o?void 0!==o?o:n:(0,Vt.Z)(n,o)}}return t}function Hj(e){return void 0!==e}function Zj(...e){return qj(...e.filter(Hj))}var Vj=e.createContext(void 0);function Jj(){return e.useContext(Vj)}var Gj=e.createContext(void 0);var Kj=e.createContext(void 0);function $j(){return e.useContext(Kj)}function Yj(t){var n;const r=$j(),o=e.useContext(Gj),i=null!=(n=null!=t?t:r)?n:null==o?void 0:o.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}var Xj=e.createContext(void 0);function Qj(){const t=e.useContext(Xj);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function eR(){return e.useContext(Xj)}function tR(e){const t=eR(),n=null!=e?e:t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}function nR(t,n){const[r,o]=e.useState(n);return e.useEffect((()=>{if("undefined"==typeof window||!t)return;const e=t.subscribe(o);return()=>e.unsubscribe()}),[t]),r}function rR(t){const n=tR(t),r=e.useMemo((()=>function(e){return function(e,t){return new cx((n=>{const r=(...e)=>{n.next(e)};return e.on(t,r),()=>{e.off(t,r)}}))}(e,aP.ConnectionStateChanged).pipe(rx((([e])=>e)),Rx(e.state))}(n)),[n]);return nR(r,n.state)}function oR(t){var n=t,{room:r}=n,o=Fj(n,["room"]);const i=rR(r);return e.createElement("div",Uj({},o),i)}function iR({props:t}){const{dispatch:n}=function(){const t=e.useContext(Vj);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}().widget,{className:r}=e.useMemo((()=>({className:[gj("button"),gj("chat-toggle")].join(" ")})),[]);return{mergedProps:e.useMemo((()=>Zj(t,{className:r,onClick:()=>{n&&n({msg:"toggle_chat"})}})),[t,r,n])}}function aR(t){const{mergedProps:n}=iR({props:t});return e.createElement("button",Uj({},n),t.children)}function sR(t){const{buttonProps:n}=function(t){const n=Qj(),r=rR(n),o=e.useMemo((()=>{const{className:e,disconnect:o}=function(e){return{className:gj("disconnect-button"),disconnect:t=>{e.disconnect(t)}}}(n);return Zj(t,{className:e,onClick:()=>{var e;return o(null==(e=t.stopTracks)||e)},disabled:r===mC.Disconnected})}),[n,t,r]);return{buttonProps:o}}(t);return e.createElement("button",Uj({},n),t.children)}var cR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),e.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),lR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),uR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),dR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),pR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},e.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),fR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),hR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),e.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),mR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),e.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),yR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),bR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),vR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),e.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),gR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),e.createElement("g",{opacity:.25},e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),e.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),SR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),e.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),wR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),e.createElement("g",{fill:"currentColor"},e.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),e.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),kR=t=>e.createElement("svg",Uj({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),e.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},e.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"})));function OR(t){var n=t,{trackSource:r,participant:o}=n,i=Fj(n,["trackSource","participant"]);const{mergedProps:a,inFocus:s}=function({trackSource:t,participant:n,props:r}){const o=Yj(n),i=Jj(),{className:a}=e.useMemo((()=>({className:[gj("button"),gj("focus-toggle-button")].join(" ")})),[]),s=e.useMemo((()=>{const e=o.getTrack(t);return!(!(null==i?void 0:i.pin.state)||!e)&&(n={participant:o,source:t,publication:e},void 0!==(r=i.pin.state)&&(lj(n)?r.some((e=>e.participant.identity===n.participant.identity&&lj(e)&&e.publication.trackSid===n.publication.trackSid)):!!uj(n)&&r.some((e=>e.participant.identity===n.participant.identity&&uj(e)&&e.source===n.source))));var n,r}),[o,t,i]);return{mergedProps:e.useMemo((()=>Zj(r,{className:a,onClick:e=>{var n;null==(n=r.onClick)||n.call(r,e);const a=o.getTrack(t);(null==i?void 0:i.pin.dispatch)&&a&&(s?i.pin.dispatch({msg:"clear_pin"}):i.pin.dispatch({msg:"set_pin",trackReference:{participant:o,publication:a,source:a.source}}))}})),[r,a,o,t,s,i]),inFocus:s}}({trackSource:r,participant:o,props:i});return e.createElement(Vj.Consumer,null,(t=>void 0!==t&&e.createElement("button",Uj({},a),i.children?i.children:s?e.createElement(kR,null):e.createElement(pR,null))))}function PR(t){var n=t,{kind:r,initialSelection:o,onActiveDeviceChange:i,onDeviceListChange:a}=n,s=Fj(n,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange"]);const c=eR(),{devices:l,activeDeviceId:u,setActiveMediaDevice:d,className:p}=function({kind:t,room:n}){const r=eR(),o=nR(e.useMemo((()=>function(e,t=!0){var n;const r=()=>ej(this,null,(function*(){const n=yield wC.getLocalDevices(e,t);o.next(n)})),o=new _x,i=o.pipe((a=()=>{var e;null==(e=null==navigator?void 0:navigator.mediaDevices)||e.removeEventListener("devicechange",r)},PT((function(e,t){try{e.subscribe(t)}finally{t.add(a)}}))));var a;if("undefined"!=typeof window){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");null==(n=null==navigator?void 0:navigator.mediaDevices)||n.addEventListener("devicechange",r),r()}return i}(t)),[t]),[]),[i,a]=e.useState(""),{className:s,activeDeviceObservable:c,setActiveMediaDevice:l}=e.useMemo((()=>Ej(t,null!=n?n:r)),[t,n,r]);return e.useEffect((()=>{const e=c.subscribe((e=>{e&&a(e)}));return()=>{null==e||e.unsubscribe()}}),[c]),{devices:o,className:s,activeDeviceId:i,setActiveMediaDevice:l}}({kind:r,room:c});e.useEffect((()=>{o&&d(o)})),e.useEffect((()=>{"function"==typeof a&&a(l)}),[a,l]);const f=e=>zj(this,null,(function*(){d(e),null==i||i(e)})),h=e.useMemo((()=>Zj(s,{className:p},{className:"lk-list"})),[p,s]);return e.createElement("ul",Uj({},h),l.map((t=>e.createElement("li",{key:t.deviceId,id:t.deviceId,"data-lk-active":t.deviceId===u,"aria-selected":t.deviceId===u,role:"option"},e.createElement("button",{className:"lk-button",onClick:()=>f(t.deviceId)},t.label)))))}function ER(t){var n=t,{label:r="Allow Audio"}=n,o=Fj(n,["label"]);const i=Qj(),{mergedProps:a}=function({room:t,props:n}){const{className:r,roomAudioPlaybackAllowedObservable:o,handleStartAudioPlayback:i}=e.useMemo((()=>Tj()),[]),a=e.useMemo((()=>o(t)),[t,o]),{canPlayAudio:s}=nR(a,{canPlayAudio:!1});return{mergedProps:e.useMemo((()=>Zj(n,{className:r,onClick:()=>{i(t)},style:{display:s?"none":"block"}})),[n,r,s,i,t]),canPlayAudio:s}}({room:i,props:o});return e.createElement("button",Uj({},a),r)}function CR(t,n){switch(t){case pP.Source.Microphone:return n?e.createElement(mR,null):e.createElement(hR,null);case pP.Source.Camera:return n?e.createElement(lR,null):e.createElement(cR,null);case pP.Source.ScreenShare:return n?e.createElement(wR,null):e.createElement(SR,null);default:return}}function TR(t){var n=t,{showIcon:r}=n,o=Fj(n,["showIcon"]);const{buttonProps:i,enabled:a}=function(t){var n,r=t,{source:o,onChange:i,initialState:a,captureOptions:s}=r,c=Fj(r,["source","onChange","initialState","captureOptions"]);const l=eR(),u=null==(n=null==l?void 0:l.localParticipant)?void 0:n.getTrack(o),{toggle:d,className:p,pendingObserver:f,enabledObserver:h}=e.useMemo((()=>l?function(e,t,n){const{localParticipant:r}=t,o=(e,t)=>{let n=!1;switch(e){case pP.Source.Camera:n=t.isCameraEnabled;break;case pP.Source.Microphone:n=t.isMicrophoneEnabled;break;case pP.Source.ScreenShare:n=t.isScreenShareEnabled}return n},i=kj(r).pipe(rx((t=>o(e,t.participant))),Rx(o(e,r))),a=new _x;return{className:gj("button"),toggle:(t,o)=>ej(this,null,(function*(){try{switch(null!=o||(o=n),a.next(!0),e){case pP.Source.Camera:yield r.setCameraEnabled(null!=t?t:!r.isCameraEnabled,o);break;case pP.Source.Microphone:yield r.setMicrophoneEnabled(null!=t?t:!r.isMicrophoneEnabled,o);break;case pP.Source.ScreenShare:yield r.setScreenShareEnabled(null!=t?t:!r.isScreenShareEnabled,o)}}finally{a.next(!1)}})),enabledObserver:i,pendingObserver:a.asObservable()}}(o,l,s):function(){let e=!1;const t=new _x,n=new _x;return{className:gj("button"),toggle:r=>{n.next(!0),e=null!=r?r:!e,t.next(e),n.next(!1)},enabledObserver:t.asObservable(),pendingObserver:n.asObservable()}}()),[l,o,JSON.stringify(s)]),m=nR(f,!1),y=nR(h,null!=a?a:!!(null==u?void 0:u.isEnabled));e.useEffect((()=>{null==i||i(y)}),[y,i]),e.useEffect((()=>{void 0!==a&&(Rj.debug("forcing initial toggle state",o,a),d(a))}),[]);const b=e.useMemo((()=>qj(c,{className:p})),[c,p]),v=e.useCallback((e=>{var t;d(),null==(t=c.onClick)||t.call(c,e)}),[c,d]);return{toggle:d,enabled:y,pending:m,track:u,buttonProps:Bj(Uj({},b),{"aria-pressed":y,"data-lk-source":o,"data-lk-enabled":y,disabled:m,onClick:v})}}(o);return e.createElement("button",Uj({},i),(null==r||r)&&CR(o.source,a),o.children)}function xR(t){var n;const{className:r,quality:o}=function(t={}){const n=Yj(t.participant),{className:r,connectionQualityObserver:o}=e.useMemo((()=>function(e){const t=gj("connection-quality"),n=function(e){return Oj(e,sP.ConnectionQualityChanged).pipe(rx((([e])=>e)),Rx(e.connectionQuality))}(e);return{className:t,connectionQualityObserver:n}}(n)),[n]);return{className:r,quality:nR(o,hC.Unknown)}}(t),i=e.useMemo((()=>Bj(Uj({},Zj(t,{className:r})),{"data-lk-quality":o})),[o,t,r]);return e.createElement("div",Uj({},i),null!=(n=t.children)?n:function(t){switch(t){case hC.Excellent:return e.createElement(yR,null);case hC.Good:return e.createElement(bR,null);case hC.Poor:return e.createElement(vR,null);default:return e.createElement(gR,null)}}(o))}function jR(t){var n=t,{participant:r}=n,o=Fj(n,["participant"]);const i=Yj(r),{className:a,infoObserver:s}=e.useMemo((()=>function(e){const t=function(e){const t=wj(e,sP.ParticipantMetadataChanged).pipe(rx((({name:e,identity:t,metadata:n})=>({name:e,identity:t,metadata:n}))),Rx({name:e.name,identity:e.identity,metadata:e.metadata}));return t}(e);return{className:"lk-participant-name",infoObserver:t}}(i)),[i]),{identity:c,name:l}=nR(s,{name:i.name,identity:i.identity,metadata:i.metadata}),u=e.useMemo((()=>Zj(o,{className:a,"data-lk-participant-name":l})),[o,a,l]);return e.createElement("span",Uj({},u),""!==l?l:c,o.children)}var RR,IR=t=>{var n,r=t,{source:o,participant:i,show:a="always"}=r,s=Fj(r,["source","participant","show"]);const{className:c,isMuted:l}=((t,n={})=>{var r;const o=Yj(n.participant),{className:i,mediaMutedObserver:a}=e.useMemo((()=>function(e,t){let n="track-muted-indicator-camera";switch(t){case pP.Source.Camera:n="track-muted-indicator-camera";break;case pP.Source.Microphone:n="track-muted-indicator-microphone"}return{className:gj(n),mediaMutedObserver:Pj(e,t)}}(o,t)),[o,t]);return{isMuted:nR(a,!!(null==(r=o.getTrack(t))?void 0:r.isMuted)),className:i}})(o,{participant:i}),u="always"===a||"muted"===a&&l||"unmuted"===a&&!l,d=e.useMemo((()=>Zj(s,{className:c})),[c,s]);return u?e.createElement("div",Bj(Uj({},d),{"data-lk-muted":l}),null!=(n=s.children)?n:CR(o,!l)):null},_R=t=>{const[n,r]=e.useState({width:0,height:0});e.useLayoutEffect((()=>{if(t.current){const{width:e,height:n}=t.current.getBoundingClientRect();r({width:e,height:n})}}),[t.current]);const o=e.useCallback((e=>r(e.contentRect)),[]);return function(t,n){const r=RR||(RR=function(){let e=!1,t=[];const n=new Map;if("undefined"==typeof window)return;const r=new ResizeObserver(((r,o)=>{t=t.concat(r),e||window.requestAnimationFrame((()=>{const r=new Set;for(let e=0;e<t.length;e++){if(r.has(t[e].target))continue;r.add(t[e].target);const i=n.get(t[e].target);null==i||i.forEach((n=>n(t[e],o)))}t=[],e=!1})),e=!0}));return{observer:r,subscribe(e,t){var o;r.observe(e);const i=null!=(o=n.get(e))?o:[];i.push(t),n.set(e,i)},unsubscribe(e,t){var o;const i=null!=(o=n.get(e))?o:[];if(1===i.length)return r.unobserve(e),void n.delete(e);const a=i.indexOf(t);-1!==a&&i.splice(a,1),n.set(e,i)}}}()),o=ki(n);e.useLayoutEffect((()=>{let e=!1;const n=t.current;if(n)return null==r||r.subscribe(n,i),()=>{e=!0,null==r||r.unsubscribe(n,i)};function i(t,n){e||o.current(t,n)}}),[t.current,r,o]),null==r||r.observer}(t,o),n};function AR(t,n){const{width:r,height:o}=_R(t),i=r>0&&o>0?aj(ij,n,r,o):ij[0];return e.useEffect((()=>{t.current&&i&&(t.current.style.setProperty("--lk-col-count",null==i?void 0:i.columns.toString()),t.current.style.setProperty("--lk-row-count",null==i?void 0:i.rows.toString()))}),[t,i]),{layout:i}}function MR(t,n={}){var r;const o=Yj(n.participant),[i,a]=e.useState(!!(null==(r=o.getTrack(t))?void 0:r.isMuted));return e.useEffect((()=>{const e=Pj(o,t).subscribe(a);return()=>e.unsubscribe()}),[o,t]),i}function DR(t,n={}){const[r,o]=e.useState(Sj(t)),[i,a]=e.useState(null==r?void 0:r.isMuted),[s,c]=e.useState(null==r?void 0:r.isSubscribed),[l,u]=e.useState(null==r?void 0:r.track),[d,p]=e.useState("landscape"),f=e.useRef(),{className:h,trackObserver:m}=e.useMemo((()=>function(e){const t=Sj(e),n=kj(e.participant).pipe(rx((()=>Sj(e))),Rx(t));return{className:gj(e.source===pP.Source.Camera||e.source===pP.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}(t)),[t.participant.identity,t.source,lj(t)&&t.publication.trackSid]);return e.useEffect((()=>{const e=m.subscribe((e=>{Rj.debug("update track",e),o(e),a(null==e?void 0:e.isMuted),c(null==e?void 0:e.isSubscribed),u(null==e?void 0:e.track)}));return()=>null==e?void 0:e.unsubscribe()}),[m]),e.useEffect((()=>{var e,r;return l&&(f.current&&l.detach(f.current),!(null==(e=n.element)?void 0:e.current)||function(e){return e instanceof SC}(t.participant)&&"audio"===(null==l?void 0:l.kind)||l.attach(n.element.current)),f.current=null==(r=n.element)?void 0:r.current,()=>{f.current&&(null==l||l.detach(f.current))}}),[l,n.element]),e.useEffect((()=>{var e,t;if("number"==typeof(null==(e=null==r?void 0:r.dimensions)?void 0:e.width)&&"number"==typeof(null==(t=null==r?void 0:r.dimensions)?void 0:t.height)){const e=r.dimensions.width>r.dimensions.height?"landscape":"portrait";p(e)}}),[r]),{publication:r,isMuted:i,isSubscribed:s,track:l,elementProps:Zj(n.props,Uj({className:h,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":null==r?void 0:r.source},(null==r?void 0:r.source)===pP.Source.Camera||(null==r?void 0:r.source)===pP.Source.ScreenShare?{"data-lk-orientation":d}:{}))}}function LR(t,n,r={}){const o=e.useRef([]),i=e.useRef(-1),a=n!==i.current,s="function"==typeof r.customSortFunction?r.customSortFunction(t):function(e){const t=[],n=[],r=[],o=[];e.forEach((e=>{e.participant.isLocal&&e.source===pP.Source.Camera?t.push(e):e.source===pP.Source.ScreenShare?n.push(e):e.source===pP.Source.Camera?r.push(e):o.push(e)}));const i=function(e){const t=[],n=[];return e.forEach((e=>{e.participant.isLocal?t.push(e):n.push(e)})),t.sort(((e,t)=>pj(e.participant,t.participant))),n.sort(((e,t)=>pj(e.participant,t.participant))),[...n,...t]}(n),a=function(e){const t=[],n=[];return e.forEach((e=>{e.participant.isLocal?t.push(e):n.push(e)})),n.sort(((e,t)=>e.participant.isSpeaking&&t.participant.isSpeaking?function(e,t){return t.audioLevel-e.audioLevel}(e.participant,t.participant):e.participant.isSpeaking!==t.participant.isSpeaking?function(e,t){return e.isSpeaking===t.isSpeaking?0:e.isSpeaking?-1:1}(e.participant,t.participant):e.participant.lastSpokeAt!==t.participant.lastSpokeAt?function(e,t){var n,r,o,i;return void 0!==e.lastSpokeAt||void 0!==t.lastSpokeAt?(null!=(r=null==(n=t.lastSpokeAt)?void 0:n.getTime())?r:0)-(null!=(i=null==(o=e.lastSpokeAt)?void 0:o.getTime())?i:0):0}(e.participant,t.participant):lj(e)!==lj(t)?function(e,t){return lj(e)?lj(t)?0:-1:lj(t)?1:0}(e,t):e.participant.isCameraEnabled!==t.participant.isCameraEnabled?function(e,t){const n=e.participant.isCameraEnabled;return n!==t.participant.isCameraEnabled?n?-1:1:0}(e,t):pj(e.participant,t.participant))),[...t,...n]}(r);return[...t,...i,...a,...o]}(t);let c=[...s];if(!1===a)try{c=function(e,t,n){let r=[...e];if(e.length<t.length){const n=hj(t,e,dj);r=[...r,...n]}if(fj(bj(e,n),bj(t,n)).forEach((([e,t],o)=>{if(e&&t){const s={dropped:hj(i=bj(r,n)[o],a=t,dj),added:hj(a,i,dj)};(function(e){return 0!==e.added.length||0!==e.dropped.length})(s)&&(oj.debug(`Detected visual changes on page: ${o}, current: ${mj(e)}, next: ${mj(t)}`,{changes:s}),s.added.length===s.dropped.length&&fj(s.added,s.dropped).forEach((([e,t])=>{if(!e||!t)throw new Error(`For a swap action we need a addition and a removal one is missing: ${e}, ${t}`);r=function(e,t,n){const r=yj(e,n),o=yj(t,n);return n.splice(r,1,t),n.splice(o,1,e),n}(e,t,r)})),0===s.added.length&&s.dropped.length>0&&s.dropped.forEach((e=>{r=function(e,t){const n=yj(e,t);return t.splice(n,1),t}(e,r)})),s.added.length>0&&0===s.dropped.length&&s.added.forEach((e=>{var t,n;t=e,n=r,r=[...n,t]})))}var i,a})),r.length>t.length){const n=hj(e,t,dj);r=r.filter((e=>!n.map(dj).includes(dj(e))))}return r}(o.current,s,n)}catch(e){Rj.error("Error while running updatePages(): ",e)}return o.current=a?s:c,i.current=n,c}function NR(t=[pP.Source.Camera,pP.Source.Microphone,pP.Source.ScreenShare,pP.Source.ScreenShareAudio,pP.Source.Unknown],n={}){const r=tR(n.room),[o,i]=e.useState([]),[a,s]=e.useState([]),c=e.useMemo((()=>t.map((e=>sj(e)?e.source:e))),[JSON.stringify(t)]);e.useEffect((()=>{const e=function(e,t,n){var r,o;const i=null!=(r=n.additionalRoomEvents)?r:nj,a=null==(o=n.onlySubscribed)||o;return vj(e,...Array.from(new Set([aP.ParticipantConnected,aP.ConnectionStateChanged,aP.LocalTrackPublished,aP.LocalTrackUnpublished,aP.TrackPublished,aP.TrackUnpublished,aP.TrackSubscriptionStatusChanged,...i]).values())).pipe(rx((e=>{const n=xj(e,t,a);return oj.debug(`TrackReference[] was updated. (length ${n.trackReferences.length})`,n),n})),Rx(xj(e,t,a)))}(r,c,{additionalRoomEvents:n.updateOnlyOn,onlySubscribed:n.onlySubscribed}).subscribe((({trackReferences:e,participants:t})=>{Rj.debug("setting track bundles",e,t),i(e),s(t)}));return()=>e.unsubscribe()}),[r,JSON.stringify(n.updateOnlyOn),JSON.stringify(t)]);const l=e.useMemo((()=>{if(cj(t)){const e=function(e,t){const n=new Map;if(cj(e)){const r=e.filter((e=>e.withPlaceholder)).map((e=>e.source));t.forEach((e=>{const t=e.getTracks().map((e=>{var t;return null==(t=e.track)?void 0:t.source})).filter((e=>void 0!==e)),o=Array.from(function(e,t){const n=new Set(e);for(const e of t)n.delete(e);return n}(new Set(r),new Set(t)));o.length>0&&n.set(e.identity,o)}))}return n}(t,a),n=Array.from(o);return a.forEach((t=>{var r;e.has(t.identity)&&(null!=(r=e.get(t.identity))?r:[]).forEach((e=>{if(o.find((({participant:n,publication:r})=>t.identity===n.identity&&r.source===e)))return;Rj.debug(`Add ${e} placeholder for participant ${t.identity}.`);const r={participant:t,source:e};n.push(r)}))})),n}return o}),[o,a,t]);return l}var UR=t=>e.createElement("svg",Uj({width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),e.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),e.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25}));function BR(t){var n=t,{onTrackClick:r,onClick:o,onSubscriptionStatusChanged:i,name:a,publication:s,source:c}=n,l=Fj(n,["onTrackClick","onClick","onSubscriptionStatusChanged","name","publication","source"]);const u=e.useRef(null),d=Yj(l.participant),{elementProps:p,publication:f,isSubscribed:h}=DR({participant:d,name:a,source:c,publication:s},{element:u,props:l});return e.useEffect((()=>{null==i||i(!!h)}),[h,i]),e.createElement("video",Bj(Uj({ref:u},p),{muted:!0,onClick:e=>{null==o||o(e),null==r||r({participant:d,track:f})}}))}function FR(t){var n=t,{onSubscriptionStatusChanged:r,volume:o}=n,i=Fj(n,["onSubscriptionStatusChanged","volume"]);const{source:a,name:s,publication:c}=i,l=e.useRef(null),u=Yj(i.participant),{elementProps:d,isSubscribed:p,track:f}=DR({source:a,name:s,participant:u,publication:c},{element:l,props:i});return e.useEffect((()=>{null==r||r(!!p)}),[p,r]),e.useEffect((()=>{o&&f instanceof cC?f.setVolume(o):Rj.warn("volume can only be set on remote audio tracks")}),[o,f]),e.createElement("audio",Uj({ref:l},d))}function zR({participant:t,source:n,publication:r,onParticipantClick:o,disableSpeakingIndicator:i,htmlProps:a}){const s=Yj(t),c=e.useMemo((()=>{const{className:e}={className:gj("participant-tile")};return Zj(a,{className:e,onClick:e=>{var t;if(null==(t=a.onClick)||t.call(a,e),"function"==typeof o){const e=null!=r?r:s.getTrack(n);o({participant:s,track:e})}}})}),[a,n,o,s,r]),l=MR(pP.Source.Camera,{participant:t}),u=MR(pP.Source.Microphone,{participant:t}),d=function(t){const n=Yj(t),r=e.useMemo((()=>function(e){return Oj(e,sP.IsSpeakingChanged).pipe(rx((([e])=>e)))}(n)),[n]);return nR(r,n.isSpeaking)}(t);return{elementProps:Uj({"data-lk-audio-muted":u,"data-lk-video-muted":l,"data-lk-speaking":!0!==i&&d,"data-lk-local-participant":t.isLocal,"data-lk-source":n},c)}}function WR(t){const n=!!$j();return t.participant&&!n?e.createElement(Kj.Provider,{value:t.participant},t.children):e.createElement(e.Fragment,null,t.children)}var qR=t=>{var n=t,{participant:r,children:o,source:i=pP.Source.Camera,onParticipantClick:a,publication:s,disableSpeakingIndicator:c}=n,l=Fj(n,["participant","children","source","onParticipantClick","publication","disableSpeakingIndicator"]);const u=Yj(r),{elementProps:d}=zR({participant:u,htmlProps:l,source:i,publication:s,disableSpeakingIndicator:c,onParticipantClick:a}),p=Jj(),f=e.useCallback((e=>{i&&!e&&p&&p.pin.dispatch&&function(e,t,n){return void 0!==n&&n.some((({source:n,participant:r})=>n===t&&r.identity===e.identity))}(u,i,p.pin.state)&&p.pin.dispatch({msg:"clear_pin"})}),[u,p,i]);return e.createElement("div",Uj({style:{position:"relative"}},d),e.createElement(WR,{participant:u},null!=o?o:e.createElement(e.Fragment,null,"video"===(null==s?void 0:s.kind)||i===pP.Source.Camera||i===pP.Source.ScreenShare?e.createElement(BR,{participant:u,source:i,publication:s,onSubscriptionStatusChanged:f}):e.createElement(FR,{participant:u,source:i,publication:s,onSubscriptionStatusChanged:f}),e.createElement("div",{className:"lk-participant-placeholder"},e.createElement(UR,null)),e.createElement("div",{className:"lk-participant-metadata"},e.createElement("div",{className:"lk-participant-metadata-item"},i===pP.Source.Camera?e.createElement(e.Fragment,null,e.createElement(IR,{source:pP.Source.Microphone,show:"muted"}),e.createElement(jR,null)):e.createElement(e.Fragment,null,e.createElement(SR,{style:{marginRight:"0.25rem"}}),e.createElement(jR,null,"'s screen"))),e.createElement(xR,{className:"lk-participant-metadata-item"}))),e.createElement(OR,{trackSource:i})))},HR=t=>{var n=t,{tracks:r}=n,o=Fj(n,["tracks"]);return e.createElement(e.Fragment,null,r.map((t=>{const n=lj(t)?t.publication.source:t.source;return e.createElement(Gj.Provider,{value:t,key:`${t.participant.identity}_${n}`},function(t,n,r){return e.Children.map(t,(o=>e.isValidElement(o)&&e.Children.only(t)?e.cloneElement(o,Bj(Uj({},n),{key:r})):o))}(o.children))})))};function ZR({totalPageCount:t,nextPage:n,prevPage:r,currentPage:o,pagesContainer:i}){const[a,s]=e.useState(!1);return e.useEffect((()=>{let e;return i&&(e=jj(i.current,2e3).subscribe(s)),()=>{e&&e.unsubscribe()}}),[i]),e.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":a},e.createElement("button",{className:"lk-button",onClick:r},e.createElement(dR,null)),e.createElement("span",{className:"lk-pagination-count"},`${o} of ${t}`),e.createElement("button",{className:"lk-button",onClick:n},e.createElement(dR,null)))}function VR({totalPageCount:t,currentPage:n}){const r=new Array(t).fill("").map(((t,r)=>r+1===n?e.createElement("span",{"data-lk-active":!0,key:r}):e.createElement("span",{key:r})));return e.createElement("div",{className:"lk-pagination-indicator"},r)}function JR(t){var n=t,{tracks:r}=n,o=Fj(n,["tracks"]);const i=e.createRef(),a=e.useMemo((()=>Zj(o,{className:"lk-grid-layout"})),[o]),{layout:s}=AR(i,r.length),c=function(t,n){const[r,o]=e.useState(1),i=Math.max(Math.ceil(n.length/t),1);r>i&&o(i);const a=r*t,s=a-t,c=e=>{o((t=>"next"===e?t===i?t:t+1:1===t?t:t-1))},l=LR(n,t);return{totalPageCount:i,nextPage:()=>c("next"),prevPage:()=>c("previous"),setPage:e=>{o(e>i?i:e<1?1:e)},firstItemIndex:s,lastItemIndex:a,tracks:l.slice(s,a),currentPage:r}}(s.maxTiles,r);return function(t,n={}){var r;const o=e.useRef(null),i=e.useRef(null),a=null!=(r=n.minSwipeDistance)?r:50,s=e=>{i.current=null,o.current=e.targetTouches[0].clientX},c=e=>{i.current=e.targetTouches[0].clientX},l=e.useCallback((()=>{if(!o.current||!i.current)return;const e=o.current-i.current,t=e<-a;e>a&&n.onLeftSwipe&&n.onLeftSwipe(),t&&n.onRightSwipe&&n.onRightSwipe()}),[a,n]);e.useEffect((()=>{const e=t.current;return e&&(e.addEventListener("touchstart",s),e.addEventListener("touchmove",c),e.addEventListener("touchend",l)),()=>{e&&(e.removeEventListener("touchstart",s),e.removeEventListener("touchmove",c),e.removeEventListener("touchend",l))}}),[t,l])}(i,{onLeftSwipe:c.nextPage,onRightSwipe:c.prevPage}),e.createElement("div",Uj({ref:i,"data-lk-pagination":c.totalPageCount>1},a),e.createElement(HR,{tracks:c.tracks},o.children),r.length>s.maxTiles&&e.createElement(e.Fragment,null,e.createElement(VR,{totalPageCount:c.totalPageCount,currentPage:c.currentPage}),e.createElement(ZR,Uj({pagesContainer:i},c))))}var GR={connect:!0,audio:!1,video:!1};function KR(t){const{room:n,htmlProps:r}=function(t){const n=Uj(Uj({},GR),t),{token:r,serverUrl:o,options:i,room:a,connectOptions:s,connect:c,audio:l,video:u,screen:d,onConnected:p,onDisconnected:f,onError:h,onMediaDeviceFailure:m,simulateParticipants:y}=n,b=Fj(n,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","simulateParticipants"]);i&&a&&Rj.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,g]=e.useState();e.useEffect((()=>{g(null!=a?a:new wC(i))}),[i,a]);const S=e.useMemo((()=>Zj(b,{className:"lk-room-container"})),[b]);return e.useEffect((()=>{if(!v)return;const e=()=>{const e=v.localParticipant;try{Rj.debug("trying to publish local tracks"),e.setMicrophoneEnabled(!!l,"boolean"!=typeof l?l:void 0),e.setCameraEnabled(!!u,"boolean"!=typeof u?u:void 0),e.setScreenShareEnabled(!!d,"boolean"!=typeof d?d:void 0)}catch(e){Rj.warn(e),null==h||h(e)}},t=e=>{const t=Xk.getFailure(e);null==m||m(t)};return v.on(aP.SignalConnected,e),v.on(aP.MediaDevicesError,t),()=>{v.off(aP.SignalConnected,e),v.off(aP.MediaDevicesError,t)}}),[v,l,u,d,h]),e.useEffect((()=>{if(v)if(y)v.simulateParticipants({participants:{count:y},publish:{audio:!0,useRealTracks:!0}});else{if(r)return o?void(c?(Rj.debug("connecting"),v.connect(o,r,s).catch((e=>{Rj.warn(e),null==h||h(e)}))):(Rj.debug("disconnecting because connect is false"),v.disconnect())):(Rj.warn("no livekit url provided"),void(null==h||h(Error("no livekit url provided"))));Rj.debug("no token yet")}}),[c,r,s,v,h,o,y]),e.useEffect((()=>{if(!v)return;const e=e=>{switch(e){case mC.Disconnected:f&&f();break;case mC.Connected:p&&p()}};return v.on(aP.ConnectionStateChanged,e),()=>{v.off(aP.ConnectionStateChanged,e)}}),[r,p,f,v]),e.useEffect((()=>{if(v)return()=>{Rj.info("disconnecting on onmount"),v.disconnect()}}),[v]),{room:v,htmlProps:S}}(t);return e.createElement("div",Uj({},r),n&&e.createElement(Xj.Provider,{value:n},t.children))}var $R=t=>{var n=t,{childrenPosition:r="before",children:o}=n,i=Fj(n,["childrenPosition","children"]);const{name:a}=function(t={}){const n=tR(t.room),r=e.useMemo((()=>function(e){const t=vj(e,aP.RoomMetadataChanged,aP.ConnectionStateChanged).pipe(rx((e=>({name:e.name,metadata:e.metadata}))));return t}(n)),[n]),{name:o,metadata:i}=nR(r,{name:n.name,metadata:n.metadata});return{name:o,metadata:i}}();return e.createElement("span",Uj({},i),"before"===r&&o,a,"after"===r&&o)},YR=t=>{var n=t,{kind:r,initialSelection:o,onActiveDeviceChange:i}=n,a=Fj(n,["kind","initialSelection","onActiveDeviceChange"]);const[s,c]=e.useState(!1),[l,u]=e.useState([]),[d,p]=e.useState(!0),f=(e,t)=>{Rj.debug("handle device change"),c(!1),null==i||i(e,t)},h=e.useRef(null),m=e.useRef(null);e.useLayoutEffect((()=>{h.current&&m.current&&(l||d)&&function(e,t){return ej(this,null,(function*(){const{x:n,y:r}=yield((e,t,n)=>{const r=new Map,o={platform:wT,...n},i={...o.platform,_c:r};return jC(e,t,{...o,platform:i})})(e,t,{placement:"top",middleware:[zC(6),FC(),WC({padding:5})]});return{x:n,y:r}}))}(h.current,m.current).then((({x:e,y:t})=>{m.current&&Object.assign(m.current.style,{left:`${e}px`,top:`${t}px`})})),p(!1)}),[h,m,l,d]);const y=e.useCallback((e=>{m.current&&e.target!==h.current&&s&&function(e,t){return!e.contains(t.target)}(m.current,e)&&c(!1)}),[s,m,h]);return e.useEffect((()=>(document.addEventListener("click",y),window.addEventListener("resize",(()=>p(!0))),()=>{document.removeEventListener("click",y),window.removeEventListener("resize",(()=>p(!0)))})),[y,p]),e.createElement(e.Fragment,null,e.createElement("button",Bj(Uj({className:"lk-button lk-button-menu","aria-pressed":s},a),{onClick:()=>c(!s),ref:h}),a.children),e.createElement("div",{className:"lk-device-menu",ref:m,style:{visibility:s?"visible":"hidden"}},r?e.createElement(PR,{initialSelection:o,onActiveDeviceChange:e=>f(r,e),onDeviceListChange:u,kind:r}):e.createElement(e.Fragment,null,e.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),e.createElement(PR,{kind:"audioinput",onActiveDeviceChange:e=>f("audioinput",e),onDeviceListChange:u}),e.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),e.createElement(PR,{kind:"videoinput",onActiveDeviceChange:e=>f("videoinput",e),onDeviceListChange:u}))))};function XR(t){var n,r=t,{variation:o,controls:i}=r,a=Fj(r,["variation","controls"]);const[s,c]=e.useState(!1),l=Jj();e.useEffect((()=>{var e,t;void 0!==(null==(e=null==l?void 0:l.widget.state)?void 0:e.showChat)&&c(null==(t=null==l?void 0:l.widget.state)?void 0:t.showChat)}),[null==(n=null==l?void 0:l.widget.state)?void 0:n.showChat]);const u=function(t){const n=e=>"undefined"!=typeof window&&window.matchMedia(e).matches,[r,o]=e.useState(n(t));function i(){o(n(t))}return e.useEffect((()=>{const e=window.matchMedia(t);return i(),e.addListener?e.addListener(i):e.addEventListener("change",i),()=>{e.removeListener?e.removeListener(i):e.removeEventListener("change",i)}}),[t]),r}(`(max-width: ${s?1e3:760}px)`);null!=o||(o=u?"minimal":"verbose");const d=Uj({leave:!0},i),p=function(){const t=Qj();return nR(e.useMemo((()=>{return Oj(e=t.localParticipant,sP.ParticipantPermissionsChanged).pipe(rx((()=>e.permissions)),Rx(e.permissions));var e}),[t]),t.localParticipant.permissions)}();p?(null!=d.camera||(d.camera=p.canPublish),null!=d.microphone||(d.microphone=p.canPublish),null!=d.screenShare||(d.screenShare=p.canPublish),null!=d.chat||(d.chat=p.canPublishData&&(null==i?void 0:i.chat))):(d.camera=!1,d.chat=!1,d.microphone=!1,d.screenShare=!1);const f=e.useMemo((()=>"minimal"===o||"verbose"===o),[o]),h=e.useMemo((()=>"textOnly"===o||"verbose"===o),[o]),m=e.useMemo((()=>"undefined"!=typeof document&&/Mobi/i.test(window.navigator.userAgent)),[]),[y,b]=e.useState(!1);return e.createElement("div",Uj({className:"lk-control-bar"},a),d.microphone&&e.createElement("div",{className:"lk-button-group"},e.createElement(TR,{source:pP.Source.Microphone,showIcon:f},h&&"Microphone"),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(YR,{kind:"audioinput"}))),d.camera&&e.createElement("div",{className:"lk-button-group"},e.createElement(TR,{source:pP.Source.Camera,showIcon:f},h&&"Camera"),e.createElement("div",{className:"lk-button-group-menu"},e.createElement(YR,{kind:"videoinput"}))),d.screenShare&&!m&&e.createElement(TR,{source:pP.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:f,onChange:e=>{b(e)}},h&&(y?"Stop screen share":"Share screen")),d.chat&&e.createElement(aR,null,f&&e.createElement(uR,null),h&&"Chat"),d.leave&&e.createElement(sR,null,f&&e.createElement(fR,null),h&&"Leave"),e.createElement(ER,{label:"Start Audio"}))}function QR(e){return QR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QR(e)}function eI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eI(Object(n),!0).forEach((function(t){nI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==QR(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==QR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===QR(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return oI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oI(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iI(){var e=NR([pP.Source.Camera]),n=NR([pP.Source.ScreenShare])[0];return t().createElement(t().Fragment,null,n&&t().createElement(qR,n),t().createElement(JR,{tracks:e},t().createElement(Gj.Consumer,null,(function(e){return t().createElement(qR,e)}))))}var aI=function(n){var r=n.url,o=n.token,i=(n.onRoomConnected,n.style),a=(n.stageRenderer,rI((0,e.useState)(!0),2)),s=a[0],c=a[1],l=rI((0,e.useState)(!1),2),u=l[0],d=l[1];return t().createElement("div",{className:"roomContainer",style:tI({color:"white"},i)},t().createElement(KR,{serverUrl:r,token:o,connect:s,audio:!0,video:!0,onConnected:function(){return d(!0)},onDisconnected:function(){c(!1),d(!1)}},t().createElement($R,null),t().createElement(oR,null),u&&t().createElement(iI,null),t().createElement(XR,null)))};function sI(e){return sI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sI(e)}function cI(){return cI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cI.apply(this,arguments)}function lI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uI(r.key),r)}}function uI(e){var t=function(e,t){if("object"!==sI(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==sI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===sI(t)?t:String(t)}function dI(e,t){return dI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dI(e,t)}function pI(e){return pI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pI(e)}var fI={inline:{backgroundColor:"rgba(0,0,0)"},fullscreen:{position:"absolute",top:0,left:0,bottom:0,right:0,padding:30,zIndex:1e3,backgroundColor:"rgba(0,0,0,0.75)",overflowY:"auto"}};const hI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dI(e,t)}(c,e);var n,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pI(i);if(a){var n=pI(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===sI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).state={mode:"inline"},t}return n=c,(o=[{key:"componentWillUnmount",value:function(){this.videoRoomConnected&&this.videoRoomConnected.disconnect()}},{key:"toggleMode",value:function(){this.videoRoomConnected&&this.videoRoomConnected.disconnect();var e=this.state.mode;this.setState({mode:"inline"===e?"fullscreen":"inline"})}},{key:"render",value:function(){var e=this,n=this.state.mode,o=t().createElement("div",{style:fI[n]},t().createElement("a",{style:{color:"white"},onClick:function(){return e.toggleMode()}},"Toogle"),t().createElement(aI,cI({},this.props,{stageRenderer:void 0,onRoomConnected:function(t){e.videoRoomConnected=t}})));return"inline"===n?o:r().createPortal(o,document.body)}}])&&lI(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),c}(t().Component);function mI(e){return mI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mI(e)}function yI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yI(Object(n),!0).forEach((function(t){vI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vI(e,t,n){return(t=kI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gI(){return gI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gI.apply(this,arguments)}function SI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kI(r.key),r)}}function kI(e){var t=function(e,t){if("object"!==mI(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==mI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===mI(t)?t:String(t)}function OI(e,t){return OI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},OI(e,t)}function PI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EI(e){return EI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},EI(e)}var CI=q().requireLib("boot"),TI=CI.PydioContextConsumer,xI=CI.moment,jI=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OI(e,t)}(c,n);var r,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=EI(i);if(a){var n=EI(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===mI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return PI(e)}(this,e)});function c(t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=s.call(this,t)).client=null,n.state={messages:[],room:null,value:""},n._newMessageListener=n.onNewMessage.bind(PI(n)),n.commentPane=(0,e.createRef)(),n}return r=c,o=[{key:"componentDidMount",value:function(){this.join(this.props.roomType,this.props.roomObjectId)}},{key:"componentWillUnmount",value:function(){this.stop(),this.videoRoomConnected&&this.videoRoomConnected.disconnect()}},{key:"componentDidUpdate",value:function(e,t){if(t.messages.length<=this.state.messages.length){var n=t.messages.length>0?parseFloat(t.messages[t.messages.length-1].Timestamp):0;(this.state.messages.length>0?parseFloat(this.state.messages[this.state.messages.length-1].Timestamp):0)>n&&this.commentPane.current&&(this.commentPane.current.scrollTop=1e5)}}},{key:"componentWillReceiveProps",value:function(e){var t=e.roomType,n=e.roomObjectId;t===this.props.roomType&&n===this.props.roomObjectId||(this.client&&this.client.leaveRoom(this.props.roomType,this.props.roomObjectId,this._newMessageListener),this.setState({messages:[],room:null,value:""}),t&&n&&this.join(t,n))}},{key:"onRoomMessage",value:function(e){if(!this.state.firstUpdateReceived){var t=this.props,n=t.roomType,r=t.roomObjectId;this.client.loadHistory(n,r,0,40),this.setState({firstUpdateReceived:!0})}e&&this.setState({room:e.Room})}},{key:"onNewMessage",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){if(this.setState({firstUpdateReceived:!0}),"VIDEO_CALL"===e["@type"])return console.log("Video Enabled!",e),void this.setState({videoData:e});if(n)this.setState({messages:this.state.messages.filter((function(t){return t.Uuid!==e.Uuid}))});else{var r=[].concat((t=this.state.messages.filter((function(t){return t.Uuid!==e.Uuid})),function(e){if(Array.isArray(e))return SI(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return SI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SI(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[e]).filter((function(e){return!!e.Message}));r.sort((function(e,t){return e.Timestamp===t.Timestamp?0:parseFloat(e.Timestamp)>parseFloat(t.Timestamp)?1:-1})),this.setState({messages:r})}}}},{key:"join",value:function(e,t){var n=this;if(t){var r=this.props.pydio;this.client=$v.getInstance(r),this.setState({firstUpdateReceived:!1},(function(){var r=n.client.joinRoom(e,t,n._newMessageListener,n.onRoomMessage.bind(n));null!==r&&n.setState({room:r})})),this.client.loadHistory(e,t,0,40)}}},{key:"more",value:function(){var e=this.props,t=e.roomType,n=e.roomObjectId,r=this.state.messages;this.client&&this.client.loadHistory(t,n,r.length-1,40)}},{key:"stop",value:function(){var e=this.props,t=e.roomType,n=e.roomObjectId;this.client&&this.client.leaveRoom(t,n,this._newMessageListener)}},{key:"postMessage",value:function(){if(this.state.value){var e=this.state.room;if(e&&e.Uuid){var t={"@type":"POST",Message:{RoomUuid:e.Uuid,Message:this.state.value}};this.client.send(JSON.stringify(t)),this.setState({value:""})}else console.error("Cannot find cell info")}}},{key:"deleteMessage",value:function(e){var t=this.state.room;if(t&&t.Uuid){var n={"@type":"DELETE_MSG",Message:e};this.client.send(JSON.stringify(n))}else console.error("Cannot find cell info")}},{key:"keyDown",value:function(e){var t=this.state.value;if("Enter"===e.key)if(e.metaKey||e.ctrlKey){var n,r,o=e.currentTarget;o.selectionEnd<t.length?(n=t.substr(0,o.selectionEnd)+"\n"+t.substr(o.selectionEnd),r=o.selectionEnd+1):r=(n=t+"\n").length,this.setState({value:n},(function(){o.setSelectionRange(r,r)}))}else e.preventDefault(),this.postMessage()}},{key:"render",value:function(){var e,n,r,o,i,a=this,s=this.props,c=s.style,l=s.msgContainerStyle,u=s.chatUsersStyle,d=s.fieldContainerStyle,p=s.fieldHint,f=s.textFieldProps,h=s.emptyStateProps,m=s.pydio,y=s.pushMessagesToBottom,b=s.computePresenceFromACLs,v=s.readonly,S=s.muiTheme,w=s.popoverPanel,k=this.state,O=k.messages,P=k.room,E=k.videoData,C=k.joinVideo,T=[],x=O.length>=40;O.forEach((function(r){var o=xI(1e3*parseFloat(r.Timestamp)).fromNow(),i=e&&e===o,s=n&&n===r.Author&&i;T.push(t().createElement(pg,{key:r.Uuid,message:r,hideDate:i,sameAuthor:s,onDeleteMessage:function(){a.deleteMessage(r)},moreLoader:x?function(){a.more()}:null,muiTheme:S})),x=!1,e=o,n=r.Author})),y&&(r={display:"flex",flexDirection:"column"},T&&T.length&&(o=t().createElement("span",{style:{flex:1}}))),!h||T&&T.length||(i=t().createElement(fo,gI({pydio:m},h)));var j=!P,R={color:X()(S.palette.mui3["on-surface-variant"]).fade(.5).toString(),whiteSpace:"nowrap"};f&&f.hintStyle&&(R=bI(bI({},R),f.hintStyle)),j&&(R=bI(bI({},R),{},{fontStyle:"italic"}));var I=bI({backgroundColor:S.palette.mui3[w?"surface-variant":"surface"]||"white",position:"relative",paddingLeft:16,paddingRight:16},d);return t().createElement("div",{style:bI({padding:0},c)},void 0!==b&&t().createElement("div",{style:u},t().createElement(mm,{acls:b,max:12,onlines:P?P.Users:[]})),t().createElement("div",{ref:this.commentPane,className:"comments_feed",style:bI(bI({maxHeight:300,overflowY:"auto"},r),l)},o,T,i),t().createElement("div",{style:I},t().createElement(g.TextField,gI({hintText:j?m.MessageHash[466]:p,value:this.state.value,onChange:function(e,t){a.setState({value:t})},multiLine:!0,onKeyDown:this.keyDown.bind(this),fullWidth:!0,underlineShow:!1,disabled:v||j},f,{hintStyle:R})),E&&t().createElement("div",{style:{position:"absolute",top:0,right:0}},t().createElement(g.IconButton,{iconStyle:{color:C?"#F44336":"#4CAF4F"},iconClassName:"mdi mdi-video"+(C?"-off":""),onClick:function(){return a.setState({joinVideo:!C})}}))),E&&C&&t().createElement(hI,{url:E.Url,token:E.Token}),t().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n.chat-message-md *, .comments_feed .user-label, .comments_feed .date-from{\n    user-select: text;\n}\n.chat-message-md p{\n    padding-top: 0; \n    margin-bottom: 0;\n}\n.chat-message-md strong {\n    font-weight: 500;\n}\n.chat-message-md a {\n    text-decoration: underline;\n    color:#2196f3;\n}\n.chat-message-md ul {\n    padding-left: 20px;\n}\n"}}))}}],o&&wI(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(t().Component);function RI(e){return RI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RI(e)}function II(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_I(r.key),r)}}function _I(e){var t=function(e,t){if("object"!==RI(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==RI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===RI(t)?t:String(t)}function AI(e,t){return AI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},AI(e,t)}function MI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DI(e){return DI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},DI(e)}jI.PropTypes={roomType:z().string,roomObjectId:z().string},jI=TI((0,$.muiThemeable)()(jI));var LI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AI(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=DI(o);if(i){var n=DI(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===RI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return MI(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={newMessages:0},t._messageListener=t.onMessage.bind(MI(t)),t}return n=s,r=[{key:"onMessage",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.setState({newMessages:Math.max(0,this.state.newMessages-1)}):this.setState({newMessages:this.state.newMessages+1})}},{key:"listenToRoom",value:function(e,t){$v.getInstance(this.props.pydio).joinRoom(e,t,this._messageListener,null)}},{key:"leaveRoom",value:function(e,t){$v.getInstance(this.props.pydio).leaveRoom(e,t,this._messageListener)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.roomType,n=e.objectId;this.listenToRoom(t,n)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.roomType,n=e.objectId;this.leaveRoom(t,n)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props,r=n.roomType,o=n.objectId;e.roomType===r&&e.objectId===o||(this.leaveRoom(r,o),this.setState({newMessages:0},(function(){t.listenToRoom(e.roomType,e.objectId)})))}},{key:"onClick",value:function(){this.props.pydio.Controller.fireAction("toggle_chat_panel"),this.setState({newMessages:0})}},{key:"render",value:function(){var e=this.state.newMessages;if(0===e)return null;return t().createElement("span",{onClick:this.onClick.bind(this),className:"mdi mdi-comment",style:{display:"inline-block",padding:"0 5px",fontSize:15,textAlign:"center",color:"#8BC34A",fontWeight:500,position:"relative"}},t().createElement("span",{style:{fontSize:13,display:"inline-block",position:"absolute",top:-1,marginLeft:2}},e))}}],r&&II(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function NI(e){return NI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NI(e)}function UI(){return UI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UI.apply(this,arguments)}function BI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function FI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BI(Object(n),!0).forEach((function(t){zI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zI(e,t,n){return(t=qI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qI(r.key),r)}}function qI(e){var t=function(e,t){if("object"!==NI(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==NI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===NI(t)?t:String(t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},HI(e,t)}function ZI(e){return ZI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ZI(e)}var VI=q().requireLib("form").FileDropZone,JI={root:{paddingTop:20},section:{container:{},title:{},description:{},actions:{}},action:{container:{},icon:{},title:{},description:{}},deleteButton:{},deleteIconProps:{style:{position:"absolute",top:0,right:0},iconStyle:{color:"#bdbdbd",hoverColor:"#9e9e9e"}}},GI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ZI(o);if(i){var n=ZI(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===NI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),e.model||(e.model={Sections:[]}),a.call(this,e)}return n=s,r=[{key:"stProps",value:function(e,t){return{style:JI[e][t],className:"stepper-"+e+"-"+t}}},{key:"render",value:function(){var e=this,n=this.props,r=n.model,o=n.style,i=n.onPick;return t().createElement("div",{style:FI(FI({},JI.root),o),className:"bbpanel"},r.Sections.map((function(n){return t().createElement("div",e.stProps("section","container"),t().createElement("div",e.stProps("section","title"),n.title),t().createElement("div",e.stProps("section","description"),n.description),t().createElement("div",e.stProps("section","actions"),n.Actions.map((function(n){var r=n.description;r&&r.length>70&&(r=t().createElement("span",{title:r},r.substr(0,70)+"..."));var o=t().createElement(t().Fragment,null,n.tag&&t().createElement("div",{className:"stepper-tag"},n.tag),n.onDelete&&t().createElement("div",e.stProps("action","deleteButton"),t().createElement(g.IconButton,UI({iconClassName:"mdi mdi-close",tooltip:"Remove",onClick:function(e){e.stopPropagation(),n.onDelete()}},JI.deleteIconProps))),t().createElement("div",e.stProps("action","icon"),t().createElement(g.FontIcon,{color:n.tint||"#03A9F4",className:n.icon})),t().createElement("div",e.stProps("action","title"),n.title),t().createElement("div",e.stProps("action","description"),r));return n.dropProps?t().createElement(VI,UI({},e.stProps("action","container"),n.dropProps),o):t().createElement(g.Paper,UI({zDepth:0},e.stProps("action","container"),{onClick:function(){i(n.value)}}),o)}))))})),t().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n.react-mui-context .bbpanel .stepper-section-actions {\n    display: flex;\n    flex-wrap: wrap;\n}\n\n.react-mui-context .bbpanel .stepper-section-container {\n    margin-bottom: 30px;\n}\n\n.react-mui-context .bbpanel .stepper-section-title {\n    font-size: 13px;\n    font-weight: 500;\n    color: #455a64;\n    padding-bottom: 20px;    \n}\n\n.react-mui-context .bbpanel .stepper-action-container {\n    margin: 10px;\n    width: 230px;\n    height: 210px;\n    display: flex;\n    flex-direction: column;\n    font-size: 15px;\n    padding: 10px 20px;\n    border-radius: 6px !important;\n    box-shadow: 1px 10px 20px 0 rgba(40,60,75,.15);\n    cursor: pointer;\n    position:relative;\n}\n\n.react-mui-context .bbpanel .stepper-action-container:hover {\n    box-shadow: 1px 10px 20px 0 rgba(40,60,75,.3)\n}\n\n.react-mui-context .bbpanel .stepper-action-icon {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.react-mui-context .bbpanel .stepper-tag {\n    position: absolute;\n    top: 15px;\n    left: 16px;\n    background-color: #B0BEC5;\n    color: white;\n    padding: 1px 5px;\n    font-size: 12px;\n    height: 19px;\n    line-height: 16px;\n    border-radius: 4px;\n    font-weight: 500;\n}\n\n.react-mui-context .bbpanel .stepper-action-icon > span {\n    font-size: 50px !important;\n}\n\n.react-mui-context .bbpanel .stepper-action-title {\n    padding-bottom: 20px;\n    font-weight: 500;\n    text-align: center;\n    font-size: 16px;\n}\n\n.react-mui-context .bbpanel .stepper-action-description {\n    text-align: center;\n    font-weight: 300;\n    font-size: 13px;\n    padding-bottom: 10px;   \n}\n"}}))}}],r&&WI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);const KI=GI;function $I(e){return $I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$I(e)}function YI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function XI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YI(Object(n),!0).forEach((function(t){QI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function QI(e,t,n){return(t=t_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t_(r.key),r)}}function t_(e){var t=function(e,t){if("object"!==$I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==$I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===$I(t)?t:String(t)}function n_(e,t){return n_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n_(e,t)}function r_(e){return r_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r_(e)}var o_=q().requireLib("hoc").ModernTextField,i_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n_(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=r_(o);if(i){var n=r_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===$I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"componentDidUpdate",value:function(e){e.random!==this.props.random&&this.refs.dialog&&setTimeout((function(){window.dispatchEvent(new Event("resize"))}),0)}},{key:"render",value:function(){var e=this.props,n=e.title,r=e.actions,o=e.open,i=e.onDismiss,a=e.onFilter,s=e.customFilter,c=e.children,l=e.dialogProps,u=n;return(i||a||s)&&(u=t().createElement("div",{style:{position:"relative",display:"flex",alignItems:"center"}},t().createElement("div",{style:{flex:1}},n),s&&t().createElement("div",{style:{marginRight:16}},s),a&&t().createElement("div",{style:{width:210,height:34,marginTop:-10,marginRight:i?50:0}},t().createElement(o_,{hintText:"Filter list",onChange:function(e,t){a(t)},fullWidth:!0})),i&&t().createElement("div",{style:{position:"absolute",top:11,right:20}},t().createElement(g.IconButton,{iconClassName:"mdi mdi-close",onClick:i})))),t().createElement(g.Dialog,{ref:"dialog",title:u,actions:r,modal:l.modal,open:o,autoDetectWindowHeight:!0,autoScrollBodyContent:!0,contentClassName:"stepper-dialog",bodyStyle:XI({backgroundColor:"rgb(236, 239, 241)",borderRadius:"0 0 6px 6px"},l.bodyStyle),contentStyle:XI({width:"90%",maxWidth:"none",borderRadius:6},l.contentStyle),titleStyle:XI({borderBottom:"none",backgroundColor:"rgb(246, 247, 248)",borderRadius:"6px 6px 0 0"},l.titleStyle)},c,t().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:".stepper-dialog > div{border-radius: 6px !important;}"}}))}}])&&e_(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component),a_={SortableList:N,SimpleList:Do,NodeListCustomProvider:qo,ListEntry:de,ListPaginator:wr,MaterialTable:ii,Masonry:$a,Timeline:cs,TreeView:js,DNDTreeView:xs,FoldersTree:Rs,ClipboardTextField:rc,LabelWithTip:Bs,EmptyStateView:fo,SimpleFigureBadge:Js,ModalAppBar:function(e){var n=e.style,r=e.titleStyle,o=e.iconStyleRight,i=e.iconStyleLeft,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Ic),s={style:Mc({flexShrink:0},n),titleStyle:Mc({lineHeight:"56px",height:56,marginLeft:-8},r),iconStyleRight:Mc({marginTop:4},o),iconStyleLeft:Mc({marginTop:4},i)};return t().createElement(g.AppBar,_c({},a,s))},GenericCard:Oc,GenericLine:kc,Mui3CardLine:wc,QuotaUsageLine:jc,ReactEditorOpener:qc,DynamicGrid:Tl,DynamicGridItemMixin:_l,asGridItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{gridWidth:4,gridHeight:12},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=e.displayName||e.name;e=Hl()(e);var i=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bl(e,t)}(s,t);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fl(o);if(i){var n=Fl(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Al(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).state={focus:!1,showCloseAction:!1},n}return n=s,r=[{key:"focusItem",value:function(){this.setState({focus:!0})}},{key:"blurItem",value:function(){this.setState({focus:!1})}},{key:"mergeStyleWithFocus",value:function(){return Dl(Dl({},this.props.style),{},{zIndex:this.state.focus?1:null})}},{key:"toggleEditMode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;void 0===e?this.setState({showCloseAction:!(this.state&&this.state.showCloseAction)}):this.setState({showCloseAction:e})}},{key:"getCloseButton",value:function(){var e=function(){};return this.props.onCloseAction&&(e=this.props.onCloseAction),React.createElement("div",{style:{position:"absolute",backgroundColor:"rgba(0,0,0,0.53)",zIndex:10,top:0,left:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement(ql,{label:this.props.pydio.MessageHash["ajxp_admin.home.48"],className:"card-close-button",onClick:e,style:{color:"white"}}))}},{key:"render",value:function(){var t=Dl(Dl({},this.props),{},{style:this.mergeStyleWithFocus(),closeButton:this.state.showCloseAction?this.getCloseButton():null,onFocusItem:this.focusItem.bind(this),onBlurItem:this.blurItem.bind(this)});return React.createElement(e,t)}}],r&&Nl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(Wl);return i.propTypes={onCloseAction:zl.func},i.displayName=o,i.builderDisplayName=t,i.getGridLayout=function(e,t){return{x:e||0,y:t||0,w:n.gridWidth||4,h:n.gridHeight||12,isResizable:!1}},i.hasBuilderFields=function(){return void 0!==r},i.getBuilderFields=function(){return r},i},DynamicGridStore:Qc,DND:{Types:p,collect:f,collectDrop:h,nodeDragSource:b,nodeDropTarget:v,DNDActionParameter:m},DNDActionParameter:m,UserAvatar:Qd,SharedAvatar:um,UsersCompleter:om,TeamCreationForm:ih,AddressBook:Hh,DirectoryLayout:Uv,ListStylesCompact:Pu,SharedUsersStack:mm,ContextMenu:Xm,Toolbar:Iy,ButtonMenu:xm,IconButtonMenu:ar,MenuItemsConsumer:Kn,MenuUtils:Bn,Chat:jI,ChatIcon:LI,ChatClient:$v,ResourcePoliciesPanel:bp,CellActionsRenderer:Ou,Stepper:{PanelBigButtons:KI,Dialog:i_}}})(),window.PydioComponents=s})();