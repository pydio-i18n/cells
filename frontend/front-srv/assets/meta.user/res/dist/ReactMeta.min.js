(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Callbacks:()=>a,InfoPanel:()=>yr,MetaClient:()=>b,Renderer:()=>Jt,TypeEditor:()=>en,UserMetaDialog:()=>Tr,UserMetaPanel:()=>nr});const r=require("pydio");var n=e.n(r);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===o(i)?i:String(i)),n)}var i}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"editMeta",value:function(){var e=n().getInstance();e.UI.openComponentInModal("ReactMeta","UserMetaDialog",{dialogTitleId:489,selection:e.getUserSelection()})}}],null&&i(t.prototype,null),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const u=require("react");var c=e.n(u);const l=require("material-ui"),s=require("pydio/http/api");var f=e.n(s);const p=require("cells-sdk");function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===y(o)?o:String(o)),n)}var o}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=f().getRestClient()}var t,r,n;return t=e,n=[{key:"getInstance",value:function(){return e.Instance||(e.Instance=new e),e.Instance}}],(r=[{key:"saveMeta",value:function(e,t){var r=this,n=new p.UserMetaServiceApi(this.client);return new Promise((function(o,i){r.loadConfigs().then((function(r){var a=[];e.map((function(e){var o=new p.IdmUpdateUserMetaRequest;o.MetaDatas=[],o.Operation="PUT",r.forEach((function(r,n){if(t.has(n)){var i=new p.IdmUserMeta;i.NodeUuid=e.getMetadata().get("uuid"),i.Namespace=n,i.JsonValue=JSON.stringify(t.get(n)),i.Policies=[p.ServiceResourcePolicy.constructFromObject({Action:"READ",Subject:"*",Effect:"allow"}),p.ServiceResourcePolicy.constructFromObject({Action:"WRITE",Subject:"*",Effect:"allow"})],o.MetaDatas.push(i)}})),a.push(n.updateUserMeta(o))})),Promise.all(a).then((function(){o()})).catch((function(e){i(e)}))}))}))}},{key:"clearConfigs",value:function(){this.configs=null}},{key:"loadConfigs",value:function(){var e=this;return this.configs?Promise.resolve(this.configs):(this.promise||(this.promise=new Promise((function(t){var r={},n=new Map;new p.UserMetaServiceApi(e.client).listUserMetaNamespace().then((function(o){o.Namespaces.map((function(e){var t=e.Namespace,n={label:e.Label,indexable:e.Indexable,order:e.Order,visible:!0,readonly:!e.PoliciesContextEditable};if(e.JsonDefinition){var o=JSON.parse(e.JsonDefinition);Object.keys(o).map((function(e){"hide"===e?n.visible=!o[e]:n[e]=o[e]}))}r[t]=n}));var i=Object.entries(r).map((function(e){return e[1].ns=e[0],e[1]}));i.sort((function(e,t){var r=e.order||0,n=t.order||0;return r>n?1:r===n?0:-1})),i.map((function(e){if("choice"===e.type&&e.data&&e.data.split){var t=e.data.split(",").map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("|"),2);return{key:t[0],value:t[1]}}));e.data={items:t}}n.set(e.ns,e)})),e.configs=n,t(n),e.promise=null})).catch((function(){t(new Map),e.promise=null}))}))),this.promise)}},{key:"listTags",value:function(e){var t=this;return new Promise((function(r){new p.UserMetaServiceApi(t.client).listUserMetaTags(e).then((function(e){e.Tags?r(e.Tags):r([])})).catch((function(e){r([])}))}))}},{key:"createTag",value:function(e,t){return new p.UserMetaServiceApi(this.client).putUserMetaTag(e,p.RestPutUserMetaTagRequest.constructFromObject({Namespace:e,Tag:t}))}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h.apply(this,arguments)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==v(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===v(o)?o:String(o)),n)}var o}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function j(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(u,t);var r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(o);if(i){var r=w(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,e)).state={value:t.props.value||0,configs:t.props.configs||new Map,getRealValue:function(){var e=t.props,r=e.node,n=e.column;return r.getMetadata().get(n.name)}},t}return r=u,(n=[{key:"componentDidMount",value:function(){var e=this;this.props.configs||b.getInstance().loadConfigs().then((function(t){e.setState({configs:t})}))}},{key:"render",value:function(){return c().createElement(e,h({},this.props,this.state))}}])&&g(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}(c().Component)}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==P(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===P(o)?o:String(o)),n)}var o}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}var k={fontSize:20,color:"#FBC02D",marginTop:6,marginBottom:6};const x=j(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(n);if(o){var r=T(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e=this.props,t=e.getRealValue,r=e.size,n=t()||0,o=[0,1,2,3,4].map((function(e){return c().createElement("span",{key:"star-"+e,className:"mdi mdi-star"+(n>e?"":"-outline")})})),i="small"===r?{color:k.color}:k;return c().createElement("span",{style:i},o)}}])&&S(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component));function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==C(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===C(o)?o:String(o)),n)}var o}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}const D=j(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(n);if(o){var r=_(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e,t=this.props,r=t.configs,n=t.getRealValue,o=t.column,i=n(),a=n(),u=r.get(o.name);if(u&&u.data&&u.data.items){var l=u.data.items.filter((function(e){return e.key===i}));l.length&&(a=l[0].value,l[0].color&&(e=c().createElement("span",{className:"mdi mdi-label",style:{color:l[0].color,marginRight:5}})))}return c().createElement("span",null,e,a)}}])&&M(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component));function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===I(o)?o:String(o)),n)}var o}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var A=function(){var e=n().getMessages();return{low:{label:e["meta.user.4"],sortValue:"5",color:"#66c"},todo:{label:e["meta.user.5"],sortValue:"4",color:"#69c"},personal:{label:e["meta.user.6"],sortValue:"3",color:"#6c6"},work:{label:e["meta.user.7"],sortValue:"2",color:"#c96"},important:{label:e["meta.user.8"],sortValue:"1",color:"#c66"}}};const F=j(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=B(n);if(o){var r=B(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e=(0,this.props.getRealValue)(),t=A();if(e&&t[e]){var r=t[e];return c().createElement("span",null,c().createElement("span",{className:"mdi mdi-label",style:{color:r.color}})," ",r.label)}return c().createElement("span",null,e)}}])&&N(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component)),L=require("color");var U=e.n(L),q={};function W(e){if(0===e.length)return{};if(q[e])return q[e];var t,r,n=0;for(t=0,r=e.length;t<r;t++)n=(n<<5)-n+1e3*e.charCodeAt(t),n|=0;var o=(16777215&n).toString(16).toUpperCase(),i="00000".substring(0,6-o.length)+o,a=new(U())("#"+i).hsl(),u=a.hue(),c=new(U())({h:u,s:a.saturationl(),l:90}),l={color:new(U())({h:u,s:a.saturationl(),l:40}).string(),backgroundColor:c.string()};return q[e]=l,l}function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J.apply(this,arguments)}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==z(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===z(o)?o:String(o)),n)}var o}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function $(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(u,t);var r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Y(o);if(i){var r=Y(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,e)).state={value:t.props.value||"",configs:t.props.configs||new Map,getRealValue:function(){var e=t.props,r=e.node,n=e.column;return r.getMetadata().get(n.name)}},t}return r=u,n=[{key:"updateValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState({value:e});var r=this.props,n=r.fieldname,o=r.onChange,i=r.onValueChange;if(o){var a={};a["ajxp_meta_"+n]=e,o(a,t)}else this.props.onValueChange&&i(n,e,t)}},{key:"componentDidMount",value:function(){var e=this;this.props.configs||b.getInstance().loadConfigs().then((function(t){e.setState({configs:t})}))}},{key:"componentWillReceiveProps",value:function(e,t){this.setState({value:e.value||""})}},{key:"render",value:function(){return c().createElement(e,J({},this.props,this.state,{updateValue:this.updateValue.bind(this)}))}}],n&&K(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}(c().Component)}const G=require("material-ui/styles");function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e,t,r){return(t=re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,re(n.key),n)}}function re(e){var t=function(e,t){if("object"!==Q(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Q(t)?t:String(t)}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ne(e,t)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}var ie=n().requireLib("hoc").ThemedModernStyles,ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oe(n);if(o){var r=oe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"render",value:function(){var e=this.props,t=e.updateValue,r=e.value,n=void 0===r?0:r,o=e.search,i=e.label,a=e.muiTheme,u=ie(a),l=[-1,0,1,2,3,4].map((function(e){var r="star"+(-1===e?"-off":n>e?"":"-outline"),o=-1===e?{marginRight:5,cursor:"pointer"}:{cursor:"pointer"};return c().createElement("span",{key:"star-"+e,onClick:function(){return t(e+1,!0)},className:"mdi mdi-"+r,style:o})}));return o?c().createElement("div",{className:"advanced-search-stars",style:Z(Z(Z({},u.div),{},{borderRadius:u.textFieldV1Search.inputStyle.borderRadius},k),{},{fontSize:18})},c().createElement("div",null,l)):c().createElement("div",{style:Z(Z({},u.textFieldV2.style),{},{borderBottom:u.fillBlockV2Right.borderBottom,marginBottom:6})},c().createElement("div",{style:{color:a.palette.mui3["on-surface-variant"],fontSize:12,padding:"3px 8px 0",lineHeight:"16px"}},i),c().createElement("div",{style:Z(Z({},k),{},{paddingLeft:6})},l))}}],r&&te(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component);const ue=$((0,G.muiThemeable)()(ae));function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function le(){return le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},le.apply(this,arguments)}function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fe(e,t,r){return(t=me(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e){return function(e){if(Array.isArray(e))return ye(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ye(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,me(n.key),n)}}function me(e){var t=function(e,t){if("object"!==ce(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ce(t)?t:String(t)}function be(e,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},be(e,t)}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(e)}var he=n().requireLib("hoc"),ge=he.ModernSelectField,Oe=he.ModernStyles;const we=$(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ve(n);if(o){var r=ve(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={},t}return t=a,r=[{key:"changeSelector",value:function(e,t,r){this.props.updateValue(r,!0)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.itemsLoader;t&&t((function(t,r,n){e.setState({menuItems:t,keys:r,stepper:n})}))}},{key:"next",value:function(){}},{key:"render",value:function(){var e,t=this.state,r=t.stepper,n=t.keys,o=void 0===n?[]:n,i=this.props,a=i.value,u=i.label,s=i.updateValue,f=i.search;(e=void 0===this.state.menuItems?pe(this.props.menuItems):pe(this.state.menuItems)).unshift(c().createElement(l.MenuItem,{value:"",primaryText:""}));var p=f?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(Object(r),!0).forEach((function(t){fe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({variant:"v1"},Oe.selectFieldV1Search):{variant:"v2"};return c().createElement("div",{style:{display:"flex"}},r&&!f&&c().createElement("div",null,c().createElement(l.IconButton,{iconClassName:"mdi mdi-chevron-left",tooltip:"Previous Step",onClick:function(){return s(o[o.indexOf(a)-1],!0)},disabled:o.indexOf(a)<=0,style:{width:28,padding:"12px 0"}})),c().createElement("div",{style:{flex:1,maxWidth:r&&!f?"75%":null}},c().createElement(ge,le({fullWidth:!0,value:a,hintText:u,onChange:this.changeSelector.bind(this)},p),e)),r&&!f&&c().createElement("div",null,c().createElement(l.IconButton,{iconClassName:"mdi mdi-chevron-right",tooltip:"Next Step",onClick:function(){return s(o[o.indexOf(a)+1],!0)},disabled:o.indexOf(a)>=o.length-1,style:{width:28,padding:"12px 0"}})))}}],r&&de(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component)),je=require("pydio/util/lang");var Pe=e.n(je);function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function Ee(){return Ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ee.apply(this,arguments)}function Te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach((function(t){xe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xe(e,t,r){return(t=Me(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Me(n.key),n)}}function Me(e){var t=function(e,t){if("object"!==Se(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Se(t)?t:String(t)}function Re(e,t){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Re(e,t)}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}var De=n().requireLib("hoc"),Ie=De.ThemedModernStyles,Ne=De.ModernAutoComplete,Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(u,e);var t,r,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_e(o);if(i){var r=_e(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var r=(t=a.call(this,e)).props,n=r.node,o=r.value,i=r.column;return t.state={loading:!1,dataSource:[],tags:n?n.getMetadata().get(i.name):o,searchText:""},t}return t=u,r=[{key:"componentDidMount",value:function(){this.getRealValue(),this.props.editMode&&this.load()}},{key:"componentWillReceiveProps",value:function(e){var t=e.node,r=e.value,n=e.column;t?this.setState({tags:t.getMetadata().get(n.name)}):r?this.setState({tags:r}):this.setState({tags:""}),e.editMode&&!this.state.loaded&&this.load()}},{key:"getRealValue",value:function(){var e=this.props,t=e.node,r=e.value,n=e.column;null==t?this.setState({tags:r}):this.setState({tags:t.getMetadata().get(n.name)})}},{key:"suggestionLoader",value:function(e){var t=this;this.setState({loading:this.state.loading+1}),b.getInstance().listTags(this.props.fieldname||this.props.column.name).then((function(r){t.setState({loading:t.state.loading-1}),e(r)}))}},{key:"load",value:function(){this.setState({loading:!0}),this.suggestionLoader(function(e){var t=e.filter((function(e){return!!e})).map((function(e){return{value:c().createElement(l.MenuItem,{innerDivStyle:{paddingLeft:0,marginLeft:0},style:ke({margin:"5px 10px",fontSize:14,fontWeight:500,paddingLeft:10,borderRadius:4},W(e))},c().createElement("span",{className:"mdi mdi-label-outline",style:{marginRight:5}}),e),text:e}}));this.setState({dataSource:t,loading:!1,loaded:!0})}.bind(this))}},{key:"handleRequestDelete",value:function(e){var t=this,r=this.props.updateValue,n=this.state.tags.split(","),o=n.indexOf(e);n.splice(o,1),this.setState({tags:n.toString()},(function(){r(t.state.tags,!0)}))}},{key:"handleUpdateInput",value:function(e){this.setState({searchText:e})}},{key:"handleNewRequest",value:function(){var e=this,t=this.state,r=t.searchText,n=t.tags;if(r){var o=[];n&&n.split&&(o=n.split(",")),o.indexOf(r)>-1?this.setState({searchText:""}):(o.push(r),this.setState({searchText:"",tags:o.toString()},(function(){(0,e.props.updateValue)(e.state.tags,!0)})))}}},{key:"renderChip",value:function(e){var t=W(e),r=t.color,n=t.backgroundColor,o={margin:2,borderRadius:"4px 16px 16px 4px"},i={color:r,fontWeight:500,paddingLeft:10,paddingRight:16};return this.props.editMode?c().createElement(l.Chip,{key:e,backgroundColor:n,labelStyle:i,style:o,onRequestDelete:this.handleRequestDelete.bind(this,e)},e):c().createElement(l.Chip,{key:e,backgroundColor:n,labelStyle:i,style:o},e)}},{key:"render",value:function(){var e,t,r=this,o=this.props,i=o.editMode,a=o.search,u=o.label,s=o.muiTheme,f=this.state,p=f.tags,y=f.searchText,d=[];p&&p.split&&(e=(d=p.split(",").map((function(e){return Pe().trim(e," ")})).filter((function(e){return!!e}))).map((function(e){return r.renderChip(e)})));var m=Ie(s);if(i){var b=a?l.AutoComplete:Ne,v=a?ke({style:{marginBottom:-10}},m.textFieldV1Search):{hintText:u};t=c().createElement(b,Ee({fullWidth:!0,hintText:n().getMessages()["meta.user.10"],searchText:y,onUpdateInput:this.handleUpdateInput.bind(this),onNewRequest:this.handleNewRequest.bind(this),dataSource:this.state.dataSource,filter:function(e,t){return 0===t.toLowerCase().indexOf(e.toLowerCase())&&-1===d.indexOf(t)},openOnFocus:!0,menuProps:{maxHeight:200,desktop:!0},listStyle:{paddingTop:5,paddingBottom:5},onClose:function(){y&&r.handleNewRequest()}},v))}else t=c().createElement("div",null);return c().createElement("div",{style:a?{marginBottom:8}:{}},t,e&&c().createElement("div",{style:{display:"flex",flexWrap:"wrap",zoom:.8,marginTop:a?8:0}},e))}}],r&&Ce(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(c().Component);const Be=$((0,G.muiThemeable)()(Ve));function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Fe(){return Fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fe.apply(this,arguments)}function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){qe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qe(e,t,r){return(t=Ke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ke(n.key),n)}}function Je(e,t,r){return t&&ze(e.prototype,t),r&&ze(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ke(e){var t=function(e,t){if("object"!==Ae(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ae(t)?t:String(t)}function He(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ye(e,t)}function Ye(e,t){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ye(e,t)}function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ge(e);if(t){var o=Ge(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===Ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Ge(e){return Ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ge(e)}var Qe=n().requireLib("hoc"),Xe=Qe.ModernTextField,Ze=Qe.ModernSelectField,et=Qe.ThemedModernStyles,tt=Qe.DatePicker,rt=Qe.TimePicker,nt=n().requireLib("boot").moment,ot=function(e){He(r,e);var t=$e(r);function r(){return We(this,r),t.apply(this,arguments)}return Je(r,[{key:"render",value:function(){var e=this.props,t=e.getRealValue,r=e.configs,n=e.column,o=r.get(n.name),i="date",a="normal";o&&o.data&&(i=o.data.format||i,a=o.data.display||a);var l=t(),s=new Date(1e3*parseFloat(l));if(isNaN(s.getTime()))return c().createElement(u.Fragment,null,"[Invalid Date]");var f=new nt(s);if("relative"===a)return c().createElement(u.Fragment,null,f.fromNow());switch(i){case"date":return c().createElement(u.Fragment,null,f.format("ll"));case"date-time":default:return c().createElement(u.Fragment,null,f.format("llll"));case"time":return c().createElement(u.Fragment,null,f.format("LT"))}}}]),r}(u.Component);ot=j((0,G.muiThemeable)()(ot));var it=function(e){He(r,e);var t=$e(r);function r(e){var n;return We(this,r),(n=t.call(this,e)).state={},n}return Je(r,[{key:"configAsState",value:function(e,t){e.has(t)&&this.setState(e.get(t).data)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.fieldname,n=t.configs;n?this.configAsState(n,r):b.getInstance().loadConfigs().then((function(t){return e.configAsState(t,r)}))}},{key:"getDate",value:function(){var e,t=this.props.value,r="";if(!t)return{vDate:null,searchComp:r};t.indexOf&&["<",">"].indexOf(t.charAt(0))>-1?(r=t.charAt(0),"="===t.charAt(1)?(r+="=",e=parseFloat(t.substr(2))):e=parseFloat(t.substr(1))):e=parseFloat(t);var n=new Date(1e3*parseFloat(e));return isNaN(n.getTime())?{vDate:new Date(0),searchComp:r}:{vDate:n,searchComp:r}}},{key:"clear",value:function(){(0,this.props.updateValue)("")}},{key:"updateDate",value:function(e,t){var r=this.props,n=r.updateValue,o=r.search,i=this.getDate(),a=i.vDate,u=i.searchComp;a||(a=new Date(0)),"date-time"===t?(e.setHours(a.getHours()),e.setMinutes(a.getMinutes()),e.setSeconds(a.getSeconds())):(e.setHours(0),e.setMinutes(0),e.setSeconds(0)),n(o?u+""+parseInt(e/1e3):parseInt(e/1e3))}},{key:"updateTime",value:function(e){var t=this.props,r=t.updateValue,n=t.search,o=this.getDate(),i=o.vDate,a=o.searchComp;i||(i=new Date(0)),i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds()),r(n?a+""+parseInt(i/1e3):parseInt(i/1e3))}},{key:"updateComp",value:function(e){var t=this.props.updateValue,r=this.getDate().vDate;r||(r=new Date),t(e+""+parseInt(r/1e3))}},{key:"render",value:function(){var e=this,t=this.props,r=t.supportTemplates,n=t.search,o=t.updateValue,i=t.value,a=t.label,u=t.muiTheme,s=et(u);if(r)return c().createElement(Xe,{value:i,fullWidth:!0,hintText:a,onChange:function(e,t){o(t)}});var f=this.state.format,p=void 0===f?"date":f,y=this.getDate(),d=y.vDate,m=y.searchComp,b=[];if(n){var v=s.selectFieldV1Search,h=Ue(Ue({},v.style),{},{borderRadius:0,marginTop:4});b.push(c().createElement("div",{style:{width:60,marginRight:0}},c().createElement(Ze,Fe({},v,{style:h,fullWidth:!0,value:m,onChange:function(t,r,n){return e.updateComp(n)}}),c().createElement(l.MenuItem,{value:"",primaryText:"="}),c().createElement(l.MenuItem,{value:">=",primaryText:">="}),c().createElement(l.MenuItem,{value:"<=",primaryText:"<="}),c().createElement(l.MenuItem,{value:">",primaryText:">"}),c().createElement(l.MenuItem,{value:"<",primaryText:"<"}))))}var g=n?Ue({},s.textFieldV1Search):Ue(Ue({},s.textFieldV2),{},{textFieldStyle:{height:52}});return"date"!==p&&"date-time"!==p||b.push(c().createElement("div",{style:{flex:3}},c().createElement(tt,Fe({floatingLabelText:n?null:a+" (date)",hintText:n?"Date":null},g,{container:"inline",fullWidth:!0,value:d,onChange:function(t,r){return e.updateDate(r,p)},autoOk:"date"===p})))),"date-time"===p&&b.push(c().createElement("div",{style:{width:8}})),"time"!==p&&"date-time"!==p||b.push(c().createElement("div",{style:{flex:2}},c().createElement(rt,Fe({floatingLabelText:n?null:a+" (time)",hintText:n?"Time":null},g,{dialogStyle:{zIndex:5e3},fullWidth:!0,value:d,onChange:function(t,r){return e.updateTime(r)},autoOk:"time"===p})))),!n&&d&&b.push(c().createElement("div",{style:Ue(Ue({cursor:"pointer"},s.fillBlockV2Right),{},{paddingTop:22,paddingRight:8}),onClick:function(){return e.clear()}},c().createElement(l.FontIcon,{className:"mdi mdi-close",color:"rgba(0,0,0,.5)"}))),c().createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:n?null:6}},b)}}]),r}(u.Component);function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function ut(){return ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ut.apply(this,arguments)}function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){st(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function st(e,t,r){return(t=pt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pt(n.key),n)}}function pt(e){var t=function(e,t){if("object"!==at(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===at(t)?t:String(t)}function yt(e,t){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yt(e,t)}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}it=$((0,G.muiThemeable)()(it));var mt=Pydio.requireLib("hoc").ThemedModernStyles,bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dt(n);if(o){var r=dt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===at(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"render",value:function(){var e=this.props,t=e.updateValue,r=e.value,n=e.search,o=e.muiTheme,i=mt(o),a=lt({},i.toggleFieldV1Search),u=r?"Yes":"No";n||(a=lt({},i.toggleFieldV2),u=this.props.label+" ("+u+")");var s=c().createElement(l.Toggle,ut({toggled:r,onToggle:function(e,r){t(r)},label:u,labelPosition:"right"},a));return n?s:c().createElement("div",{style:{margin:"12px 0 6px"}},s)}}],r&&ft(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component);const vt=$((0,G.muiThemeable)()(bt));function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){wt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function wt(e,t,r){return(t=Tt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jt(){return jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jt.apply(this,arguments)}function Pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tt(n.key),n)}}function Et(e,t,r){return t&&St(e.prototype,t),r&&St(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tt(e){var t=function(e,t){if("object"!==ht(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ht(t)?t:String(t)}function kt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}function xt(e,t){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xt(e,t)}function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Mt(e);if(t){var o=Mt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Mt(e){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mt(e)}var Rt=n().requireLib("form").InputIntegerBytes,_t=n().requireLib("hoc"),Dt=_t.ModernTextField,It=_t.ModernSelectField,Nt=_t.ModernStyles,Vt=function(e){kt(r,e);var t=Ct(r);function r(){return Pt(this,r),t.apply(this,arguments)}return Et(r,[{key:"render",value:function(){var e=this.props,t=e.getRealValue,r=e.configs,n=e.column,o=e.inline,i=r.get(n.name),a="general";i&&i.data&&(a=i.data.format||a);var s=t();switch(a){case"bytesize":return c().createElement(Rt,{value:s,editMode:!1,displayContext:"grid",toggleEditMode:function(){},disabled:!0});case"percentage":return c().createElement(u.Fragment,null,s,"%");case"progress":return o?c().createElement(l.LinearProgress,{value:s,max:100,mode:"determinate",style:{display:"inline-block",width:60,height:6,backgroundColor:"rgba(189,189,189,.5)"}}):c().createElement("div",{style:{display:"flex",alignItems:"center"}},c().createElement(l.LinearProgress,{value:s,max:100,mode:"determinate",style:{flex:1}}),c().createElement("div",{style:{marginLeft:5}},s,"%"));default:return c().createElement(u.Fragment,null,s)}}}]),r}(c().Component);Vt=j(Vt);var Bt=function(e){kt(r,e);var t=Ct(r);function r(e){var n;return Pt(this,r),(n=t.call(this,e)).state={},n}return Et(r,[{key:"configAsState",value:function(e,t){e.has(t)&&this.setState(e.get(t).data)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.fieldname,n=t.configs;n?this.configAsState(n,r):b.getInstance().loadConfigs().then((function(t){return e.configAsState(t,r)}))}},{key:"render",value:function(){var e=this.props,t=e.supportTemplates,r=e.search,n=e.updateValue,o=e.label,i=function(e){n(e,!1)},a=this.state.format,u=void 0===a?"general":a,s=this.props.value,f="";r&&(s.indexOf&&["<",">"].indexOf(s.charAt(0))>-1?(f=s.charAt(0),"="===s.charAt(1)?(f+="=",s=parseInt(s.substr(2))):s=parseInt(s.substr(1))):s=parseInt(s));var p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r?Nt.textFieldV1Search:null;return c().createElement(Dt,jt({value:s,fullWidth:!0,hintText:o,type:e,onChange:t,underlineShow:!n,variant:r?"v1":"v2"},i))};if(t)return p("",(function(e,t){return i(t)}));if(r){var y=Nt.selectFieldV1Search,d=Ot(Ot({},y.style),{},{borderRadius:0});return c().createElement("div",{style:{display:"flex"}},c().createElement("div",{style:{width:60,marginRight:0}},c().createElement(It,jt({},y,{style:d,fullWidth:!0,value:f,onChange:function(e,t,r){return i(r+""+s)}}),c().createElement(l.MenuItem,{value:"",primaryText:"="}),c().createElement(l.MenuItem,{value:">=",primaryText:">="}),c().createElement(l.MenuItem,{value:"<=",primaryText:"<="}),c().createElement(l.MenuItem,{value:">",primaryText:">"}),c().createElement(l.MenuItem,{value:"<",primaryText:"<"}))),c().createElement("div",{style:{flex:1}},p("number",(function(e,t){i(t?f+""+t:t)}))))}var m="number";switch(u){case"general":default:return p(m,(function(e,t){return i(parseInt(t))}));case"percentage":return p(m,(function(e,t){i(Math.max(0,Math.min(100,t)))}));case"progress":return c().createElement("div",null,p(m,(function(e,t){i(Math.max(0,Math.min(100,t)))}),!0),c().createElement(l.LinearProgress,{mode:"determinate",max:100,value:s,style:{marginTop:-8}}));case"bytesize":var b=function(){};return c().createElement(Rt,{value:s,editMode:!0,onChange:function(e,t){return i(parseInt(e))},isDisplayGrid:b,isDisplayForm:b,toggleEditMode:b,attributes:{type:"integer-bytes",label:o},variant:r?"v1":"v2"})}}}]),r}(c().Component);function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function Ft(){return Ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ft.apply(this,arguments)}function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach((function(t){qt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qt(e,t,r){return(t=zt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zt(n.key),n)}}function zt(e){var t=function(e,t){if("object"!==At(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===At(t)?t:String(t)}Bt=$(Bt);var Jt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"renderStars",value:function(e,t){return e.getMetadata().get(t.name)?c().createElement(x,{node:e,column:t,size:"small"}):null}},{key:"renderBoolean",value:function(e,t){return e.getMetadata().get(t.name)?c().createElement("span",null,c().createElement("span",{className:"mdi mdi-check",style:{color:"#4caf50"}})," ",t.label):null}},{key:"renderSelector",value:function(e,t){return e.getMetadata().get(t.name)?c().createElement(D,{node:e,column:t}):null}},{key:"renderCSSLabel",value:function(e,t){return e.getMetadata().get(t.name)?c().createElement(F,{node:e,column:t}):null}},{key:"renderTagsCloud",value:function(e,t){if(!e.getMetadata().get(t.name))return null;var r={display:"inline-block",backgroundColor:"#E1BEE7",borderRadius:6,height:22,lineHeight:"22px",padding:"0 6px",color:"#9C27B0",fontWeight:500,fontSize:12,marginLeft:2,marginRight:6},n=e.getMetadata().get(t.name);return n&&n.split?c().createElement("span",null,n.split(",").map((function(e,t){var o=Ut(Ut({},r),W(e));return t===n.split(",").length-1&&(o=Ut(Ut({},o),{},{marginRight:-4})),c().createElement("span",{style:o},e)}))):null}},{key:"renderDate",value:function(e,t){return e.getMetadata().get(t.name)?c().createElement(ot,{node:e,column:t,type:"date"}):null}},{key:"renderInteger",value:function(e,t){return e.getMetadata().get(t.name)?c().createElement(Vt,{node:e,column:t,inline:!0}):null}},{key:"formPanelStars",value:function(e){return c().createElement(ue,Ft({},e,{search:!0}))}},{key:"formPanelCssLabels",value:function(e,t){var r=Object.keys(A()).map(function(e){var t=A()[e],r=c().createElement("span",null,c().createElement("span",{className:"mdi mdi-label",style:{color:t.color,marginRight:5}}),t.label);return c().createElement(l.MenuItem,{value:e,primaryText:r})}.bind(this));return c().createElement(we,Ft({},e,{menuItems:r,search:!t}))}},{key:"formPanelSelectorFilter",value:function(e,t){var r=function(t,r){var n,o=t.get(e.fieldname),i=[],a=[];o&&o.data&&o.data.items&&(i=o.data.items.map((function(e){a.push(e.key);var t=e.value;return e.color&&(t=c().createElement("span",null,c().createElement("span",{className:"mdi mdi-label",style:{color:e.color,marginRight:5}}),e.value)),c().createElement(l.MenuItem,{value:e.key,primaryText:t})}))),o&&o.data&&o.data.steps&&(n=!0),r(i,a,n)};return c().createElement(we,Ft({},e,{menuItems:[],itemsLoader:function(e){t?r(t,e):b.getInstance().loadConfigs().then((function(t){return r(t,e)}))},search:!t}))}},{key:"formPanelTags",value:function(e,t){return c().createElement(Be,Ft({},e,{editMode:!0,search:!t}))}},{key:"formPanelDate",value:function(e){return c().createElement(it,Ft({type:"date"},e,{editMode:!0,search:!0}))}},{key:"formPanelBoolean",value:function(e){return c().createElement(vt,Ft({},e,{search:!0}))}},{key:"formPanelInteger",value:function(e){return c().createElement(Bt,Ft({},e,{search:!0}))}},{key:"typeFormRenderer",value:function(t){switch(t){case"stars_rate":return e.formPanelStars;case"css_label":return e.formPanelCssLabels;case"choice":return e.formPanelSelectorFilter;case"tags":return e.formPanelTags;case"integer":return e.formPanelInteger;case"boolean":return e.formPanelBoolean;case"date":return e.formPanelDate;default:return null}}},{key:"typeColumnRenderer",value:function(t){var r;switch(t){case"stars_rate":r={renderComponent:e.renderStars,sortType:"number"};break;case"css_label":r={renderComponent:e.renderCSSLabel,sortType:"string"};break;case"choice":r={renderComponent:e.renderSelector,sortType:"string"};break;case"tags":r={renderComponent:e.renderTagsCloud,renderBlock:!0,sortType:"string"};break;case"integer":r={renderComponent:e.renderInteger,sortType:"number"};break;case"boolean":r={renderComponent:e.renderBoolean,sortType:"number"};break;case"date":r={renderComponent:e.renderDate,sortType:"number"};break;default:return{}}return r.renderComponent&&(r.renderCell=r.renderComponent),r}}],null&&Wt(t.prototype,null),r&&Wt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Kt(e){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(e)}function Ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(r),!0).forEach((function(t){$t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $t(e,t,r){return(t=Xt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gt(){return Gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gt.apply(this,arguments)}function Qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xt(n.key),n)}}function Xt(e){var t=function(e,t){if("object"!==Kt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Kt(t)?t:String(t)}function Zt(e,t){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zt(e,t)}function er(e){return er=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},er(e)}var tr=n().requireLib("hoc").ModernTextField,rr=n().requireLib("components").EmptyStateView,nr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=er(n);if(o){var r=er(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),void 0===e.editMode&&(e.editMode=!1),(t=i.call(this,e)).state={updateMeta:new Map,fields:{},configs:new Map},t}return t=a,r=[{key:"componentDidMount",value:function(){var e=this;(this.props.loader?this.props.loader():b.getInstance().loadConfigs()).then((function(t){var r=e.props,n=r.node,o=r.loadChecks,i={},a=new Map;o&&t.forEach((function(e,t){n.getMetadata().has(t)&&(i[t]=!0,a.set(t,n.getMetadata().get(t)))})),e.setState({configs:t,fields:i,updateMeta:a})}))}},{key:"updateValue",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.state.updateMeta.set(e,t),this.setState({updateMeta:this.state.updateMeta}),this.props.onChangeUpdateData&&this.props.onChangeUpdateData(this.state.updateMeta),r&&this.props.autoSave&&this.props.autoSave()}},{key:"deleteValue",value:function(e){this.state.updateMeta.delete(e),this.setState({updateMeta:this.state.updateMeta}),this.props.onChangeUpdateData&&this.props.onChangeUpdateData(this.state.updateMeta)}},{key:"getUpdateData",value:function(){return this.state.updateMeta}},{key:"resetUpdateData",value:function(){this.setState({updateMeta:new Map}),this.props.onChangeUpdateData&&this.props.onChangeUpdateData(new Map)}},{key:"onCheck",value:function(e,t){var r=this.state.fields;r[e]=t,t||this.deleteValue(e),this.setState({fields:r})}},{key:"render",value:function(){var e=this,t=this.state,r=t.configs,n=t.updateMeta,o=this.props,i=o.pydio,a=o.node,u=o.editMode,s=o.onRequestEditMode,f=o.supportTemplates,p=o.multiple,y=o.style,d=[],m=a.getMetadata(),b=0;r.forEach((function(t,o){var i,s=t.label,y=t.type,v=t.readonly;if("json"!==y||f){i=m.get(o),n.has(o)&&(i=n.get(o));var h=i;if(u&&!v){var g,O={fieldname:o,label:s,value:i,configs:r,onValueChange:function(t,r,n){return e.updateValue(t,r,n)}};switch(y){case"stars_rate":g=c().createElement(ue,O);break;case"choice":g=Jt.formPanelSelectorFilter(O,r);break;case"css_label":g=Jt.formPanelCssLabels(O,r);break;case"tags":g=Jt.formPanelTags(O,r);break;case"date":g=c().createElement(it,Gt({type:y},O,{supportTemplates:f}));break;case"integer":g=c().createElement(Bt,Gt({},O,{supportTemplates:f}));break;case"boolean":g=c().createElement(vt,O);break;default:var w="integer"===y&&!f;g=c().createElement(tr,{value:i||"",variant:"v2",fullWidth:!0,disabled:v,floatingLabelText:s,multiLine:"textarea"===y||"json"===y,type:w?"number":null,onChange:function(t,r){w&&(r=parseInt(r)),e.updateValue(o,r)},onKeyPress:function(t){"Enter"===t.key&&e.updateValue(o,i,!0)}})}if(p){var j=e.state.fields[o]||!1;d.push(c().createElement("div",{className:"infoPanelRow",key:o,style:{marginBottom:20}},c().createElement(l.Checkbox,{checked:j,label:s,onCheck:function(t,r){return e.onCheck(o,r)}}),j&&c().createElement("div",{className:"infoPanelValue"},g)))}else d.push(c().createElement("div",{key:o},g))}else{var P={name:o};switch(y){case"stars_rate":i=c().createElement(x,{node:a,column:P});break;case"choice":i=c().createElement(D,{node:a,column:P});break;case"css_label":i=c().createElement(F,{node:a,column:P});break;case"tags":i=c().createElement(Be,{node:a,column:P});break;case"date":i=c().createElement(ot,{node:a,column:P,type:y});break;case"integer":i=c().createElement(Vt,{node:a,column:P});break;case"boolean":h=i=i?"Yes":"No"}h&&b++,d.push(c().createElement("div",{className:"infoPanelRow"+(h?"":" no-value"),key:o},c().createElement("div",{className:"infoPanelLabel"},s),c().createElement("div",{className:"infoPanelValue"},i)))}}}));var v,h=i.MessageHash;if(u||b)return p&&(v=c().createElement("div",{style:{paddingBottom:16}},c().createElement("em",null,h["meta.user.12"])," ",h["meta.user.13"])),c().createElement("div",{style:Yt({width:"100%",overflowY:"scroll"},y)},v,d);var g={};return s&&(g={onClick:s,style:{cursor:"pointer"}}),c().createElement("div",g,c().createElement(rr,{pydio:this.props.pydio,iconClassName:"mdi mdi-tag-outline",primaryTextId:h["meta.user."+(s?"11":"16")],style:{padding:"10px 40px 20px",backgroundColor:"transparent"},iconStyle:{fontSize:40},legendStyle:{fontSize:13}}))}}],r&&Qt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component);function or(e){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(e)}function ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(r),!0).forEach((function(t){ur(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ur(e,t,r){return(t=lr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lr(n.key),n)}}function lr(e){var t=function(e,t){if("object"!==or(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===or(t)?t:String(t)}function sr(e,t){return sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sr(e,t)}function fr(e){return fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fr(e)}var pr=n().requireLib("workspaces").InfoPanelCard,yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fr(n);if(o){var r=fr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={},t._nodeObserver=function(){t.refs.panel&&t.refs.panel.resetUpdateData(),t.forceUpdate()},e.node&&e.node.observe("node_replaced",t._nodeObserver),t}return t=a,(r=[{key:"componentWillReceiveProps",value:function(e){this.props.node&&this.props.node.stopObserving("node_replaced",this._nodeObserver),e.node!==this.props.node&&this.refs.panel&&e.node.observe("node_replaced",this._nodeObserver)}},{key:"componentWillUnmount",value:function(){this.props.node&&this.props.node.stopObserving("node_replaced",this._nodeObserver)}},{key:"saveMeta",value:function(){var e=this.refs.panel.getUpdateData();return b.getInstance().saveMeta(this.props.pydio.getContextHolder().getSelectedNodes(),e)}},{key:"onChangeUpdateData",value:function(e){this.setState({updateData:e})}},{key:"render",value:function(){var e=this,t=[],r=this.props,n=r.pydio,o=r.node,i=r.popoverPanel,a=n.MessageHash,u=this.state.updateData||new Map,s="true"===o.getMetadata().get("node_readonly"),f=!1;!s&&u.size>0&&(f=!0,t.push(c().createElement(l.FlatButton,{key:"edit",label:a["meta.user.15"],onClick:function(){e.saveMeta()}})));var p={};return i&&(p=ar(ar({},p),{},{maxHeight:"80vh",overflowY:"auto"})),f||(p=ar(ar({},p),{},{paddingBottom:16})),c().createElement(pr,{identifier:"meta-user",style:this.props.style,title:this.props.pydio.MessageHash["meta.user.1"],actions:t.length?t:null,icon:"tag-multiple",iconColor:"#00ACC1",popoverPanel:i},c().createElement(nr,{ref:"panel",node:this.props.node,editMode:!s,pydio:this.props.pydio,onChangeUpdateData:function(t){e.onChangeUpdateData(t)},autoSave:function(){e.saveMeta()},style:p}))}}])&&cr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component);const dr=require("pydio/model/node");var mr=e.n(dr);const br=require("pydio/model/data-model");var vr=e.n(br);const hr=require("create-react-class");var gr=e.n(hr);const Or=require("prop-types");var wr=e.n(Or),jr=n().requireLib("boot"),Pr=jr.ActionDialogMixin,Sr=jr.CancelButtonProviderMixin,Er=jr.SubmitButtonProviderMixin;const Tr=gr()({displayName:"UserMetaDialog",propsTypes:{selection:wr().instanceOf(vr())},mixins:[Pr,Sr,Er],saveMeta:function(){var e=this.refs.panel.getUpdateData(),t={};return e.forEach((function(e,r){t[r]=e})),b.getInstance().saveMeta(this.props.selection.getSelectedNodes(),e)},submit:function(){var e=this;this.saveMeta().then((function(){e.dismiss()}))},render:function(){return c().createElement(nr,{pydio:this.props.pydio,multiple:!this.props.selection.isUnique(),ref:"panel",node:this.props.selection.isUnique()?this.props.selection.getUniqueNode():new(mr()),editMode:!0})}});function kr(e){return kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kr(e)}function xr(){return xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xr.apply(this,arguments)}function Cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==kr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==kr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===kr(o)?o:String(o)),n)}var o}function Mr(e,t){return Mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mr(e,t)}function Rr(e){return Rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rr(e)}var _r=Pydio.requireLib("hoc"),Dr=_r.ModernSelectField,Ir=_r.ModernTextField,Nr=_r.ThemedModernStyles,Vr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rr(n);if(o){var r=Rr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===kr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={},t}return t=a,r=[{key:"addSelectionValue",value:function(){var e=this.state,t=e.selectorNewKey,r=e.selectorNewValue,n=e.selectorNewColor,o=this.props,i=o.data,a=o.setAdditionalDataKey,u=i.items,c=void 0===u?[]:u;c.push({key:t,value:r,color:n}),a("items",c),this.setState({selectorNewKey:"",selectorNewValue:"",selectorNewColor:""})}},{key:"removeSelectionValue",value:function(e){var t=this.props,r=t.data,n=t.setAdditionalDataKey,o=r.items;n("items",(void 0===o?[]:o).filter((function(t){return t.key!==e})))}},{key:"renderColor",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r?c().createElement("span",{className:"mdi mdi-label"+(t?"":"-outline"),style:{color:t||"#ccc",marginRight:5}}):c().createElement("span",{style:{width:60,marginRight:6}},c().createElement(Dr,{disabled:r,fullWidth:!0,value:t,onChange:function(t,r,n){e.setState({selectorNewColor:n})}},c().createElement(l.MenuItem,{value:"",primaryText:c().createElement("span",{className:"mdi mdi-label-outline",style:{color:"#ccc"}})}),["#9c27b0","#607d8b","#66c","#69c","#6c6","#696","#c96","#ff9800","#c66","#fff","#ccc","#999","#000"].map((function(e){return c().createElement(l.MenuItem,{value:e,primaryText:c().createElement("span",{className:"mdi mdi-label",style:{color:e}})})}))))}},{key:"render",value:function(){var e=this,t=this.props,r=t.data,n=t.m,o=t.setAdditionalDataKey,i=t.muiTheme,a=this.state,s=a.selectorNewKey,f=a.selectorNewValue,p=a.selectorNewColor,y=r.items,d=void 0===y?[]:y,m=Nr(i);return c().createElement(u.Fragment,null,c().createElement("div",{style:{padding:10,paddingRight:0,backgroundColor:"#f5f5f5",borderRadius:3}},c().createElement("div",{style:{fontSize:13}},n("editor.selection")),c().createElement("div",null,d.map((function(t){var r=t.key,n=t.value,o=t.color;return c().createElement("div",{key:r,style:{display:"flex",alignItems:"center"}},e.renderColor(o,!0),c().createElement("span",{style:{marginRight:6,width:80}},c().createElement(Ir,{value:r,disabled:!0,fullWidth:!0})),c().createElement("span",{style:{flex:1}},c().createElement(Ir,{value:n,disabled:!0,fullWidth:!0})),c().createElement("span",null,c().createElement(l.IconButton,{iconClassName:"mdi mdi-delete",iconStyle:{color:"rgba(0,0,0,.3)"},onClick:function(){e.removeSelectionValue(r)}})))}))),c().createElement("div",{style:{display:"flex"},key:"new-selection-key"},this.renderColor(p),c().createElement("span",{style:{width:80,marginRight:6}},c().createElement(Ir,{value:s,onChange:function(t,r){e.setState({selectorNewKey:r})},hintText:n("editor.selection.key"),fullWidth:!0})),c().createElement("span",{style:{flex:1}},c().createElement(Ir,{value:f,onChange:function(t,r){e.setState({selectorNewValue:r})},hintText:n("editor.selection.value"),fullWidth:!0})),c().createElement("span",null,c().createElement(l.IconButton,{iconClassName:"mdi mdi-plus",onClick:function(){e.addSelectionValue()},disabled:!s||!f})))),c().createElement("div",null,c().createElement(l.Toggle,xr({label:n("editor.selection.steps"),labelPosition:"left",toggled:r.steps,onToggle:function(e,t){return o("steps",t)}},m.toggleFieldV2))))}}],r&&Cr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component);const Br=Vr=(0,G.muiThemeable)()(Vr);function Ar(e){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ar(e)}function Fr(){return Fr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fr.apply(this,arguments)}function Lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(r),!0).forEach((function(t){qr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qr(e,t,r){return(t=Jr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jr(n.key),n)}}function Jr(e){var t=function(e,t){if("object"!==Ar(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ar(t)?t:String(t)}function Kr(e,t){return Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kr(e,t)}function Hr(e){return Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hr(e)}var Yr=n().requireLib("hoc"),$r=Yr.ModernSelectField,Gr=Yr.ModernTextField,Qr=Yr.ThemedModernStyles,Xr={string:"Text",textarea:"Long Text",integer:"Number",boolean:"Boolean",date:"Date",choice:"Selection",tags:"Extensible Tags",stars_rate:"Stars Rating",css_label:"Color Labels",json:"JSON"},Zr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Hr(n);if(o){var r=Hr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ar(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"updateType",value:function(e){var t=this.props,r=t.namespace,n=t.onChange,o={type:e};"date"===o&&(o.data={format:"date",display:"normal"}),r.JsonDefinition=JSON.stringify(o),n(r)}},{key:"updateLabel",value:function(e){var t=this.props,r=t.create,n=t.namespace,o=t.onChange,i=t.forcePrefix,a=void 0===i?"":i;!r||n.Namespace&&n.Namespace!==a+Pe().computeStringSlug(n.Label)||this.updateName(e),n.Label=e,o(n)}},{key:"updateName",value:function(e){var t=this.props,r=t.namespace,n=t.onChange,o=t.forcePrefix,i=Pe().computeStringSlug(e);o&&0!==i.indexOf(o)&&(i=o+i),r.Namespace=i,n(r)}},{key:"getAdditionalData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props.namespace;try{var r=JSON.parse(t.JsonDefinition).data||e;return e.items&&r.split?{items:r.split(",").map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("|"),2);return{key:t[0],value:t[1]}}))}:r}catch(e){}return e}},{key:"setAdditionalDataKey",value:function(e,t){var r=this.props,n=r.namespace,o=r.onChange,i=JSON.parse(n.JsonDefinition),a=qr({},e,t);i.data=Ur(Ur({},i.data),a),n.JsonDefinition=JSON.stringify(i),o(n)}},{key:"render",value:function(){var e=this,t=this.props,r=t.pydio,n=t.create,o=t.namespace,i=t.readonly,a=t.labelError,s=t.nameError,f=t.styles,p=t.metaTypes,y=void 0===p?Xr:p,d=t.showMandatory,m=void 0!==d&&d,b=t.muiTheme,v=Qr(b),h=this.props.m;h||(h=function(e){return r.MessageHash["ajxp_admin.metadata."+e]||e});var g="string";return o.JsonDefinition&&(g=JSON.parse(o.JsonDefinition).type),c().createElement("div",null,c().createElement(Gr,{floatingLabelText:h("label"),value:o.Label,onChange:function(t,r){e.updateLabel(r)},fullWidth:!0,errorText:a,disabled:i,variant:"v2"}),c().createElement(Gr,{floatingLabelText:h("namespace"),disabled:!n,value:o.Namespace,onChange:function(t,r){e.updateName(r)},fullWidth:!0,errorText:s,variant:"v2"}),c().createElement("div",{style:f.section},h("type")),c().createElement($r,{hintText:h("type"),value:g,onChange:function(t,r,n){return e.updateType(n)},disabled:i,fullWidth:!0,variant:"v2"},Object.keys(y).map((function(e){return c().createElement(l.MenuItem,{value:e,primaryText:h("type."+e)||y[e]})}))),"choice"===g&&c().createElement(Br,{data:this.getAdditionalData({items:[],steps:!1}),setAdditionalDataKey:this.setAdditionalDataKey.bind(this),m:h}),"date"===g&&c().createElement(u.Fragment,null,c().createElement($r,{hintText:h("type.date.format"),value:this.getAdditionalData({format:"date",display:"normal"}).format,onChange:function(t,r,n){return e.setAdditionalDataKey("format",n)},disabled:i,fullWidth:!0,variant:"v2"},c().createElement(l.MenuItem,{value:"date",primaryText:h("type.date.format.date")}),c().createElement(l.MenuItem,{value:"date-time",primaryText:h("type.date.format.date-time")}),c().createElement(l.MenuItem,{value:"time",primaryText:h("type.date.format.time")})),c().createElement($r,{hintText:h("type.date.display"),value:this.getAdditionalData({format:"date",display:"normal"}).display,onChange:function(t,r,n){return e.setAdditionalDataKey("display",n)},disabled:i,fullWidth:!0,variant:"v2"},c().createElement(l.MenuItem,{value:"normal",primaryText:h("type.date.display.normal")}),c().createElement(l.MenuItem,{value:"relative",primaryText:h("type.date.display.relative")}))),"integer"===g&&c().createElement(u.Fragment,null,c().createElement($r,{hintText:h("type.integer.format"),value:this.getAdditionalData({format:"general"}).format||"general",onChange:function(t,r,n){return e.setAdditionalDataKey("format",n)},disabled:i,fullWidth:!0,variant:"v2"},c().createElement(l.MenuItem,{value:"general",primaryText:h("type.integer.format.general")}),c().createElement(l.MenuItem,{value:"bytesize",primaryText:h("type.integer.format.bytesize")}),c().createElement(l.MenuItem,{value:"percentage",primaryText:h("type.integer.format.percentage")}),c().createElement(l.MenuItem,{value:"progress",primaryText:h("type.integer.format.progress")}))),m&&c().createElement(u.Fragment,null,c().createElement(l.Toggle,Fr({},v.toggleFieldV2,{toggled:this.getAdditionalData({mandatory:!1}).mandatory,onToggle:function(t,r){e.setAdditionalDataKey("mandatory",r)},label:h("field.mandatory"),labelPosition:"right"}))))}}],r&&zr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c().Component);(Zr=(0,G.muiThemeable)()(Zr)).MetaTypes=Xr;const en=Zr;window.ReactMeta=t})();