(()=>{"use strict";var e={760:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},156:e=>{e.exports=function(e){return e[1]}},144:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(156),o=n.n(r),i=n(760),a=n.n(i)()(o());a.push([e.id,'div.user-badge.share-dialog {\n  border-bottom: 1px solid var(--md-sys-color-field-underline-idle);\n  clear: both;\n  font-size: 14px;\n  margin-left: 10px;\n  margin-right: 10px;\n  padding-top: 1px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  line-height: 20px;\n}\ndiv.user-badge.share-dialog .user-badge-label {\n  flex: 1;\n  font-size: 14px;\n  font-weight: 500;\n  padding: 9px 0;\n  line-height: 25px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\ndiv.user-badge.share-dialog:last-of-type {\n  border-bottom: 0;\n}\ndiv.user-badge.share-dialog span.icon-ellipsis-vertical.mui-font-icon {\n  color: #6F6F6F;\n  font-size: 18px;\n}\ndiv.user-badge.share-dialog .avatar {\n  background-color: #4aceb0;\n  border-radius: 50%;\n  color: white;\n  display: inline-block;\n  font-size: 17px;\n  height: 24px;\n  width: 24px;\n  margin: 5px 14px 7px 7px;\n  padding: 2px;\n  text-align: center;\n}\ndiv.user-badge.share-dialog img {\n  background-color: #4aceb0;\n  border-radius: 50%;\n  color: white;\n  display: inline-block;\n  font-size: 17px;\n  height: 24px;\n  margin: 5px 14px 7px -44px;\n  padding: 6px;\n  text-align: center;\n  width: 24px;\n}\ndiv.user-badge.share-dialog div.user-badge-menu-box {\n  font-size: 13px;\n  position: relative;\n}\ndiv.user-badge.share-dialog div.user-badge-menu-box div.mui-menu.mui-visible {\n  box-shadow: 0 0 5px rgba(0, 0, 0, 0.43);\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 200px;\n  z-index: 120;\n}\ndiv.user-badge.share-dialog div.user-badge-menu-box div.mui-menu span.icon-check {\n  float: right;\n  font-size: 16px;\n  margin-top: 15px;\n}\ndiv.user-badge.share-dialog span.user-badge-rights-container {\n  float: right;\n  padding: 11px;\n  color: gray;\n  font-size: 11px;\n  line-height: 25px;\n}\ndiv.user-badge.share-dialog span.user-badge-rights-container input[name="write"] {\n  margin-left: 28px;\n}\ndiv#share-form-users {\n  margin-top: 0 !important;\n}\n',""]);const s=a},247:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],u=i[c]||0,p="".concat(c," ").concat(u);i[c]=u+1;var f=n(p),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)t[f].references++,t[f].updater(d);else{var y=o(d,r);r.byIndex=s,t.splice(s,0,{identifier:p,updater:y,references:1})}a.push(p)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var l=r(e,o),c=0;c<i.length;c++){var u=n(i[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},938:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},767:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},549:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},415:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},35:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},566:e=>{e.exports=require("create-react-class")},455:e=>{e.exports=require("material-ui")},173:e=>{e.exports=require("material-ui/styles")},580:e=>{e.exports=require("prop-types")},757:e=>{e.exports=require("pydio")},689:e=>{e.exports=require("react")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};(()=>{n.r(r),n.d(r,{CellCard:()=>Zt,CompositeDialog:()=>vi,CreateCellDialog:()=>it,EditCellDialog:()=>Ct,InfoPanel:()=>mi,LinkModel:()=>cn,ShareHelper:()=>Ae,ShareView:()=>Wi,ShareViewModal:()=>Yi,SimpleLinkCard:()=>Bo});var e=n(689),t=n.n(e),o=n(580),i=n.n(o),a=n(757),s=n.n(a),l=n(455),c=n(173);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===u(o)?o:String(o)),r)}var o}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var h=n(580),m=n(689);function b(e){var t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(s,t);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(o);if(i){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"render",value:function(){var t=this.context,n={messages:t.messages,getMessage:t.getMessage,isReadonly:t.isReadonly};return m.createElement(e,p({},this.props,n))}}])&&f(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(m.Component);return t.contextTypes={messages:h.object,getMessage:h.func,isReadonly:h.func},t}const v=require("pydio/model/idm-object-helper");var g=n.n(v);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===w(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=n(173).muiThemeable,k=s().requireLib("components").UserAvatar,S=s().requireLib("boot").M3Tooltip;const x=j()((function(e){var n,r=e.size,o=void 0===r?24:r,i=e.idmObject,a=e.type,l=e.muiTheme,c=e.tooltip,u=void 0!==c&&c,p=e.style,f=void 0===p?{}:p,d=l.palette.avatarsColor,y=P({borderRadius:"50%",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:17,height:o,width:o},f);if(n="group"===a?t().createElement("span",{className:"mdi mdi-account-multiple",style:P(P({},y),{},{backgroundColor:d})}):"team"===a?t().createElement("span",{className:"mdi mdi-account-multiple-outline",style:P(P({},y),{},{backgroundColor:d})}):"temporary"===a?t().createElement("span",{className:"mdi mdi-account-plus",style:P(P({},y),{},{backgroundColor:d})}):"remote_user"===a?t().createElement("span",{className:"mdi mdi-account-network",style:P(P({},y),{},{backgroundColor:d})}):"more"===a?t().createElement("span",{style:P(P({},y),{},{backgroundColor:d})},"+ ",i):t().createElement("div",{style:{zIndex:y.zIndex}},t().createElement(k,{avatarSize:o,pydio:s().getInstance(),userId:i.Login,avatarOnly:!0,idmUser:i,userType:"user",useDefaultAvatar:!0,richOnClick:!1,richOnHover:!1,style:P({padding:0,lineHeight:"16px"},f)})),u){var h,m=s().getMessages();return h="more"===a?i>1?m["share_center.cell.participant.other.multiple"].replace("%d",i):m["share_center.cell.participant.other.single"]:g().extractLabelFromIdmObject(i),t().createElement(S,{PopperProps:{style:{zIndex:2200}},placement:"bottom",title:t().createElement("div",{style:{padding:"0 6px"}},h)},n)}return n}));function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===R(o)?o:String(o)),r)}var o}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}var C=n(580),T=n(455),D=T.MenuItem,I=T.IconMenu,A=T.IconButton,U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(o);if(i){var n=M(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"renderMenu",value:function(){if(!this.props.menus||!this.props.menus.length)return null;var e=this.props.menus.map((function(e){var n;return e.checked&&(n=t().createElement("span",{className:"mdi mdi-check"})),t().createElement(D,{primaryText:e.text,onClick:e.callback,rightIcon:n})}));return t().createElement(I,{iconButtonElement:t().createElement(A,{style:{width:30,height:30,padding:5},iconStyle:{fontSize:18},iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},desktop:!0},e)}},{key:"render",value:function(){var e=this.props,n=e.type,r=e.avatarUser,o=this.renderMenu(),i=this.props.boxes;return t().createElement("div",{className:"share-dialog user-badge user-type-"+this.props.type},t().createElement(x,{size:28,type:n,idmObject:r,style:{margin:"5px 14px 7px 7px"}}),t().createElement("span",{className:"user-badge-label"},this.props.label),o,i)}}])&&_(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.Component);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}function W(e,t,n){return(t=Y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e){var t=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===N(t)?t:String(t)}U.propTypes={label:C.string,avatar:C.string,type:C.string,menus:C.object};var G=n(580),X=n(689),Q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=V(r);if(o){var n=V(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return z(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return W(z(e=i.call.apply(i,[this].concat(n))),"onRemove",(function(){e.props.onUserObjectRemove(e.props.cellAcl.RoleId)})),W(z(e),"onInvite",(function(){var t={},n=PydioUsers.User.fromIdmUser(e.props.cellAcl.User);t[n.getId()]=n,e.props.sendInvitations(t)})),W(z(e),"onUpdateRight",(function(t,n){e.props.onUserObjectUpdateRight(e.props.cellAcl.RoleId,t,n)})),e}return t=a,(n=[{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.cellAcl,i=r.pydio,a=[],s=o.User?"user":o.Group?"group":"team";if(o.User&&o.User.Login===i.user.id)return null;switch("group"!==s&&this.props.sendInvitations&&a.push({text:this.props.getMessage("45"),callback:this.onInvite}),this.props.isReadonly()||this.props.readonly||a.push({text:this.props.getMessage("257",""),callback:this.onRemove}),s){case"user":e=o.User.Attributes.displayName||o.User.Login,t=o.User;break;case"group":e=o.Group.Attributes?o.Group.Attributes.displayName||o.Group.GroupLabel:o.Group.Uuid;break;case"team":e=o.Role?o.Role.Label:"No role found";break;default:e=o.RoleId}var c=!1,u=!1;o.Actions.map((function(e){"read"===e.Name&&(c=!0),"write"===e.Name&&(u=!0)}));var p=this.props.isReadonly()||this.props.readonly,f={display:"flex",width:70};a.length||(f=q(q({},f),{},{marginRight:48}));var d=X.createElement("span",{style:f},X.createElement(l.Checkbox,{disabled:p,checked:c,onCheck:function(e,t){n.onUpdateRight("read",t)}}),X.createElement(l.Checkbox,{disabled:p,checked:u,onCheck:function(e,t){n.onUpdateRight("write",t)}}));return X.createElement(U,{label:e,avatarUser:t,type:s,menus:a,boxes:d})}}])&&F(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(X.Component);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==K(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===K(o)?o:String(o)),r)}var o}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},J(e,t)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}W(Q,"propTypes",{cellAcl:G.object.isRequired,sendInvitations:G.func,onUserObjectRemove:G.func.isRequired,onUserObjectUpdateRight:G.func.isRequired}),Q=b(Q);var ee=n(580),te=n(689).Component,ne=n(455).IconButton,re=n(173).muiThemeable,oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$(r);if(o){var n=$(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){var e=this.props.muiTheme.palette,t=this.props,n=t.destructive,r=t.disabled,o=n?e.mui3.error:e.mui3.primary,i={root:{borderRadius:"50%",border:"1px solid "+o,backgroundColor:"transparent",width:36,height:36,padding:"8px 6px",margin:"0 6px",zIndex:0,opacity:r?.5:1},icon:{color:o,fontSize:20,lineHeight:"20px"}},a=this.props,s=a.tooltip,l=a.messageId,c=a.getMessage,u=a.messageCoreNamespace;return l&&c&&(s=this.props.getMessage(l,u||void 0)),React.createElement(ne,{style:i.root,iconStyle:i.icon,onClick:this.props.callback||this.props.onClick,iconClassName:this.props.mdiIcon?"mdi mdi-"+this.props.mdiIcon:this.props.iconClassName,tooltip:s,disabled:r,tooltipPosition:this.props.tooltipPosition})}}])&&Z(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(te);oe.propTypes={callback:ee.func,onClick:ee.func,mdiIcon:ee.string,messageId:ee.string},oe=b(oe);const ie=oe=re()(oe);function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fe(r.key),r)}}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}function pe(e,t,n){return(t=fe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e){var t=function(e,t){if("object"!==ae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ae(t)?t:String(t)}var de=s().requireLib("components").UsersCompleter,ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ue(o);if(i){var n=ue(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ce(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pe(ce(e=a.call.apply(a,[this].concat(n))),"sendInvitationToAllUsers",(function(){var t=e.props,n=t.cellAcls,r=t.pydio,o=[];Object.keys(n).map((function(e){var t=n[e];if((!t.User||t.User.Login!==r.user.id)&&t.User){var i=PydioUsers.User.fromIdmUser(t.User);o[i.getId()]=i}})),e.props.sendInvitations(o)})),pe(ce(e),"clearAllUsers",(function(){Object.keys(e.props.cellAcls).map((function(t){e.props.onUserObjectRemove(t)}))})),pe(ce(e),"valueSelected",(function(t){t.IdmUser?e.props.onUserObjectAdd(t.IdmUser):e.props.onUserObjectAdd(t.IdmRole)})),e}return n=s,(r=[{key:"render",value:function(){var e=this,n=this.props,r=n.cellAcls,o=n.pydio,i=n.completerStyle,a=n.muiTheme,s=o.getPluginConfigs("core.auth"),l=0,c=[];Object.keys(r).map((function(n){var i=r[n];i.User&&i.User.Login===o.user.id||(l++,c.push(t().createElement(Q,{cellAcl:i,key:l,pydio:e.props.pydio,readonly:e.props.readonly,sendInvitations:e.props.sendInvitations,onUserObjectRemove:e.props.onUserObjectRemove,onUserObjectUpdateRight:e.props.onUserObjectUpdateRight})))}));var u,p,f=[],d=Object.keys(this.props.cellAcls).length;if(!d||this.props.isReadonly()||this.props.readonly||f.push(t().createElement(ie,{key:"clear",callback:this.clearAllUsers,tooltipPosition:"top-center",mdiIcon:"account-minus",messageId:"180"})),d&&this.props.sendInvitations&&f.push(t().createElement(ie,{key:"invite",callback:this.sendInvitationToAllUsers,tooltipPosition:"top-center",mdiIcon:"email-outline",messageId:"45"})),this.props.saveSelectionAsTeam&&d>1&&!this.props.isReadonly()&&!this.props.readonly&&f.push(t().createElement(ie,{key:"team",callback:this.props.saveSelectionAsTeam,mdiIcon:"account-multiple-plus",tooltipPosition:"top-center",messageId:"509",messageCoreNamespace:!0})),this.props.withActionLinks&&(f=this.props.withActionLinks(f)),c.length){var y="rgba(0,0,0,.33)";"mui3"===a.userTheme&&(y=a.palette.mui3.outline),u=t().createElement("div",{style:{display:"flex",marginBottom:-8,marginTop:-8,color:y,fontSize:12}},t().createElement("div",{style:{flex:1}}),t().createElement("div",{style:{width:43,textAlign:"center",overflow:"hidden",textOverflow:"ellipsis"}},this.props.getMessage("361","")),t().createElement("div",{style:{width:43,textAlign:"center",overflow:"hidden",textOverflow:"ellipsis"}},this.props.getMessage("181")),t().createElement("div",{style:{width:6}}))}if(!this.props.isReadonly()&&!this.props.readonly){var h=Object.values(r).map((function(e){return e.User?e.User.Login:e.Group?e.Group.Uuid:e.Role?e.Role.Uuid:null})).filter((function(e){return!!e})),m=s.get("USER_CREATE_USERS");p=t().createElement(de,{className:"share-form-users",fieldLabel:this.props.getMessage(m?"34":"34b"),onValueSelected:this.valueSelected,pydio:this.props.pydio,showAddressBook:!0,usersFrom:"local",excludes:h,existingOnly:!m})}return t().createElement("div",null,t().createElement("div",{style:i||{margin:"0 8px 16px"}},p),u,t().createElement("div",null,c),!c.length&&t().createElement("div",{style:{color:a.palette.mui3["on-surface-variant"],fontWeight:500,margin:"0 10px"}},this.props.getMessage("182")),c.length>0&&t().createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},f))}}])&&se(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);pe(ye,"propTypes",{pydio:i().instanceOf(s()),cellAcls:i().object,saveSelectionAsTeam:i().func,sendInvitations:i().func,showTitle:i().bool,onUserObjectAdd:i().func.isRequired,onUserObjectRemove:i().func.isRequired,onUserObjectUpdateRight:i().func.isRequired}),ye=b((0,c.muiThemeable)()(ye));const he=require("pydio/model/data-model");var me=n.n(he);function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function ve(e){return function(e){if(Array.isArray(e))return ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===be(o)?o:String(o)),r)}var o}function Oe(e,t){return Oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Oe(e,t)}function Pe(e){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pe(e)}var Ee=s().requireLib("components").FoldersTree,je=s().requireLib("hoc").ThemedContainers.Popover,ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Pe(o);if(i){var n=Pe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e);var r=e.pydio.user,o=[];r.getRepositoriesList().forEach((function(e){if("gateway"===e.getAccessType()){if(e.getId()===r.activeRepository){if("shared"===e.getOwner())return;n=e}o.push(e)}}));var i,l,c=o.filter((function(e){return!e.getOwner()})),u=o.filter((function(e){return e.getOwner()}));if((l=c.length&&u.length?[].concat(ve(c),["DIVIDER"],ve(u)):[].concat(ve(c),ve(u))).length){n||(n=l[0]);var p=(i=me().RemoteDataModelFactory({tmp_repository_id:n.getId()})).getRootNode();p.getMetadata().set("repository_id",n.getId()),p.load(i.getAjxpNodeProvider())}return t.state={dataModel:i,open:!1,availableWs:l,crtWs:n},t}return n=s,(r=[{key:"switchWorkspace",value:function(e){var t=me().RemoteDataModelFactory({tmp_repository_id:e.getId()}),n=t.getRootNode();n.getMetadata().set("repository_id",e.getId()),n.load(t.getAjxpNodeProvider()),this.setState({crtWs:e,dataModel:t})}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.setState({open:!0,anchorEl:e.currentTarget})}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"onValidateNode",value:function(){var e=this.state,t=e.node,n=e.crtWs;this.props.model.addRootNode(t,n.getId()),this.handleRequestClose()}},{key:"onNodeSelected",value:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({node:e})}},{key:"renderNodeLine",value:function(e){var n=this.props.model;return t().createElement(l.ListItem,{disabled:!0,leftIcon:t().createElement(l.FontIcon,{style:{fontSize:20,margin:"14px 12px"},className:"mdi mdi-"+("LEAF"===e.Type?"file-outline":"folder-outline")}),primaryText:n.getNodeLabelInContext(e),innerDivStyle:{paddingLeft:52,fontSize:14,fontWeight:500},rightIconButton:t().createElement(l.IconButton,{onClick:function(){n.removeRootNode(e.Uuid)},iconClassName:"mdi mdi-delete",tooltip:"Remove",iconStyle:{color:"var(--md-sys-color-primary)"}})})}},{key:"render",value:function(){var e,n=this,r=this.props,o=r.model,i=r.muiTheme,a=r.mode,s=r.pydio,c=function(e){return s.MessageHash["share_center."+e]},u=o.getRootNodes()||[],p=[];u.map((function(e){p.push(n.renderNodeLine(e)),p.push(t().createElement(l.Divider,{inset:!1}))})),p.pop(),u.length||"edit"!==a||(e=t().createElement("div",{style:{fontStyle:"italic",padding:20,textAlign:"center"}},c(280)));var f=t().createElement(l.RaisedButton,{label:c(282),onClick:this.handleTouchTap.bind(this),primary:"edit"===a,secondary:"edit"!==a,style:{marginBottom:10,width:"100%"},icon:t().createElement(l.FontIcon,{className:"mdi mdi-folder-plus",style:{fontSize:20,marginTop:-4}})}),d=this.state,y=d.node,h=d.availableWs,m=d.crtWs;return t().createElement("div",null,t().createElement(l.List,null,p),e,f,t().createElement(je,{open:this.state.open,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},t().createElement("div",{style:{width:372,height:300,display:"flex",flexDirection:"column"}},t().createElement(l.DropDownMenu,{style:{height:54},value:m,onChange:function(e,t,r){n.switchWorkspace(r)}},h.map((function(e){return"DIVIDER"===e?t().createElement(l.Divider,null):t().createElement(l.MenuItem,{value:e,primaryText:e.getLabel()})}))),t().createElement(l.Divider,null),t().createElement("div",{style:{marginLeft:-26,flex:"1",overflowY:"auto",fontSize:15}},t().createElement(Ee,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!1,draggable:!1})),t().createElement(l.Divider,null),t().createElement("div",{style:{display:"flex",padding:"4px 16px",alignItems:"center",fontSize:15,background:"var(--md-sys-color-surface-5)"}},t().createElement("div",{style:{flex:1,opacity:y&&y.getPath()?1:.5}},y&&y.getPath()||c(283)),t().createElement(l.IconButton,{iconStyle:{color:i.palette.primary1Color},disabled:!y,iconClassName:"mdi mdi-plus-circle-outline",onClick:this.onValidateNode.bind(this)})))))}}])&&we(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);ke=(0,c.muiThemeable)()(ke);const Se=require("pydio/model/cell");var xe=n.n(Se);const Re=require("pydio/util/xml");var _e=n.n(Re);const Le=require("pydio/http/api");var Me=n.n(Le);const Ce=require("cells-sdk");function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Te(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Te(o)?o:String(o)),r)}var o}var Ie=s().requireLib("boot").moment,Ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"mailerSupported",value:function(e){return e.Parameters.get("validMailer")}},{key:"getAuthorizations",value:function(){var e=s().getInstance(),t=e.getPluginConfigs("action.share"),n={folder_public_link:t.get("ENABLE_FOLDER_PUBLIC_LINK"),folder_workspaces:t.get("ENABLE_FOLDER_INTERNAL_SHARING"),file_public_link:t.get("ENABLE_FILE_PUBLIC_LINK"),file_workspaces:t.get("ENABLE_FILE_INTERNAL_SHARING"),editable_hash:t.get("HASH_USER_EDITABLE"),hash_min_length:t.get("HASH_MIN_LENGTH")||6,password_mandatory:!1,max_expiration:t.get("FILE_MAX_EXPIRATION"),max_downloads:t.get("FILE_MAX_DOWNLOAD"),cells_max_expiration:t.get("CELLS_MAX_EXPIRATION")},r=t.get("SHARE_FORCE_PASSWORD");return r&&(n.password_mandatory=!0),n.password_placeholder=r?e.MessageHash["share_center.176"]:e.MessageHash["share_center.148"],n}},{key:"buildPublicUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.Parameters;if(n)return"..."+r.get("PUBLIC_BASEURI")+"/"+t.LinkHash;if(t.LinkUrl&&t.LinkUrl.match(new RegExp("^http://|^https://")))return t.LinkUrl;var o=e.getFrontendUrl();return"".concat(o.protocol,"//").concat(o.host)+r.get("PUBLIC_BASEURI")+"/"+t.LinkHash}},{key:"nodeHasEditor",value:function(e,t){if(!t.getMetadata().has("mime_has_preview_editor")){var n=e.Registry.findEditorsForMime(t.getAjxpMime()),r=(n=n.filter((function(e){return"editor.browser"!==e.id&&"editor.other"!==e.id}))).filter((function(e){return e.canWrite}));t.getMetadata().set("mime_has_preview_editor",n.length>0),t.getMetadata().set("mime_has_writeable_editor",r.length>0)}return{preview:t.getMetadata().get("mime_has_preview_editor"),writeable:t.getMetadata().get("mime_has_writeable_editor")}}},{key:"compileLayoutData",value:function(t,n){var r,o,i=n.getNode();if(i.isLeaf()?(o=i.getAjxpMime(),r=_e().XPathSelectNodes(t.getXmlRegistry(),"//template[contains(@name, 'unique_preview_')]")):r=_e().XPathSelectNodes(t.getXmlRegistry(),"//template[contains(@name, 'minisite_')]"),!r.length)return[];if(1===r.length)return[{LAYOUT_NAME:r[0].getAttribute("element"),LAYOUT_LABEL:""}];var a=t.Parameters.get("theme"),s=[];return r.map((function(n){var r=n.getAttribute("theme");if(!r||r===a){var l=n.getAttribute("element"),c=n.getAttribute("name"),u=n.getAttribute("label");o&&"unique_preview_file"===c&&!e.nodeHasEditor(t,i).preview||(u?MessageHash[u]&&(u=MessageHash[u]):u=n.getAttribute("name"),s[c]=l,s.push({LAYOUT_NAME:c,LAYOUT_ELEMENT:l,LAYOUT_LABEL:u}))}})),s}},{key:"forceMailerOldSchool",value:function(){return n.g.pydio.getPluginConfigs("action.share").get("EMAIL_INVITE_EXTERNAL")}},{key:"qrcodeEnabled",value:function(){return n.g.pydio.getPluginConfigs("action.share").get("CREATE_QRCODE")}},{key:"sendCellInvitation",value:function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=e.prepareEmail(t,null,n),a=i.templateId,l=i.templateData,c=new Ce.MailerMail,u=new Ce.MailerServiceApi(Me().getRestClient());c.To=[];var p=0;Object.keys(r).map((function(e){var t=r[e],n=new Ce.MailerUser;return t.IdmUser&&t.IdmUser.Login&&t.IdmUser.Attributes&&(t.IdmUser.Attributes.hasEmail||t.IdmUser.Attributes.email)?(n.Uuid=t.IdmUser.Login,c.To.push(n)):p++,n}));var f=s().getInstance().MessageHash;if(c.To.length){c.TemplateId=a,c.TemplateData=l,u.send(c).then((function(){o()}));var d=f["core.mailer.1"].replace("%s",c.To.length);p>0&&(d+=" "+f["core.mailer.entries.ignored"]),s().getInstance().UI.displayMessage("SUCCESS",d)}else s().getInstance().UI.displayMessage("ERROR",f["core.mailer.entries.ignored"])}},{key:"prepareEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={},o="",i=pydio.user;if(i.getPreference("displayName")?r.Inviter=i.getPreference("displayName"):r.Inviter=i.id,t){var a=t.getLink();if(e.isLeaf()?(o="PublicFile",r.FileName=a.Label||e.getLabel()):(o="PublicFolder",r.FolderName=a.Label||e.getLabel()),r.LinkPath="/public/"+a.LinkHash,a.MaxDownloads&&(r.MaxDownloads=a.MaxDownloads+""),a.AccessEnd){var s=Ie(new Date(1e3*a.AccessEnd));r.Expire=s.format("LL")}}else o="Cell",r.Cell=n.getLabel();return{templateId:o,templateData:r,message:"",linkModel:t}}}],null&&De(t.prototype,null),r&&De(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ue(e){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ue(e)}function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ne.apply(this,arguments)}function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){We(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ye(r.key),r)}}function He(e,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},He(e,t)}function ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ve(e){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ve(e)}function We(e,t,n){return(t=Ye(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ye(e){var t=function(e,t){if("object"!==Ue(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ue(t)?t:String(t)}var Ge=s().requireLib("hoc"),Xe=Ge.ModernTextField,Qe=Ge.DatePicker,Ke=Ge.ThemedModernStyles,Ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&He(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ve(o);if(i){var n=Ve(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ze(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return We(ze(e=a.call.apply(a,[this].concat(n))),"formatDate",(function(t){return e.props.pydio.MessageHash.date_format.split(" ").shift().replace("Y",t.getFullYear()).replace("m",t.getMonth()+1).replace("d",t.getDate())})),e}return n=s,(r=[{key:"render",value:function(){var e,n,r,o,i=this.props,a=i.pydio,s=i.model,c=i.muiTheme,u=i.labelFocus,p=i.labelEnter,f=i.createLabels,d=i.style,y=function(e){return a.MessageHash["share_center."+e]},h=Ke(c);if(s&&s.cell){var m=Ae.getAuthorizations();m.cells_max_expiration&&(n=new Date(1e3*(Math.round(new Date/1e3)+60*parseInt(m.cells_max_expiration)*60*24))),r=function(e,t){if(null===t)s.cell.AccessEnd="-1";else{var n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());s.cell.AccessEnd=Math.floor(n/1e3)}s.notifyDirty()},s.cell.AccessEnd&&parseInt(s.cell.AccessEnd)>0&&(e=new Date(1e3*parseInt(s.cell.AccessEnd)),o=t().createElement(l.IconButton,{iconStyle:{color:"var(--md-sys-color-secondary)"},style:{position:"absolute",right:0,bottom:0,zIndex:1},iconClassName:"mdi mdi-close-circle",onClick:function(){r(null,null)}}))}return t().createElement("div",{style:qe({padding:"0 8px"},d)},t().createElement(Xe,{floatingLabelText:y(f?276:267),value:s.getLabel(),onChange:function(e,t){s.setLabel(t)},fullWidth:!0,variant:"v2",focusOnMount:u,onKeyPress:function(e){p&&"Enter"===e.key&&s.getLabel()&&p()}}),t().createElement(Xe,{floatingLabelText:y(f?277:268),value:s.getDescription(),onChange:function(e,t){s.setDescription(t)},fullWidth:!0,variant:"v2"}),t().createElement("div",{style:{position:"relative"}},t().createElement(Qe,Ne({ref:"expirationDate",key:"start",value:e,minDate:new Date,maxDate:n,autoOk:!0,onChange:r,showYearSelector:!0,floatingLabelText:y("21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},h.textFieldV2,{style:{flex:1},textFieldStyle:qe(qe({},h.textFieldV2.style),{},{flex:1})})),o))}}])&&Fe(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.Component);function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ot(r.key),r)}}function et(e,t){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},et(e,t)}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nt(e){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nt(e)}function rt(e,t,n){return(t=ot(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ot(e){var t=function(e,t){if("object"!==Je(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Je(t)?t:String(t)}Ze=b((0,c.muiThemeable)()(Ze));var it=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&et(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nt(o);if(i){var n=nt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Je(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return tt(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rt(tt(e=a.call.apply(a,[this].concat(n))),"state",{step:"users",model:new(xe()),saving:!1}),rt(tt(e),"submit",(function(){var t=e.state.model;e.setState({saving:!0}),t.save().then((function(t){e.props.onDismiss(),e.setState({saving:!1})})).catch((function(t){pydio.UI.displayMessage("ERROR",t.message),e.setState({saving:!1})}))})),rt(tt(e),"m",(function(t){return e.props.pydio.MessageHash["share_center."+t]})),rt(tt(e),"computeSummaryString",(function(){var t,n=e.state.model,r=0,o=0,i=0,a=[],s=n.getAcls();return Object.keys(s).map((function(e){var t=s[e];t.Group?o++:t.Role?i++:r++})),r&&a.push(r+" "+e.m(270)),o&&a.push(o+" "+e.m(271)),i&&a.push(i+" "+e.m(272)),t=3===a.length?a[0]+", "+a[1]+e.m(274)+a[3]:0===a.length?e.m(273):a.join(e.m(274)),e.m(269).replace("%USERS",t)})),e}return n=s,r=[{key:"getChildContext",value:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return e[n+(n?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){var e=this;this.state.model.observe("update",(function(){e.forceUpdate()}))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"render",value:function(){var e,n=this,r=[],o="20px",i=this.props,a=i.pydio,s=i.muiTheme,c=this.state,u=c.step,p=c.model,f=c.saving,d=a.MessageHash[418];return"users"!==u&&(d=p.getLabel()),"users"===u?(e=t().createElement("div",null,t().createElement("div",null,this.m(275)),t().createElement(Ze,{pydio:a,model:p,style:{padding:0},muiTheme:s,labelFocus:!0,labelEnter:function(){return n.submit()},createLabels:!0})),p.getLabel()&&(r.push(t().createElement(l.FlatButton,{key:"quick",primary:!0,disabled:!p.getLabel()||f,label:this.m("cells.create.advanced"),onClick:function(){n.setState({step:"data"})}})),r.push(t().createElement("span",{style:{display:"inline-block",margin:"0  10px",fontSize:14,fontWeight:500,color:"#9E9E9E"}},this.m("cells.create.buttons.separator")))),r.push(t().createElement(l.RaisedButton,{key:"next1",disabled:!p.getLabel()||f,primary:!0,label:this.m(279),onClick:function(){n.submit()}}))):"data"===u?(e=t().createElement("div",null,t().createElement("h5",{style:{marginTop:-10,padding:"0 10px"}},this.m(278)),t().createElement(ye,{pydio:a,cellAcls:p.getAcls(),excludes:[a.user.id],onUserObjectAdd:p.addUser.bind(p),onUserObjectRemove:p.removeUser.bind(p),onUserObjectUpdateRight:p.updateUserRight.bind(p)})),o="10px",r.push(t().createElement(l.FlatButton,{key:"prev1",primary:!1,label:a.MessageHash[304],onClick:function(){n.setState({step:"users"})}})),r.push(t().createElement(l.FlatButton,{key:"next2",primary:!0,label:a.MessageHash[179],onClick:function(){return n.setState({step:"label"})}}))):(e=t().createElement("div",null,t().createElement("h5",{style:{marginTop:-10}},this.m("cells.create.title.fill.folders")),t().createElement("div",{style:{color:"var(--md-sys-color-outline)",paddingTop:10}},this.computeSummaryString()),t().createElement("div",{style:{paddingTop:16}},t().createElement(ke,{pydio:a,model:p}))),r.push(t().createElement(l.FlatButton,{key:"prev2",primary:!1,label:a.MessageHash[304],onClick:function(){n.setState({step:"data"})}})),r.push(t().createElement(l.RaisedButton,{key:"submit",disabled:f,primary:!0,label:this.m(279),onClick:this.submit.bind(this)}))),t().createElement("div",{style:{width:380,fontSize:13,display:"flex",flexDirection:"column",minHeight:300}},t().createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:20}},t().createElement(l.FontIcon,{className:"icomoon-cells-full-plus"}),t().createElement("div",{style:{padding:20,fontSize:22}},d)),t().createElement("div",{style:{padding:"20px "+o+" 10px",flex:1}},e),t().createElement("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"flex-end"}},r))}}],r&&$e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function st(e){return function(e){if(Array.isArray(e))return lt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e,t,n){return(t=ht(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ht(r.key),r)}}function yt(e,t,n){return t&&dt(e.prototype,t),n&&dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ht(e){var t=function(e,t){if("object"!==at(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===at(t)?t:String(t)}function mt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}function vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gt(e);if(t){var o=gt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===at(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gt(e)}rt(it,"childContextTypes",{messages:i().object,getMessage:i().func,isReadonly:i().func}),it=(0,c.muiThemeable)()(it);var wt=function(e){mt(r,e);var n=vt(r);function r(){return ft(this,r),n.apply(this,arguments)}return yt(r,[{key:"render",value:function(){var e=this.props,n=e.tabs,r=e.active,o=e.onChange,i=e.style,a=e.muiTheme,s=a.palette.mui3["on-surface-variant"],c=a.palette.mui3.primary;return t().createElement("div",{style:ut({display:"flex"},i)},n.map((function(e){var n=e.Value===r,i=e.Label;return e.Icon&&(i=t().createElement("span",null,t().createElement("span",{className:e.Icon,style:{marginLeft:-5}})," ",e.Label)),t().createElement(l.FlatButton,{label:i,onClick:function(){o(e.Value)},primary:n,style:{flex:1,height:46,lineHeight:"46px",borderRadius:0,borderBottom:"3px solid "+(n?c:"transparent")},labelStyle:{textTransform:"none",fontSize:13,paddingLeft:8,paddingRight:8,color:n?c:s}})})))}}]),r}(t().Component);wt=(0,c.muiThemeable)()(wt);var Ot=function(e){mt(n,e);var t=vt(n);function n(){return ft(this,n),t.apply(this,arguments)}return yt(n,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.active,r=null;return t.map((function(e){e.Value===n&&(r=e.Component)})),r}}]),n}(t().Component),Pt=function(e){mt(r,e);var n=vt(r);function r(e){var t;return ft(this,r),(t=n.call(this,e)).state={left:e.tabs.left.length?e.tabs.left[0].Value:"",right:e.tabs.right.length?e.tabs.right[0].Value:""},e.defaultLeft&&(t.state.left=e.defaultLeft),e.defaultRight&&(t.state.right=e.defaultRight),t}return yt(r,[{key:"componentWillReceiveProps",value:function(e){!this.props.defaultLeft&&e.defaultLeft?this.setState({left:e.defaultLeft}):!this.state.left&&e.tabs.left.length&&this.setState({left:e.tabs.left[0].Value}),!this.props.defaultRight&&e.defaultRight?this.setState({right:e.defaultRight}):!this.state.right&&e.tabs.right.length&&this.setState({right:e.tabs.right[0].Value})}},{key:"render",value:function(){var e=this,n=this.props,r=n.tabs,o=n.header,i=n.onSaveAction,a=n.onCloseAction,s=n.onRevertAction,c=n.saveEnabled,u=n.style,p=n.pydio,f=n.editorOneColumn,d=this.state,y=d.left,h=d.right;if(f){var m=[].concat(st(r.left),st(r.right)),b=m.filter((function(e){return e.AlwaysLast}));return b.length&&(m=[].concat(st(m.filter((function(e){return!e.AlwaysLast}))),st(b))),m.length&&0===m.filter((function(e){return e.Value===y})).length&&(y=m[0].Value),t().createElement("div",{style:ut({display:"flex",flexDirection:"column",height:"100%"},u)},t().createElement("div",{style:{display:"flex",alignItems:"center"}},t().createElement("div",{style:{flex:1,padding:10}},o),t().createElement(l.IconButton,{iconClassName:"mdi mdi-close",tooltip:p.MessageHash[86],onClick:a,style:{marginRight:10}})),t().createElement("div",{style:{display:"flex"}},t().createElement(wt,{tabs:m,active:y,style:{flex:1,padding:"0 16px"},onChange:function(t){e.setState({left:t})}})),t().createElement(l.Divider,{style:{flexShrink:0,marginRight:16,marginLeft:16}}),t().createElement("div",{style:{display:"flex",flex:1,overflow:"hidden"}},t().createElement("div",{style:ut({overflowY:"auto",width:"100%",height:"100%"},r.leftStyle)},t().createElement(Ot,{tabs:m,active:y}))),t().createElement(l.Divider,{style:{flexShrink:0,marginRight:16,marginLeft:16}}),t().createElement("div",{style:{padding:10,display:"flex",alignItems:"center",justifyContent:"flex-end"}},t().createElement(l.FlatButton,{disabled:!c,label:p.MessageHash[628],onClick:s,style:{marginLeft:10}}),t().createElement(l.RaisedButton,{disabled:!c,label:p.MessageHash[53],onClick:i})))}return r.left&&r.left.length&&0===r.left.filter((function(e){return e.Value===y})).length&&(y=r.left[0].Value),r.right&&r.right.length&&0===r.right.filter((function(e){return e.Value===y})).length&&(h=r.right[0].Value),t().createElement("div",{style:ut({display:"flex",flexDirection:"column",height:"100%"},u)},t().createElement("div",{style:{display:"flex",alignItems:"center",padding:10,paddingBottom:0}},t().createElement("div",{style:{flex:1,alignItems:"center",paddingRight:20}},o),t().createElement(l.RaisedButton,{disabled:!c,primary:!0,label:p.MessageHash[53],onClick:i}),t().createElement(l.FlatButton,{disabled:!c,label:p.MessageHash[628],onClick:s,style:{marginLeft:10}}),t().createElement(l.IconButton,{iconClassName:"mdi mdi-close",tooltip:p.MessageHash[86],onClick:a,style:{marginLeft:10}})),t().createElement("div",{style:{display:"flex"}},t().createElement(wt,{tabs:r.left,active:y,style:{flex:1,margin:"0 16px"},onChange:function(t){e.setState({left:t})}}),t().createElement(wt,{tabs:r.right,active:h,style:{flex:1,margin:"0 16px"},onChange:function(t){e.setState({right:t})}})),t().createElement(l.Divider,{style:{flexShrink:0,display:"none"}}),t().createElement("div",{style:{display:"flex",flex:1,overflow:"hidden",padding:"0 5px 5px"}},t().createElement(l.Paper,{zDepth:1,style:ut({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},r.leftStyle)},t().createElement(Ot,{tabs:r.left,active:y})),t().createElement(l.Paper,{zDepth:1,style:ut({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},r.rightStyle)},t().createElement(Ot,{tabs:r.right,active:h}))))}}]),r}(t().Component);function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_t(r.key),r)}}function kt(e,t){return kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kt(e,t)}function St(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xt(e){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xt(e)}function Rt(e,t,n){return(t=_t(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _t(e){var t=function(e,t){if("object"!==Et(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Et(t)?t:String(t)}var Lt=n(689),Mt=s().requireLib("components").ResourcePoliciesPanel,Ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xt(r);if(o){var n=xt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return St(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Rt(St(e=i.call.apply(i,[this].concat(n))),"submit",(function(){var t=e.props,n=t.model,r=t.pydio,o=n.hasDirtyRootNodes();n.save().then((function(t){e.forceUpdate(),o&&n.getUuid()===r.user.getActiveRepository()&&(r.goTo("/"),r.fireContextRefresh())})).catch((function(e){r.UI.displayMessage("ERROR",e.message)}))})),e}return t=a,n=[{key:"getChildContext",value:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return e[n+(n?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}}}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.model,r=e.sendInvitations,o=function(e){return t.MessageHash["share_center."+e]},i={leftStyle:{padding:10},rightStyle:{padding:10},left:[{Label:o(54),Value:"users",Component:Lt.createElement(ye,{pydio:t,cellAcls:n.getAcls(),excludes:[t.user.id],sendInvitations:r,onUserObjectAdd:n.addUser.bind(n),onUserObjectRemove:n.removeUser.bind(n),onUserObjectUpdateRight:n.updateUserRight.bind(n)})},{Label:o("35"),Value:"base",Component:Lt.createElement(Ze,{pydio:t,model:n})},{Label:o(253),Value:"permissions",AlwaysLast:!0,Component:Lt.createElement(Mt,{pydio:t,resourceType:"cell",description:o("cell.visibility.advanced"),resourceId:n.getUuid(),style:{margin:-10},skipTitle:!0,onSavePolicies:function(){},readonly:!1,cellAcls:n.getAcls()})}],right:[{Label:o(249),Value:"content",Component:Lt.createElement(ke,{pydio:t,model:n,mode:"edit"})}]};return Lt.createElement(Pt,{pydio:t,tabs:i,header:Lt.createElement("div",{style:{fontSize:22,lineHeight:"26px",padding:6}},n.getLabel()),editorOneColumn:this.props.editorOneColumn,saveEnabled:n.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){n.revertChanges()}})}}],n&&jt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Lt.Component);Rt(Ct,"childContextTypes",{messages:i().object,getMessage:i().func,isReadonly:i().func});const Tt=require("pydio/http/resources-manager");var Dt=n.n(Tt);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){Nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==It(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===It(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bt=function(e){var n=e.acls,r=e.max,o=void 0===r?6:r,i=e.size,a=void 0===i?32:i,s={border:"2px solid var(--md-sys-color-surface-variant)"},l=Object.keys(n).map((function(e,t){var r,o,i=n[e];if(i.User)r="user",o=i.User;else if(i.Group)r="group",o=i.Group;else{if(!i.Role)return null;r="team",o=i.Role}var a=Ut({},s);return t>0&&(a.marginLeft=-10,a.zIndex=2*t),{type:r,object:o,style:a}})).filter((function(e){return null!==e}));if(l.length>o){var c=l.length-o;(l=l.slice(0,o)).push({type:"more",object:c,style:Ut(Ut({},s),{},{marginLeft:-10,zIndex:16,fontWeight:500,fontSize:14})})}return t().createElement("div",{style:{display:"flex",height:a}},l.map((function(e){var n=e.type,r=e.object,o=e.style;return t().createElement(x,{size:a,type:n,idmObject:r,style:o,tooltip:!0})})))};function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Ft(){return Ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ft.apply(this,arguments)}function Ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==qt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===qt(o)?o:String(o)),r)}var o}function zt(e,t){return zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zt(e,t)}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}var Wt=s().requireLib("boot").moment,Yt=s().requireLib("components"),Gt=Yt.GenericCard,Xt=Yt.GenericLine,Qt=Yt.Mui3CardLine,Kt=Yt.QuotaUsageLine,Zt=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zt(e,t)}(c,n);var r,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vt(i);if(a){var n=Vt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===qt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).state={edit:!1,model:new(xe()),loading:!0},t._observer=function(){t.forceUpdate()},Dt().loadClass("PydioActivityStreams").then((function(e){t.setState({asLib:e})})),Dt().loadClass("PydioCoreActions").then((function(e){t.setState({coreActionsLib:e})}));var n=t.props.rootNode;return n&&(n.getMetadata().has("virtual_root")?n.isLoaded()?(t.state.rootNodes=[],n.getChildren().forEach((function(e){return t.state.rootNodes.push(e)}))):(n.observe("loaded",(function(){var e=[];n.getChildren().forEach((function(t){return e.push(t)})),t.setState({rootNodes:e})})),n.load()):t.state.rootNodes=[n]),t}return r=c,(o=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.pydio,r=t.cellId;n.user.activeRepository===r?n.user.getActiveRepositoryAsCell().then((function(t){t?(e.setState({model:t,loading:!1}),t.observe("update",e._observer)):e.setState({loading:!1})})):(this.state.model.observe("update",(function(){e.setState({loading:!1}),e.forceUpdate()})),this.state.model.load(this.props.cellId))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update",this._observer)}},{key:"usersInvitations",value:function(e){Ae.sendCellInvitation(this.props.node,this.state.model,e)}},{key:"render",value:function(){var n,r=this,o=this.props,i=o.mode,a=o.pydio,s=o.editorOneColumn,c=o.muiTheme,u=this.state,p=u.edit,f=u.model,d=u.asLib,y=u.coreActionsLib,h=u.rootNodes,m=u.loading,b=function(e){return a.MessageHash["share_center."+e]},v={width:400,minHeight:270};if(p)v=s?{width:400,height:500}:{width:700,height:500},n=t().createElement(Ct,Ft({},this.props,{model:f,sendInvitations:this.usersInvitations.bind(this),editorOneColumn:s}));else if(f){var g,w,O,P=f.getRootNodes().map((function(e){return f.getNodeLabelInContext(e)})).join(", ");P||(P=f.getRootNodes().length+" item(s)"),"infoPanel"!==i&&(O=[],f.getUuid()!==a.user.activeRepository&&O.push(t().createElement(l.MenuItem,{primaryText:b(246),onClick:function(){a.triggerRepositoryChange(f.getUuid()),r.props.onDismiss()}})),f.isEditable()&&(g=function(){f.deleteCell().then((function(e){r.props.onDismiss()}))},w=function(){r.setState({edit:!0}),r.props.onHeightChange&&r.props.onHeightChange(500)},O.push(t().createElement(l.MenuItem,{primaryText:b(247),onClick:function(){return r.setState({edit:!0})}})),O.push(t().createElement(l.MenuItem,{primaryText:b(248),onClick:g}))));var E,j,k,S=[],x=[],R=[];if(h&&!m){h.forEach((function(e){e.getMetadata().get("ws_quota")&&R.push(t().createElement(Kt,{mui3:"infoPanel"!==i,node:e}))})),h.length>1?x.push(a.MessageHash["share_center.cell.folder-root.multiple"].replace("%d",h.length)):x.push(a.MessageHash["share_center.cell.folder-root.single"]);var _=Object.keys(f.getAcls()).length;_>1?x.push(a.MessageHash["share_center.cell.participant.multiple"].replace("%d",_)):x.push(a.MessageHash["share_center.cell.participant.single"]),S.push(x.join(", "))}if(!m&&f.cell&&f.cell.AccessEnd){var L=new Date(1e3*parseInt(f.cell.AccessEnd)),M=L<new Date;k=t().createElement(Xt,{iconClassName:M?"mdi mdi-alert-outline":"mdi mdi-calendar",iconStyle:M?{color:"var(--md-sys-color-error)"}:{},legend:b(M?"21b":"21"),data:Wt(L).calendar()}),S.push(b(M?"21b":"21")+" "+Wt(L).calendar())}if(d&&y&&h&&!m){var C,T=d.WatchSelector,D=d.WatchSelectorMui3,I=y.BookmarkButton,A=y.MaskWsButton;C="mui3"===c.userTheme?t().createElement(D,{pydio:a,nodes:h,fullWidth:!1}):t().createElement(T,{pydio:a,nodes:h,fullWidth:!0}),E=t().createElement(Qt,{legend:a.MessageHash["meta.watch.selector.legend"+("mui3"===c.userTheme?".mui":"")],data:C,dataStyle:{marginTop:6}}),j=[t().createElement(A,{pydio:a,workspaceId:f.getUuid(),style:{width:40,height:40,padding:8},iconStyle:{color:"var(--md-sys-color-primary)"}}),t().createElement(I,{pydio:a,nodes:h,styles:{style:{width:40,height:40,padding:8},iconStyle:{color:"var(--md-sys-color-primary)"}}})]}if(n=t().createElement(Gt,{pydio:a,title:f.getLabel(),onDismissAction:this.props.onDismiss,otherActions:j,onDeleteAction:g,deleteTooltip:a.MessageHash["share_center.248"],onEditAction:w,editTooltip:a.MessageHash["share_center.247"],headerSmall:"infoPanel"===i,mui3:!0,topLeftAvatar:"infoPanel"!==i&&t().createElement(Bt,{size:40,acls:f.getAcls()})},"infoPanel"!==i&&t().createElement(e.Fragment,null,t().createElement(Qt,{legend:f.getDescription(),data:t().createElement("div",null,S.map((function(e){return t().createElement("div",null,e)})))}),E||t().createElement(Xt,{placeHolder:!0,placeHolderReady:!m})),"infoPanel"===i&&t().createElement(e.Fragment,null,!m&&t().createElement(Xt,{iconClassName:"mdi mdi-account-multiple",legend:"Participants",data:t().createElement(Bt,{size:30,acls:f.getAcls()})}),!m&&f.getDescription()&&t().createElement(Xt,{iconClassName:"mdi mdi-information",legend:b(145),data:f.getDescription()}),t().createElement(Xt,{iconClassName:"mdi mdi-folder-multiple-outline",legend:b(249),data:P,placeHolder:!0,placeHolderReady:!m}),k,R)),"infoPanel"===i)return n}return t().createElement("div",{style:v},n)}}])&&Ht(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(t().Component);Zt=(0,c.muiThemeable)()(Zt);const Jt=require("pydio/lang/observable");var $t=n.n(Jt);const en=require("pydio/util/pass");var tn=n.n(en);function nn(e){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(e)}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ln(r.key),r)}}function on(e,t){return on=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},on(e,t)}function an(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sn(e)}function ln(e){var t=function(e,t){if("object"!==nn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===nn(t)?t:String(t)}var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&on(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=sn(r);if(o){var n=sn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return an(e)}(this,e)});function a(){var e,t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=an(e=i.call(this)),r=void 0,(n=ln(n="dirty"))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,e.link=new Ce.RestShareLink,e.link.Permissions=[Ce.RestShareLinkAccessType.constructFromObject("Preview"),Ce.RestShareLinkAccessType.constructFromObject("Download")],e.link.Policies=[],e.link.PoliciesContextEditable=!0,e.link.RootNodes=[],e.ValidPassword=!0,e.loadError=null,e}return t=a,(n=[{key:"hasError",value:function(){return this.loadError}},{key:"isEditable",value:function(){return this.link.PoliciesContextEditable}},{key:"isDirty",value:function(){return this.dirty}},{key:"getLinkUuid",value:function(){return this.link.Uuid}},{key:"getLink",value:function(){return this.link}},{key:"getPublicUrl",value:function(){return Ae.buildPublicUrl(s().getInstance(),this.link)}},{key:"updateLink",value:function(e){this.link=e,this.notifyDirty()}},{key:"notifyDirty",value:function(){this.dirty=!0,this.notify("update")}},{key:"revertChanges",value:function(){this.originalLink&&(this.link=this.clone(this.originalLink),this.dirty=!1,this.updatePassword=this.createPassword=null,this.ValidPassword=!0,this.notify("update"))}},{key:"hasPermission",value:function(e){return this.link.Permissions.filter((function(t){return t===e})).length>0}},{key:"isExpired",value:function(){return!!(this.link.MaxDownloads&&parseInt(this.link.CurrentDownloads)>=parseInt(this.link.MaxDownloads))||(this.link.AccessEnd,!1)}},{key:"load",value:function(e){var t=this;return new Ce.ShareServiceApi(Me().getRestClient()).getShareLink(e).then((function(e){t.link=e,t.link.Permissions||(t.link.Permissions=[]),t.link.Policies||(t.link.Policies=[]),t.link.RootNodes||(t.link.RootNodes=[]),t.originalLink=t.clone(t.link),t.notify("update")})).catch((function(e){t.loadError=e,t.notify("update")}))}},{key:"setCreatePassword",value:function(e){var t=this;e?tn().checkPasswordStrength(e,(function(e,n){t.ValidPassword=e,t.ValidPasswordMessage=n})):this.ValidPassword=!0,this.createPassword=e,this.link.PasswordRequired=!0,this.notifyDirty()}},{key:"setUpdatePassword",value:function(e){var t=this;e?tn().checkPasswordStrength(e,(function(e,n){t.ValidPassword=e,t.ValidPasswordMessage=n})):this.ValidPassword=!0,this.updatePassword=e,this.notifyDirty()}},{key:"setCustomLink",value:function(e){this.customLink=e}},{key:"save",value:function(){var e=this;if(!this.ValidPassword)throw new Error(this.ValidPasswordMessage);var t=new Ce.ShareServiceApi(Me().getRestClient()),n=new Ce.RestPutShareLinkRequest;this.createPassword?(n.PasswordEnabled=!0,n.CreatePassword=this.createPassword):this.updatePassword?(n.PasswordEnabled=!0,this.link.PasswordRequired?n.UpdatePassword=this.updatePassword:n.CreatePassword=this.updatePassword):n.PasswordEnabled=this.link.PasswordRequired;var r=Ae.getAuthorizations();if(r.password_mandatory&&!n.PasswordEnabled)throw new Error(s().getMessages()["share_center.175"]);return parseInt(r.max_downloads)>0&&!parseInt(this.link.MaxDownloads)&&(this.link.MaxDownloads=""+parseInt(r.max_downloads),this.notify("update")),parseInt(r.max_expiration)>0&&!parseInt(this.link.AccessEnd)&&(this.link.AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(r.max_expiration)*60*24),this.notify("update")),this.customLink&&this.customLink!==this.link.LinkHash&&(n.UpdateCustomHash=this.customLink),n.ShareLink=this.link,t.putShareLink(n).then((function(t){e.link=t,e.dirty=!1,e.originalLink=e.clone(e.link),e.updatePassword=e.createPassword=e.customLink=null,e.ValidPassword=!0,e.notify("update"),e.notify("save")})).catch((function(e){var t=e.Detail||e.message||e;s().getInstance().UI.displayMessage("ERROR",t)}))}},{key:"deleteLink",value:function(e){var t=this;return new Ce.ShareServiceApi(Me().getRestClient()).deleteShareLink(this.link.Uuid).then((function(n){t.link=e,t.dirty=!1,t.updatePassword=t.createPassword=t.customLink=null,t.notify("update"),t.notify("delete")})).catch((function(e){var t=e.Detail||e.message||e;pydio.UI.displayMessage("ERROR",t)}))}},{key:"clone",value:function(e){return Ce.RestShareLink.constructFromObject(JSON.parse(JSON.stringify(e)))}}])&&rn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}($t());function un(e){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un(e)}function pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bn(r.key),r)}}function fn(){return fn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},fn.apply(this,arguments)}function dn(e,t){return dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dn(e,t)}function yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hn(e){return hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hn(e)}function mn(e,t,n){return(t=bn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bn(e){var t=function(e,t){if("object"!==un(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==un(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===un(t)?t:String(t)}var vn=s().requireLib("boot").moment,gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hn(r);if(o){var n=hn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===un(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return yn(e)}(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),mn(yn(e=i.call(this)),"cells",void 0),mn(yn(e),"links",void 0),mn(yn(e),"edit",void 0),mn(yn(e),"node",void 0),mn(yn(e),"saving",void 0),e.cells=[],e.links=[],e.edit=t,e}return t=a,n=[{key:"emptyLink",value:function(e){var t,n=this,r=new cn,o=new Ce.TreeNode,i=Ae.getAuthorizations();o.Uuid=e.getMetadata().get("uuid"),r.getLink().Label=e.getLabel(),r.getLink().Description=pydio.MessageHash["share_center.257"].replace("%s",vn(new Date).format("YYYY/MM/DD")),r.getLink().RootNodes.push(o);var a=[Ce.RestShareLinkAccessType.constructFromObject("Download")];return e.isLeaf()?(t="pydio_unique_dl",Ae.nodeHasEditor(pydio,e).preview&&!i.max_downloads?(t="pydio_unique_strip",a.push(Ce.RestShareLinkAccessType.constructFromObject("Preview"))):i.max_downloads>0&&(r.getLink().MaxDownloads=i.max_downloads)):(t="pydio_shared_folder",a.push(Ce.RestShareLinkAccessType.constructFromObject("Preview"))),r.getLink().ViewTemplateName=t,r.getLink().Permissions=a,i.max_expiration&&(r.getLink().AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(i.max_expiration)*60*24)),r.observe("update",(function(){n.notify("update")})),r.observe("save",(function(){n.updateUnderlyingNode()})),r}},{key:"createEmptyCell",value:function(){var e=this,t=new(xe())(!0);t.setLabel(this.node.getLabel()),t.addRootNode(this.node),t.observe("update",(function(){e.notify("update")})),t.dirty=!1,this.cells.push(t),this.notify("update")}},{key:"addToExistingCell",value:function(e){var t=this,n=new(xe())(!0);n.observe("update",(function(){t.notify("update")})),n.load(e).then((function(){n.addRootNode(t.node)}));var r=this.cells.filter((function(e){return!e.getUuid()}));r.length&&this.removeNewCell(r[0]),this.cells.push(n)}},{key:"updateUnderlyingNode",value:function(){this.skipUpdateUnderlyingNode||s().getInstance().getContextHolder().requireNodeReload(this.node)}},{key:"deleteLink",value:function(e){var t=this;return e.deleteLink(this.emptyLink(this.node).getLink()).then((function(e){t.updateUnderlyingNode()}))}},{key:"getNode",value:function(){return this.node}},{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.node=e,this.cells=[],this.links=[],e.getMetadata().get("pydio_shares")&&JSON.parse(e.getMetadata().get("pydio_shares")).map((function(e){if(3===e.Scope){var n=new cn;n.observe("update",(function(){t.notify("update")})),n.observe("save",(function(){t.updateUnderlyingNode()})),n.load(e.UUID),t.links.push(n)}else if(2===e.Scope){var r=new(xe());r.observe("update",(function(){t.notify("update")})),r.load(e.UUID),t.cells.push(r)}})),this.edit&&!this.links.length&&this.links.push(this.emptyLink(e)),this.edit&&this.canCreateCells()&&!this.cells.length&&this.createEmptyCell(),n&&this.node.observe("node_replaced",(function(){t.load(t.node,!1)}))}},{key:"loadUniqueLink",value:function(e,t){var n=this;this.node=t;var r=new cn;return r.observe("update",(function(){n.notify("update")})),r.load(e),this.links.push(r),r}},{key:"canCreateCells",value:function(){if(!this.node)return!1;var e=Ae.getAuthorizations(),t=this.node.isLeaf();return t&&e.file_workspaces||!t&&e.folder_workspaces}},{key:"save",value:function(){var e=this;this.saving=!0,this.notify("update");var t=[];this.cells.map((function(e){e.isDirty()&&t.push(e.save())})),this.links.map((function(e){e.isDirty()&&t.push(e.save())})),Promise.all(t).then((function(){var t=e.node.getMetadata().get("uuid");e.cells=e.cells.filter((function(e){return e.hasRootNode(t)})),e.updateUnderlyingNode(),e.saving=!1})).catch((function(t){e.updateUnderlyingNode(),e.saving=!1}))}},{key:"deleteAll",value:function(){var e=this.node.getMetadata().get("uuid"),t=[];return this.cells.map((function(n){n.removeRootNode(e),t.push(n.save())})),this.links.map((function(e){t.push(e.deleteLink())})),Promise.all(t)}},{key:"removeNewCell",value:function(e){this.cells=this.cells.filter((function(t){return t!==e})),this.notify("update")}},{key:"revertChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cells=this.cells.filter((function(e){return e.getUuid()})),this.cells.map((function(e){e.isDirty()&&e.revertChanges()})),this.links.map((function(e){e.isDirty()&&e.revertChanges()})),!this.cells.length&&e&&this.canCreateCells()&&this.createEmptyCell(),this.notify("update")}},{key:"isDirty",value:function(){return!this.saving&&this.cells.filter((function(e){return e.isDirty()})).length||this.links.filter((function(e){return e.isDirty()})).length}},{key:"stopObserving",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.cells.map((function(e){e.stopObserving("update")})),this.links.map((function(e){e.stopObserving("update")})),fn(hn(a.prototype),"stopObserving",this).call(this,e,t)}},{key:"getCells",value:function(){if(this.node){var e=this.node.getMetadata().get("uuid");return this.cells.filter((function(t){return t.hasRootNode(e)}))}return this.cells}},{key:"getLinks",value:function(){return this.links}}],n&&pn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}($t());const wn=require("qrcode.react");var On=n.n(wn);const Pn=require("clipboard");var En=n.n(Pn);const jn=require("pydio/util/path");var kn=n.n(jn);const Sn=require("pydio/util/lang");var xn=n.n(Sn);function Rn(e){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rn(e)}function _n(){return _n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_n.apply(this,arguments)}function Ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,In(r.key),r)}}function Mn(e,t){return Mn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mn(e,t)}function Cn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tn(e){return Tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Tn(e)}function Dn(e,t,n){return(t=In(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function In(e){var t=function(e,t){if("object"!==Rn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rn(t)?t:String(t)}var An=s().requireLib("hoc").ThemedModernStyles,Un=s().requireLib("boot").Tooltip,Nn=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mn(e,t)}(u,r);var o,i,a,s,c=(a=u,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Tn(a);if(s){var n=Tn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Rn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Cn(e)}(this,e)});function u(t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),Dn(Cn(r=c.call(this,t)),"state",{editLink:!1,copyMessage:"",showQRCode:!1}),Dn(Cn(r),"toggleEditMode",(function(){var e=r.props,t=e.linkModel,n=e.pydio,o=e.getMessage,i=r.state,a=i.editLink,s=i.customLink;if(a&&s){var l=Ae.getAuthorizations();if(l.hash_min_length&&s.length<l.hash_min_length)return void n.UI.displayMessage("ERROR",o("223").replace("%s",l.hash_min_length));t.setCustomLink(s),t.save()}r.setState({editLink:!a,customLink:void 0})})),Dn(Cn(r),"changeLink",(function(e){var t=e.target.value;t=xn().computeStringSlug(t),r.setState({customLink:t})})),Dn(Cn(r),"clearCopyMessage",(function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(Cn(r)),5e3)})),Dn(Cn(r),"attachClipboard",(function(){var e=r.props,t=e.linkModel,o=e.pydio,i=e.getMessage;r.detachClipboard(),r.copyButton.current&&(r._clip=new(En())(r.copyButton.current,{text:function(e){return Ae.buildPublicUrl(o,t.getLink())}.bind(Cn(r))}),r._clip.on("success",function(){var e=this;this.setState({copyMessage:i("192")},(function(){return e.clearCopyMessage()}))}.bind(Cn(r))),r._clip.on("error",function(){var e,t=this;e=0===n.g.navigator.platform.indexOf("Mac")?i("144"):i("143"),this.publicLinkField.current.focus(),this.setState({copyMessage:e},(function(){return t.clearCopyMessage()}))}.bind(Cn(r))))})),Dn(Cn(r),"detachClipboard",(function(){r._clip&&r._clip.destroy()})),Dn(Cn(r),"openMailer",(function(){r.props.showMailer(r.props.linkModel)})),Dn(Cn(r),"toggleQRCode",(function(){r.setState({showQRCode:!r.state.showQRCode})})),r.copyButton=(0,e.createRef)(),r.publicLinkField=(0,e.createRef)(),r}return o=u,(i=[{key:"componentDidUpdate",value:function(e,t){this.attachClipboard()}},{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"confirmDisable",value:function(){var e=this.props,t=e.onDisableLink,n=e.getMessage;confirm(n("dialog.link.confirm.remove"))&&t()}},{key:"render",value:function(){var e=this,n=this.props,r=n.linkModel,o=n.pydio,i=n.getMessage,a=n.muiTheme,s=Ae.buildPublicUrl(o,r.getLink()),c=Ae.getAuthorizations(),u=this.props.editAllowed&&c.editable_hash&&!this.props.isReadonly()&&r.isEditable(),p=this.state,f=p.editLink,d=p.customLink;if(f&&u){var y=void 0===d?r.getLink().LinkHash:d,h=void 0!==d&&d.length<c.hash_min_length,m=h&&a.palette.mui3&&a.palette.mui3.error;return t().createElement("div",null,t().createElement("div",{style:{display:"flex",alignItems:"center",padding:6,borderRadius:2}},t().createElement("span",{style:{fontSize:16,display:"inline-block",maxWidth:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},kn().getDirname(s)+"/ "),t().createElement(l.TextField,{style:{flex:1,marginRight:10,marginLeft:10},autoFocus:!0,onChange:this.changeLink,value:y,errorText:h?" ":null}),t().createElement(ie,{mdiIcon:"check",callback:function(){return e.toggleEditMode()},disabled:h})),t().createElement("div",{style:{textAlign:"center",fontSize:13,paddingTop:10,color:m}},h?i("223").replace("%s",c.hash_min_length):i("194")))}var b,v=this.state,g=v.copyMessage,w=v.linkTooltip,O=[],P=this.props.muiTheme,E=t().createElement("div",{key:"copy",ref:this.copyButton,style:{position:"absolute",right:0,bottom:7,width:30,height:30,padding:4,backgroundColor:"transparent",fontSize:16,cursor:"pointer"},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},t().createElement(Un,{label:g||i("191"),horizontalPosition:"left",verticalPosition:"bottom",show:w}),t().createElement("span",{className:"copy-link-button mdi mdi-content-copy",style:{color:P.palette.mui3.primary}}));return this.props.showMailer&&O.push(t().createElement(ie,{key:"outline",callback:this.openMailer,mdiIcon:"email-outline",messageId:"45"})),u&&O.push(t().createElement(ie,{key:"pencil",callback:this.toggleEditMode,mdiIcon:"pencil",messageId:"193"})),Ae.qrcodeEnabled()&&O.push(t().createElement(ie,{key:"qrcode",callback:this.toggleQRCode,mdiIcon:"qrcode",messageId:"94"})),this.props.onDisableLink&&O.push(t().createElement(ie,{key:"delete",destructive:!0,callback:function(){return e.confirmDisable()},mdiIcon:"link-off",messageId:"link.disable"})),O=O.length?t().createElement("div",{style:{display:"flex",marginTop:10}},t().createElement("span",{style:{flex:1}}),O,t().createElement("span",{style:{flex:1}})):null,b=this.state.showQRCode?t().createElement(l.Paper,{zDepth:1,style:{width:120,paddingTop:10,overflow:"hidden",margin:"0 auto",height:120,textAlign:"center"}},t().createElement(On(),{size:100,value:s,level:"Q"})):t().createElement(l.Paper,{zDepth:0,style:{width:120,overflow:"hidden",margin:"0 auto",height:0,textAlign:"center"}}),t().createElement("div",{className:"public-link-container"},t().createElement("div",{style:{marginTop:-8,position:"relative"}},t().createElement(l.TextField,_n({floatingLabelText:i("link.floatingLabel"),floatingLabelFixed:!0,type:"text",name:"Link",ref:this.publicLinkField,value:s,onFocus:function(e){e.target.select()},fullWidth:!0},An(P).textFieldV2)),E),O,b)}}])&&Ln(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),u}(t().Component);function Bn(e){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bn(e)}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Wn(r.key),r)}}function Fn(e,t){return Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fn(e,t)}function Hn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zn(e){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zn(e)}function Vn(e,t,n){return(t=Wn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wn(e){var t=function(e,t){if("object"!==Bn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Bn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Bn(t)?t:String(t)}function Yn(e,t,n){var r,o=[];return t.hasPermission("Preview")&&o.push(n("72")),t.hasPermission("Download")&&o.push(n("73")),t.hasPermission("Upload")&&(e.getNode().isLeaf()?o.push(n("74b")):o.push(n("74"))),o.length&&(r=o.join(", ").toLowerCase()),{title:n("71"),legend:r}}Dn(Nn,"propTypes",{linkModel:i().instanceOf(cn),editAllowed:i().bool,onChange:i().func,showMailer:i().func}),Nn=b(Nn=(0,c.muiThemeable)()(Nn));var Gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fn(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=zn(o);if(i){var n=zn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Bn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Hn(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Vn(Hn(e=a.call.apply(a,[this].concat(n))),"changePermission",(function(t){var n=t.target.name,r=t.target.checked,o=e.props,i=o.compositeModel,a=o.linkModel,s=a.getLink();if(r?s.Permissions.push(Ce.RestShareLinkAccessType.constructFromObject(n)):s.Permissions=s.Permissions.filter((function(e){return e!==n})),i.getNode().isLeaf()){var l=Ae.getAuthorizations().max_downloads;a.hasPermission("Preview")?(s.ViewTemplateName="pydio_unique_strip",s.MaxDownloads=0):(s.ViewTemplateName="pydio_unique_dl",l&&!s.MaxDownloads&&(s.MaxDownloads=l))}e.props.linkModel.updateLink(s)})),e}return n=s,(r=[{key:"render",value:function(){var e=this.props,n=e.linkModel,r=e.compositeModel,o=e.pydio,i=r.getNode(),a=[],s=Ae.getAuthorizations();if(i.isLeaf()){var c=Ae.nodeHasEditor(o,i),u=c.preview,p=c.writeable;a.push({NAME:"Download",LABEL:this.props.getMessage("73"),DISABLED:!u||!n.hasPermission("Preview")}),u&&!s.max_downloads&&(a.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!n.hasPermission("Download")}),n.hasPermission("Preview")&&p&&a.push({NAME:"Upload",LABEL:this.props.getMessage("74b")}))}else a.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!n.hasPermission("Upload")}),a.push({NAME:"Download",LABEL:this.props.getMessage("73")}),a.push({NAME:"Upload",LABEL:this.props.getMessage("74")});return t().createElement("div",null,a.map(function(e){return t().createElement(l.Checkbox,{key:e.NAME,disabled:e.DISABLED||this.props.isReadonly()||!n.isEditable(),type:"checkbox",name:e.NAME,label:e.LABEL,onCheck:this.changePermission,checked:n.hasPermission(e.NAME),labelStyle:{whiteSpace:"nowrap"},style:{margin:"10px 0"}})}.bind(this)),void 0)}}])&&qn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);Vn(Gn,"propTypes",{linkModel:i().instanceOf(cn),style:i().object}),Gn=b(Gn);const Xn=require("react-dom");var Qn=n.n(Xn);function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn(e)}function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(n),!0).forEach((function(t){$n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $n(e,t,n){return(t=rr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function er(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rr(r.key),r)}}function nr(e,t,n){return t&&tr(e.prototype,t),n&&tr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rr(e){var t=function(e,t){if("object"!==Kn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Kn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Kn(t)?t:String(t)}function or(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ir(e,t)}function ir(e,t){return ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ir(e,t)}function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sr(e);if(t){var o=sr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Kn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function sr(e){return sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sr(e)}var lr=function(e){or(o,e);var r=ar(o);function o(e){var t;return er(this,o),(t=r.call(this,e)).state={copyMessage:""},t}return nr(o,[{key:"componentDidMount",value:function(){this._clip&&this._clip.destroy(),this._button&&(this._clip=new(En())(this._button,{text:function(e){return this.props.link}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var e;e=0===n.g.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("share_center.143"),this.setState({copyMessage:e},this.clearCopyMessage)}.bind(this)))}},{key:"componentWillUnmount",value:function(){this._clip&&this._clip.destroy()}},{key:"clearCopyMessage",value:function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(this),5e3)}},{key:"render",value:function(){var e=this,n=this.props,r=n.targetUser,o=n.link;return t().createElement("div",{style:{display:"flex"}},t().createElement("div",{style:{flex:1}},r.Display,t().createElement(l.IconButton,{pydio:this.props.pydio,ref:function(t){e._button=Qn().findDOMNode(t)},iconClassName:"mdi mdi-link",tooltip:this.state.copyMessage||o,iconStyle:{fontSize:13,lineHeight:"17px"},style:{width:34,height:34,padding:6}})),t().createElement("div",{style:{width:40,textAlign:"center"}},r.DownloadCount))}}]),o}(t().Component),cr=function(e){or(r,e);var n=ar(r);function r(e,t){var o;return er(this,r),(o=n.call(this,e,t)).state={open:!1},o}return nr(r,[{key:"render",value:function(){var e,n=this,r=this.props.linkModel,o=r.getLink();o.TargetUsers&&(e=o.TargetUsers);var i=Object.keys(e).map((function(n){var o=r.getPublicUrl()+"?u="+n;return t().createElement(lr,{targetUser:e[n],link:o})}));if(!i.length)return null;var a={borderBottom:this.state.open?"1px solid #757575":"",color:"rgba(0, 0, 0, 0.36)"};return t().createElement("div",{style:{lineHeight:"34px",padding:"4px 10px 4px",fontSize:14,backgroundColor:"#fafafa",borderRadius:2}},t().createElement("div",{style:Jn({display:"flex"},a)},t().createElement("div",{style:{flex:1}},this.props.getMessage("245").replace("%s",i.length)," ",t().createElement("span",{className:"mdi mdi-chevron-"+(this.state.open?"up":"down"),style:{cursor:"pointer"},onClick:function(){n.setState({open:!n.state.open})}})),this.state.open&&t().createElement("div",{style:{width:40,textAlign:"center"}},"#DL")),this.state.open&&t().createElement("div",null,i))}}]),r}(t().Component);function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(n),!0).forEach((function(t){vr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dr(){return dr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dr.apply(this,arguments)}function yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gr(r.key),r)}}function hr(e,t){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hr(e,t)}function mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},br(e)}function vr(e,t,n){return(t=gr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gr(e){var t=function(e,t){if("object"!==ur(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ur(t)?t:String(t)}cr.propTypes={linkModel:i().instanceOf(cn)},cr=b(cr),lr=b(lr);var wr=s().requireLib("form").ValidPassword,Or=s().requireLib("hoc"),Pr=Or.ThemedContainers.Popover,Er=Or.ModernTextField,jr=Or.ThemedModernStyles,kr=Or.DatePicker,Sr=s().requireLib("boot").moment,xr={iconButton:{style:{width:40,height:40,padding:6},iconStyle:{color:"rgba(0,0,0,.5)",fontSize:20}},leftIcon:{margin:"0 16px 0 4px",color:"#757575"}},Rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hr(e,t)}(c,e);var n,r,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=br(o);if(i){var n=br(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ur(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return mr(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return vr(mr(e=a.call.apply(a,[this].concat(r))),"state",{}),vr(mr(e),"updateDLExpirationField",(function(t){var n=t.currentTarget.value;parseInt(n)<0&&(n=-parseInt(n));var r=e.props.linkModel,o=r.getLink();o.MaxDownloads=n,r.updateLink(o)})),vr(mr(e),"updateDaysExpirationField",(function(t,n){n||(n=t.currentTarget.getValue());var r=e.props.linkModel,o=r.getLink();o.AccessEnd=n,r.updateLink(o)})),vr(mr(e),"onDateChange",(function(t,n){var r=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate());e.updateDaysExpirationField(t,Math.floor(r/1e3)+"")})),vr(mr(e),"resetPassword",(function(){var t=e.props.linkModel;t.setUpdatePassword(""),t.getLink().PasswordRequired=!1,t.notifyDirty()})),vr(mr(e),"setUpdatingPassword",(function(t){tn().checkPasswordStrength(t,(function(n,r){e.setState({updatingPassword:t,updatingPasswordValid:n})}))})),vr(mr(e),"changePassword",(function(){var t=e.props.linkModel,n=e.state.updatingPassword;t.setUpdatePassword(n),e.setState({pwPop:!1,updatingPassword:"",updatingPasswordValid:!1}),t.notifyDirty()})),vr(mr(e),"updatePassword",(function(t,n){var r=e.props.linkModel;e.state.validPasswordStatus?e.setState({invalidPassword:null,invalid:!1},(function(){r.setUpdatePassword(t)})):e.setState({invalidPassword:t,invalid:!0})})),vr(mr(e),"resetDownloads",(function(){if(window.confirm(e.props.getMessage("106"))){var t=e.props.linkModel;t.getLink().CurrentDownloads="0",t.notifyDirty()}})),vr(mr(e),"resetExpiration",(function(){var t=e.props.linkModel;t.getLink().AccessEnd="0",t.notifyDirty()})),vr(mr(e),"renderPasswordContainer",(function(){var n,r,o,i=e.props.linkModel,a=i.getLink(),c=Ae.getAuthorizations();return a.PasswordRequired?(e.props.isReadonly()||!i.isEditable()||c.password_mandatory||(r=t().createElement(l.IconButton,dr({iconClassName:"mdi mdi-close-circle",onClick:e.resetPassword,tooltip:e.props.getMessage("174")},xr.iconButton))),!e.props.isReadonly()&&i.isEditable()&&(o=t().createElement("div",null,t().createElement(l.IconButton,dr({iconClassName:"mdi mdi-pencil",onClick:function(t){e.setState({pwPop:!0,pwAnchor:t.currentTarget})},tooltip:e.props.getMessage("181")},xr.iconButton)),t().createElement(Pr,{open:e.state.pwPop,anchorEl:e.state.pwAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){e.setState({pwPop:!1})}},t().createElement("div",{style:{width:380,padding:8}},t().createElement(wr,{name:"update",ref:"pwdUpdate",attributes:{label:e.props.getMessage("23")},value:e.state.updatingPassword?e.state.updatingPassword:"",onChange:function(t){e.setUpdatingPassword(t)},onValidStatusChange:function(t){return e.setState({updatingPasswordDiffer:!t})},variant:"v2"}),t().createElement("div",{style:{paddingTop:20,textAlign:"right"}},t().createElement(l.FlatButton,{label:s().getMessages()[54],onClick:function(){e.setState({pwPop:!1,updatingPassword:""})}}),t().createElement(l.FlatButton,{style:{minWidth:60},label:s().getMessages()[48],onClick:function(){e.changePassword()},disabled:!e.state.updatingPassword||!e.state.updatingPasswordValid||e.state.updatingPasswordDiffer})))))),n=t().createElement(Er,{floatingLabelText:e.props.getMessage("23"),disabled:!0,value:"********",fullWidth:!0,variant:"v2"})):!e.props.isReadonly()&&i.isEditable()&&(n=t().createElement(wr,{name:"share-password",ref:"pwd",attributes:{label:e.props.getMessage("23")},value:e.state.invalidPassword?e.state.invalidPassword:i.updatePassword,onChange:e.updatePassword.bind(mr(e)),onValidStatusChange:function(t){e.setState({validPasswordStatus:t})},variant:"v2"})),n?t().createElement("div",{className:"password-container",style:{display:"flex",alignItems:"baseline",width:"100%",position:"relative"}},t().createElement("div",{style:{width:"100%",display:"inline-block"}},n),(r||o)&&t().createElement("div",{style:{position:"absolute",right:0,bottom:0,display:"flex"}},o,r)):null})),vr(mr(e),"formatDate",(function(t){return e.props.getMessage("date_format","").split(" ").shift().replace("Y",t.getFullYear()).replace("m",t.getMonth()+1).replace("d",t.getDate())})),e}return n=c,(r=[{key:"render",value:function(){var e,n,r,o,i=this.props,a=i.linkModel,s=i.muiTheme,c=a.getLink(),u=this.renderPasswordContainer(),p=a.hasPermission("Download")&&!a.hasPermission("Preview")&&!a.hasPermission("Upload"),f=parseInt(c.MaxDownloads),d=parseInt(c.AccessEnd),y=!1,h=!1,m=new Date,b=Ae.getAuthorizations();if(parseInt(b.max_expiration)>0&&(r=new Date).setDate(m.getDate()+parseInt(b.max_expiration)),parseInt(b.max_downloads)>0&&(f=Math.max(1,Math.min(f,parseInt(b.max_downloads)))),d&&(d<0&&(y=!0),n=new Date(1e3*d),parseInt(b.max_expiration)||(e=t().createElement(l.IconButton,{iconStyle:xr.iconButton.iconStyle,style:fr(fr({},xr.iconButton.style),{},{position:"absolute",right:0,bottom:0,zIndex:1}),iconClassName:"mdi mdi-close-circle",onClick:this.resetExpiration.bind(this)}))),f){var v,g=parseInt(c.CurrentDownloads)||0;g&&(v=t().createElement("a",{style:{cursor:"pointer"},onClick:this.resetDownloads.bind(this),title:this.props.getMessage("17")},"(",this.props.getMessage("16"),")"),g>=f&&(h=!0)),o=t().createElement("span",{className:"dlCounterString"},g+"/"+f," ",v)}var w={fontSize:13,fontWeight:500,color:s.palette.mui3["on-surface-variant"]},O=jr(s);return t().createElement("div",null,u,t().createElement("div",{style:{display:"flex",alignItems:"baseline",position:"relative"},className:y?"limit-block-expired":null},t().createElement(kr,dr({ref:"expirationDate",key:"start",value:n,minDate:new Date,maxDate:r,autoOk:!0,disabled:this.props.isReadonly()||!a.isEditable(),onChange:this.onDateChange,showYearSelector:!0,floatingLabelText:this.props.getMessage(y?"21b":"21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},O.textFieldV2,{style:{flex:1},textFieldStyle:fr(fr({},O.textFieldV2.style),{},{flex:1})})),e),t().createElement("div",{style:{alignItems:"baseline",display:p?"flex":"none",position:"relative"},className:h?"limit-block-expired":null},t().createElement(Er,{type:"number",disabled:this.props.isReadonly()||!a.isEditable(),floatingLabelText:this.props.getMessage(h?"22b":"22"),value:f>0?f:"",onChange:this.updateDLExpirationField,fullWidth:!0,style:{flex:1},variant:"v2"}),t().createElement("span",{style:fr({position:"absolute",right:10,top:14},w)},o)))}}])&&yr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),c}(t().Component);function _r(e){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r(e)}function Lr(){return Lr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lr.apply(this,arguments)}function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){Tr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tr(e,t,n){return(t=Ur(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ur(r.key),r)}}function Ar(e,t,n){return t&&Ir(e.prototype,t),n&&Ir(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ur(e){var t=function(e,t){if("object"!==_r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==_r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_r(t)?t:String(t)}function Nr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Br(e,t)}function Br(e,t){return Br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Br(e,t)}function qr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hr(e);if(t){var o=Hr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===_r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fr(e)}(this,n)}}function Fr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hr(e){return Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hr(e)}vr(Rr,"propTypes",{linkModel:i().instanceOf(cn).isRequired,style:i().object}),Rr=b((0,c.muiThemeable)()(Rr));var zr=s().requireLib("form").ValidPassword,Vr=s().requireLib("hoc").ThemedModernStyles,Wr=function(e){Nr(r,e);var n=qr(r);function r(e){var t;return Dr(this,r),(t=n.call(this,e)).state={active:!!e.active},t}return Ar(r,[{key:"render",value:function(){var e=this,n=this.props,r=n.title,o=n.legend,i=n.children,a=this.state.active,s={title:{cursor:"pointer",fontSize:15,padding:16,paddingBottom:a?8:16,display:"flex",alignItems:"center",fontWeight:a?500:null},legend:{opacity:.4,fontSize:12,fontWeight:500,fontStyle:"italic"},content:{padding:"0 16px 8px"},chevron:{fontSize:24,color:"rgba(0,0,0,.3)",transition:"transform 250ms ease",transform:a?"rotate(90deg)":""}};return t().createElement(t().Fragment,null,t().createElement("div",{style:Cr({},s.title),onClick:function(){e.setState({active:!a})}},t().createElement("span",{style:{flex:1}},r,o&&t().createElement("span",{style:s.legend}," - ",o)),t().createElement("span",{className:"mdi mdi-chevron-right",style:s.chevron})),a&&t().createElement("div",{style:Cr({},s.content)},i))}}]),r}(t().Component),Yr=function(e){Nr(r,e);var n=qr(r);function r(){var e;Dr(this,r);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Tr(Fr(e=n.call.apply(n,[this].concat(o))),"state",{showTemporaryPassword:!1,temporaryPassword:null,saving:!1}),Tr(Fr(e),"toggleLink",(function(){var t=e.props,n=t.linkModel;t.pydio,e.state.showTemporaryPassword?e.setState({showTemporaryPassword:!1,temporaryPassword:null}):!n.getLinkUuid()&&Ae.getAuthorizations().password_mandatory?e.setState({showTemporaryPassword:!0,temporaryPassword:""}):(e.setState({saving:!0}),n.getLinkUuid()?e.props.compositeModel.deleteLink(n).catch((function(){e.setState({saving:!1})})).then((function(){e.setState({saving:!1})})):n.save().catch((function(){e.setState({saving:!1})})).then((function(){e.setState({saving:!1})})))})),Tr(Fr(e),"updateTemporaryPassword",(function(t,n){void 0===t&&(t=n.currentTarget.getValue()),e.setState({temporaryPassword:t})})),Tr(Fr(e),"enableLinkWithPassword",(function(){var t=e.props.linkModel;if(e.state.temporaryPasswordState){t.setCreatePassword(e.state.temporaryPassword);try{t.save()}catch(t){e.props.pydio.UI.displayMessage("ERROR",t.message)}e.setState({showTemporaryPassword:!1,temporaryPassword:null})}else e.props.pydio.UI.displayMessage("ERROR","Invalid Password")})),e}return Ar(r,[{key:"render",value:function(){var e,n,r,o=this,i=this.props,a=i.linkModel,s=i.pydio,c=i.compositeModel,u=i.toggleOnly,p=i.additionalPanes,f=i.muiTheme,d=this.state,y=d.showTemporaryPassword,h=d.temporaryPassword,m=d.saving,b=Ae.getAuthorizations(),v=c.getNode().isLeaf(),g=v&&b.file_public_link||!v&&b.folder_public_link,w={fontSize:13,fontWeight:500,color:f.palette.mui3["on-surface-variant"],padding:8,paddingTop:0};return a.getLinkUuid()?(this.props.isReadonly()||m||!a.isEditable()||!a.getLinkUuid()&&!g||(r=function(){return o.toggleLink()}),n=t().createElement(Nn,{pydio:s,linkModel:a,showMailer:this.props.showMailer,editAllowed:b.editable_hash&&a.isEditable(),onDisableLink:r,key:"public-link"}),e=[t().createElement(l.Divider,null),t().createElement(Wr,Yn(c,a,this.props.getMessage),t().createElement(Gn,{compositeModel:c,linkModel:a,pydio:s,key:"public-perm"}))],a.getLink().TargetUsers&&(e.push(t().createElement(l.Divider,null)),e.push(t().createElement(cr,{linkModel:a,pydio:s}))),e.push(t().createElement(l.Divider,null)),e.push(t().createElement(Wr,function(e,n,r){r("link.secure.title");var o,i,a=[],s=n.getLink();if(s.AccessEnd&&0!==parseInt(s.AccessEnd)){var l=new Date(1e3*parseInt(s.AccessEnd)),c=new Date,u=r("link.secure.expires");l<c&&(u=r("link.secure.expired"),o=t().createElement("span",{className:"mdi mdi-alert"})),a.push(u+" "+Sr(l).fromNow())}return s.PasswordRequired&&a.push(r("link.secure.hasPassword")),s.MaxDownloads>0&&a.push(r("link.secure.maxdownloads").replace("%d",s.MaxDownloads)),a.length&&(i=t().createElement(t().Fragment,null,o,a.join(", "))),{title:r("link.secure.title"),legend:i}}(0,a,this.props.getMessage),t().createElement(Rr,{pydio:s,linkModel:a}))),p&&p.forEach((function(n){e.push(t().createElement(l.Divider,null)),e.push(t().createElement(Wr,{title:n.title,legend:n.legend},n.content))}))):n=y?t().createElement("div",null,t().createElement("div",{className:"section-legend",style:{marginTop:20}},this.props.getMessage("215")),t().createElement("div",{style:{width:"100%"}},t().createElement(zr,{attributes:{label:this.props.getMessage("23")},value:h,onChange:this.updateTemporaryPassword.bind(this),onValidStatusChange:function(e){return o.setState({temporaryPasswordState:e})},variant:"v2"})),t().createElement("div",{style:{textAlign:"center",marginTop:20}},t().createElement(l.RaisedButton,{label:this.props.getMessage("92"),secondary:!0,onClick:this.enableLinkWithPassword.bind(this),disabled:!this.state.temporaryPasswordState}))):g?t().createElement("div",{style:w},this.props.getMessage("190")):t().createElement("div",{style:w},this.props.getMessage(v?"225":"226")),t().createElement("div",{style:this.props.style},!(a.getLinkUuid()||y)&&t().createElement("div",{style:{padding:16}},t().createElement(l.Toggle,Lr({disabled:this.props.isReadonly()||m||!a.isEditable()||!a.getLinkUuid()&&!g,onToggle:this.toggleLink,toggled:a.getLinkUuid()||y,label:this.props.getMessage("189")},Vr(f).toggleFieldV2))),m&&t().createElement("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"}},t().createElement(l.CircularProgress,null)),!u&&!m&&t().createElement("div",{style:{padding:16}},n),!u&&!m&&e)}}]),r}(t().Component);function Gr(e){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gr(e)}function Xr(){return Xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xr.apply(this,arguments)}function Qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(n),!0).forEach((function(t){Zr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zr(e,t,n){return(t=$r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$r(r.key),r)}}function $r(e){var t=function(e,t){if("object"!==Gr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Gr(t)?t:String(t)}function eo(e,t){return eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},eo(e,t)}function to(e){return to=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},to(e)}Tr(Yr,"propTypes",{linkModel:i().instanceOf(cn),compositeModel:i().instanceOf(gn),pydio:i().instanceOf(s()),authorizations:i().object,showMailer:i().func}),Yr=b((0,c.muiThemeable)()(Yr));var no=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eo(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=to(o);if(i){var n=to(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Gr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={mailerData:null},t}return n=s,r=[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.subject,r=e.message,o=(e.users,e.linkModel),i=e.templateId;if(e.templateData,n||i){if(Ae.forceMailerOldSchool()){var a=encodeURIComponent(n);return void(location.href="mailto:custom-email@domain.com?Subject="+a+"&Body="+r)}Dt().loadClass("PydioMailer").then((function(n){t.setState({mailerData:Kr(Kr({},e),{},{enableIdentification:o&&o.getLink().TargetUsers,identifiedOnly:o&&o.getLink().RestrictToTargetUsers,crippleIdentificationKeys:!0}),MailerPanel:n.Pane})}))}else this.setState({mailerData:null})}},{key:"toggleMailerData",value:function(e){this.setState({mailerData:Kr(Kr({},this.state.mailerData),e)})}},{key:"dismissMailer",value:function(){this.props.onDismiss()}},{key:"mailerProcessPost",value:function(e,t,n,r,o,i){var a=this.state.mailerData,s=a.crippleIdentificationKeys,l=a.identifiedOnly,c=a.linkModel,u=c.getLink();u.TargetUsers||(u.TargetUsers={}),u.RestrictToTargetUsers=l;var p={};Object.keys(t).forEach((function(e){var n=s?Math.random().toString(36).substring(7):e;u.TargetUsers[n]=Ce.RestShareLinkTargetUser.constructFromObject({Display:t[e].getLabel(),DownloadCount:0}),p[n]=e})),c.updateLink(u),c.save().then((function(){var t=new e,o=c.getPublicUrl(),a=new RegExp(o,"g");Object.keys(p).forEach((function(e){var i=o+"?u="+e,s=r.replace(a,i);t.addTarget(p[e],n,s)})),t.post((function(e){i(e)}))}))}},{key:"getMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";return this.props.pydio.MessageHash[t+(t?".":"")+e]}},{key:"render",value:function(){var e=this.state,n=e.mailerData,r=e.MailerPanel;if(!n)return null;var o=this.props.muiTheme;return t().createElement(r,Xr({},n,{onDismiss:this.dismissMailer.bind(this),overlay:!0,className:"share-center-mailer",panelTitle:this.props.pydio.MessageHash["share_center.45"],additionalPaneTop:void 0,processPost:n.enableIdentification?this.mailerProcessPost.bind(this):null,style:{width:420,margin:"0 auto",background:o.palette.mui3["surface-3"]}}))}}],r&&Jr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function ro(e){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ro(e)}function oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ro(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ro(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ro(o)?o:String(o)),r)}var o}function io(e,t){return io=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},io(e,t)}function ao(e){return ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ao(e)}no=(0,c.muiThemeable)()(no);var so=s().requireLib("hoc").ModernSelectField,lo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&io(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ao(o);if(i){var n=ao(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ro(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"onDropDownChange",value:function(e,t,n){var r=this.props.linkModel;r.getLink().ViewTemplateName=n,r.notifyDirty()}},{key:"render",value:function(){var e,n=this.props,r=n.linkModel,o=n.hideTitle,i=n.muiTheme,a=r.getLink().ViewTemplateName,s=this.props.layoutData.map((function(n){return a&&n.LAYOUT_ELEMENT===a&&(e=n.LAYOUT_LABEL),a||e||(a=n.LAYOUT_ELEMENT,e=n.LAYOUT_LABEL),t().createElement(l.MenuItem,{key:n.LAYOUT_ELEMENT,value:n.LAYOUT_ELEMENT,primaryText:n.LAYOUT_LABEL})})),c={fontSize:13,fontWeight:500,color:i.palette.mui3["on-surface-variant"]};return t().createElement("div",{style:this.props.style},!o&&t().createElement("div",{style:c},this.props.getMessage("151")),t().createElement(so,{variant:"v2",fullWidth:!0,value:a,onChange:this.onDropDownChange.bind(this),disabled:this.props.isReadonly()||this.props.readonly||!r.isEditable(),floatingLabelText:this.props.getMessage("151")},s))}}])&&oo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);lo.PropTypes={linkModel:i().instanceOf(cn)};const co=lo=b((0,c.muiThemeable)()(lo)),uo=require("pydio/http/policies");var po=n.n(uo);function fo(e){return fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fo(e)}function yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wo(r.key),r)}}function mo(e,t){return mo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mo(e,t)}function bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vo(e)}function go(e,t,n){return(t=wo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wo(e){var t=function(e,t){if("object"!==fo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==fo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===fo(t)?t:String(t)}var Oo=s().requireLib("components").ResourcePoliciesPanel,Po=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mo(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vo(o);if(i){var n=vo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===fo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bo(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return go(bo(e=a.call.apply(a,[this].concat(n))),"onSavePolicies",(function(t){var n=e.props,r=n.linkModel,o=(n.pydio,r.getLink().UserLogin);po().loadPolicies("user",o).then((function(n){if(n.length){var r=n[0].Resource,i=e.diffPolicies(n,t,r);po().savePolicies("user",o,i)}}))})),go(bo(e),"diffPolicies",(function(e,t,n){var r=[];return e.map((function(e){var n=e.Action+"///"+e.Subject;t.remove[n]||r.push(e)})),Object.keys(t.add).map((function(e){var t,o,i=new Ce.ServiceResourcePolicy,a=(t=e.split("///"),o=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,o)||function(e,t){if(e){if("string"==typeof e)return yo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yo(e,t):void 0}}(t,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],l=a[1];i.Resource=n,i.Effect=Ce.ServiceResourcePolicyPolicyEffect.constructFromObject("allow"),i.Subject=l,i.Action=s,r.push(i)})),r})),e}return n=s,(r=[{key:"render",value:function(){var e=this.props,n=e.linkModel,r=e.pydio,o=[];o["user:"+n.getLink().UserLogin]=!0;var i={READ:o,WRITE:o};return t().createElement("div",{style:this.props.style},n.getLink().Uuid&&t().createElement(Oo,{pydio:r,resourceType:"link",description:this.props.getMessage("link.visibility.advanced"),resourceId:n.getLink().Uuid,skipTitle:!0,onSavePolicies:this.onSavePolicies.bind(this),subjectsDisabled:i,subjectsHidden:o,readonly:this.props.isReadonly()||!n.isEditable(),ref:"policies"}))}}])&&ho(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);Po.PropTypes={pydio:i().instanceOf(s()).isRequired,linkModel:i().instanceOf(cn).isRequired};const Eo=Po=b(Po);function jo(e){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jo(e)}function ko(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==jo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===jo(o)?o:String(o)),r)}var o}function So(e,t){return So=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},So(e,t)}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xo(e)}var Ro=s().requireLib("hoc").ModernTextField,_o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&So(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xo(o);if(i){var n=xo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===jo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return n=s,(r=[{key:"render",value:function(){var e,n=this.props,r=n.pydio,o=n.model,i=n.linkModel,a=n.style,s=n.showLayout,l=function(e){return r.MessageHash["share_center."+e]},c=i.getLink(),u=Ae.compileLayoutData(r,o);return s&&u.length>1&&(e=t().createElement(co,{linkModel:i,pydio:r,layoutData:u,hideTitle:!0})),t().createElement("div",{style:a},t().createElement(Ro,{variant:"v2",floatingLabelText:l(265),value:c.Label,onChange:function(e,t){c.Label=t,i.updateLink(c)},fullWidth:!0}),t().createElement(Ro,{variant:"v2",floatingLabelText:l(266),value:c.Description,onChange:function(e,t){c.Description=t,i.updateLink(c)},fullWidth:!0}),e)}}])&&ko(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Lo(e){return Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lo(e)}function Mo(){return Mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mo.apply(this,arguments)}function Co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function To(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(n),!0).forEach((function(t){Do(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Do(e,t,n){return(t=Ao(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ao(r.key),r)}}function Ao(e){var t=function(e,t){if("object"!==Lo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Lo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Lo(t)?t:String(t)}function Uo(e,t){return Uo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Uo(e,t)}function No(e){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},No(e)}(_o=b(_o)).PropTypes={pydio:i().instanceOf(s()),linkModel:i().instanceOf(cn)},n(757).requireLib("boot").ThemeModifier;var Bo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uo(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=No(o);if(i){var n=No(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Lo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),e.editorOneColumn=!0,t=a.call(this,e);var n=new gn(!0);return n.skipUpdateUnderlyingNode=!0,t.state={mode:t.props.mode||"view",model:n},t}return n=s,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,r=t.linkUuid,o=t.onRemoveLink,i=this.state.model;i.observe("update",(function(){e.forceUpdate()})),i.loadUniqueLink(r,n).observeOnce("delete",(function(){o&&o()}))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"componentWillReceiveProps",value:function(e){e.LinkUuid&&e.LinkUuid!==this.props.LinkUuid&&this.state.model.loadUniqueLink(e.LinkUuid,e.node)}},{key:"linkInvitation",value:function(e){try{var t=Ae.prepareEmail(this.props.node,e);this.setState({mailerData:To(To({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){var e=this.state.model;try{e.getLinks().length&&e.getLinks()[0].save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){var e,n,r=this.props,o=r.node,i=r.pydio,a=r.editorOneColumn,s=this.state,l=s.model,c=s.mailerData,u=function(e){return i.MessageHash["share_center."+e]};l.getLinks().length&&(e=l.getLinks()[0]),n=e&&e.getLinkUuid()&&e.isEditable()?t().createElement("div",null,t().createElement(no,Mo({},c,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),t().createElement(_o,{pydio:i,linkModel:e,model:l})):t().createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},t().createElement(no,Mo({},c,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),u(256).replace("%s",o.getLabel()));var p={left:[],right:[],leftStyle:{padding:0}},f=l.getLinks();return e&&(p.left.push({Label:u(251),Value:"public-link",Component:t().createElement(Yr,{pydio:i,compositeModel:l,linkModel:f[0],showMailer:Ae.mailerSupported(i)?this.linkInvitation.bind(this):null})}),e.getLinkUuid()&&p.left.push({Label:u(253),Value:"link-visibility",Component:t().createElement(Eo,{pydio:i,linkModel:f[0]}),AlwaysLast:!0})),t().createElement(Pt,{tabs:p,pydio:i,header:n,saveEnabled:l.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){l.revertChanges()},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}}])&&Io(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function qo(e){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qo(e)}function Fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fo(Object(n),!0).forEach((function(t){zo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zo(e,t,n){return(t=Yo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yo(r.key),r)}}function Yo(e){var t=function(e,t){if("object"!==qo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==qo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qo(t)?t:String(t)}function Go(e,t){return Go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Go(e,t)}function Xo(e){return Xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xo(e)}var Qo=s().requireLib("hoc").ThemedContainers.Popover,Ko=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Go(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xo(o);if(i){var n=Xo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===qo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t=a.call(this,e);var n=null;return 0===e.compositeModel.getCells().length&&(n="NEWCELL"),t.state={edit:n},t}return n=s,(r=[{key:"addToCellsMenuItems",value:function(e){var n,r,o,i=this,a=[],s=this.props,c=s.pydio,u=s.compositeModel,p=u.getCells().map((function(e){return e.getUuid()}));return 0===p.filter((function(e){return!e})).length&&(a.push(t().createElement(l.MenuItem,{primaryText:e("cell.add.new"),onClick:function(){i.setState({addMenuOpen:!1}),u.createEmptyCell()},leftIcon:t().createElement(l.FontIcon,{className:"icomoon-cells-full-plus"})})),n=!0),c.user.getRepositoriesList().forEach((function(e){"shared"===e.getOwner()&&-1===p.indexOf(e.getId())&&(a.push(t().createElement(l.MenuItem,{primaryText:e.getLabel(),onClick:function(){i.setState({addMenuOpen:!1}),u.addToExistingCell(e.getId())},leftIcon:t().createElement(l.FontIcon,{className:"icomoon-cells"})})),r=!0)})),r&&n?o=e("cell.add.existing-or-new"):r?o=e("cell.add.existing"):n&&(o=e("cell.add.new")),{addItems:a,addLabel:o}}},{key:"removeCurrentNodeFromCell",value:function(e){var t=this.props.compositeModel;0===t.getCells().filter((function(t){return t!==e})).length&&t.createEmptyCell(),e.removeRootNode(t.getNode().getMetadata().get("uuid"))}},{key:"render",value:function(){var e=this,n=this.props,r=n.compositeModel,o=n.pydio,i=n.usersInvitations,a=n.muiTheme,s=(this.state.edit,function(e){return o.MessageHash["share_center."+e]}),c={fontSize:13,fontWeight:500,color:a.palette.mui3["on-surface-variant"],padding:8};if(r.getNode()&&!r.canCreateCells())return t().createElement("div",{style:c},s(r.getNode().isLeaf()?"227":"228"));var u=r.getCells().length>1,p=[];r.getCells().map((function(n){var r=t().createElement("div",{style:{margin:"0 -10px"}},t().createElement(ye,{pydio:o,cellAcls:n.getAcls(),excludes:[o.user.id],onUserObjectAdd:n.addUser.bind(n),onUserObjectRemove:n.removeUser.bind(n),onUserObjectUpdateRight:n.updateUserRight.bind(n),sendInvitations:function(e){return i(e,n)},saveSelectionAsTeam:!1,withActionLinks:function(r){return n.isEditable()?[].concat(function(e){if(Array.isArray(e))return Vo(e)}(o=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return Vo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vo(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t().createElement(ie,{mdiIcon:"delete-forever",destructive:!0,messageId:s("cells.remove.node"),tooltipPosition:"top-center",callback:function(){e.removeCurrentNodeFromCell(n)}})]):r;var o},readonly:!n.isEditable(),completerStyle:{margin:"-6px 8px 16px"}}));u?p.push(t().createElement(Wr,{title:n.getLabel(),legend:n.getAclsSubjects()},r)):p.push(t().createElement("div",{style:{padding:16}},r)),p.push(t().createElement(l.Divider,null))})),p.pop();var f,d=this.addToCellsMenuItems(s),y=d.addItems,h=d.addLabel;if(y.length){var m=this.props.muiTheme;f=t().createElement("span",{id:"share-dialog-addtocell-menu"},t().createElement(l.FlatButton,{iconClassName:"icomoon-cells-full-plus",style:{width:"100%"},iconStyle:{color:m.palette.accent2Color},primary:!0,tooltip:s(263),label:h,tooltipPosition:"bottom-left",onClick:function(t){e.setState({addMenuOpen:!0,addMenuAnchor:t.currentTarget})}}),t().createElement(Qo,{open:this.state.addMenuOpen,anchorEl:this.state.addMenuAnchor,onRequestClose:function(){e.setState({addMenuOpen:!1})},anchorOrigin:{horizontal:"left",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"bottom"}},t().createElement(l.Menu,{desktop:!0,listStyle:{paddingTop:0},width:250},t().createElement(l.Subheader,null,h),y)))}return t().createElement("div",{style:Ho(Ho({},this.props.style),{},{minHeight:300})},p,f&&t().createElement("div",{style:{position:"absolute",bottom:10,left:10}},f))}}])&&Wo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component);function Zo(e){return Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zo(e)}function Jo(){return Jo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jo.apply(this,arguments)}function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){ti(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ti(e,t,n){return(t=ri(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ri(r.key),r)}}function ri(e){var t=function(e,t){if("object"!==Zo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Zo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Zo(t)?t:String(t)}function oi(e,t){return oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oi(e,t)}function ii(e){return ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ii(e)}Ko.PropTypes={pydio:i().instanceOf(s()),compositeModel:i().instanceOf(gn).isRequired,usersInvitations:i().func},Ko=(0,c.muiThemeable)()(Ko),n(757).requireLib("boot").ThemeModifier;var ai=s().requireLib("boot").Tooltip,si=s().requireLib("components"),li=si.GenericCard,ci=si.GenericLine,ui=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oi(e,t)}(l,e);var r,o,i,a,s=(i=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ii(i);if(a){var n=ii(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Zo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).state={mode:t.props.mode||"view",model:new gn("edit"===t.props.mode)},t}return r=l,(o=[{key:"confirmAndDismiss",value:function(){var e=this.state.model,t=this.props,n=t.pydio,r=t.onDismiss;e.isDirty()&&!confirm(n.MessageHash["share_center.dialog.close.confirm.unsaved"])||r()}},{key:"attachClipboard",value:function(){var e=this.props.pydio,t=function(t){return e.MessageHash["share_center."+t]},r=this.state.model;if(this.detachClipboard(),r.getLinks().length){var o=r.getLinks()[0];o.getLink()&&this.refs["copy-button"]&&(this._clip=new(En())(this.refs["copy-button"],{text:function(t){return Ae.buildPublicUrl(e,o.getLink())}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copyMessage:t("192")},(function(){setTimeout((function(){e.setState({copyMessage:null})}),2500)}))}.bind(this)),this._clip.on("error",function(){var e,r=this;e=0===n.g.navigator.platform.indexOf("Mac")?t(144):t(143),this.setState({copyMessage:e},(function(){setTimeout((function(){r.setState({copyMessage:null})}),2500)}))}.bind(this)))}}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,r=t.mode;this.state.model.observe("update",(function(){e.forceUpdate()})),this.state.model.load(n,"infoPanel"===r),this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update"),this.detachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"componentWillReceiveProps",value:function(e){!e.node||e.node===this.props.node&&e.node.getMetadata("pydio_shares")===this.props.node.getMetadata("pydio_shares")||this.state.model.load(e.node,"infoPanel"===e.mode)}},{key:"usersInvitations",value:function(e,t){Ae.sendCellInvitation(this.props.node,t,e)}},{key:"linkInvitation",value:function(e){try{var t=Ae.prepareEmail(this.props.node,e);this.setState({mailerData:ei(ei({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){try{this.state.model.save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"deleteAllShares",value:function(){var e=this.props.pydio,t=this.state.model;e.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{dialogTitleId:"share_center.composite.deleteAll",message:e.MessageHash["share_center.255"],validCallback:function(){t.stopObserving("update"),t.deleteAll().then((function(e){t.updateUnderlyingNode()}))}})}},{key:"render",value:function(){var e=this,n=this.props,r=n.node,o=n.mode,i=n.pydio,a=n.editorOneColumn,s=n.popoverPanel,l=n.popoverRequestClose,c=this.state,u=c.model,p=c.mailerData,f=c.linkTooltip,d=c.copyMessage,y=function(e){return i.MessageHash["share_center."+e]};if("edit"===o){var h,m=t().createElement("div",{style:{fontSize:20,padding:10}},t().createElement(no,Jo({},p,{pydio:i,onDismiss:this.dismissMailer.bind(this)})),r&&y(256).replace("%s",r.getLabel())+(u.isDirty()?" *":"")),b={left:[],right:[]},v=u.getCells().filter((function(e){return e.getUuid()}));h=v.length>1?y("254c").replace("%d",v.length):1===v.length?y("254d").replace("%s",v[0].getLabel()):y("254b"),b.right.push({Label:h,Value:"cells",Icon:"mdi mdi-account-multiple",Component:t().createElement(Ko,{pydio:i,compositeModel:u,usersInvitations:this.usersInvitations.bind(this)})});var g,w=u.getLinks();if(w.length&&(g=w[0]),g){var O=[],P=!1;g.getLinkUuid()&&(P=!0,O.push(ei(ei({},(S=g,{title:y("265"),legend:S.getLink().Label})),{},{content:t().createElement(_o,{pydio:i,linkModel:w[0],model:u,showLayout:!0})})),w[0].isEditable()&&O.push({title:y("link.visibility.title"),content:t().createElement(Eo,{pydio:i,linkModel:w[0],style:{margin:-10}})})),b.left.push({Label:y(121)+(P?" ("+y("link.active")+")":""),Value:"public-link",Icon:"mdi mdi-link",Component:t().createElement(Yr,{pydio:i,compositeModel:u,linkModel:w[0],showMailer:Ae.mailerSupported(i)?this.linkInvitation.bind(this):null,additionalPanes:O})})}var E=!w.filter((function(e){return e.getLinkUuid()})).length&&v.length>0?"cells":null;return t().createElement(Pt,{tabs:b,defaultLeft:E,pydio:i,header:m,saveEnabled:u.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:function(){return e.confirmAndDismiss()},onRevertAction:function(){u.revertChanges(!0)},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:350,fontSize:13}})}var j=[],k=[];u.getCells().map((function(e){k.push(e.getLabel())}));var S,x=u.getLinks();if(x.length){var R=x[0];if(R.hasError()){var _=R.hasError();j.push(t().createElement(ci,{iconClassName:"mdi mdi-alert-outline",legend:"Error",data:_.Detail||_.Msg||_}))}else if(R.getLink()&&R.getLink().LinkHash){var L=Ae.buildPublicUrl(i,R.getLink(),"infoPanel"===o);j.push(t().createElement(ci,{iconClassName:"mdi mdi-link",legend:y(121),style:{overflow:"visible"},dataStyle:{overflow:"visible"},data:t().createElement("div",{ref:"copy-button",style:{cursor:"pointer",position:"relative"},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},t().createElement(ai,{label:d||y(191),horizontalPosition:"left",verticalPosition:"top",show:f}),L)}))}}return k.length&&j.push(t().createElement(ci,{iconClassName:"mdi mdi-account-multiple",legend:y(254),data:k.join(", ")})),t().createElement(li,{pydio:i,title:i.MessageHash["share_center.50"],onDismissAction:this.props.onDismiss,onDeleteAction:function(){l&&l(),e.deleteAllShares()},onEditAction:function(){l&&l(),i.Controller.fireAction("share-edit-shared")},editTooltip:i.MessageHash["share_center.125"],deleteTooltip:i.MessageHash["share_center.composite.deleteAll"],headerSmall:"infoPanel"===o,popoverPanel:s,popoverRequestClose:l},j,!j.length&&t().createElement(ci,{placeHolder:!0}))}}])&&ni(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),l}(t().Component);function pi(e){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}function fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==pi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==pi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===pi(o)?o:String(o)),r)}var o}function di(e,t){return di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},di(e,t)}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yi(e)}var hi=s().requireLib("workspaces").InfoPanelCard,mi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&di(e,t)}(s,e);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yi(o);if(i){var n=yi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===pi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).state={popoverOpen:!1},t}return n=s,(r=[{key:"openPopover",value:function(e){this.setState({popoverOpen:!0,popoverAnchor:e.target})}},{key:"render",value:function(){var e=this.props,n=e.pydio,r=e.node,o=e.popoverPanel,i=e.popoverRequestClose;return r.isRoot()?t().createElement(hi,{popoverPanel:o},t().createElement("div",{style:{padding:0}},t().createElement(Zt,{cellId:n.user.activeRepository,pydio:n,mode:"infoPanel"}))):t().createElement(hi,{popoverPanel:o},t().createElement("div",{style:{padding:0}},t().createElement(ui,{node:r,pydio:n,mode:"infoPanel",popoverPanel:o,popoverRequestClose:i})))}}])&&fi(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(t().Component),bi=n(689),vi=n(566)({displayName:"CompositeDialog",mixins:[n(757).requireLib("boot").ActionDialogMixin],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogPadding:!1,dialogSize:"md+"}},propTypes:{pydio:i().instanceOf(s()).isRequired,selection:i().instanceOf(me()),readonly:i().bool},childContextTypes:{messages:i().object,getMessage:i().func,isReadonly:i().func},getChildContext:function(){var e=this,t=this.props.pydio.MessageHash;return{messages:t,getMessage:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return t[n+(n?".":"")+e]||e}catch(t){return e}},isReadonly:function(){return e.props.readonly}}},shouldComponentUpdate:function(e,t){return!!this.props.selection.getUniqueNode()},render:function(){var e,t=this.props,n=t.pydio,r=t.selection;return r.getUniqueNode()&&(e=r.getUniqueNode()),bi.createElement(ui,{editorOneColumn:!0,pydio:n,mode:"edit",node:e,onDismiss:this.props.onDismiss})}}),gi=n(566),wi=n.n(gi);const Oi=require("pydio/model/node");var Pi=n.n(Oi);function Ei(e){return Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(e)}function ji(){return ji=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ji.apply(this,arguments)}function ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Si(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(n),!0).forEach((function(t){xi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xi(e,t,n){return(t=Mi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Mi(r.key),r)}}function Li(e,t,n){return t&&_i(e.prototype,t),n&&_i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mi(e){var t=function(e,t){if("object"!==Ei(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ei(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ei(t)?t:String(t)}function Ci(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ti(e,t)}function Ti(e,t){return Ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ti(e,t)}function Di(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ii(e);if(t){var o=Ii(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ei(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Ii(e){return Ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ii(e)}var Ai=s().requireLib("boot"),Ui=Ai.ActionDialogMixin,Ni=Ai.Loader,Bi=s().requireLib("components"),qi=Bi.ModalAppBar,Fi=Bi.EmptyStateView,Hi=s().requireLib("hoc").ModernTextField,zi=n(173).muiThemeable,Vi=function(e){Ci(r,e);var n=Di(r);function r(){return Ri(this,r),n.apply(this,arguments)}return Li(r,[{key:"render",value:function(){var e=this.props,n=e.value,r=e.onChange,o=e.muiTheme,i=e.m,a={color:"#616161"},s={color:o.palette.accent1Color},c={marginRight:5};return t().createElement(l.Tabs,{style:{width:360},onChange:function(e){r(null,0,e)},value:n,tabItemContainerStyle:{background:"transparent"}},t().createElement(l.Tab,{label:t().createElement("span",null,t().createElement("span",{style:c,className:"mdi mdi-share-variant"}),i(243)),value:"LINKS",buttonStyle:"LINKS"===n?s:a}),t().createElement(l.Tab,{label:t().createElement("span",null,t().createElement("span",{style:c,className:"icomoon-cells"}),i(254)),value:"CELLS",buttonStyle:"CELLS"===n?s:a}))}}]),r}(t().Component);Vi=zi()(Vi);var Wi=function(e){Ci(r,e);var n=Di(r);function r(e){var t;return Ri(this,r),(t=n.call(this,e)).state={resources:[],loading:!1,selectedModel:null,shareType:e.defaultShareType||"LINKS"},t}return Li(r,[{key:"getChildContext",value:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return e[n+(n?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var e=this;this.setState({filter:""});var t=new Ce.ShareServiceApi(Me().getRestClient()),n=new Ce.RestListSharedResourcesRequest;n.ShareType=Ce.ListSharedResourcesRequestListShareType.constructFromObject(this.state.shareType),this.props.subject?n.Subject=this.props.subject:n.OwnedBySubject=!0,this.setState({loading:!0}),t.listSharedResources(n).then((function(t){e.setState({resources:t.Resources||[],loading:!1})})).catch((function(){e.setState({loading:!1})}))}},{key:"getLongestPath",value:function(e){if(!e.AppearsIn)return{path:e.Path,basename:e.Path};var t={};e.AppearsIn.map((function(e){t[e.Path]=e}));var n=Object.keys(t);n.sort();var r=n[n.length-1],o=kn().getBasename(r);return o||(o=t[r].WsLabel),{path:r,appearsIn:t[r],basename:o}}},{key:"goTo",value:function(e){var t=e.Path,n=e.WsLabel,r=e.WsUuid,o=t.split("/");o.shift();var i=new(Pi())(o.join("/"));i.getMetadata().set("repository_id",r),i.getMetadata().set("repository_label",n),this.props.pydio.goTo(i),this.props.onRequestClose()}},{key:"render",value:function(){var e=this,n=this.state,r=n.loading,o=n.resources,i=n.filter,a=void 0===i?"":i,s=this.props,c=s.pydio,u=s.style,p=function(e){return c.MessageHash["share_center."+e]};o.sort((function(e,t){var n=e.Node.Path,r=t.Node.Path;return n===r?0:n>r?1:-1}));var f=c.Registry.getFilesExtensions();return t().createElement("div",{style:Si(Si({},u),{},{display:"flex",flexDirection:"column",overflow:"hidden"})},t().createElement("div",{style:{backgroundColor:"#F5F5F5",borderBottom:"1px solid #EEEEEE",display:"flex",paddingRight:16,paddingTop:3}},t().createElement(Vi,{m:p,value:this.state.shareType,onChange:function(t,n,r){e.setState({shareType:r},(function(){e.load()}))}}),t().createElement("span",{style:{flex:1}}),t().createElement("div",{style:{width:150}},t().createElement(Hi,{hintText:p("sharelist.quick-filter"),value:a,onChange:function(t,n){e.setState({filter:n})},fullWidth:!0}))),r&&t().createElement(Ni,{style:{height:400}}),!r&&0===o.length&&t().createElement(Fi,{pydio:c,iconClassName:"mdi mdi-share-variant",primaryTextId:p(131),style:{flex:1,height:400,padding:"90px 0",backgroundColor:"transparent"}}),!r&&o.length>0&&t().createElement(l.List,{style:{flex:1,minHeight:400,maxHeight:400,overflowY:"auto",paddingTop:0}},o.map((function(t){var n,r=e.getLongestPath(t.Node),o=r.appearsIn,i=r.basename;if(-1===i.indexOf("."))n="mdi mdi-folder";else{var a=kn().getFileExtension(i);n=f.has(a)?"mdi mdi-"+f.get(a).fontIcon:"mdi mdi-file"}return t.Link&&t.Link.Label&&t.Link.Label!==i&&(i=t.Link.Label+" ("+i+")"),{primaryText:i,secondaryText:t.Link?p(251)+": "+t.Link.Description:p(284).replace("%s",t.Cells.length),icon:n,appearsIn:o}})).filter((function(e){return!a||-1!==e.primaryText.toLowerCase().indexOf(a.toLowerCase())})).map((function(n){var r=n.appearsIn,o=n.icon;return t().createElement(l.ListItem,{primaryText:n.primaryText,secondaryText:n.secondaryText,onClick:function(){r&&e.goTo(r)},disabled:!r,leftIcon:t().createElement(l.FontIcon,{className:o})})}))))}}]),r}(t().Component);Wi.childContextTypes={messages:i().object,getMessage:i().func,isReadonly:i().func};var Yi=wi()({displayName:"ShareViewModal",mixins:[Ui],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this;return t().createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},t().createElement(qi,{title:this.props.pydio.MessageHash["share_center.98"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),t().createElement(Wi,ji({},this.props,{style:{width:"100%",flex:1},onRequestClose:function(){e.dismiss()}})))}}),Gi=n(247),Xi=n.n(Gi),Qi=n(415),Ki=n.n(Qi),Zi=n(938),Ji=n.n(Zi),$i=n(549),ea=n.n($i),ta=n(767),na=n.n(ta),ra=n(35),oa=n.n(ra),ia=n(144),aa={};aa.styleTagTransform=oa(),aa.setAttributes=ea(),aa.insert=Ji().bind(null,"head"),aa.domAPI=Ki(),aa.insertStyleElement=na(),Xi()(ia.Z,aa),ia.Z&&ia.Z.locals&&ia.Z.locals})(),window.ShareDialog=r})();