(()=>{"use strict";var e={823:e=>{e.exports=require("color")},204:e=>{e.exports=require("react-textfit")}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};r.r(o),r.d(o,{DLTemplate:()=>le,DropZoneMinisite:()=>ue,FileMinisite:()=>de,FilmStripMinisite:()=>pe,FolderMinisite:()=>ce,withRepositoriesListener:()=>oe,withSearchFormEnabled:()=>ie,withUniqueNode:()=>re});const i=require("react");var n=r.n(i);const a=require("prop-types");var s=r.n(a);const l=require("create-react-class");var c=r.n(l);const d=require("pydio");var u=r.n(d);const p=require("material-ui/styles"),m=require("react-redux"),y=require("redux"),f=require("material-ui"),h=require("pydio/util/path");var g=r.n(h);const b=require("pydio/util/dom");var v=r.n(b);const E=require("pydio/util/func");var x=r.n(E);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return(t=N(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)({}).hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},O.apply(null,arguments)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,N(o.key),o)}}function M(e,t,r){return t&&j(e.prototype,t),r&&j(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}function P(e,t,r){return t=R(t),function(e,t){if(t&&("object"==S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,T()?Reflect.construct(t,r||[],R(e).constructor):t.apply(e,r))}function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(T=function(){return!!e})()}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},q(e,t)}var D=r(204).Textfit,F=r(823),I=u().requireLib("workspaces"),H=I.Breadcrumb,B=I.UnifiedSearchForm,z=I.MainFilesList,A=I.Editor,U=I.EditionPanel,W=I.FilePreview,V=u().requireLib("components"),G=V.ContextMenu,Z=V.IconButtonMenu,J=V.Toolbar,K=V.ListPaginator,Q=V.ClipboardTextField,X=u().requireLib("boot").withProgressiveBg,Y=u().requireLib("hoc"),$=Y.EditorActions,ee=Y.dropProvider,te=Y.withSearch,re=function(e){return function(t){return function(r){function o(){return _(this,o),P(this,o,arguments)}return L(o,r),M(o,[{key:"componentDidMount",value:function(){this.detectFirstNode()}},{key:"detectFirstNode",value:function(){var t=this,r=this.props.pydio.getContextHolder();if(r.getSelectedNodes().length)this.state&&this.state.node||this.setState({node:r.getSelectedNodes()[0]});else{var o=r.getRootNode().getFirstChildIfExists();o?(r.setSelectedNodes([o],"dataModel"),this.setState({node:o})):setTimeout((function(){return t.detectFirstNode()}),1e3)}e&&r.observe("selection_changed",function(){var e=r.getSelectedNodes();this.setState({node:e.length?e[0]:null})}.bind(this))}},{key:"render",value:function(){return n().createElement(t,O({},this.props,this.state))}}])}(n().PureComponent)}},oe=function(){return function(e){return function(t){function r(e){var t;_(this,r),t=P(this,r,[e]);var o=e.pydio;return t.state={emptyUser:!o.user},t}return L(r,t),M(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.pydio;this._obs=function(){return e.setState({emptyUser:!t.user})},t.observe("repository_list_refreshed",this._obs)}},{key:"componentWillUnmount",value:function(){this.props.pydio.stopObserving("repository_list_refreshed",this._obs)}},{key:"render",value:function(){return n().createElement(e,O({},this.props,this.state))}}])}(n().PureComponent)}},ie=function(){return function(e){return u().getInstance().getPluginConfigs("action.share").get("SHARED_FOLDER_SHOW_SEARCH")?function(t){function r(e){var t;_(this,r),t=P(this,r,[e]);var o=e.pydio.getContextHolder();return t.state={searchView:!1},o.observe("context_changed",(function(){t.setState({searchView:o.getContextNode()===o.getSearchNode()})})),t}return L(r,t),M(r,[{key:"render",value:function(){var t=this;return n().createElement(e,O({},this.props,this.state,{showSearchForm:!0,onUpdateSearchView:function(e){return t.setState({searchView:e})}}))}}])}(n().PureComponent):e}},ne=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"render",value:function(){var e,t=this.props.pydio,r=t.Registry.getPluginConfigs("action.advanced_settings").get("CUSTOM_MINISITE_LOGO");return r||(r=t.Parameters.get("ajxpResourcesFolder")+"/themes/common/images/PydioLogoSquare.png"),r&&(e=r.indexOf("plug/")>-1?r:t.Parameters.get("ENDPOINT_REST_API")+"/frontend/binaries/GLOBAL/"+r),n().createElement("img",{src:e,style:this.props.style,alt:"Application Logo"})}}])}(n().Component),ae=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"render",value:function(){var e,t=this.props,r=t.mode,o=t.style;return"false"===t.aboutString?null:("insert"===r?e={textAlign:"right",padding:"6px 16px",backgroundColor:"var(--md-sys-color-surface-variant)",color:"var(--md-sys-color-on-surface-variant)"}:"overlay"===r?e={position:"absolute",bottom:0,right:0,color:"rgba(255,255,255,0.8)",padding:"6px 16px"}:"block"===r&&(e={textAlign:"center",padding:"6px 16px",color:"rgba(255,255,255)"}),n().createElement("div",{style:C(C({},e),o)},n().createElement("a",{href:"https://pydio.com",style:{fontWeight:500,color:e.color}},"Pydio Cells")," - secure file sharing"))}}])}(n().Component),se=c()({displayName:"StandardLayout",childContextTypes:{messages:s().object,getMessage:s().func,showSearchForm:s().bool},getChildContext:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){try{return e[t]||t}catch(e){return t}}}},getDefaultProps:function(){return{minisiteMode:"embed",uniqueNode:!0}},render:function(){var e=this.props,t=e.showSearchForm,r=e.searchView,o=e.onUpdateSearchView,i=e.uniqueNode,a=e.skipDisplayToolbar,s=e.bgStyle,l=e.emptyUser,c=e.pydio,d=e.muiTheme,u={appBarStyle:{zIndex:1,backgroundColor:F(d.palette.primary1Color).alpha(.5).toString(),display:"flex",alignItems:"center",height:64,padding:"0 10px"},buttonsStyle:{color:F(d.appBar.textColor).alpha(.9).toString()}};if(l)return n().createElement("div",{className:"vertical_fit vertical_layout",style:s});var p=[];i?p.push("minisite_toolbar"):(p.push("info_panel"),a||p.push("minisite_display_toolbar","display_toolbar"));var m=c.getContextHolder(),y=function(){o(!1),m.setContextNode(m.getRootNode())};return n().createElement("div",{className:"vertical_fit vertical_layout",style:s},n().createElement(f.Paper,{zDepth:1,rounded:!1,style:u.appBarStyle},n().createElement(ne,{pydio:this.props.pydio,style:{height:40}}),n().createElement("div",{id:"workspace_toolbar",style:{display:"flex",flex:1,overflow:"hidden"}},n().createElement(H,O({},this.props,{rootStyle:{padding:"0 14px",height:36,lineHeight:"36px",maxWidth:null}}))),n().createElement("div",{style:{position:"relative"}},n().createElement("div",{id:"main_toolbar",style:{display:"flex",padding:"0 8px"}},!i&&n().createElement(Z,O({},this.props,{id:"create-button-menu",toolbars:["upload","create"],buttonTitle:this.props.pydio.MessageHash[198],buttonClassName:"mdi mdi-folder-plus",buttonStyle:{color:"white"},controller:this.props.pydio.Controller})),n().createElement("div",{style:{flex:1}}),n().createElement(K,{id:"paginator-toolbar",dataModel:this.props.pydio.getContextHolder(),toolbarDisplay:!0,toolbarColor:"white",menuStyle:{backgroundColor:"white"}}),n().createElement(J,O({},this.props,{id:"main-toolbar",toolbars:p,groupOtherList:i?[]:["change_main","more","change","remote"],renderingType:"icon-font",buttonStyle:u.buttonsStyle})))),t&&c.user&&n().createElement(B,O({},this.props,{active:r,formStyles:{mainStyle:{borderRadius:20},textField:{color:"white"},magnifierStyle:{color:"white"}},onRequestOpen:function(){o(!0),m.setContextNode(m.getSearchNode())},onRequestClose:y,closeButton:n().createElement(f.IconButton,{onClick:y,iconClassName:"mdi mdi-close",iconStyle:{color:"white"}}),uniqueSearchScope:c.user.getActiveRepositoryObject().getSlug(),style:{marginTop:2,marginRight:3}}))),this.props.children,n().createElement("span",{className:"context-menu"},n().createElement(G,{pydio:this.props.pydio})))}});se=ee(se=X(se=te(se)));var le=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"triggerDL",value:function(){this.setState({downloadStarted:!0}),setTimeout(function(){this.props.pydio.Controller.fireAction("download"),setTimeout(function(){this.setState({downloadStarted:!1})}.bind(this),3500)}.bind(this),100)}},{key:"componentDidMount",value:function(){var e=this.props.pydio;e.user&&e.user.activeRepository?this.setState({repoObject:e.user.repositories.get(e.user.activeRepository)}):e.observe("repository_list_refreshed",function(e){var t=e.list,r=e.active;if(t&&t.has(r)){var o=t.get(r);this.setState({repoObject:o})}}.bind(this))}},{key:"renderMui3",value:function(){var e,t=this.props,r=t.bgStyle,o=t.node,i=t.emptyUser,a=t.muiTheme,s=t.pydio,l=a.palette.mui3,c={main:C(C({},r),{},{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"}),block:{cursor:"pointer",maxWidth:420,minWidth:320,margin:"0 auto",background:l.surface,borderRadius:a.borderRadius,boxShadow:"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)"},cardImage:{margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"center",background:l["surface-2"],borderRadius:a.borderRadius,padding:"60px 80px"},logo:{width:160,margin:"-50px auto 0"},filename:{fontSize:20,wordBreak:"break-all",fontWeight:500},fileIcon:{fontSize:80,color:l.primary},dlIcon:{position:"absolute",top:40,left:25,fontSize:30,color:l["inverse-primary"],transition:v().getBeziersTransition()}};if(i)return n().createElement("div",{className:"vertical_fit",style:C(C({},c.main),{},{width:"100%"})});this.state&&this.state.repoObject&&(e=this.state.repoObject.getLabel());var d,u=null,p=s.MessageHash[466];if(o){u=this.triggerDL.bind(this);var m=g().roundFileSize(o.getMetadata().get("bytesize"));p="".concat(MessageHash["share_center.231"]," (").concat(s.MessageHash[503],": ").concat(m,").")}return this.state&&this.state.downloadStarted&&(d=!0),n().createElement("div",{style:c.main,id:"main-background"},n().createElement(ne,{pydio:s,style:c.logo}),n().createElement("div",{className:["download-block"].join(" "),onClick:u,style:c.block},n().createElement("div",{style:c.cardImage},n().createElement("div",{style:{position:"relative"}},n().createElement("span",{style:c.fileIcon,className:"mdi mdi-file"}),n().createElement("span",{style:c.dlIcon,className:"mdi mdi-download"}))),n().createElement("div",{style:{padding:16,color:l["on-surface"]}},n().createElement("span",{style:c.filename},n().createElement(D,{min:14,max:16,perfectFit:!1,mode:"single"},e)),n().createElement("div",{style:{fontSize:13,paddingTop:8,color:l.outline}},p)),n().createElement("div",{style:{display:"flex",justifyContent:"flex-start",padding:16,opacity:!o||d?.5:1}},n().createElement("div",{style:{color:l["on-primary"],backgroundColor:l.primary,borderRadius:20,padding:"8px 16px",fontWeight:500}},"Start Download"))),n().createElement(ae,O({mode:"block"},this.props)))}},{key:"render",value:function(){var e=this,t=this.props,r=t.bgStyle,o=t.node,i=t.emptyUser;if("mui3"===t.muiTheme.userTheme)return this.renderMui3();var a,s={main:C(C({},r),{},{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"}),block:{cursor:"pointer",width:300,margin:"0 auto",textAlign:"center",background:"rgba(255, 255, 255, 0.91)",padding:20,borderRadius:4,boxShadow:"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)"},logo:{width:230,margin:"-50px auto 0"},filename:{fontSize:22,lineHeight:"22px",wordBreak:"break-all"},fileIcon:{fontSize:180,color:this.props.muiTheme.palette.primary1Color},dlIcon:{position:"absolute",top:90,left:80,fontSize:60,color:"#f4f4f4",transition:v().getBeziersTransition()}};if(i)return n().createElement("div",{className:"vertical_fit",style:C(C({},s.main),{},{width:"100%"})});this.state&&this.state.repoObject&&(a=this.state.repoObject.getLabel());var l=null,c=n().createElement("div",{style:{fontSize:13,lineHeight:"18px"}},this.props.pydio.MessageHash[466]);if(o){l=this.triggerDL.bind(this);var d=o.getMetadata().get("bytesize");c=n().createElement("div",{style:{fontSize:13,lineHeight:"18px",color:"rgba(0,0,0,.43)"}},n().createElement("div",{style:{display:"flex"}},n().createElement("div",{style:{flex:1,textAlign:"right",paddingRight:6,fontWeight:500}},this.props.pydio.MessageHash[503]),n().createElement("div",{style:{flex:1,textAlign:"left",color:"rgba(0,0,0,.73)"}},g().roundFileSize(d))),n().createElement("div",{style:{fontSize:12,marginTop:10}},this.props.pydio.MessageHash["share_center.231"]))}this.state&&this.state.downloadStarted&&(s.dlIcon.opacity=.3);var u,p=this.props.pydio.Controller.getActionByName("share_current_page");return p&&!p.deny&&(u=n().createElement("a",{style:{display:"block",textAlign:"center",padding:12,cursor:"pointer"},onClick:function(){e.setState({displayShareLink:!0})}},p.options.text)),n().createElement("div",{style:s.main},n().createElement(ne,{pydio:this.props.pydio,style:s.logo}),n().createElement("div",{className:["download-block"].join(" "),onClick:l,style:s.block},n().createElement("span",{style:s.filename},n().createElement(D,{min:12,max:25,perfectFit:!1,mode:"single"},a)),n().createElement("div",{style:{width:220,margin:"0 auto",position:"relative"}},n().createElement("span",{style:s.fileIcon,className:"mdi mdi-file"}),n().createElement("span",{style:s.dlIcon,className:"mdi mdi-download"})),c),this.state&&this.state.displayShareLink&&n().createElement("div",{style:{width:267,margin:"10px auto",backgroundColor:"rgba(255, 255, 255, 0.85)",padding:"0px 10px",borderRadius:2}},n().createElement(Q,{floatingLabelText:p.options.text,inputValue:document.location.href,getMessage:function(t){return e.props.pydio.MessageHash[t]},buttonStyle:{right:-8,bottom:9}})),n().createElement(ae,O({mode:"block"},this.props)),!(this.state&&this.state.displayShareLink)&&u)}}])}(n().Component),ce=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"render",value:function(){var e=this.props,t=e.pydio,r=e.searchView;return n().createElement(se,O({},this.props,{uniqueNode:!1}),n().createElement("div",{style:{backgroundColor:"var(--md-sys-color-surface)",paddingTop:8},className:"layout-fill vertical-layout"},n().createElement(z,O({searchResults:r,ref:"list"},this.props,{dataModel:t.getContextHolder()})),n().createElement(ae,O({mode:"insert"},this.props))),n().createElement(U,this.props))}}])}(n().Component),de=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,r=e.pydio,o=e.node,i=e.dispatch;if(o){r.UI.registerEditorOpener(this);var n=g().getAjxpMimeType(o),a=r.Registry.findEditorsForMime(n,!1);if(a.length&&a[0].openable){var s=a[0],l=s.resourcesManager,c=s.editorClass;r.Registry.loadEditorResources(l,(function(){var e=x().getFunctionByName(c,window);if(e){var n=i($.tabCreate({id:o.getLabel(),title:o.getLabel(),url:o.getPath(),icon:W,Editor:e.Editor,Controls:e.Controls,metadata:o.getMetadata(),readonly:"true"===o.getMetadata().get("node_readonly"),pydio:r,node:o,editorData:s,registry:r.Registry})).id;i($.editorSetActiveTab(n))}else t.setState({error:"Cannot find editor component ("+c+")!"})}))}}}},{key:"openEditorForNode",value:function(e,t){var r=this,o=this.props.dispatch;pydio.Registry.loadEditorResources(t.resourcesManager,(function(){var i=x().getFunctionByName(t.editorClass,window);i?o($.tabModify({id:e.getLabel(),title:e.getLabel(),url:e.getPath(),icon:W,Editor:i.Editor,Controls:i.Controls,metadata:e.getMetadata(),readonly:"true"===e.getMetadata().get("node_readonly"),pydio,node:e,editorData:t,registry:pydio.Registry})):r.setState({error:"Cannot find editor component ("+t.editorClass+")!"})}))}},{key:"componentWillUnmount",value:function(){pydio.UI.unregisterEditorOpener(this)}},{key:"render",value:function(){return n().createElement(se,O({},this.props,{uniqueNode:!0,skipDisplayToolbar:!0}),n().createElement("div",{className:"editor_container vertical_layout vertical_fit",style:{backgroundColor:"#424242"}},n().createElement(A,{displayToolbar:!1,style:{display:"flex",flex:1}}),n().createElement(ae,O({mode:"overlay"},this.props))))}}])}(n().Component),ue=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"render",value:function(){var e=this.props.pydio;return n().createElement(se,O({},this.props,{uniqueNode:!1}),n().createElement("div",{className:"vertical_fit vertical_layout",style:{backgroundColor:"var(--md-sys-color-surface)"}},n().createElement("div",{className:"vertical_fit vertical_layout",style:{margin:8,padding:"8px 0",marginBottom:2,border:"2px dashed #CFD8DC",borderRadius:12}},n().createElement(z,O({ref:"list",dataModel:e.getContextHolder()},this.props))),n().createElement(ae,O({mode:"insert",style:{backgroundColor:"var(--md-sys-color-surface-variant)"}},this.props))),n().createElement(U,this.props))}}])}(n().Component),pe=function(e){function t(){return _(this,t),P(this,t,arguments)}return L(t,e),M(t,[{key:"render",value:function(){var e=this.props,t=e.pydio,r=e.searchView;return n().createElement(se,O({},this.props,{uniqueNode:!1}),n().createElement("div",{style:{backgroundColor:"var(--md-sys-color-surface)",paddingTop:8},className:"layout-fill vertical-layout"},n().createElement(z,O({ref:"list"},this.props,{searchResults:r,dataModel:t.getContextHolder(),displayMode:"masonry"})),n().createElement(ae,O({mode:"insert"},this.props))),n().createElement(U,this.props))}}])}(n().Component);ce=(0,y.compose)((0,p.muiThemeable)(),oe(),ie())(ce),de=(0,y.compose)(oe(),re(!1),(0,p.muiThemeable)(),(0,m.connect)())(de),le=(0,y.compose)((0,p.muiThemeable)(),re(!1),oe())(X(le)),ue=(0,y.compose)((0,p.muiThemeable)(),oe())(ue),pe=(0,y.compose)(oe(),re(!0),ie(),(0,p.muiThemeable)(),(0,m.connect)())(pe),window.ShareTemplates=o})();