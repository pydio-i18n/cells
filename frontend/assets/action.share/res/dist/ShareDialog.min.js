(()=>{"use strict";var e={738:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},729:e=>{e.exports=function(e){return e[1]}},598:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(729),o=n.n(r),i=n(738),a=n.n(i)()(o());a.push([e.id,'div.user-badge.share-dialog {\n  border-bottom: 1px solid var(--md-sys-color-field-underline-idle);\n  clear: both;\n  font-size: 14px;\n  margin-left: 10px;\n  margin-right: 10px;\n  padding-top: 1px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  line-height: 20px;\n}\ndiv.user-badge.share-dialog .user-badge-label {\n  flex: 1;\n  font-size: 14px;\n  font-weight: 500;\n  padding: 9px 0;\n  line-height: 25px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\ndiv.user-badge.share-dialog:last-of-type {\n  border-bottom: 0;\n}\ndiv.user-badge.share-dialog span.icon-ellipsis-vertical.mui-font-icon {\n  color: #6F6F6F;\n  font-size: 18px;\n}\ndiv.user-badge.share-dialog .avatar {\n  background-color: #4aceb0;\n  border-radius: 50%;\n  color: white;\n  display: inline-block;\n  font-size: 17px;\n  height: 24px;\n  width: 24px;\n  margin: 5px 14px 7px 7px;\n  padding: 2px;\n  text-align: center;\n}\ndiv.user-badge.share-dialog img {\n  background-color: #4aceb0;\n  border-radius: 50%;\n  color: white;\n  display: inline-block;\n  font-size: 17px;\n  height: 24px;\n  margin: 5px 14px 7px -44px;\n  padding: 6px;\n  text-align: center;\n  width: 24px;\n}\ndiv.user-badge.share-dialog div.user-badge-menu-box {\n  font-size: 13px;\n  position: relative;\n}\ndiv.user-badge.share-dialog div.user-badge-menu-box div.mui-menu.mui-visible {\n  box-shadow: 0 0 5px rgba(0, 0, 0, 0.43);\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 200px;\n  z-index: 120;\n}\ndiv.user-badge.share-dialog div.user-badge-menu-box div.mui-menu span.icon-check {\n  float: right;\n  font-size: 16px;\n  margin-top: 15px;\n}\ndiv.user-badge.share-dialog span.user-badge-rights-container {\n  float: right;\n  padding: 11px;\n  color: gray;\n  font-size: 11px;\n  line-height: 25px;\n}\ndiv.user-badge.share-dialog span.user-badge-rights-container input[name="write"] {\n  margin-left: 28px;\n}\ndiv#share-form-users {\n  margin-top: 0 !important;\n}\n',""]);const s=a},134:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],u=i[c]||0,p="".concat(c," ").concat(u);i[c]=u+1;var f=n(p),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)t[f].references++,t[f].updater(d);else{var y=o(d,r);r.byIndex=s,t.splice(s,0,{identifier:p,updater:y,references:1})}a.push(p)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var l=r(e,o),c=0;c<i.length;c++){var u=n(i[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},709:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},202:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},958:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},783:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},911:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},171:e=>{e.exports=require("create-react-class")},146:e=>{e.exports=require("material-ui")},509:e=>{e.exports=require("material-ui/styles")},825:e=>{e.exports=require("prop-types")},217:e=>{e.exports=require("pydio")},15:e=>{e.exports=require("react")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};n.r(r),n.d(r,{CellCard:()=>$t,CompositeDialog:()=>_i,CreateCellDialog:()=>st,EditCellDialog:()=>At,InfoPanel:()=>Si,LinkModel:()=>un,ShareHelper:()=>Ne,ShareView:()=>na,ShareViewModal:()=>ra,SimpleLinkCard:()=>Go});var o=n(15),i=n.n(o),a=n(825),s=n.n(a),l=n(217),c=n.n(l),u=n(146),p=n(509);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(null,arguments)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}var v=n(825),w=n(15);function O(e){var t=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t,n){return t=b(t),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,n||[],b(e).constructor):t.apply(e,n))}(this,n,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(n,t),r=n,(o=[{key:"render",value:function(){var t=this.context,n={messages:t.messages,getMessage:t.getMessage,isReadonly:t.isReadonly};return w.createElement(e,d({},this.props,n))}}])&&y(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(w.Component);return t.contextTypes={messages:v.object,getMessage:v.func,isReadonly:v.func},t}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function k(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function x(e,t){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x(e,t)}var _=n(825),L=n(146),M=L.MenuItem,C=L.IconMenu,T=L.IconButton,R=Pydio.requireLib("components").SharedAvatar,D=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=S(t),function(e,t){if(t&&("object"==E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,j()?Reflect.construct(t,n||[],S(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(t,e),n=t,(r=[{key:"renderMenu",value:function(){if(!this.props.menus||!this.props.menus.length)return null;var e=this.props.menus.map((function(e){var t;return e.checked&&(t=i().createElement("span",{className:"mdi mdi-check"})),i().createElement(M,{primaryText:e.text,onClick:e.callback,rightIcon:t})}));return i().createElement(C,{iconButtonElement:i().createElement(T,{style:{width:30,height:30,padding:5},iconStyle:{fontSize:18},iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},desktop:!0},e)}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.avatarUser,r=this.renderMenu(),o=this.props.boxes;return i().createElement("div",{className:"share-dialog user-badge user-type-"+this.props.type},i().createElement(R,{size:28,type:t,idmObject:n,style:{margin:"5px 14px 7px 7px"}}),i().createElement("span",{className:"user-badge-label"},this.props.label),r,o)}}])&&P(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function B(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(B=function(){return!!e})()}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}function F(e,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F(e,t)}function H(e,t,n){return(t=z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){var t=function(e){if("object"!=A(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==A(t)?t:t+""}D.propTypes={label:_.string,avatar:_.string,type:_.string,menus:_.object};var V=n(825),W=n(15),Y=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return H(e=function(e,t,n){return t=q(t),function(e,t){if(t&&("object"==A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,B()?Reflect.construct(t,n||[],q(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"onRemove",(function(){e.props.onUserObjectRemove(e.props.cellAcl.RoleId)})),H(e,"onInvite",(function(){var t={},n=PydioUsers.User.fromIdmUser(e.props.cellAcl.User);t[n.getId()]=n,e.props.sendInvitations(t)})),H(e,"onUpdateRight",(function(t,n){e.props.onUserObjectUpdateRight(e.props.cellAcl.RoleId,t,n)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.cellAcl,i=r.pydio,a=[],s=o.User?"user":o.Group?"group":"team";if(o.User&&o.User.Login===i.user.id)return null;switch("group"!==s&&this.props.sendInvitations&&a.push({text:this.props.getMessage("45"),callback:this.onInvite}),this.props.isReadonly()||this.props.readonly||a.push({text:this.props.getMessage("257",""),callback:this.onRemove}),s){case"user":e=o.User.Attributes.displayName||o.User.Login,t=o.User;break;case"group":e=o.Group.Attributes?o.Group.Attributes.displayName||o.Group.GroupLabel:o.Group.Uuid;break;case"team":e=o.Role?o.Role.Label:"No role found";break;default:e=o.RoleId}var l=!1,c=!1;o.Actions.map((function(e){"read"===e.Name&&(l=!0),"write"===e.Name&&(c=!0)}));var p=this.props.isReadonly()||this.props.readonly,f={display:"flex",width:70};a.length||(f=U(U({},f),{},{marginRight:48}));var d=W.createElement("span",{style:f},W.createElement(u.Checkbox,{disabled:p,checked:l,onCheck:function(e,t){n.onUpdateRight("read",t)}}),W.createElement(u.Checkbox,{disabled:p,checked:c,onCheck:function(e,t){n.onUpdateRight("write",t)}}));return W.createElement(D,{label:e,avatarUser:t,type:s,menus:a,boxes:d})}}])&&N(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(W.Component);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Q(r.key),r)}}function Q(e){var t=function(e){if("object"!=G(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}function K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(K=function(){return!!e})()}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}H(Y,"propTypes",{cellAcl:V.object.isRequired,sendInvitations:V.func,onUserObjectRemove:V.func.isRequired,onUserObjectUpdateRight:V.func.isRequired}),Y=O(Y);var Z=n(825),ee=n(15).Component,te=n(146).IconButton,ne=n(509).muiThemeable,re=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=J(t),function(e,t){if(t&&("object"==G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,K()?Reflect.construct(t,n||[],J(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.muiTheme.palette,t=this.props,n=t.destructive,r=t.disabled,o=n?e.mui3.error:e.mui3.primary,i={root:{borderRadius:"50%",border:"1px solid "+o,backgroundColor:"transparent",width:36,height:36,padding:"8px 6px",margin:"0 6px",zIndex:0,opacity:r?.5:1},icon:{color:o,fontSize:20,lineHeight:"20px"}},a=this.props,s=a.tooltip,l=a.messageId,c=a.getMessage,u=a.messageCoreNamespace;return l&&c&&(s=this.props.getMessage(l,u||void 0)),React.createElement(te,{style:i.root,iconStyle:i.icon,onClick:this.props.callback||this.props.onClick,iconClassName:this.props.mdiIcon?"mdi mdi-"+this.props.mdiIcon:this.props.iconClassName,tooltip:s,disabled:r,tooltipPosition:this.props.tooltipPosition})}}])&&X(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(ee);re.propTypes={callback:Z.func,onClick:Z.func,mdiIcon:Z.string,messageId:Z.string},re=O(re);const oe=re=ne()(re);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pe(r.key),r)}}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(se=function(){return!!e})()}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}function ce(e,t){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ce(e,t)}function ue(e,t,n){return(t=pe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pe(e){var t=function(e){if("object"!=ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(t)?t:t+""}var fe=c().requireLib("components").UsersCompleter,de=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return ue(e=function(e,t,n){return t=le(t),function(e,t){if(t&&("object"==ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,se()?Reflect.construct(t,n||[],le(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"sendInvitationToAllUsers",(function(){var t=e.props,n=t.cellAcls,r=t.pydio,o=[];Object.keys(n).map((function(e){var t=n[e];if((!t.User||t.User.Login!==r.user.id)&&t.User){var i=PydioUsers.User.fromIdmUser(t.User);o[i.getId()]=i}})),e.props.sendInvitations(o)})),ue(e,"clearAllUsers",(function(){Object.keys(e.props.cellAcls).map((function(t){e.props.onUserObjectRemove(t)}))})),ue(e,"valueSelected",(function(t){t.IdmUser?e.props.onUserObjectAdd(t.IdmUser):e.props.onUserObjectAdd(t.IdmRole)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ce(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props,n=t.cellAcls,r=t.pydio,o=t.completerStyle,a=t.muiTheme,s=r.getPluginConfigs("core.auth"),l=0,c=[];Object.keys(n).map((function(t){var o=n[t];o.User&&o.User.Login===r.user.id||(l++,c.push(i().createElement(Y,{cellAcl:o,key:l,pydio:e.props.pydio,readonly:e.props.readonly,sendInvitations:e.props.sendInvitations,onUserObjectRemove:e.props.onUserObjectRemove,onUserObjectUpdateRight:e.props.onUserObjectUpdateRight})))}));var u,p,f=[],d=Object.keys(this.props.cellAcls).length;if(!d||this.props.isReadonly()||this.props.readonly||f.push(i().createElement(oe,{key:"clear",callback:this.clearAllUsers,tooltipPosition:"top-center",mdiIcon:"account-minus",messageId:"180"})),d&&this.props.sendInvitations&&f.push(i().createElement(oe,{key:"invite",callback:this.sendInvitationToAllUsers,tooltipPosition:"top-center",mdiIcon:"email-outline",messageId:"45"})),this.props.saveSelectionAsTeam&&d>1&&!this.props.isReadonly()&&!this.props.readonly&&f.push(i().createElement(oe,{key:"team",callback:this.props.saveSelectionAsTeam,mdiIcon:"account-multiple-plus",tooltipPosition:"top-center",messageId:"509",messageCoreNamespace:!0})),this.props.withActionLinks&&(f=this.props.withActionLinks(f)),c.length){var y="rgba(0,0,0,.33)";"mui3"===a.userTheme&&(y=a.palette.mui3.outline),u=i().createElement("div",{style:{display:"flex",marginBottom:-8,marginTop:-8,color:y,fontSize:12}},i().createElement("div",{style:{flex:1}}),i().createElement("div",{style:{width:43,textAlign:"center",overflow:"hidden",textOverflow:"ellipsis"}},this.props.getMessage("361","")),i().createElement("div",{style:{width:43,textAlign:"center",overflow:"hidden",textOverflow:"ellipsis"}},this.props.getMessage("181")),i().createElement("div",{style:{width:6}}))}if(!this.props.isReadonly()&&!this.props.readonly){var m=Object.values(n).map((function(e){return e.User?e.User.Login:e.Group?e.Group.Uuid:e.Role?e.Role.Uuid:null})).filter((function(e){return!!e})),h=s.get("USER_CREATE_USERS");p=i().createElement(fe,{className:"share-form-users",fieldLabel:this.props.getMessage(h?"34":"34b"),onValueSelected:this.valueSelected,pydio:this.props.pydio,showAddressBook:!0,usersFrom:"local",excludes:m,existingOnly:!h})}return i().createElement("div",null,i().createElement("div",{style:o||{margin:"0 8px 16px"}},p),u,i().createElement("div",null,c),!c.length&&i().createElement("div",{style:{color:a.palette.mui3["on-surface-variant"],fontWeight:500,margin:"0 10px"}},this.props.getMessage("182")),c.length>0&&i().createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},f))}}])&&ae(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);ue(de,"propTypes",{pydio:s().instanceOf(c()),cellAcls:s().object,saveSelectionAsTeam:s().func,sendInvitations:s().func,showTitle:s().bool,onUserObjectAdd:s().func.isRequired,onUserObjectRemove:s().func.isRequired,onUserObjectUpdateRight:s().func.isRequired}),de=O((0,p.muiThemeable)()(de));const ye=require("pydio/model/data-model");var me=n.n(ye);function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function be(e){return function(e){if(Array.isArray(e))return ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ge(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,we(r.key),r)}}function we(e){var t=function(e){if("object"!=he(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==he(t)?t:t+""}function Oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Oe=function(){return!!e})()}function Ee(e){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(e)}function Pe(e,t){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pe(e,t)}var ke=c().requireLib("components").FoldersTree,je=c().requireLib("hoc").ThemedContainers.Popover,Se=function(e){function t(e){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t,n){return t=Ee(t),function(e,t){if(t&&("object"==he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Oe()?Reflect.construct(t,n||[],Ee(e).constructor):t.apply(e,n))}(this,t,[e]);var o=e.pydio.user,i=[];o.getRepositoriesList().forEach((function(e){if("gateway"===e.getAccessType()){if(e.getId()===o.activeRepository){if("shared"===e.getOwner())return;r=e}i.push(e)}}));var a,s,l=i.filter((function(e){return!e.getOwner()})),c=i.filter((function(e){return e.getOwner()}));if((s=l.length&&c.length?[].concat(be(l),["DIVIDER"],be(c)):[].concat(be(l),be(c))).length){r||(r=s[0]);var u=(a=me().RemoteDataModelFactory({tmp_repository_id:r.getId()})).getRootNode();u.getMetadata().set("repository_id",r.getId()),u.load(a.getAjxpNodeProvider())}return n.state={dataModel:a,open:!1,availableWs:s,crtWs:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pe(e,t)}(t,e),n=t,(r=[{key:"switchWorkspace",value:function(e){var t=me().RemoteDataModelFactory({tmp_repository_id:e.getId()}),n=t.getRootNode();n.getMetadata().set("repository_id",e.getId()),n.load(t.getAjxpNodeProvider()),this.setState({crtWs:e,dataModel:t})}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.setState({open:!0,anchorEl:e.currentTarget})}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"onValidateNode",value:function(){var e=this.state,t=e.node,n=e.crtWs;this.props.model.addRootNode(t,n.getId()),this.handleRequestClose()}},{key:"onNodeSelected",value:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({node:e})}},{key:"renderNodeLine",value:function(e){var t=this.props.model;return i().createElement(u.ListItem,{disabled:!0,leftIcon:i().createElement(u.FontIcon,{style:{fontSize:20,margin:"14px 12px"},className:"mdi mdi-"+("LEAF"===e.Type?"file-outline":"folder-outline")}),primaryText:t.getNodeLabelInContext(e),innerDivStyle:{paddingLeft:52,fontSize:14,fontWeight:500},rightIconButton:i().createElement(u.IconButton,{onClick:function(){t.removeRootNode(e.Uuid)},iconClassName:"mdi mdi-delete",tooltip:"Remove",iconStyle:{color:"var(--md-sys-color-primary)"}})})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.model,o=n.muiTheme,a=n.mode,s=n.pydio,l=function(e){return s.MessageHash["share_center."+e]},c=r.getRootNodes()||[],p=[];c.map((function(e){p.push(t.renderNodeLine(e)),p.push(i().createElement(u.Divider,{inset:!1}))})),p.pop(),c.length||"edit"!==a||(e=i().createElement("div",{style:{fontStyle:"italic",padding:20,textAlign:"center"}},l(280)));var f=i().createElement(u.RaisedButton,{label:l(282),onClick:this.handleTouchTap.bind(this),primary:"edit"===a,secondary:"edit"!==a,style:{marginBottom:10,width:"100%"},icon:i().createElement(u.FontIcon,{className:"mdi mdi-folder-plus",style:{fontSize:20,marginTop:-4}})}),d=this.state,y=d.node,m=d.availableWs,h=d.crtWs;return i().createElement("div",null,i().createElement(u.List,null,p),e,f,i().createElement(je,{open:this.state.open,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},i().createElement("div",{style:{width:372,height:300,display:"flex",flexDirection:"column"}},i().createElement(u.DropDownMenu,{style:{height:54},value:h,onChange:function(e,n,r){t.switchWorkspace(r)}},m.map((function(e){return"DIVIDER"===e?i().createElement(u.Divider,null):i().createElement(u.MenuItem,{value:e,primaryText:e.getLabel()})}))),i().createElement(u.Divider,null),i().createElement("div",{style:{marginLeft:-26,flex:"1",overflowY:"auto",fontSize:15}},i().createElement(ke,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!1,draggable:!1})),i().createElement(u.Divider,null),i().createElement("div",{style:{display:"flex",padding:"4px 16px",alignItems:"center",fontSize:15,background:"var(--md-sys-color-surface-5)"}},i().createElement("div",{style:{flex:1,opacity:y&&y.getPath()?1:.5}},y&&y.getPath()||l(283)),i().createElement(u.IconButton,{iconStyle:{color:o.palette.primary1Color},disabled:!y,iconClassName:"mdi mdi-plus-circle-outline",onClick:this.onValidateNode.bind(this)})))))}}])&&ve(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);Se=(0,p.muiThemeable)()(Se);const xe=require("pydio/model/cell");var _e=n.n(xe);const Le=require("pydio/util/xml");var Me=n.n(Le);const Ce=require("pydio/http/api");var Te=n.n(Ce);const Re=require("cells-sdk");function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ie(r.key),r)}}function Ie(e){var t=function(e){if("object"!=De(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==De(t)?t:t+""}var Ue=c().requireLib("boot").moment,Ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"mailerSupported",value:function(e){return e.Parameters.get("validMailer")}},{key:"getAuthorizations",value:function(){var e=c().getInstance(),t=e.getPluginConfigs("action.share"),n={folder_public_link:t.get("ENABLE_FOLDER_PUBLIC_LINK"),folder_workspaces:t.get("ENABLE_FOLDER_INTERNAL_SHARING"),file_public_link:t.get("ENABLE_FILE_PUBLIC_LINK"),file_workspaces:t.get("ENABLE_FILE_INTERNAL_SHARING"),editable_hash:t.get("HASH_USER_EDITABLE"),hash_min_length:t.get("HASH_MIN_LENGTH")||6,password_mandatory:!1,max_expiration:t.get("FILE_MAX_EXPIRATION"),max_downloads:t.get("FILE_MAX_DOWNLOAD"),cells_max_expiration:t.get("CELLS_MAX_EXPIRATION")},r=t.get("SHARE_FORCE_PASSWORD");return r&&(n.password_mandatory=!0),n.password_placeholder=r?e.MessageHash["share_center.176"]:e.MessageHash["share_center.148"],n}},{key:"buildPublicUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.Parameters;if(n)return"..."+r.get("PUBLIC_BASEURI")+"/"+t.LinkHash;if(t.LinkUrl&&t.LinkUrl.match(new RegExp("^http://|^https://")))return t.LinkUrl;var o=e.getFrontendUrl();return"".concat(o.protocol,"//").concat(o.host)+r.get("PUBLIC_BASEURI")+"/"+t.LinkHash}},{key:"nodeHasEditor",value:function(e,t){if(!t.getMetadata().has("mime_has_preview_editor")){var n=e.Registry.findEditorsForMime(t.getAjxpMime()),r=(n=n.filter((function(e){return"editor.browser"!==e.id&&"editor.other"!==e.id}))).filter((function(e){return e.canWrite}));t.getMetadata().set("mime_has_preview_editor",n.length>0),t.getMetadata().set("mime_has_writeable_editor",r.length>0)}return{preview:t.getMetadata().get("mime_has_preview_editor"),writeable:t.getMetadata().get("mime_has_writeable_editor")}}},{key:"compileLayoutData",value:function(t,n){var r,o,i=n.getNode();if(i.isLeaf()?(o=i.getAjxpMime(),r=Me().XPathSelectNodes(t.getXmlRegistry(),"//template[contains(@name, 'unique_preview_')]")):r=Me().XPathSelectNodes(t.getXmlRegistry(),"//template[contains(@name, 'minisite_')]"),!r.length)return[];if(1===r.length)return[{LAYOUT_NAME:r[0].getAttribute("element"),LAYOUT_LABEL:""}];var a=t.Parameters.get("theme"),s=[];return r.map((function(n){var r=n.getAttribute("theme");if(!r||r===a){var l=n.getAttribute("element"),c=n.getAttribute("name"),u=n.getAttribute("label");o&&"unique_preview_file"===c&&!e.nodeHasEditor(t,i).preview||(u?MessageHash[u]&&(u=MessageHash[u]):u=n.getAttribute("name"),s[c]=l,s.push({LAYOUT_NAME:c,LAYOUT_ELEMENT:l,LAYOUT_LABEL:u}))}})),s}},{key:"forceMailerOldSchool",value:function(){return n.g.pydio.getPluginConfigs("action.share").get("EMAIL_INVITE_EXTERNAL")}},{key:"qrcodeEnabled",value:function(){return n.g.pydio.getPluginConfigs("action.share").get("CREATE_QRCODE")}},{key:"sendCellInvitation",value:function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=e.prepareEmail(t,null,n),a=i.templateId,s=i.templateData,l=new Re.MailerMail,u=new Re.MailerServiceApi(Te().getRestClient());l.To=[];var p=0;Object.keys(r).map((function(e){var t=r[e],n=new Re.MailerUser;return t.IdmUser&&t.IdmUser.Login&&t.IdmUser.Attributes&&(t.IdmUser.Attributes.hasEmail||t.IdmUser.Attributes.email)?(n.Uuid=t.IdmUser.Login,l.To.push(n)):p++,n}));var f=c().getInstance().MessageHash;if(l.To.length){l.TemplateId=a,l.TemplateData=s,u.send(l).then((function(){o()}));var d=f["core.mailer.1"].replace("%s",l.To.length);p>0&&(d+=" "+f["core.mailer.entries.ignored"]),c().getInstance().UI.displayMessage("SUCCESS",d)}else c().getInstance().UI.displayMessage("ERROR",f["core.mailer.entries.ignored"])}},{key:"prepareEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={},o="",i=pydio.user;if(i.getPreference("displayName")?r.Inviter=i.getPreference("displayName"):r.Inviter=i.id,t){var a=t.getLink();if(e.isLeaf()?(o="PublicFile",r.FileName=a.Label||e.getLabel()):(o="PublicFolder",r.FolderName=a.Label||e.getLabel()),r.LinkPath="/public/"+a.LinkHash,a.MaxDownloads&&(r.MaxDownloads=a.MaxDownloads+""),a.AccessEnd){var s=Ue(new Date(1e3*a.AccessEnd));r.Expire=s.format("LL")}}else{o="Cell",r.Cell=n.getLabel();var l=c().getInstance().user.getRepositoriesList().get(n.cell.Uuid);l&&l.getSlug()&&(r.LinkPath="/ws-"+l.getSlug())}return{templateId:o,templateData:r,message:"",linkModel:t}}}],null&&Ae(t.prototype,null),r&&Ae(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function qe(){return qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qe.apply(null,arguments)}function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){Ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xe(r.key),r)}}function Ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ve=function(){return!!e})()}function We(e){return We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},We(e)}function Ye(e,t){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ye(e,t)}function Ge(e,t,n){return(t=Xe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e){var t=function(e){if("object"!=Be(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Be(t)?t:t+""}var Qe=c().requireLib("hoc"),Ke=Qe.ModernTextField,Je=Qe.DatePicker,$e=Qe.ThemedModernStyles,Ze=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Ge(e=function(e,t,n){return t=We(t),function(e,t){if(t&&("object"==Be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ve()?Reflect.construct(t,n||[],We(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"formatDate",(function(t){return e.props.pydio.MessageHash.date_format.split(" ").shift().replace("Y",t.getFullYear()).replace("m",t.getMonth()+1).replace("d",t.getDate())})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ye(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e,t,n,r,o=this.props,a=o.pydio,s=o.model,l=o.muiTheme,c=o.labelFocus,p=o.labelEnter,f=o.createLabels,d=o.style,y=function(e){return a.MessageHash["share_center."+e]},m=$e(l);if(s&&s.cell){var h=Ne.getAuthorizations();h.cells_max_expiration&&(t=new Date(1e3*(Math.round(new Date/1e3)+60*parseInt(h.cells_max_expiration)*60*24))),n=function(e,t){if(null===t)s.cell.AccessEnd="-1";else{var n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());s.cell.AccessEnd=Math.floor(n/1e3)}s.notifyDirty()},s.cell.AccessEnd&&parseInt(s.cell.AccessEnd)>0&&(e=new Date(1e3*parseInt(s.cell.AccessEnd)),r=i().createElement(u.IconButton,{iconStyle:{color:"var(--md-sys-color-secondary)"},style:{position:"absolute",right:0,bottom:0,zIndex:1},iconClassName:"mdi mdi-close-circle",onClick:function(){n(null,null)}}))}return i().createElement("div",{style:He({padding:"0 8px"},d)},i().createElement(Ke,{floatingLabelText:y(f?276:267),value:s.getLabel(),onChange:function(e,t){s.setLabel(t)},fullWidth:!0,variant:"v2",focusOnMount:c,onKeyPress:function(e){p&&"Enter"===e.key&&s.getLabel()&&p()}}),i().createElement(Ke,{floatingLabelText:y(f?277:268),value:s.getDescription(),onChange:function(e,t){s.setDescription(t)},fullWidth:!0,variant:"v2"}),i().createElement("div",{style:{position:"relative"}},i().createElement(Je,qe({ref:"expirationDate",key:"start",value:e,minDate:new Date,maxDate:t,autoOk:!0,onChange:n,showYearSelector:!0,floatingLabelText:y("21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},m.textFieldV2,{style:{flex:1},textFieldStyle:He(He({},m.textFieldV2.style),{},{flex:1})})),r))}}])&&ze(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component);function et(e){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,at(r.key),r)}}function nt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(nt=function(){return!!e})()}function rt(e){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(e)}function ot(e,t){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ot(e,t)}function it(e,t,n){return(t=at(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function at(e){var t=function(e){if("object"!=et(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==et(t)?t:t+""}Ze=O((0,p.muiThemeable)()(Ze));var st=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return it(e=function(e,t,n){return t=rt(t),function(e,t){if(t&&("object"==et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,nt()?Reflect.construct(t,n||[],rt(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"state",{step:"users",model:new(_e()),saving:!1}),it(e,"submit",(function(){var t=e.state.model;e.setState({saving:!0}),t.save().then((function(t){e.props.onDismiss(),e.setState({saving:!1})})).catch((function(t){pydio.UI.displayMessage("ERROR",t.message),e.setState({saving:!1})}))})),it(e,"m",(function(t){return e.props.pydio.MessageHash["share_center."+t]})),it(e,"computeSummaryString",(function(){var t,n=e.state.model,r=0,o=0,i=0,a=[],s=n.getAcls();return Object.keys(s).map((function(e){var t=s[e];t.Group?o++:t.Role?i++:r++})),r&&a.push(r+" "+e.m(270)),o&&a.push(o+" "+e.m(271)),i&&a.push(i+" "+e.m(272)),t=3===a.length?a[0]+", "+a[1]+e.m(274)+a[3]:0===a.length?e.m(273):a.join(e.m(274)),e.m(269).replace("%USERS",t)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ot(e,t)}(t,e),n=t,r=[{key:"getChildContext",value:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return e[n+(n?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){var e=this;this.state.model.observe("update",(function(){e.forceUpdate()}))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"render",value:function(){var e,t=this,n=[],r="20px",o=this.props,a=o.pydio,s=o.muiTheme,l=this.state,c=l.step,p=l.model,f=l.saving,d=a.MessageHash[418];return"users"!==c&&(d=p.getLabel()),"users"===c?(e=i().createElement("div",null,i().createElement("div",null,this.m(275)),i().createElement(Ze,{pydio:a,model:p,style:{padding:0},muiTheme:s,labelFocus:!0,labelEnter:function(){return t.submit()},createLabels:!0})),p.getLabel()&&(n.push(i().createElement(u.FlatButton,{key:"quick",primary:!0,disabled:!p.getLabel()||f,label:this.m("cells.create.advanced"),onClick:function(){t.setState({step:"data"})}})),n.push(i().createElement("span",{style:{display:"inline-block",margin:"0  10px",fontSize:14,fontWeight:500,color:"#9E9E9E"}},this.m("cells.create.buttons.separator")))),n.push(i().createElement(u.RaisedButton,{key:"next1",disabled:!p.getLabel()||f,primary:!0,label:this.m(279),onClick:function(){t.submit()}}))):"data"===c?(e=i().createElement("div",null,i().createElement("h5",{style:{marginTop:-10,padding:"0 10px"}},this.m(278)),i().createElement(de,{pydio:a,cellAcls:p.getAcls(),excludes:[a.user.id],onUserObjectAdd:p.addUser.bind(p),onUserObjectRemove:p.removeUser.bind(p),onUserObjectUpdateRight:p.updateUserRight.bind(p)})),r="10px",n.push(i().createElement(u.FlatButton,{key:"prev1",primary:!1,label:a.MessageHash[304],onClick:function(){t.setState({step:"users"})}})),n.push(i().createElement(u.FlatButton,{key:"next2",primary:!0,label:a.MessageHash[179],onClick:function(){return t.setState({step:"label"})}}))):(e=i().createElement("div",null,i().createElement("h5",{style:{marginTop:-10}},this.m("cells.create.title.fill.folders")),i().createElement("div",{style:{color:"var(--md-sys-color-outline)",paddingTop:10}},this.computeSummaryString()),i().createElement("div",{style:{paddingTop:16}},i().createElement(Se,{pydio:a,model:p}))),n.push(i().createElement(u.FlatButton,{key:"prev2",primary:!1,label:a.MessageHash[304],onClick:function(){t.setState({step:"data"})}})),n.push(i().createElement(u.RaisedButton,{key:"submit",disabled:f,primary:!0,label:this.m(279),onClick:this.submit.bind(this)}))),i().createElement("div",{style:{width:380,fontSize:13,display:"flex",flexDirection:"column",minHeight:300}},i().createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:20}},i().createElement(u.FontIcon,{className:"icomoon-cells-full-plus"}),i().createElement("div",{style:{padding:20,fontSize:22}},d)),i().createElement("div",{style:{padding:"20px "+r+" 10px",flex:1}},e),i().createElement("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"flex-end"}},n))}}],r&&tt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dt(e,t,n){return(t=bt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bt(r.key),r)}}function ht(e,t,n){return t&&mt(e.prototype,t),n&&mt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bt(e){var t=function(e){if("object"!=lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lt(t)?t:t+""}function gt(e,t,n){return t=wt(t),function(e,t){if(t&&("object"==lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vt()?Reflect.construct(t,n||[],wt(e).constructor):t.apply(e,n))}function vt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vt=function(){return!!e})()}function wt(e){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wt(e)}function Ot(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Et(e,t)}function Et(e,t){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Et(e,t)}it(st,"childContextTypes",{messages:s().object,getMessage:s().func,isReadonly:s().func}),st=(0,p.muiThemeable)()(st);var Pt=function(e){function t(){return yt(this,t),gt(this,t,arguments)}return Ot(t,e),ht(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.active,r=e.onChange,o=e.style,a=e.muiTheme,s=a.palette.mui3["on-surface-variant"],l=a.palette.mui3.primary;return i().createElement("div",{style:ft({display:"flex"},o)},t.map((function(e){var t=e.Value===n,o=e.Label;return e.Icon&&(o=i().createElement("span",null,i().createElement("span",{className:e.Icon,style:{marginLeft:-5}})," ",e.Label)),i().createElement(u.FlatButton,{label:o,onClick:function(){r(e.Value)},primary:t,style:{flex:1,height:46,lineHeight:"46px",borderRadius:0,borderBottom:"3px solid "+(t?l:"transparent")},labelStyle:{textTransform:"none",fontSize:13,paddingLeft:8,paddingRight:8,color:t?l:s}})})))}}])}(i().Component);Pt=(0,p.muiThemeable)()(Pt);var kt=function(e){function t(){return yt(this,t),gt(this,t,arguments)}return Ot(t,e),ht(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.active,r=null;return t.map((function(e){e.Value===n&&(r=e.Component)})),r}}])}(i().Component),jt=function(e){function t(e){var n;return yt(this,t),(n=gt(this,t,[e])).state={left:e.tabs.left.length?e.tabs.left[0].Value:"",right:e.tabs.right.length?e.tabs.right[0].Value:""},e.defaultLeft&&(n.state.left=e.defaultLeft),e.defaultRight&&(n.state.right=e.defaultRight),n}return Ot(t,e),ht(t,[{key:"componentWillReceiveProps",value:function(e){!this.props.defaultLeft&&e.defaultLeft?this.setState({left:e.defaultLeft}):!this.state.left&&e.tabs.left.length&&this.setState({left:e.tabs.left[0].Value}),!this.props.defaultRight&&e.defaultRight?this.setState({right:e.defaultRight}):!this.state.right&&e.tabs.right.length&&this.setState({right:e.tabs.right[0].Value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.tabs,r=t.header,o=t.onSaveAction,a=t.onCloseAction,s=t.onRevertAction,l=t.saveEnabled,c=t.style,p=t.pydio,f=t.editorOneColumn,d=this.state,y=d.left,m=d.right;if(f){var h=[].concat(ct(n.left),ct(n.right)),b=h.filter((function(e){return e.AlwaysLast}));return b.length&&(h=[].concat(ct(h.filter((function(e){return!e.AlwaysLast}))),ct(b))),h.length&&0===h.filter((function(e){return e.Value===y})).length&&(y=h[0].Value),i().createElement("div",{style:ft({display:"flex",flexDirection:"column",height:"100%"},c)},i().createElement("div",{style:{display:"flex",alignItems:"flex-start"}},i().createElement("div",{style:{flex:1,padding:10}},r),i().createElement("div",{style:{paddingTop:8,paddingRight:10}},i().createElement(u.IconButton,{iconClassName:"mdi mdi-close",primary:!0,tooltip:p.MessageHash[86],onClick:a}))),i().createElement("div",{style:{display:"flex"}},i().createElement(Pt,{tabs:h,active:y,style:{flex:1,padding:"0 16px"},onChange:function(t){e.setState({left:t})}})),i().createElement(u.Divider,{style:{flexShrink:0,marginRight:16,marginLeft:16}}),i().createElement("div",{style:{display:"flex",flex:1,overflow:"hidden"}},i().createElement("div",{style:ft({overflowY:"auto",width:"100%",height:"100%"},n.leftStyle)},i().createElement(kt,{tabs:h,active:y}))),i().createElement(u.Divider,{style:{flexShrink:0,marginRight:16,marginLeft:16}}),i().createElement("div",{style:{padding:10,display:"flex",alignItems:"center",justifyContent:"flex-end"}},i().createElement(u.FlatButton,{disabled:!l,label:p.MessageHash[628],onClick:s,style:{marginLeft:10}}),i().createElement(u.RaisedButton,{disabled:!l,label:p.MessageHash[53],onClick:o})))}return n.left&&n.left.length&&0===n.left.filter((function(e){return e.Value===y})).length&&(y=n.left[0].Value),n.right&&n.right.length&&0===n.right.filter((function(e){return e.Value===y})).length&&(m=n.right[0].Value),i().createElement("div",{style:ft({display:"flex",flexDirection:"column",height:"100%"},c)},i().createElement("div",{style:{display:"flex",alignItems:"center",padding:10,paddingBottom:0}},i().createElement("div",{style:{flex:1,alignItems:"center",paddingRight:20}},r),i().createElement(u.RaisedButton,{disabled:!l,primary:!0,label:p.MessageHash[53],onClick:o}),i().createElement(u.FlatButton,{disabled:!l,label:p.MessageHash[628],onClick:s,style:{marginLeft:10}}),i().createElement(u.IconButton,{iconClassName:"mdi mdi-close",tooltip:p.MessageHash[86],onClick:a,style:{marginLeft:10}})),i().createElement("div",{style:{display:"flex"}},i().createElement(Pt,{tabs:n.left,active:y,style:{flex:1,margin:"0 16px"},onChange:function(t){e.setState({left:t})}}),i().createElement(Pt,{tabs:n.right,active:m,style:{flex:1,margin:"0 16px"},onChange:function(t){e.setState({right:t})}})),i().createElement(u.Divider,{style:{flexShrink:0,display:"none"}}),i().createElement("div",{style:{display:"flex",flex:1,overflow:"hidden",padding:"0 5px 5px"}},i().createElement(u.Paper,{zDepth:1,style:ft({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.leftStyle)},i().createElement(kt,{tabs:n.left,active:y})),i().createElement(u.Paper,{zDepth:1,style:ft({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.rightStyle)},i().createElement(kt,{tabs:n.right,active:m}))))}}])}(i().Component);function St(e){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},St(e)}function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tt(r.key),r)}}function _t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_t=function(){return!!e})()}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}function Mt(e,t){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mt(e,t)}function Ct(e,t,n){return(t=Tt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tt(e){var t=function(e){if("object"!=St(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=St(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==St(t)?t:t+""}var Rt=n(15),Dt=c().requireLib("components").ResourcePoliciesPanel,At=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Ct(e=function(e,t,n){return t=Lt(t),function(e,t){if(t&&("object"==St(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_t()?Reflect.construct(t,n||[],Lt(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"submit",(function(){var t=e.props,n=t.model,r=t.pydio,o=n.hasDirtyRootNodes();n.save().then((function(t){e.forceUpdate(),o&&n.getUuid()===r.user.getActiveRepository()&&(r.goTo("/"),r.fireContextRefresh())})).catch((function(e){r.UI.displayMessage("ERROR",e.message)}))})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mt(e,t)}(t,e),n=t,r=[{key:"getChildContext",value:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return e[n+(n?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}}}},{key:"render",value:function(){var e=this.props,t=e.pydio,n=e.model,r=e.sendInvitations,o=function(e){return t.MessageHash["share_center."+e]},i={leftStyle:{padding:10},rightStyle:{padding:10},left:[{Label:o(54),Value:"users",Component:Rt.createElement(de,{pydio:t,cellAcls:n.getAcls(),excludes:[t.user.id],sendInvitations:r,onUserObjectAdd:n.addUser.bind(n),onUserObjectRemove:n.removeUser.bind(n),onUserObjectUpdateRight:n.updateUserRight.bind(n)})},{Label:o("35"),Value:"base",Component:Rt.createElement(Ze,{pydio:t,model:n})},{Label:o(253),Value:"permissions",AlwaysLast:!0,Component:Rt.createElement(Dt,{pydio:t,resourceType:"cell",description:o("cell.visibility.advanced"),resourceId:n.getUuid(),style:{margin:-10},skipTitle:!0,onSavePolicies:function(){},readonly:!1,cellAcls:n.getAcls()})}],right:[{Label:o(249),Value:"content",Component:Rt.createElement(Se,{pydio:t,model:n,mode:"edit"})}]};return Rt.createElement(jt,{pydio:t,tabs:i,header:Rt.createElement("div",{style:{fontSize:22,lineHeight:"26px",padding:6}},n.getLabel()),editorOneColumn:this.props.editorOneColumn,saveEnabled:n.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){n.revertChanges()}})}}],r&&xt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Rt.Component);Ct(At,"childContextTypes",{messages:s().object,getMessage:s().func,isReadonly:s().func});const It=require("pydio/http/resources-manager");var Ut=n.n(It);function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function Bt(){return Bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bt.apply(null,arguments)}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ft(r.key),r)}}function Ft(e){var t=function(e){if("object"!=Nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nt(t)?t:t+""}function Ht(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ht=function(){return!!e})()}function zt(e){return zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zt(e)}function Vt(e,t){return Vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vt(e,t)}var Wt=c().requireLib("boot").moment,Yt=c().requireLib("components"),Gt=Yt.GenericCard,Xt=Yt.GenericLine,Qt=Yt.Mui3CardLine,Kt=Yt.QuotaUsageLine,Jt=Yt.SharedUsersStack,$t=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=zt(t),function(e,t){if(t&&("object"==Nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ht()?Reflect.construct(t,n||[],zt(e).constructor):t.apply(e,n))}(this,t,[e])).state={edit:!1,model:new(_e()),loading:!0},n._observer=function(){n.forceUpdate()},Ut().loadClass("PydioActivityStreams").then((function(e){n.setState({asLib:e})})),Ut().loadClass("PydioCoreActions").then((function(e){n.setState({coreActionsLib:e})}));var r=n.props.rootNode;return r&&(r.getMetadata().has("virtual_root")?r.isLoaded()?(n.state.rootNodes=[],r.getChildren().forEach((function(e){return n.state.rootNodes.push(e)}))):(r.observe("loaded",(function(){var e=[];r.getChildren().forEach((function(t){return e.push(t)})),n.setState({rootNodes:e})})),r.load()):n.state.rootNodes=[r]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vt(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.pydio,r=t.cellId;n.user.activeRepository===r?n.user.getActiveRepositoryAsCell().then((function(t){t?(e.setState({model:t,loading:!1}),t.observe("update",e._observer)):e.setState({loading:!1})})):(this.state.model.observe("update",(function(){e.setState({loading:!1}),e.forceUpdate()})),this.state.model.load(this.props.cellId))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update",this._observer)}},{key:"usersInvitations",value:function(e){Ne.sendCellInvitation(this.props.node,this.state.model,e)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.mode,a=n.pydio,s=n.editorOneColumn,l=n.genericFlex,c=n.muiTheme,p=this.state,f=p.edit,d=p.model,y=p.asLib,m=p.coreActionsLib,h=p.rootNodes,b=p.loading,g=function(e){return a.MessageHash["share_center."+e]},v={width:400,minHeight:270};if(f)v=s?{width:400,height:500}:{width:700,height:500},e=i().createElement(At,Bt({},this.props,{model:d,sendInvitations:this.usersInvitations.bind(this),editorOneColumn:s}));else if(d){var w,O,E,P=d.getRootNodes().map((function(e){return d.getNodeLabelInContext(e)})).join(", ");P||(P=d.getRootNodes().length+" item(s)"),"infoPanel"!==r&&(E=[],d.getUuid()!==a.user.activeRepository&&E.push(i().createElement(u.MenuItem,{primaryText:g(246),onClick:function(){a.triggerRepositoryChange(d.getUuid()),t.props.onDismiss()}})),d.isEditable()&&(w=function(){d.deleteCell().then((function(e){t.props.onDismiss()}))},O=function(){t.setState({edit:!0}),t.props.onHeightChange&&t.props.onHeightChange(500)},E.push(i().createElement(u.MenuItem,{primaryText:g(247),onClick:function(){return t.setState({edit:!0})}})),E.push(i().createElement(u.MenuItem,{primaryText:g(248),onClick:w}))));var k,j,S,x=[],_=[],L=[];if(h&&!b){h.forEach((function(e){e.getMetadata().get("ws_quota")&&L.push(i().createElement(Kt,{mui3:"infoPanel"!==r,node:e}))})),h.length>1?_.push(a.MessageHash["share_center.cell.folder-root.multiple"].replace("%d",h.length)):_.push(a.MessageHash["share_center.cell.folder-root.single"]);var M=Object.keys(d.getAcls()).length;M>1?_.push(a.MessageHash["share_center.cell.participant.multiple"].replace("%d",M)):_.push(a.MessageHash["share_center.cell.participant.single"]),x.push(_.join(", "))}if(!b&&d.cell&&d.cell.AccessEnd){var C=new Date(1e3*parseInt(d.cell.AccessEnd)),T=C<new Date;S=i().createElement(Xt,{iconClassName:T?"mdi mdi-alert-outline":"mdi mdi-calendar",iconStyle:T?{color:"var(--md-sys-color-error)"}:{},legend:g(T?"21b":"21"),data:Wt(C).calendar()}),x.push(g(T?"21b":"21")+" "+Wt(C).calendar())}if(y&&m&&h&&!b){var R,D=y.WatchSelector,A=y.WatchSelectorMui3,I=m.BookmarkButton,U=m.MaskWsButton;R="mui3"===c.userTheme?i().createElement(A,{pydio:a,nodes:h,fullWidth:!1}):i().createElement(D,{pydio:a,nodes:h,fullWidth:!0}),k=i().createElement(Qt,{legend:a.MessageHash["meta.watch.selector.legend"+("mui3"===c.userTheme?".mui":"")],data:R,dataStyle:{marginTop:6}}),j=[i().createElement(U,{pydio:a,workspaceId:d.getUuid(),style:{width:40,height:40,padding:8},iconStyle:{color:"var(--md-sys-color-primary)"}}),i().createElement(I,{pydio:a,nodes:h,styles:{style:{width:40,height:40,padding:8},iconStyle:{color:"var(--md-sys-color-primary)"}}})]}if(e=i().createElement(Gt,{pydio:a,title:d.getLabel(),onDismissAction:this.props.onDismiss,otherActions:j,onDeleteAction:w,deleteTooltip:a.MessageHash["share_center.248"],onEditAction:O,editTooltip:a.MessageHash["share_center.247"],headerSmall:"infoPanel"===r,genericFlex:l,mui3:!0,topLeftAvatar:"infoPanel"!==r&&i().createElement(Jt,{size:40,acls:d.getAcls()})},"infoPanel"!==r&&i().createElement(o.Fragment,null,i().createElement(Qt,{legend:d.getDescription(),data:i().createElement("div",null,x.map((function(e){return i().createElement("div",null,e)})))}),k||i().createElement(Xt,{placeHolder:!0,placeHolderReady:!b})),"infoPanel"===r&&i().createElement(o.Fragment,null,!b&&i().createElement(Xt,{iconClassName:"mdi mdi-account-multiple",legend:"Participants",data:i().createElement(Jt,{size:30,acls:d.getAcls()})}),!b&&d.getDescription()&&i().createElement(Xt,{iconClassName:"mdi mdi-information",legend:g(145),data:d.getDescription()}),i().createElement(Xt,{iconClassName:"mdi mdi-folder-multiple-outline",legend:g(249),data:P,placeHolder:!0,placeHolderReady:!b}),S,L)),"infoPanel"===r)return e}return i().createElement("div",{style:v},e)}}])&&qt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);$t=(0,p.muiThemeable)()($t);const Zt=require("pydio/lang/observable");var en=n.n(Zt);const tn=require("pydio/util/pass");var nn=n.n(tn);function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function on(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cn(r.key),r)}}function an(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(an=function(){return!!e})()}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sn(e)}function ln(e,t){return ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ln(e,t)}function cn(e){var t=function(e){if("object"!=rn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rn(t)?t:t+""}var un=function(e){function t(){var e,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=function(e,t,n){return t=sn(t),function(e,t){if(t&&("object"==rn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,an()?Reflect.construct(t,n||[],sn(e).constructor):t.apply(e,n))}(this,t),n=e,o=void 0,(r=cn(r="dirty"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,e.link=new Re.RestShareLink,e.link.Permissions=[Re.RestShareLinkAccessType.constructFromObject("Preview"),Re.RestShareLinkAccessType.constructFromObject("Download")],e.link.Policies=[],e.link.PoliciesContextEditable=!0,e.link.RootNodes=[],e.ValidPassword=!0,e.loadError=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ln(e,t)}(t,e),n=t,(r=[{key:"hasError",value:function(){return this.loadError}},{key:"isEditable",value:function(){return this.link.PoliciesContextEditable}},{key:"isDirty",value:function(){return this.dirty}},{key:"getLinkUuid",value:function(){return this.link.Uuid}},{key:"getLink",value:function(){return this.link}},{key:"getPublicUrl",value:function(){return Ne.buildPublicUrl(c().getInstance(),this.link)}},{key:"updateLink",value:function(e){this.link=e,this.notifyDirty()}},{key:"notifyDirty",value:function(){this.dirty=!0,this.notify("update")}},{key:"revertChanges",value:function(){this.originalLink&&(this.link=this.clone(this.originalLink),this.dirty=!1,this.updatePassword=this.createPassword=null,this.ValidPassword=!0,this.notify("update"))}},{key:"hasPermission",value:function(e){return this.link.Permissions.filter((function(t){return t===e})).length>0}},{key:"isExpired",value:function(){return!!(this.link.MaxDownloads&&parseInt(this.link.CurrentDownloads)>=parseInt(this.link.MaxDownloads))||(this.link.AccessEnd,!1)}},{key:"load",value:function(e){var t=this;return new Re.ShareServiceApi(Te().getRestClient()).getShareLink(e).then((function(e){t.link=e,t.link.Permissions||(t.link.Permissions=[]),t.link.Policies||(t.link.Policies=[]),t.link.RootNodes||(t.link.RootNodes=[]),t.originalLink=t.clone(t.link),t.notify("update")})).catch((function(e){t.loadError=e,t.notify("update")}))}},{key:"setCreatePassword",value:function(e){var t=this;e?nn().checkPasswordStrength(e,(function(e,n){t.ValidPassword=e,t.ValidPasswordMessage=n})):this.ValidPassword=!0,this.createPassword=e,this.link.PasswordRequired=!0,this.notifyDirty()}},{key:"setUpdatePassword",value:function(e){var t=this;e?nn().checkPasswordStrength(e,(function(e,n){t.ValidPassword=e,t.ValidPasswordMessage=n})):this.ValidPassword=!0,this.updatePassword=e,this.notifyDirty()}},{key:"setCustomLink",value:function(e){this.customLink=e}},{key:"save",value:function(){var e=this;if(!this.ValidPassword)throw new Error(this.ValidPasswordMessage);var t=new Re.ShareServiceApi(Te().getRestClient()),n=new Re.RestPutShareLinkRequest;this.createPassword?(n.PasswordEnabled=!0,n.CreatePassword=this.createPassword):this.updatePassword?(n.PasswordEnabled=!0,this.link.PasswordRequired?n.UpdatePassword=this.updatePassword:n.CreatePassword=this.updatePassword):n.PasswordEnabled=this.link.PasswordRequired;var r=Ne.getAuthorizations();if(r.password_mandatory&&!n.PasswordEnabled)throw new Error(c().getMessages()["share_center.175"]);return parseInt(r.max_downloads)>0&&!parseInt(this.link.MaxDownloads)&&(this.link.MaxDownloads=""+parseInt(r.max_downloads),this.notify("update")),parseInt(r.max_expiration)>0&&!parseInt(this.link.AccessEnd)&&(this.link.AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(r.max_expiration)*60*24),this.notify("update")),this.customLink&&this.customLink!==this.link.LinkHash&&(n.UpdateCustomHash=this.customLink),n.ShareLink=this.link,t.putShareLink(n).then((function(t){e.link=t,e.dirty=!1,e.originalLink=e.clone(e.link),e.updatePassword=e.createPassword=e.customLink=null,e.ValidPassword=!0,e.notify("update"),e.notify("save")})).catch((function(e){var t=e.Detail||e.message||e;c().getInstance().UI.displayMessage("ERROR",t)}))}},{key:"deleteLink",value:function(e){var t=this;return new Re.ShareServiceApi(Te().getRestClient()).deleteShareLink(this.link.Uuid).then((function(n){t.link=e,t.dirty=!1,t.updatePassword=t.createPassword=t.customLink=null,t.notify("update"),t.notify("delete")})).catch((function(e){var t=e.Detail||e.message||e;pydio.UI.displayMessage("ERROR",t)}))}},{key:"clone",value:function(e){return Re.RestShareLink.constructFromObject(JSON.parse(JSON.stringify(e)))}}])&&on(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(en());function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gn(r.key),r)}}function dn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dn=function(){return!!e})()}function yn(){return yn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=mn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},yn.apply(null,arguments)}function mn(e){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mn(e)}function hn(e,t){return hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hn(e,t)}function bn(e,t,n){return(t=gn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gn(e){var t=function(e){if("object"!=pn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pn(t)?t:t+""}var vn=c().requireLib("boot").moment,wn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),bn(e=function(e,t,n){return t=mn(t),function(e,t){if(t&&("object"==pn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,dn()?Reflect.construct(t,n||[],mn(e).constructor):t.apply(e,n))}(this,t),"cells",void 0),bn(e,"links",void 0),bn(e,"edit",void 0),bn(e,"node",void 0),bn(e,"saving",void 0),e.cells=[],e.links=[],e.edit=n,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hn(e,t)}(t,e),n=t,r=[{key:"emptyLink",value:function(e){var t,n=this,r=new un,o=new Re.TreeNode,i=Ne.getAuthorizations();o.Uuid=e.getMetadata().get("uuid"),r.getLink().Label=e.getLabel(),r.getLink().Description=pydio.MessageHash["share_center.257"].replace("%s",vn(new Date).format("YYYY/MM/DD")),r.getLink().RootNodes.push(o);var a=[Re.RestShareLinkAccessType.constructFromObject("Download")];return e.isLeaf()?(t="pydio_unique_dl",Ne.nodeHasEditor(pydio,e).preview&&!i.max_downloads?(t="pydio_unique_strip",a.push(Re.RestShareLinkAccessType.constructFromObject("Preview"))):i.max_downloads>0&&(r.getLink().MaxDownloads=i.max_downloads)):(t="pydio_shared_folder",a.push(Re.RestShareLinkAccessType.constructFromObject("Preview"))),r.getLink().ViewTemplateName=t,r.getLink().Permissions=a,i.max_expiration&&(r.getLink().AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(i.max_expiration)*60*24)),r.observe("update",(function(){n.notify("update")})),r.observe("save",(function(){n.updateUnderlyingNode()})),r}},{key:"createEmptyCell",value:function(){var e=this,t=new(_e())(!0);t.setLabel(this.node.getLabel()),t.addRootNode(this.node),t.observe("update",(function(){e.notify("update")})),t.dirty=!1,this.cells.push(t),this.notify("update")}},{key:"addToExistingCell",value:function(e){var t=this,n=new(_e())(!0);n.observe("update",(function(){t.notify("update")})),n.load(e).then((function(){n.addRootNode(t.node)}));var r=this.cells.filter((function(e){return!e.getUuid()}));r.length&&this.removeNewCell(r[0]),this.cells.push(n)}},{key:"updateUnderlyingNode",value:function(){this.skipUpdateUnderlyingNode||c().getInstance().getContextHolder().requireNodeReload(this.node)}},{key:"deleteLink",value:function(e){var t=this;return e.deleteLink(this.emptyLink(this.node).getLink()).then((function(e){t.updateUnderlyingNode()}))}},{key:"getNode",value:function(){return this.node}},{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.node=e,this.cells=[],this.links=[],e.getMetadata().get("pydio_shares")&&JSON.parse(e.getMetadata().get("pydio_shares")).map((function(e){if(3===e.Scope){var n=new un;n.observe("update",(function(){t.notify("update")})),n.observe("save",(function(){t.updateUnderlyingNode()})),n.load(e.UUID),t.links.push(n)}else if(2===e.Scope){var r=new(_e());r.observe("update",(function(){t.notify("update")})),r.load(e.UUID),t.cells.push(r)}})),this.edit&&!this.links.length&&this.links.push(this.emptyLink(e)),this.edit&&this.canCreateCells()&&!this.cells.length&&this.createEmptyCell(),n&&this.node.observe("node_replaced",(function(){t.load(t.node,!1)}))}},{key:"loadUniqueLink",value:function(e,t){var n=this;this.node=t;var r=new un;return r.observe("update",(function(){n.notify("update")})),r.load(e),this.links.push(r),r}},{key:"canCreateCells",value:function(){if(!this.node)return!1;var e=Ne.getAuthorizations(),t=this.node.isLeaf();return t&&e.file_workspaces||!t&&e.folder_workspaces}},{key:"save",value:function(){var e=this;this.saving=!0,this.notify("update");var t=[];this.cells.map((function(e){e.isDirty()&&t.push(e.save())})),this.links.map((function(e){e.isDirty()&&t.push(e.save())})),Promise.all(t).then((function(){var t=e.node.getMetadata().get("uuid");e.cells=e.cells.filter((function(e){return e.hasRootNode(t)})),e.updateUnderlyingNode(),e.saving=!1})).catch((function(t){e.updateUnderlyingNode(),e.saving=!1}))}},{key:"deleteAll",value:function(){var e=this.node.getMetadata().get("uuid"),t=[];return this.cells.map((function(n){n.removeRootNode(e),t.push(n.save())})),this.links.map((function(e){t.push(e.deleteLink())})),Promise.all(t)}},{key:"removeNewCell",value:function(e){this.cells=this.cells.filter((function(t){return t!==e})),this.notify("update")}},{key:"revertChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cells=this.cells.filter((function(e){return e.getUuid()})),this.cells.map((function(e){e.isDirty()&&e.revertChanges()})),this.links.map((function(e){e.isDirty()&&e.revertChanges()})),!this.cells.length&&e&&this.canCreateCells()&&this.createEmptyCell(),this.notify("update")}},{key:"isDirty",value:function(){return!this.saving&&this.cells.filter((function(e){return e.isDirty()})).length||this.links.filter((function(e){return e.isDirty()})).length}},{key:"stopObserving",value:function(e){var n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.cells.map((function(e){e.stopObserving("update")})),this.links.map((function(e){e.stopObserving("update")})),(n=t,r=this,"function"==typeof(o=yn(mn(1&3?n.prototype:n),"stopObserving",r))?function(e){return o.apply(r,e)}:o)([e,i])}},{key:"getCells",value:function(){if(this.node){var e=this.node.getMetadata().get("uuid");return this.cells.filter((function(t){return t.hasRootNode(e)}))}return this.cells}},{key:"getLinks",value:function(){return this.links}}],r&&fn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(en());const On=require("qrcode.react");var En=n.n(On);const Pn=require("clipboard");var kn=n.n(Pn);const jn=require("pydio/util/path");var Sn=n.n(jn);const xn=require("pydio/util/lang");var _n=n.n(xn);function Ln(e){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(e)}function Mn(){return Mn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mn.apply(null,arguments)}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,In(r.key),r)}}function Tn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Tn=function(){return!!e})()}function Rn(e){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rn(e)}function Dn(e,t){return Dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dn(e,t)}function An(e,t,n){return(t=In(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function In(e){var t=function(e){if("object"!=Ln(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ln(t)?t:t+""}var Un=c().requireLib("hoc").ThemedModernStyles,Nn=c().requireLib("boot").Tooltip,Bn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),An(r=function(e,t,n){return t=Rn(t),function(e,t){if(t&&("object"==Ln(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Tn()?Reflect.construct(t,n||[],Rn(e).constructor):t.apply(e,n))}(this,t,[e]),"state",{editLink:!1,copyMessage:"",showQRCode:!1}),An(r,"toggleEditMode",(function(){var e=r.props,t=e.linkModel,n=e.pydio,o=e.getMessage,i=r.state,a=i.editLink,s=i.customLink;if(a&&s){var l=Ne.getAuthorizations();if(l.hash_min_length&&s.length<l.hash_min_length)return void n.UI.displayMessage("ERROR",o("223").replace("%s",l.hash_min_length));t.setCustomLink(s),t.save()}r.setState({editLink:!a,customLink:void 0})})),An(r,"changeLink",(function(e){var t=e.target.value;t=_n().computeStringSlug(t),r.setState({customLink:t})})),An(r,"clearCopyMessage",(function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(r),5e3)})),An(r,"attachClipboard",(function(){var e=r.props,t=e.linkModel,o=e.pydio,i=e.getMessage;r.detachClipboard(),r.copyButton.current&&(r._clip=new(kn())(r.copyButton.current,{text:function(e){return Ne.buildPublicUrl(o,t.getLink())}.bind(r)}),r._clip.on("success",function(){var e=this;this.setState({copyMessage:i("192")},(function(){return e.clearCopyMessage()}))}.bind(r)),r._clip.on("error",function(){var e,t=this;e=0===n.g.navigator.platform.indexOf("Mac")?i("144"):i("143"),this.publicLinkField.current.focus(),this.setState({copyMessage:e},(function(){return t.clearCopyMessage()}))}.bind(r)))})),An(r,"detachClipboard",(function(){r._clip&&r._clip.destroy()})),An(r,"openMailer",(function(){r.props.showMailer(r.props.linkModel)})),An(r,"toggleQRCode",(function(){r.setState({showQRCode:!r.state.showQRCode})})),r.copyButton=(0,o.createRef)(),r.publicLinkField=(0,o.createRef)(),Ut().loadClass("PydioActivityStreams").then((function(e){r.setState({asLib:e})})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dn(e,t)}(t,e),r=t,a=[{key:"componentDidUpdate",value:function(e,t){this.attachClipboard()}},{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"confirmDisable",value:function(){var e=this.props,t=e.onDisableLink,n=e.getMessage;confirm(n("dialog.link.confirm.remove"))&&t()}},{key:"render",value:function(){var e=this,t=this.props,n=t.linkModel,r=t.compositeModel,o=t.pydio,a=t.getMessage,s=t.muiTheme,l=Ne.buildPublicUrl(o,n.getLink()),c=Ne.getAuthorizations(),p=this.props.editAllowed&&c.editable_hash&&!this.props.isReadonly()&&n.isEditable(),f=this.state,d=f.editLink,y=f.customLink;if(d&&p){var m=void 0===y?n.getLink().LinkHash:y,h=void 0!==y&&y.length<c.hash_min_length,b=h&&s.palette.mui3&&s.palette.mui3.error;return i().createElement("div",null,i().createElement("div",{style:{display:"flex",alignItems:"center",padding:6,borderRadius:2}},i().createElement("span",{style:{fontSize:16,display:"inline-block",maxWidth:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},Sn().getDirname(l)+"/ "),i().createElement(u.TextField,{style:{flex:1,marginRight:10,marginLeft:10},autoFocus:!0,onChange:this.changeLink,value:m,errorText:h?" ":null}),i().createElement(oe,{mdiIcon:"check",callback:function(){return e.toggleEditMode()},disabled:h})),i().createElement("div",{style:{textAlign:"center",fontSize:13,paddingTop:10,color:b}},h?a("223").replace("%s",c.hash_min_length):a("194")))}var g,v=this.state,w=v.copyMessage,O=v.linkTooltip,E=v.asLib,P=[],k=this.props.muiTheme,j=i().createElement("div",{key:"copy",ref:this.copyButton,style:{position:"absolute",right:0,bottom:7,width:30,height:30,padding:4,backgroundColor:"transparent",fontSize:16,cursor:"pointer"},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},i().createElement(Nn,{label:w||a("191"),horizontalPosition:"left",verticalPosition:"bottom",show:O}),i().createElement("span",{className:"copy-link-button mdi mdi-content-copy",style:{color:k.palette.mui3.primary}}));if(this.props.showMailer&&P.push(i().createElement(oe,{key:"outline",callback:this.openMailer,mdiIcon:"email-outline",messageId:"45"})),p&&P.push(i().createElement(oe,{key:"pencil",callback:this.toggleEditMode,mdiIcon:"pencil",messageId:"193"})),Ne.qrcodeEnabled()&&P.push(i().createElement(oe,{key:"qrcode",callback:this.toggleQRCode,mdiIcon:"qrcode",messageId:"94"})),E){var S=E.WatchSelectorMui3;P.push(i().createElement(S,{animatedButton:!0,pydio:o,nodes:[r.getNode()],fullWidth:!1,readPermissionOnly:!n.hasPermission("Upload")}))}return this.props.onDisableLink&&P.push(i().createElement(oe,{key:"delete",destructive:!0,callback:function(){return e.confirmDisable()},mdiIcon:"link-off",messageId:"link.disable"})),P=P.length?i().createElement("div",{style:{display:"flex",marginTop:10}},i().createElement("span",{style:{flex:1}}),P,i().createElement("span",{style:{flex:1}})):null,g=this.state.showQRCode?i().createElement(u.Paper,{zDepth:1,style:{width:120,paddingTop:10,overflow:"hidden",margin:"0 auto",height:120,textAlign:"center"}},i().createElement(En(),{size:100,value:l,level:"Q"})):i().createElement(u.Paper,{zDepth:0,style:{width:120,overflow:"hidden",margin:"0 auto",height:0,textAlign:"center"}}),i().createElement("div",{className:"public-link-container"},i().createElement("div",{style:{marginTop:-8,position:"relative"}},i().createElement(u.TextField,Mn({floatingLabelText:a("link.floatingLabel"),floatingLabelFixed:!0,type:"text",name:"Link",ref:this.publicLinkField,value:l,onFocus:function(e){e.target.select()},fullWidth:!0},Un(k).textFieldV2)),j),P,g)}}],a&&Cn(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(i().Component);function qn(e){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qn(e)}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yn(r.key),r)}}function Hn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Hn=function(){return!!e})()}function zn(e){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zn(e)}function Vn(e,t){return Vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vn(e,t)}function Wn(e,t,n){return(t=Yn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yn(e){var t=function(e){if("object"!=qn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qn(t)?t:t+""}function Gn(e,t,n){var r,o=[];return t.hasPermission("Preview")&&o.push(n("72")),t.hasPermission("Download")&&o.push(n("73")),t.hasPermission("Upload")&&(e.getNode().isLeaf()?o.push(n("74b")):o.push(n("74"))),o.length&&(r=o.join(", ").toLowerCase()),{title:n("71"),legend:r}}An(Bn,"propTypes",{linkModel:s().instanceOf(un),editAllowed:s().bool,onChange:s().func,showMailer:s().func}),Bn=O(Bn=(0,p.muiThemeable)()(Bn));var Xn=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Wn(e=function(e,t,n){return t=zn(t),function(e,t){if(t&&("object"==qn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Hn()?Reflect.construct(t,n||[],zn(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"changePermission",(function(t){var n=t.target.name,r=t.target.checked,o=e.props,i=o.compositeModel,a=o.linkModel,s=a.getLink();if(r?s.Permissions.push(Re.RestShareLinkAccessType.constructFromObject(n)):s.Permissions=s.Permissions.filter((function(e){return e!==n})),i.getNode().isLeaf()){var l=Ne.getAuthorizations().max_downloads;a.hasPermission("Preview")?(s.ViewTemplateName="pydio_unique_strip",s.MaxDownloads=0):(s.ViewTemplateName="pydio_unique_dl",l&&!s.MaxDownloads&&(s.MaxDownloads=l))}e.props.linkModel.updateLink(s)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vn(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.linkModel,n=e.compositeModel,r=e.pydio,o=n.getNode(),a=[],s=Ne.getAuthorizations();if(o.isLeaf()){var l=Ne.nodeHasEditor(r,o),c=l.preview,p=l.writeable;a.push({NAME:"Download",LABEL:this.props.getMessage("73"),DISABLED:!c||!t.hasPermission("Preview")}),c&&!s.max_downloads&&(a.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Download")}),t.hasPermission("Preview")&&p&&a.push({NAME:"Upload",LABEL:this.props.getMessage("74b")}))}else a.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Upload")}),a.push({NAME:"Download",LABEL:this.props.getMessage("73")}),a.push({NAME:"Upload",LABEL:this.props.getMessage("74")});return i().createElement("div",null,a.map(function(e){return i().createElement(u.Checkbox,{key:e.NAME,disabled:e.DISABLED||this.props.isReadonly()||!t.isEditable(),type:"checkbox",name:e.NAME,label:e.LABEL,onCheck:this.changePermission,checked:t.hasPermission(e.NAME),labelStyle:{whiteSpace:"nowrap"},style:{margin:"10px 0"}})}.bind(this)),void 0)}}])&&Fn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);Wn(Xn,"propTypes",{linkModel:s().instanceOf(un),style:s().object}),Xn=O(Xn);const Qn=require("react-dom");var Kn=n.n(Qn);function Jn(e){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jn(e)}function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){er(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function er(e,t,n){return(t=or(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,or(r.key),r)}}function rr(e,t,n){return t&&nr(e.prototype,t),n&&nr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function or(e){var t=function(e){if("object"!=Jn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jn(t)?t:t+""}function ir(e,t,n){return t=sr(t),function(e,t){if(t&&("object"==Jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ar()?Reflect.construct(t,n||[],sr(e).constructor):t.apply(e,n))}function ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ar=function(){return!!e})()}function sr(e){return sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sr(e)}function lr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cr(e,t)}function cr(e,t){return cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},cr(e,t)}var ur=function(e){function t(e){var n;return tr(this,t),(n=ir(this,t,[e])).state={copyMessage:""},n}return lr(t,e),rr(t,[{key:"componentDidMount",value:function(){this._clip&&this._clip.destroy(),this._button&&(this._clip=new(kn())(this._button,{text:function(e){return this.props.link}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var e;e=0===n.g.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("share_center.143"),this.setState({copyMessage:e},this.clearCopyMessage)}.bind(this)))}},{key:"componentWillUnmount",value:function(){this._clip&&this._clip.destroy()}},{key:"clearCopyMessage",value:function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(this),5e3)}},{key:"render",value:function(){var e=this,t=this.props,n=t.targetUser,r=t.link;return i().createElement("div",{style:{display:"flex"}},i().createElement("div",{style:{flex:1}},n.Display,i().createElement(u.IconButton,{pydio:this.props.pydio,ref:function(t){e._button=Kn().findDOMNode(t)},iconClassName:"mdi mdi-link",tooltip:this.state.copyMessage||r,iconStyle:{fontSize:13,lineHeight:"17px"},style:{width:34,height:34,padding:6}})),i().createElement("div",{style:{width:40,textAlign:"center"}},n.DownloadCount))}}])}(i().Component),pr=function(e){function t(e,n){var r;return tr(this,t),(r=ir(this,t,[e,n])).state={open:!1},r}return lr(t,e),rr(t,[{key:"render",value:function(){var e,t=this,n=this.props.linkModel,r=n.getLink();r.TargetUsers&&(e=r.TargetUsers);var o=Object.keys(e).map((function(t){var r=n.getPublicUrl()+"?u="+t;return i().createElement(ur,{targetUser:e[t],link:r})}));if(!o.length)return null;var a={borderBottom:this.state.open?"1px solid #757575":"",color:"rgba(0, 0, 0, 0.36)"};return i().createElement("div",{style:{lineHeight:"34px",padding:"4px 10px 4px",fontSize:14,backgroundColor:"#fafafa",borderRadius:2}},i().createElement("div",{style:Zn({display:"flex"},a)},i().createElement("div",{style:{flex:1}},this.props.getMessage("245").replace("%s",o.length)," ",i().createElement("span",{className:"mdi mdi-chevron-"+(this.state.open?"up":"down"),style:{cursor:"pointer"},onClick:function(){t.setState({open:!t.state.open})}})),this.state.open&&i().createElement("div",{style:{width:40,textAlign:"center"}},"#DL")),this.state.open&&i().createElement("div",null,o))}}])}(i().Component);function fr(e){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(e)}function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){wr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mr(){return mr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mr.apply(null,arguments)}function hr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Or(r.key),r)}}function br(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(br=function(){return!!e})()}function gr(e){return gr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gr(e)}function vr(e,t){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vr(e,t)}function wr(e,t,n){return(t=Or(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Or(e){var t=function(e){if("object"!=fr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fr(t)?t:t+""}pr.propTypes={linkModel:s().instanceOf(un)},pr=O(pr),ur=O(ur);var Er=c().requireLib("form").ValidPassword,Pr=c().requireLib("hoc"),kr=Pr.ThemedContainers.Popover,jr=Pr.ModernTextField,Sr=Pr.ThemedModernStyles,xr=Pr.DatePicker,_r=c().requireLib("boot").moment,Lr={iconButton:{style:{width:40,height:40,padding:6},iconStyle:{color:"rgba(0,0,0,.5)",fontSize:20}},leftIcon:{margin:"0 16px 0 4px",color:"#757575"}},Mr=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return wr(e=function(e,t,n){return t=gr(t),function(e,t){if(t&&("object"==fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,br()?Reflect.construct(t,n||[],gr(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"state",{}),wr(e,"updateDLExpirationField",(function(t){var n=t.currentTarget.value;parseInt(n)<0&&(n=-parseInt(n));var r=e.props.linkModel,o=r.getLink();o.MaxDownloads=n,r.updateLink(o)})),wr(e,"updateDaysExpirationField",(function(t,n){n||(n=t.currentTarget.getValue());var r=e.props.linkModel,o=r.getLink();o.AccessEnd=n,r.updateLink(o)})),wr(e,"onDateChange",(function(t,n){var r=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate());e.updateDaysExpirationField(t,Math.floor(r/1e3)+"")})),wr(e,"resetPassword",(function(){var t=e.props.linkModel;t.setUpdatePassword(""),t.getLink().PasswordRequired=!1,t.notifyDirty()})),wr(e,"setUpdatingPassword",(function(t){nn().checkPasswordStrength(t,(function(n,r){e.setState({updatingPassword:t,updatingPasswordValid:n})}))})),wr(e,"changePassword",(function(){var t=e.props.linkModel,n=e.state.updatingPassword;t.setUpdatePassword(n),e.setState({pwPop:!1,updatingPassword:"",updatingPasswordValid:!1}),t.notifyDirty()})),wr(e,"updatePassword",(function(t,n){var r=e.props.linkModel;e.state.validPasswordStatus?e.setState({invalidPassword:null,invalid:!1},(function(){r.setUpdatePassword(t)})):e.setState({invalidPassword:t,invalid:!0})})),wr(e,"resetDownloads",(function(){if(window.confirm(e.props.getMessage("106"))){var t=e.props.linkModel;t.getLink().CurrentDownloads="0",t.notifyDirty()}})),wr(e,"resetExpiration",(function(){var t=e.props.linkModel;t.getLink().AccessEnd="0",t.notifyDirty()})),wr(e,"renderPasswordContainer",(function(){var t,n,r,o=e.props.linkModel,a=o.getLink(),s=Ne.getAuthorizations();return a.PasswordRequired?(e.props.isReadonly()||!o.isEditable()||s.password_mandatory||(n=i().createElement(u.IconButton,mr({iconClassName:"mdi mdi-close-circle",onClick:e.resetPassword,tooltip:e.props.getMessage("174")},Lr.iconButton))),!e.props.isReadonly()&&o.isEditable()&&(r=i().createElement("div",null,i().createElement(u.IconButton,mr({iconClassName:"mdi mdi-pencil",onClick:function(t){e.setState({pwPop:!0,pwAnchor:t.currentTarget})},tooltip:e.props.getMessage("181")},Lr.iconButton)),i().createElement(kr,{open:e.state.pwPop,anchorEl:e.state.pwAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){e.setState({pwPop:!1})}},i().createElement("div",{style:{width:380,padding:8}},i().createElement(Er,{name:"update",ref:"pwdUpdate",attributes:{label:e.props.getMessage("23")},value:e.state.updatingPassword?e.state.updatingPassword:"",onChange:function(t){e.setUpdatingPassword(t)},onValidStatusChange:function(t){return e.setState({updatingPasswordDiffer:!t})},variant:"v2"}),i().createElement("div",{style:{paddingTop:20,textAlign:"right"}},i().createElement(u.FlatButton,{label:c().getMessages()[54],onClick:function(){e.setState({pwPop:!1,updatingPassword:""})}}),i().createElement(u.FlatButton,{style:{minWidth:60},label:c().getMessages()[48],onClick:function(){e.changePassword()},disabled:!e.state.updatingPassword||!e.state.updatingPasswordValid||e.state.updatingPasswordDiffer})))))),t=i().createElement(jr,{floatingLabelText:e.props.getMessage("23"),disabled:!0,value:"********",fullWidth:!0,variant:"v2"})):!e.props.isReadonly()&&o.isEditable()&&(t=i().createElement(Er,{name:"share-password",ref:"pwd",attributes:{label:e.props.getMessage("23")},value:e.state.invalidPassword?e.state.invalidPassword:o.updatePassword,onChange:e.updatePassword.bind(e),onValidStatusChange:function(t){e.setState({validPasswordStatus:t})},variant:"v2"})),t?i().createElement("div",{className:"password-container",style:{display:"flex",alignItems:"baseline",width:"100%",position:"relative"}},i().createElement("div",{style:{width:"100%",display:"inline-block"}},t),(n||r)&&i().createElement("div",{style:{position:"absolute",right:0,bottom:0,display:"flex"}},r,n)):null})),wr(e,"formatDate",(function(t){return e.props.getMessage("date_format","").split(" ").shift().replace("Y",t.getFullYear()).replace("m",t.getMonth()+1).replace("d",t.getDate())})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vr(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e,t,n,r,o=this.props,a=o.linkModel,s=o.muiTheme,l=a.getLink(),c=this.renderPasswordContainer(),p=a.hasPermission("Download")&&!a.hasPermission("Preview")&&!a.hasPermission("Upload"),f=parseInt(l.MaxDownloads),d=parseInt(l.AccessEnd),y=!1,m=!1,h=new Date,b=Ne.getAuthorizations();if(parseInt(b.max_expiration)>0&&(n=new Date).setDate(h.getDate()+parseInt(b.max_expiration)),parseInt(b.max_downloads)>0&&(f=Math.max(1,Math.min(f,parseInt(b.max_downloads)))),d&&(d<0&&(y=!0),t=new Date(1e3*d),parseInt(b.max_expiration)||(e=i().createElement(u.IconButton,{iconStyle:Lr.iconButton.iconStyle,style:yr(yr({},Lr.iconButton.style),{},{position:"absolute",right:0,bottom:0,zIndex:1}),iconClassName:"mdi mdi-close-circle",onClick:this.resetExpiration.bind(this)}))),f){var g,v=parseInt(l.CurrentDownloads)||0;v&&(g=i().createElement("a",{style:{cursor:"pointer"},onClick:this.resetDownloads.bind(this),title:this.props.getMessage("17")},"(",this.props.getMessage("16"),")"),v>=f&&(m=!0)),r=i().createElement("span",{className:"dlCounterString"},v+"/"+f," ",g)}var w={fontSize:13,fontWeight:500,color:s.palette.mui3["on-surface-variant"]},O=Sr(s);return i().createElement("div",null,c,i().createElement("div",{style:{display:"flex",alignItems:"baseline",position:"relative"},className:y?"limit-block-expired":null},i().createElement(xr,mr({ref:"expirationDate",key:"start",value:t,minDate:new Date,maxDate:n,autoOk:!0,disabled:this.props.isReadonly()||!a.isEditable(),onChange:this.onDateChange,showYearSelector:!0,floatingLabelText:this.props.getMessage(y?"21b":"21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},O.textFieldV2,{style:{flex:1},textFieldStyle:yr(yr({},O.textFieldV2.style),{},{flex:1})})),e),i().createElement("div",{style:{alignItems:"baseline",display:p?"flex":"none",position:"relative"},className:m?"limit-block-expired":null},i().createElement(jr,{type:"number",disabled:this.props.isReadonly()||!a.isEditable(),floatingLabelText:this.props.getMessage(m?"22b":"22"),value:f>0?f:"",onChange:this.updateDLExpirationField,fullWidth:!0,style:{flex:1},variant:"v2"}),i().createElement("span",{style:yr({position:"absolute",right:10,top:14},w)},r)))}}])&&hr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function Cr(e){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cr(e)}function Tr(){return Tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tr.apply(null,arguments)}function Rr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(n),!0).forEach((function(t){Ar(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ar(e,t,n){return(t=Br(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Br(r.key),r)}}function Nr(e,t,n){return t&&Ur(e.prototype,t),n&&Ur(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Br(e){var t=function(e){if("object"!=Cr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Cr(t)?t:t+""}function qr(e,t,n){return t=Hr(t),function(e,t){if(t&&("object"==Cr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Fr()?Reflect.construct(t,n||[],Hr(e).constructor):t.apply(e,n))}function Fr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Fr=function(){return!!e})()}function Hr(e){return Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hr(e)}function zr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vr(e,t)}function Vr(e,t){return Vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vr(e,t)}wr(Mr,"propTypes",{linkModel:s().instanceOf(un).isRequired,style:s().object}),Mr=O((0,p.muiThemeable)()(Mr));var Wr=c().requireLib("form").ValidPassword,Yr=c().requireLib("hoc").ThemedModernStyles,Gr=function(e){function t(e){var n;return Ir(this,t),(n=qr(this,t,[e])).state={active:!!e.active},n}return zr(t,e),Nr(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,r=t.legend,o=t.children,a=this.state.active,s={title:{cursor:"pointer",fontSize:15,padding:16,paddingBottom:a?8:16,display:"flex",alignItems:"center",fontWeight:a?500:null},legend:{opacity:.4,fontSize:12,fontWeight:500,fontStyle:"italic"},content:{padding:"0 16px 8px"},chevron:{fontSize:24,color:"rgba(0,0,0,.3)",transition:"transform 250ms ease",transform:a?"rotate(90deg)":""}};return i().createElement(i().Fragment,null,i().createElement("div",{style:Dr({},s.title),onClick:function(){e.setState({active:!a})}},i().createElement("span",{style:{flex:1}},n,r&&i().createElement("span",{style:s.legend}," - ",r)),i().createElement("span",{className:"mdi mdi-chevron-right",style:s.chevron})),a&&i().createElement("div",{style:Dr({},s.content)},o))}}])}(i().Component),Xr=function(e){function t(){var e;Ir(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Ar(e=qr(this,t,[].concat(r)),"state",{showTemporaryPassword:!1,temporaryPassword:null,saving:!1}),Ar(e,"toggleLink",(function(){var t=e.props,n=t.linkModel;t.pydio,e.state.showTemporaryPassword?e.setState({showTemporaryPassword:!1,temporaryPassword:null}):!n.getLinkUuid()&&Ne.getAuthorizations().password_mandatory?e.setState({showTemporaryPassword:!0,temporaryPassword:""}):(e.setState({saving:!0}),n.getLinkUuid()?e.props.compositeModel.deleteLink(n).catch((function(){e.setState({saving:!1})})).then((function(){e.setState({saving:!1})})):n.save().catch((function(){e.setState({saving:!1})})).then((function(){e.setState({saving:!1})})))})),Ar(e,"updateTemporaryPassword",(function(t,n){void 0===t&&(t=n.currentTarget.getValue()),e.setState({temporaryPassword:t})})),Ar(e,"enableLinkWithPassword",(function(){var t=e.props.linkModel;if(e.state.temporaryPasswordState){t.setCreatePassword(e.state.temporaryPassword);try{t.save()}catch(t){e.props.pydio.UI.displayMessage("ERROR",t.message)}e.setState({showTemporaryPassword:!1,temporaryPassword:null})}else e.props.pydio.UI.displayMessage("ERROR","Invalid Password")})),e}return zr(t,e),Nr(t,[{key:"render",value:function(){var e,t,n,r=this,o=this.props,a=o.linkModel,s=o.pydio,l=o.compositeModel,c=o.toggleOnly,p=o.additionalPanes,f=o.muiTheme,d=this.state,y=d.showTemporaryPassword,m=d.temporaryPassword,h=d.saving,b=Ne.getAuthorizations(),g=l.getNode().isLeaf(),v=g&&b.file_public_link||!g&&b.folder_public_link,w={fontSize:13,fontWeight:500,color:f.palette.mui3["on-surface-variant"],padding:8,paddingTop:0};return a.getLinkUuid()?(this.props.isReadonly()||h||!a.isEditable()||!a.getLinkUuid()&&!v||(n=function(){return r.toggleLink()}),t=i().createElement(Bn,{pydio:s,linkModel:a,compositeModel:l,showMailer:this.props.showMailer,editAllowed:b.editable_hash&&a.isEditable(),onDisableLink:n,key:"public-link"}),e=[i().createElement(u.Divider,null),i().createElement(Gr,Gn(l,a,this.props.getMessage),i().createElement(Xn,{compositeModel:l,linkModel:a,pydio:s,key:"public-perm"}))],a.getLink().TargetUsers&&(e.push(i().createElement(u.Divider,null)),e.push(i().createElement(pr,{linkModel:a,pydio:s}))),e.push(i().createElement(u.Divider,null)),e.push(i().createElement(Gr,function(e,t,n){n("link.secure.title");var r,o,a=[],s=t.getLink();if(s.AccessEnd&&0!==parseInt(s.AccessEnd)){var l=new Date(1e3*parseInt(s.AccessEnd)),c=new Date,u=n("link.secure.expires");l<c&&(u=n("link.secure.expired"),r=i().createElement("span",{className:"mdi mdi-alert"})),a.push(u+" "+_r(l).fromNow())}return s.PasswordRequired&&a.push(n("link.secure.hasPassword")),s.MaxDownloads>0&&a.push(n("link.secure.maxdownloads").replace("%d",s.MaxDownloads)),a.length&&(o=i().createElement(i().Fragment,null,r,a.join(", "))),{title:n("link.secure.title"),legend:o}}(0,a,this.props.getMessage),i().createElement(Mr,{pydio:s,linkModel:a}))),p&&p.forEach((function(t){e.push(i().createElement(u.Divider,null)),e.push(i().createElement(Gr,{title:t.title,legend:t.legend},t.content))}))):t=y?i().createElement("div",null,i().createElement("div",{className:"section-legend",style:{marginTop:20}},this.props.getMessage("215")),i().createElement("div",{style:{width:"100%"}},i().createElement(Wr,{attributes:{label:this.props.getMessage("23")},value:m,onChange:this.updateTemporaryPassword.bind(this),onValidStatusChange:function(e){return r.setState({temporaryPasswordState:e})},variant:"v2"})),i().createElement("div",{style:{textAlign:"center",marginTop:20}},i().createElement(u.RaisedButton,{label:this.props.getMessage("92"),secondary:!0,onClick:this.enableLinkWithPassword.bind(this),disabled:!this.state.temporaryPasswordState}))):v?i().createElement("div",{style:w},this.props.getMessage("190")):i().createElement("div",{style:w},this.props.getMessage(g?"225":"226")),i().createElement("div",{style:this.props.style},!(a.getLinkUuid()||y)&&i().createElement("div",{style:{padding:16}},i().createElement(u.Toggle,Tr({disabled:this.props.isReadonly()||h||!a.isEditable()||!a.getLinkUuid()&&!v,onToggle:this.toggleLink,toggled:a.getLinkUuid()||y,label:this.props.getMessage("189")},Yr(f).toggleFieldV2))),h&&i().createElement("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"}},i().createElement(u.CircularProgress,null)),!c&&!h&&i().createElement("div",{style:{padding:16}},t),!c&&!h&&e)}}])}(i().Component);function Qr(e){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qr(e)}function Kr(){return Kr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kr.apply(null,arguments)}function Jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(n),!0).forEach((function(t){Zr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zr(e,t,n){return(t=to(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,to(r.key),r)}}function to(e){var t=function(e){if("object"!=Qr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Qr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qr(t)?t:t+""}function no(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(no=function(){return!!e})()}function ro(e){return ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ro(e)}function oo(e,t){return oo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oo(e,t)}Ar(Xr,"propTypes",{linkModel:s().instanceOf(un),compositeModel:s().instanceOf(wn),pydio:s().instanceOf(c()),authorizations:s().object,showMailer:s().func}),Xr=O((0,p.muiThemeable)()(Xr));var io=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=ro(t),function(e,t){if(t&&("object"==Qr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,no()?Reflect.construct(t,n||[],ro(e).constructor):t.apply(e,n))}(this,t,[e])).state={mailerData:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oo(e,t)}(t,e),n=t,r=[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.subject,r=e.message,o=(e.users,e.linkModel),i=e.templateId;if(e.templateData,n||i){if(Ne.forceMailerOldSchool()){var a=encodeURIComponent(n);return void(location.href="mailto:custom-email@domain.com?Subject="+a+"&Body="+r)}Ut().loadClass("PydioMailer").then((function(n){t.setState({mailerData:$r($r({},e),{},{enableIdentification:o&&o.getLink().TargetUsers,identifiedOnly:o&&o.getLink().RestrictToTargetUsers,crippleIdentificationKeys:!0}),MailerPanel:n.Pane})}))}else this.setState({mailerData:null})}},{key:"toggleMailerData",value:function(e){this.setState({mailerData:$r($r({},this.state.mailerData),e)})}},{key:"dismissMailer",value:function(){this.props.onDismiss()}},{key:"mailerProcessPost",value:function(e,t,n,r,o,i){var a=this.state.mailerData,s=a.crippleIdentificationKeys,l=a.identifiedOnly,c=a.linkModel,u=c.getLink();u.TargetUsers||(u.TargetUsers={}),u.RestrictToTargetUsers=l;var p={};Object.keys(t).forEach((function(e){var n=s?Math.random().toString(36).substring(7):e;u.TargetUsers[n]=Re.RestShareLinkTargetUser.constructFromObject({Display:t[e].getLabel(),DownloadCount:0}),p[n]=e})),c.updateLink(u),c.save().then((function(){var t=new e,o=c.getPublicUrl(),a=new RegExp(o,"g");Object.keys(p).forEach((function(e){var i=o+"?u="+e,s=r.replace(a,i);t.addTarget(p[e],n,s)})),t.post((function(e){i(e)}))}))}},{key:"getMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";return this.props.pydio.MessageHash[t+(t?".":"")+e]}},{key:"render",value:function(){var e=this.state,t=e.mailerData,n=e.MailerPanel;if(!t)return null;var r=this.props.muiTheme;return i().createElement(n,Kr({},t,{onDismiss:this.dismissMailer.bind(this),overlay:!0,className:"share-center-mailer",panelTitle:this.props.pydio.MessageHash["share_center.45"],additionalPaneTop:void 0,processPost:t.enableIdentification?this.mailerProcessPost.bind(this):null,style:{width:420,margin:"0 auto",background:r.palette.mui3["surface-3"]}}))}}],r&&eo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function ao(e){return ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ao(e)}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lo(r.key),r)}}function lo(e){var t=function(e){if("object"!=ao(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ao(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ao(t)?t:t+""}function co(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(co=function(){return!!e})()}function uo(e){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uo(e)}function po(e,t){return po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},po(e,t)}io=(0,p.muiThemeable)()(io);var fo=c().requireLib("hoc").ModernSelectField,yo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=uo(t),function(e,t){if(t&&("object"==ao(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,co()?Reflect.construct(t,n||[],uo(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&po(e,t)}(t,e),n=t,(r=[{key:"onDropDownChange",value:function(e,t,n){var r=this.props.linkModel;r.getLink().ViewTemplateName=n,r.notifyDirty()}},{key:"render",value:function(){var e,t=this.props,n=t.linkModel,r=t.hideTitle,o=t.muiTheme,a=n.getLink().ViewTemplateName,s=this.props.layoutData.map((function(t){return a&&t.LAYOUT_ELEMENT===a&&(e=t.LAYOUT_LABEL),a||e||(a=t.LAYOUT_ELEMENT,e=t.LAYOUT_LABEL),i().createElement(u.MenuItem,{key:t.LAYOUT_ELEMENT,value:t.LAYOUT_ELEMENT,primaryText:t.LAYOUT_LABEL})})),l={fontSize:13,fontWeight:500,color:o.palette.mui3["on-surface-variant"]};return i().createElement("div",{style:this.props.style},!r&&i().createElement("div",{style:l},this.props.getMessage("151")),i().createElement(fo,{variant:"v2",fullWidth:!0,value:a,onChange:this.onDropDownChange.bind(this),disabled:this.props.isReadonly()||this.props.readonly||!n.isEditable(),floatingLabelText:this.props.getMessage("151")},s))}}])&&so(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);yo.PropTypes={linkModel:s().instanceOf(un)};const mo=yo=O((0,p.muiThemeable)()(yo)),ho=require("pydio/http/policies");var bo=n.n(ho);function go(e){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},go(e)}function vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jo(r.key),r)}}function Oo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Oo=function(){return!!e})()}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Eo(e)}function Po(e,t){return Po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Po(e,t)}function ko(e,t,n){return(t=jo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jo(e){var t=function(e){if("object"!=go(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==go(t)?t:t+""}var So=c().requireLib("components").ResourcePoliciesPanel,xo=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return ko(e=function(e,t,n){return t=Eo(t),function(e,t){if(t&&("object"==go(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Oo()?Reflect.construct(t,n||[],Eo(e).constructor):t.apply(e,n))}(this,t,[].concat(r)),"onSavePolicies",(function(t){var n=e.props,r=n.linkModel,o=(n.pydio,r.getLink().UserLogin);bo().loadPolicies("user",o).then((function(n){if(n.length){var r=n[0].Resource,i=e.diffPolicies(n,t,r);bo().savePolicies("user",o,i)}}))})),ko(e,"diffPolicies",(function(e,t,n){var r=[];return e.map((function(e){var n=e.Action+"///"+e.Subject;t.remove[n]||r.push(e)})),Object.keys(t.add).map((function(e){var t=new Re.ServiceResourcePolicy,o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("///"),2),i=o[0],a=o[1];t.Resource=n,t.Effect=Re.ServiceResourcePolicyPolicyEffect.constructFromObject("allow"),t.Subject=a,t.Action=i,r.push(t)})),r})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Po(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.linkModel,n=e.pydio,r=[],o=t.getLink();r["user:"+o.UserLogin]=!0,r["subject:"+o.UserUuid]=!0;var a={READ:r,WRITE:r};return i().createElement("div",{style:this.props.style},t.getLink().Uuid&&i().createElement(So,{pydio:n,resourceType:"link",description:this.props.getMessage("link.visibility.advanced"),resourceId:o.Uuid,skipTitle:!0,onSavePolicies:this.onSavePolicies.bind(this),subjectsDisabled:a,subjectsHidden:r,readonly:this.props.isReadonly()||!t.isEditable(),ref:"policies"}))}}])&&wo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);xo.PropTypes={pydio:s().instanceOf(c()).isRequired,linkModel:s().instanceOf(un).isRequired};const _o=xo=O(xo);function Lo(e){return Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lo(e)}function Mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Co(r.key),r)}}function Co(e){var t=function(e){if("object"!=Lo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Lo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Lo(t)?t:t+""}function To(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(To=function(){return!!e})()}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ro(e)}function Do(e,t){return Do=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Do(e,t)}var Ao=c().requireLib("hoc").ModernTextField,Io=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=Ro(t),function(e,t){if(t&&("object"==Lo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,To()?Reflect.construct(t,n||[],Ro(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Do(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e,t=this.props,n=t.pydio,r=t.model,o=t.linkModel,a=t.style,s=t.showLayout,l=function(e){return n.MessageHash["share_center."+e]},c=o.getLink(),u=Ne.compileLayoutData(n,r);return s&&u.length>1&&(e=i().createElement(mo,{linkModel:o,pydio:n,layoutData:u,hideTitle:!0})),i().createElement("div",{style:a},i().createElement(Ao,{variant:"v2",floatingLabelText:l(265),value:c.Label,onChange:function(e,t){c.Label=t,o.updateLink(c)},fullWidth:!0}),i().createElement(Ao,{variant:"v2",floatingLabelText:l(266),value:c.Description,onChange:function(e,t){c.Description=t,o.updateLink(c)},fullWidth:!0}),e)}}])&&Mo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function Uo(e){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uo(e)}function No(){return No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},No.apply(null,arguments)}function Bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bo(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fo(e,t,n){return(t=zo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zo(r.key),r)}}function zo(e){var t=function(e){if("object"!=Uo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Uo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Uo(t)?t:t+""}function Vo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vo=function(){return!!e})()}function Wo(e){return Wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wo(e)}function Yo(e,t){return Yo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yo(e,t)}(Io=O(Io)).PropTypes={pydio:s().instanceOf(c()),linkModel:s().instanceOf(un)},n(217).requireLib("boot").ThemeModifier;var Go=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.editorOneColumn=!0,n=function(e,t,n){return t=Wo(t),function(e,t){if(t&&("object"==Uo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Vo()?Reflect.construct(t,n||[],Wo(e).constructor):t.apply(e,n))}(this,t,[e]);var r=new wn(!0);return r.skipUpdateUnderlyingNode=!0,n.state={mode:n.props.mode||"view",model:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yo(e,t)}(t,e),n=t,r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,r=t.linkUuid,o=t.onRemoveLink,i=this.state.model;i.observe("update",(function(){e.forceUpdate()})),i.loadUniqueLink(r,n).observeOnce("delete",(function(){o&&o()}))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"componentWillReceiveProps",value:function(e){e.LinkUuid&&e.LinkUuid!==this.props.LinkUuid&&this.state.model.loadUniqueLink(e.LinkUuid,e.node)}},{key:"linkInvitation",value:function(e){try{var t=Ne.prepareEmail(this.props.node,e);this.setState({mailerData:qo(qo({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){var e=this.state.model;try{e.getLinks().length&&e.getLinks()[0].save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){var e,t,n=this.props,r=n.node,o=n.pydio,a=n.editorOneColumn,s=this.state,l=s.model,c=s.mailerData,u=function(e){return o.MessageHash["share_center."+e]};l.getLinks().length&&(e=l.getLinks()[0]),t=e&&e.getLinkUuid()&&e.isEditable()?i().createElement("div",null,i().createElement(io,No({},c,{pydio:o,onDismiss:this.dismissMailer.bind(this)})),i().createElement(Io,{pydio:o,linkModel:e,model:l})):i().createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},i().createElement(io,No({},c,{pydio:o,onDismiss:this.dismissMailer.bind(this)})),u(256).replace("%s",r.getLabel()));var p={left:[],right:[],leftStyle:{padding:0}},f=l.getLinks();return e&&(p.left.push({Label:u(251),Value:"public-link",Component:i().createElement(Xr,{pydio:o,compositeModel:l,linkModel:f[0],showMailer:Ne.mailerSupported(o)?this.linkInvitation.bind(this):null})}),e.getLinkUuid()&&p.left.push({Label:u(253),Value:"link-visibility",Component:i().createElement(_o,{pydio:o,linkModel:f[0]}),AlwaysLast:!0})),i().createElement(jt,{tabs:p,pydio:o,header:t,saveEnabled:l.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){l.revertChanges()},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}}],r&&Ho(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function Xo(e){return Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xo(e)}function Qo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ko(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qo(Object(n),!0).forEach((function(t){Jo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jo(e,t,n){return(t=ei(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ei(r.key),r)}}function ei(e){var t=function(e){if("object"!=Xo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Xo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xo(t)?t:t+""}function ti(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ti=function(){return!!e})()}function ni(e){return ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ni(e)}function ri(e,t){return ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ri(e,t)}var oi=c().requireLib("hoc").ThemedContainers.Popover,ii=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t,n){return t=ni(t),function(e,t){if(t&&("object"==Xo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ti()?Reflect.construct(t,n||[],ni(e).constructor):t.apply(e,n))}(this,t,[e]);var r=null;return 0===e.compositeModel.getCells().length&&(r="NEWCELL"),n.state={edit:r},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ri(e,t)}(t,e),n=t,(r=[{key:"addToCellsMenuItems",value:function(e){var t,n,r,o=this,a=[],s=this.props,l=s.pydio,c=s.compositeModel,p=c.getCells().map((function(e){return e.getUuid()}));return 0===p.filter((function(e){return!e})).length&&(a.push(i().createElement(u.MenuItem,{primaryText:e("cell.add.new"),onClick:function(){o.setState({addMenuOpen:!1}),c.createEmptyCell()},leftIcon:i().createElement(u.FontIcon,{className:"icomoon-cells-full-plus"})})),t=!0),l.user.getRepositoriesList().forEach((function(e){"shared"===e.getOwner()&&-1===p.indexOf(e.getId())&&(a.push(i().createElement(u.MenuItem,{primaryText:e.getLabel(),onClick:function(){o.setState({addMenuOpen:!1}),c.addToExistingCell(e.getId())},leftIcon:i().createElement(u.FontIcon,{className:"icomoon-cells"})})),n=!0)})),n&&t?r=e("cell.add.existing-or-new"):n?r=e("cell.add.existing"):t&&(r=e("cell.add.new")),{addItems:a,addLabel:r}}},{key:"removeCurrentNodeFromCell",value:function(e){var t=this.props.compositeModel;0===t.getCells().filter((function(t){return t!==e})).length&&t.createEmptyCell(),e.removeRootNode(t.getNode().getMetadata().get("uuid"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.compositeModel,r=t.pydio,o=t.usersInvitations,a=t.muiTheme,s=(this.state.edit,function(e){return r.MessageHash["share_center."+e]}),l={fontSize:13,fontWeight:500,color:a.palette.mui3["on-surface-variant"],padding:8};if(n.getNode()&&!n.canCreateCells())return i().createElement("div",{style:l},s(n.getNode().isLeaf()?"227":"228"));var c=n.getCells().length>1,p=[];n.getCells().map((function(t){var n=i().createElement("div",{style:{margin:"0 -10px"}},i().createElement(de,{pydio:r,cellAcls:t.getAcls(),excludes:[r.user.id],onUserObjectAdd:t.addUser.bind(t),onUserObjectRemove:t.removeUser.bind(t),onUserObjectUpdateRight:t.updateUserRight.bind(t),sendInvitations:function(e){return o(e,t)},saveSelectionAsTeam:!1,withActionLinks:function(n){return t.isEditable()?[].concat(function(e){return function(e){if(Array.isArray(e))return $o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return $o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n),[i().createElement(oe,{mdiIcon:"delete-forever",destructive:!0,messageId:s("cells.remove.node"),tooltipPosition:"top-center",callback:function(){e.removeCurrentNodeFromCell(t)}})]):n},readonly:!t.isEditable(),completerStyle:{margin:"-6px 8px 16px"}}));c?p.push(i().createElement(Gr,{title:t.getLabel(),legend:t.getAclsSubjects()},n)):p.push(i().createElement("div",{style:{padding:16}},n)),p.push(i().createElement(u.Divider,null))})),p.pop();var f,d=this.addToCellsMenuItems(s),y=d.addItems,m=d.addLabel;if(y.length){var h=this.props.muiTheme;f=i().createElement("span",{id:"share-dialog-addtocell-menu"},i().createElement(u.FlatButton,{iconClassName:"icomoon-cells-full-plus",style:{width:"100%"},iconStyle:{color:h.palette.accent2Color},primary:!0,tooltip:s(263),label:m,tooltipPosition:"bottom-left",onClick:function(t){e.setState({addMenuOpen:!0,addMenuAnchor:t.currentTarget})}}),i().createElement(oi,{open:this.state.addMenuOpen,anchorEl:this.state.addMenuAnchor,onRequestClose:function(){e.setState({addMenuOpen:!1})},anchorOrigin:{horizontal:"left",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"bottom"}},i().createElement(u.Menu,{desktop:!0,listStyle:{paddingTop:0},width:250},i().createElement(u.Subheader,null,m),y)))}return i().createElement("div",{style:Ko(Ko({},this.props.style),{},{minHeight:300})},p,f&&i().createElement("div",{style:{position:"absolute",bottom:10,left:10}},f))}}])&&Zo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function ai(e){return ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ai(e)}function si(){return si=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},si.apply(null,arguments)}function li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?li(Object(n),!0).forEach((function(t){ui(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ui(e,t,n){return(t=fi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fi(r.key),r)}}function fi(e){var t=function(e){if("object"!=ai(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ai(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ai(t)?t:t+""}function di(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(di=function(){return!!e})()}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yi(e)}function mi(e,t){return mi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mi(e,t)}ii.PropTypes={pydio:s().instanceOf(c()),compositeModel:s().instanceOf(wn).isRequired,usersInvitations:s().func},ii=(0,p.muiThemeable)()(ii),n(217).requireLib("boot").ThemeModifier;var hi=c().requireLib("boot").Tooltip,bi=c().requireLib("components"),gi=bi.GenericCard,vi=bi.GenericLine,wi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=yi(t),function(e,t){if(t&&("object"==ai(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,di()?Reflect.construct(t,n||[],yi(e).constructor):t.apply(e,n))}(this,t,[e])).state={mode:n.props.mode||"view",model:new wn("edit"===n.props.mode)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mi(e,t)}(t,e),r=t,o=[{key:"confirmAndDismiss",value:function(){var e=this.state.model,t=this.props,n=t.pydio,r=t.onDismiss;e.isDirty()&&!confirm(n.MessageHash["share_center.dialog.close.confirm.unsaved"])||r()}},{key:"attachClipboard",value:function(){var e=this.props.pydio,t=function(t){return e.MessageHash["share_center."+t]},r=this.state.model;if(this.detachClipboard(),r.getLinks().length){var o=r.getLinks()[0];o.getLink()&&this.refs["copy-button"]&&(this._clip=new(kn())(this.refs["copy-button"],{text:function(t){return Ne.buildPublicUrl(e,o.getLink())}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copyMessage:t("192")},(function(){setTimeout((function(){e.setState({copyMessage:null})}),2500)}))}.bind(this)),this._clip.on("error",function(){var e,r=this;e=0===n.g.navigator.platform.indexOf("Mac")?t(144):t(143),this.setState({copyMessage:e},(function(){setTimeout((function(){r.setState({copyMessage:null})}),2500)}))}.bind(this)))}}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.node,r=t.mode;this.state.model.observe("update",(function(){e.forceUpdate()})),this.state.model.load(n,"infoPanel"===r),this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update"),this.detachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"componentWillReceiveProps",value:function(e){!e.node||e.node===this.props.node&&e.node.getMetadata("pydio_shares")===this.props.node.getMetadata("pydio_shares")||this.state.model.load(e.node,"infoPanel"===e.mode)}},{key:"usersInvitations",value:function(e,t){Ne.sendCellInvitation(this.props.node,t,e)}},{key:"linkInvitation",value:function(e){try{var t=Ne.prepareEmail(this.props.node,e);this.setState({mailerData:ci(ci({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){try{this.state.model.save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"deleteAllShares",value:function(){var e=this.props.pydio,t=this.state.model;e.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{dialogTitleId:"share_center.composite.deleteAll",message:e.MessageHash["share_center.255"],validCallback:function(){t.stopObserving("update"),t.deleteAll().then((function(e){t.updateUnderlyingNode()}))}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.mode,o=t.pydio,a=t.editorOneColumn,s=t.popoverPanel,l=t.popoverRequestClose,c=t.genericFlex,u=this.state,p=u.model,f=u.mailerData,d=u.linkTooltip,y=u.copyMessage,m=function(e){return o.MessageHash["share_center."+e]};if("edit"===r){var h,b=i().createElement("div",{style:{fontSize:20,padding:10,wordBreak:"break-word",lineHeight:"1.3em"}},i().createElement(io,si({},f,{pydio:o,onDismiss:this.dismissMailer.bind(this)})),n&&m(256).replace("%s",n.getLabel())+(p.isDirty()?" *":"")),g={left:[],right:[]},v=p.getCells().filter((function(e){return e.getUuid()}));h=v.length>1?m("254c").replace("%d",v.length):1===v.length?m("254d").replace("%s",v[0].getLabel()):m("254b"),g.right.push({Label:h,Value:"cells",Icon:"mdi mdi-account-multiple",Component:i().createElement(ii,{pydio:o,compositeModel:p,usersInvitations:this.usersInvitations.bind(this)})});var w,O=p.getLinks();if(O.length&&(w=O[0]),w){var E=[],P=!1;w.getLinkUuid()&&(P=!0,E.push(ci(ci({},(x=w,{title:m("265"),legend:x.getLink().Label})),{},{content:i().createElement(Io,{pydio:o,linkModel:O[0],model:p,showLayout:!0})})),O[0].isEditable()&&E.push({title:m("link.visibility.title"),content:i().createElement(_o,{pydio:o,linkModel:O[0],style:{margin:-10}})})),g.left.push({Label:m(121)+(P?" ("+m("link.active")+")":""),Value:"public-link",Icon:"mdi mdi-link",Component:i().createElement(Xr,{pydio:o,compositeModel:p,linkModel:O[0],showMailer:Ne.mailerSupported(o)?this.linkInvitation.bind(this):null,additionalPanes:E})})}var k=!O.filter((function(e){return e.getLinkUuid()})).length&&v.length>0?"cells":null;return i().createElement(jt,{tabs:g,defaultLeft:k,pydio:o,header:b,saveEnabled:p.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:function(){return e.confirmAndDismiss()},onRevertAction:function(){p.revertChanges(!0)},editorOneColumn:a,style:{width:"100%",height:null,flex:1,minHeight:350,fontSize:13}})}var j=[],S=[];p.getCells().map((function(e){S.push(e.getLabel())}));var x,_=p.getLinks();if(_.length){var L=_[0];if(L.hasError()){var M=L.hasError();j.push(i().createElement(vi,{iconClassName:"mdi mdi-alert-outline",legend:"Error",data:M.Detail||M.Msg||M}))}else if(L.getLink()&&L.getLink().LinkHash){var C=Ne.buildPublicUrl(o,L.getLink(),"infoPanel"===r);j.push(i().createElement(vi,{iconClassName:"mdi mdi-link",legend:m(121),style:{overflow:"visible"},dataStyle:{overflow:"visible"},data:i().createElement("div",{ref:"copy-button",style:{cursor:"pointer",position:"relative"},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},i().createElement(hi,{label:y||m(191),horizontalPosition:"left",verticalPosition:"top",show:d}),C)}))}}return S.length&&j.push(i().createElement(vi,{iconClassName:"mdi mdi-account-multiple",legend:m(254),data:S.join(", ")})),i().createElement(gi,{pydio:o,title:o.MessageHash["share_center.50"],onDismissAction:this.props.onDismiss,onDeleteAction:function(){l&&l(),e.deleteAllShares()},onEditAction:function(){l&&l(),o.Controller.fireAction("share-edit-shared")},editTooltip:o.MessageHash["share_center.125"],deleteTooltip:o.MessageHash["share_center.composite.deleteAll"],headerSmall:"infoPanel"===r,popoverPanel:s,popoverRequestClose:l,smallActionsBottom:"infoPanel"===r&&!s,genericFlex:c},j,!j.length&&i().createElement(vi,{placeHolder:!0}))}}],o&&pi(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(i().Component),Oi=["pydio","node","popoverPanel","popoverRequestClose"];function Ei(){return Ei=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ei.apply(null,arguments)}var Pi=c().requireLib("workspaces"),ki=Pi.InfoPanelCard,ji=Pi.MultiColumnContext,Si=function(e){var t=e.pydio,n=e.node,r=e.popoverPanel,a=e.popoverRequestClose,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Oi),l=((0,o.useContext)(ji)||{}).currentPin;return n.isRoot()?i().createElement(ki,Ei({popoverPanel:r,icon:"icomoon-cells",closedTitle:c().getMessages()["ajax_gui.infopanel.detailcard.cell-info"]},s),i().createElement("div",{style:{padding:0,height:l?"100%":null}},i().createElement($t,{cellId:t.user.activeRepository,pydio:t,mode:"infoPanel",popoverPanel:r,genericFlex:l}))):i().createElement(ki,Ei({popoverPanel:r,icon:"mdi mdi-share-variant-outline",closedTitle:c().getMessages()["share_center.50"]},s),i().createElement("div",{style:{padding:0,height:l?"100%":null}},i().createElement(wi,{node:n,pydio:t,mode:"infoPanel",popoverPanel:r,popoverRequestClose:a,genericFlex:l})))},xi=n(15),_i=n(171)({displayName:"CompositeDialog",mixins:[n(217).requireLib("boot").ActionDialogMixin],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogPadding:!1,dialogSize:"md+"}},propTypes:{pydio:s().instanceOf(c()).isRequired,selection:s().instanceOf(me()),readonly:s().bool},childContextTypes:{messages:s().object,getMessage:s().func,isReadonly:s().func},getChildContext:function(){var e=this,t=this.props.pydio.MessageHash;return{messages:t,getMessage:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return t[n+(n?".":"")+e]||e}catch(t){return e}},isReadonly:function(){return e.props.readonly}}},shouldComponentUpdate:function(e,t){return!!this.props.selection.getUniqueNode()},render:function(){var e,t=this.props,n=t.pydio,r=t.selection;return r.getUniqueNode()&&(e=r.getUniqueNode()),xi.createElement(wi,{editorOneColumn:!0,pydio:n,mode:"edit",node:e,onDismiss:this.props.onDismiss})}}),Li=n(171),Mi=n.n(Li);const Ci=require("pydio/model/node");var Ti=n.n(Ci);function Ri(e){return Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ri(e)}function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Di.apply(null,arguments)}function Ai(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ai(Object(n),!0).forEach((function(t){Ui(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ai(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ui(e,t,n){return(t=Fi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ni(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fi(r.key),r)}}function qi(e,t,n){return t&&Bi(e.prototype,t),n&&Bi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fi(e){var t=function(e){if("object"!=Ri(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ri(t)?t:t+""}function Hi(e,t,n){return t=Vi(t),function(e,t){if(t&&("object"==Ri(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,zi()?Reflect.construct(t,n||[],Vi(e).constructor):t.apply(e,n))}function zi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(zi=function(){return!!e})()}function Vi(e){return Vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vi(e)}function Wi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yi(e,t)}function Yi(e,t){return Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yi(e,t)}var Gi=c().requireLib("boot"),Xi=Gi.ActionDialogMixin,Qi=Gi.Loader,Ki=c().requireLib("components"),Ji=Ki.ModalAppBar,$i=Ki.EmptyStateView,Zi=c().requireLib("hoc").ModernTextField,ea=n(509).muiThemeable,ta=function(e){function t(){return Ni(this,t),Hi(this,t,arguments)}return Wi(t,e),qi(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.onChange,r=e.muiTheme,o=e.m,a={color:"#616161"},s={color:r.palette.accent1Color},l={marginRight:5};return i().createElement(u.Tabs,{style:{width:360},onChange:function(e){n(null,0,e)},value:t,tabItemContainerStyle:{background:"transparent"}},i().createElement(u.Tab,{label:i().createElement("span",null,i().createElement("span",{style:l,className:"mdi mdi-share-variant"}),o(243)),value:"LINKS",buttonStyle:"LINKS"===t?s:a}),i().createElement(u.Tab,{label:i().createElement("span",null,i().createElement("span",{style:l,className:"icomoon-cells"}),o(254)),value:"CELLS",buttonStyle:"CELLS"===t?s:a}))}}])}(i().Component);ta=ea()(ta);var na=function(e){function t(e){var n;return Ni(this,t),(n=Hi(this,t,[e])).state={resources:[],loading:!1,selectedModel:null,shareType:e.defaultShareType||"LINKS"},n}return Wi(t,e),qi(t,[{key:"getChildContext",value:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"share_center";try{return e[n+(n?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var e=this;this.setState({filter:""});var t=new Re.ShareServiceApi(Te().getRestClient()),n=new Re.RestListSharedResourcesRequest;n.ShareType=Re.ListSharedResourcesRequestListShareType.constructFromObject(this.state.shareType),this.props.subject?n.Subject=this.props.subject:n.OwnedBySubject=!0,this.setState({loading:!0}),t.listSharedResources(n).then((function(t){e.setState({resources:t.Resources||[],loading:!1})})).catch((function(){e.setState({loading:!1})}))}},{key:"getLongestPath",value:function(e){if(!e.AppearsIn)return{path:e.Path,basename:e.Path};var t={};e.AppearsIn.map((function(e){t[e.Path]=e}));var n=Object.keys(t);n.sort();var r=n[n.length-1],o=Sn().getBasename(r);return o||(o=t[r].WsLabel),{path:r,appearsIn:t[r],basename:o}}},{key:"goTo",value:function(e){var t=e.Path,n=e.WsLabel,r=e.WsUuid,o=t.split("/");o.shift();var i=new(Ti())(o.join("/"));i.getMetadata().set("repository_id",r),i.getMetadata().set("repository_label",n),this.props.pydio.goTo(i),this.props.onRequestClose()}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,r=t.resources,o=t.filter,a=void 0===o?"":o,s=this.props,l=s.pydio,c=s.style,p=function(e){return l.MessageHash["share_center."+e]};r.sort((function(e,t){var n=e.Node.Path,r=t.Node.Path;return n===r?0:n>r?1:-1}));var f=l.Registry.getFilesExtensions();return i().createElement("div",{style:Ii(Ii({},c),{},{display:"flex",flexDirection:"column",overflow:"hidden"})},i().createElement("div",{style:{backgroundColor:"#F5F5F5",borderBottom:"1px solid #EEEEEE",display:"flex",paddingRight:16,paddingTop:3}},i().createElement(ta,{m:p,value:this.state.shareType,onChange:function(t,n,r){e.setState({shareType:r},(function(){e.load()}))}}),i().createElement("span",{style:{flex:1}}),i().createElement("div",{style:{width:150}},i().createElement(Zi,{hintText:p("sharelist.quick-filter"),value:a,onChange:function(t,n){e.setState({filter:n})},fullWidth:!0}))),n&&i().createElement(Qi,{style:{height:400}}),!n&&0===r.length&&i().createElement($i,{pydio:l,iconClassName:"mdi mdi-share-variant",primaryTextId:p(131),style:{flex:1,height:400,padding:"90px 0",backgroundColor:"transparent"}}),!n&&r.length>0&&i().createElement(u.List,{style:{flex:1,minHeight:400,maxHeight:400,overflowY:"auto",paddingTop:0}},r.map((function(t){var n,r=e.getLongestPath(t.Node),o=r.appearsIn,i=r.basename;if(-1===i.indexOf("."))n="mdi mdi-folder";else{var a=Sn().getFileExtension(i);n=f.has(a)?"mdi mdi-"+f.get(a).fontIcon:"mdi mdi-file"}return t.Link&&t.Link.Label&&t.Link.Label!==i&&(i=t.Link.Label+" ("+i+")"),{primaryText:i,secondaryText:t.Link?p(251)+": "+t.Link.Description:p(284).replace("%s",t.Cells.length),icon:n,appearsIn:o}})).filter((function(e){return!a||-1!==e.primaryText.toLowerCase().indexOf(a.toLowerCase())})).map((function(t){var n=t.appearsIn,r=t.icon;return i().createElement(u.ListItem,{primaryText:t.primaryText,secondaryText:t.secondaryText,onClick:function(){n&&e.goTo(n)},disabled:!n,leftIcon:i().createElement(u.FontIcon,{className:r})})}))))}}])}(i().Component);na.childContextTypes={messages:s().object,getMessage:s().func,isReadonly:s().func};var ra=Mi()({displayName:"ShareViewModal",mixins:[Xi],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this;return i().createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},i().createElement(Ji,{title:this.props.pydio.MessageHash["share_center.98"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),i().createElement(na,Di({},this.props,{style:{width:"100%",flex:1},onRequestClose:function(){e.dismiss()}})))}}),oa=n(134),ia=n.n(oa),aa=n(783),sa=n.n(aa),la=n(709),ca=n.n(la),ua=n(958),pa=n.n(ua),fa=n(202),da=n.n(fa),ya=n(911),ma=n.n(ya),ha=n(598),ba={};ba.styleTagTransform=ma(),ba.setAttributes=pa(),ba.insert=ca().bind(null,"head"),ba.domAPI=sa(),ba.insertStyleElement=da(),ia()(ha.A,ba),ha.A&&ha.A.locals&&ha.A.locals,window.ShareDialog=r})();