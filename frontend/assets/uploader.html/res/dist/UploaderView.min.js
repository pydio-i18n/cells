(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t),e.d(t,{DropUploader:()=>he,TransfersList:()=>K});const r=require("react");var n=e.n(r);const o=require("pydio");var i=e.n(o);const a=require("material-ui");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(c=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var d=i().requireLib("hoc").ThemedContainers.Popover,y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=p(t),function(e,t){if(t&&("object"==l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,c()?Reflect.construct(t,r||[],p(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),r=t,o=[{key:"updateField",value:function(e,t){var r=this.props.configs;if("autostart"===e){var n=r.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send",!0);n=!n,r.updateOption("upload_auto_send",n,!0)}else if("autoclose"===e){var o=r.getOptionAsBool("DEFAULT_AUTO_CLOSE","upload_auto_close",!0);o=!o,r.updateOption("upload_auto_close",o,!0)}else if("existing"===e)r.updateOption("upload_existing",t.target.getSelectedValue());else if("show_processed"===e){var i=r.getOptionAsBool("UPLOAD_SHOW_PROCESSED","upload_show_processed",!1);i=!i,r.updateOption("upload_show_processed",i,!0)}this.setState({random:Math.random()})}},{key:"radioChange",value:function(e,t){this.props.configs.updateOption("upload_existing",t),this.setState({random:Math.random()})}},{key:"render",value:function(){var e=this,t=this.props.configs,r=i().getInstance(),o=t.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send"),l=t.getOptionAsBool("DEFAULT_AUTO_CLOSE","upload_auto_close"),s=t.getOption("DEFAULT_EXISTING","upload_existing");return n().createElement(d,{open:this.props.open,anchorEl:this.props.anchorEl,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(t){e.props.onDismiss(t)}},n().createElement("div",{style:{width:320,paddingBottom:6}},n().createElement(a.Subheader,null,r.MessageHash["html_uploader.options"]),n().createElement("div",{style:{padding:"0 16px",marginTop:-6}},n().createElement(a.Checkbox,{style:{margin:"8px 0"},checked:o,labelPosition:"right",onCheck:this.updateField.bind(this,"autostart"),label:r.MessageHash[337],labelStyle:{fontSize:14}}),n().createElement(a.Checkbox,{style:{margin:"8px 0"},checked:l,labelPosition:"right",onCheck:this.updateField.bind(this,"autoclose"),label:r.MessageHash[338],labelStyle:{fontSize:14}})),n().createElement(a.Subheader,null,r.MessageHash["html_uploader.options.existing"]),n().createElement("div",{style:{padding:16,fontSize:14,paddingTop:0}},n().createElement(a.RadioButtonGroup,{ref:"group",name:"shipSpeed",defaultSelected:s,onChange:this.radioChange.bind(this)},n().createElement(a.RadioButton,{value:"alert",label:r.MessageHash["html_uploader.options.existing.alert"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"rename-folders",label:r.MessageHash["html_uploader.options.existing.folders"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"rename",label:r.MessageHash["html_uploader.options.existing.merge"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"overwrite",label:r.MessageHash["html_uploader.options.existing.overwrite"]})))))}}],o&&s(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(n().Component);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function g(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=v(t),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,b()?Reflect.construct(t,r||[],v(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(t,e),r=t,o=[{key:"clear",value:function(e){var t=UploaderModel.Store.getInstance();switch(e){case"all":t.clearAll();break;case"loaded":t.clearStatus("loaded");break;case"error":t.clearStatus("error")}this.props.onDismiss()}},{key:"render",value:function(){var e=this,t=i().getMessages();return n().createElement(a.Popover,{open:this.props.open,anchorEl:this.props.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:function(t){e.props.onDismiss(t)}},n().createElement(a.Menu,{style:{width:146},desktop:!0},n().createElement(a.Subheader,{style:{lineHeight:"26px"}},t["html_uploader.clear-header"]),n().createElement(a.MenuItem,{primaryText:t["html_uploader.clear-finished"],onClick:function(){e.clear("loaded")}}),n().createElement(a.MenuItem,{primaryText:t["html_uploader.clear-failed"],onClick:function(){e.clear("error")}}),n().createElement(a.MenuItem,{primaryText:t["html_uploader.clear-all"],onClick:function(){e.clear("all")}})))}}],o&&m(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(n().Component);const S=require("pydio/util/path");var _=e.n(S);const E=require("pydio/lang/observable");function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function P(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function T(e){var t=function(e){if("object"!=k(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==k(t)?t:t+""}function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}var M=function(e){function t(e,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,r){return t=I(t),function(e,t){if(t&&("object"==k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,x()?Reflect.construct(t,r||[],I(e).constructor):t.apply(e,r))}(this,t))._status=t.StatusNew,n._type=e,n._id=Math.random(),n._errorMessage=null;var a=i().getInstance();return n._repositoryId=o?o.getRepositoryId():a.user.activeRepository,n._exists=!1,n._progress=0,n.children={folders:[],files:[],pg:{}},n._targetNode=r,o&&(n._parent=o,e===t.TypeFolder?o.children.folders.push(n):o.children.files.push(n)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(t,e),r=t,n=[{key:"getId",value:function(){return this._id}},{key:"getParent",value:function(){return this._parent}},{key:"getLabel",value:function(){return this._label&&this._label.normalize?this._label.normalize("NFC"):this._label}},{key:"updateTargetNode",value:function(e){this._targetNode=e}},{key:"getTargetNode",value:function(){return this._targetNode}},{key:"updateLabel",value:function(e){this._label=e,this.notify("update_label",e)}},{key:"getFullPath",value:function(){return this._parent.getFullPath()+"/"+this.getLabel()}},{key:"getProgress",value:function(){return this._progress}},{key:"setExists",value:function(){this._exists=!0}},{key:"getExists",value:function(){return this._exists}},{key:"getType",value:function(){return this._type}},{key:"getStatus",value:function(){return this._status}},{key:"setStatus",value:function(e){this._status=e,this.notify("status",e)}},{key:"updateRepositoryId",value:function(e){this._repositoryId=e}},{key:"getRepositoryId",value:function(){return this._repositoryId}},{key:"getErrorMessage",value:function(){return this._errorMessage||""}},{key:"onError",value:function(e){this._errorMessage=e,this.setStatus(t.StatusError)}},{key:"process",value:function(e){this._doProcess(e)}},{key:"abort",value:function(e){this._doAbort&&this._doAbort(e)}},{key:"pause",value:function(){if(this._doPause){var e=this._doPause();this.setStatus(e)}}},{key:"resume",value:function(){this._doResume&&(this._doResume(),this.setStatus(t.StatusLoading))}},{key:"addChild",value:function(e){var t=this;this.children.pg[e.getId()]=0,e.observe("progress",(function(r){t.children.pg[e.getId()]=r,t.recomputeProgress()})),this.notify("child_added")}},{key:"recomputeProgress",value:function(){var e=this,t=Object.keys(this.children.pg).map((function(t){return e.children.pg[t]}));if(t.length){var r=t.reduce((function(e,t){return e+t}));this._progress=r/t.length,this.notify("progress",this._progress)}}},{key:"removeChild",value:function(e){e.abort(),e.walk((function(e){e.abort()}),(function(){return!0}),t.TypeFile);var r=e.getId(),n=this.children.folders.indexOf(e),o=this.children.files.indexOf(e),i=!1;n>-1?(this.children.folders=LangUtils.arrayWithout(this.children.folders,n),i=!0):o>-1&&(this.children.files=LangUtils.arrayWithout(this.children.files,o),i=!0),i&&(e.stopObserving("progress"),delete this.children.pg[r],this.recomputeProgress(),this.notify("children"))}},{key:"getChildren",value:function(){return[].concat(P(this.children.folders),P(this.children.files))}},{key:"walk",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.TypeBoth,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return!1},i=!1;if(n===t.TypeBoth||n===t.TypeFile)for(var a=this.children.files,l=0;l<a.length;l++){if(o(a[l])){i=!0;break}r(a[l])&&e(a[l])}i||this.children.folders.forEach((function(i){n!==t.TypeFolder&&n!==t.TypeBoth||!r(i)||e(i),o(i)||i.walk(e,r,n,o)}))}},{key:"collectWithLimit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"both",n=[];return this.walk((function(e){n.push(e)}),t,r,(function(t){return n.length>=e})),n}}],n&&C(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(e.n(E)());M.StatusNew="new",M.StatusAnalyze="analyse",M.StatusFolders="folders",M.StatusLoading="loading",M.StatusLoaded="loaded",M.StatusError="error",M.StatusPause="pause",M.StatusCannotPause="cannot-pause",M.StatusMultiPause="multi-pause",M.TypeFolder="folder",M.TypeFile="file",M.TypeBoth="both";const B=require("material-ui/styles");function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t,r){return(t=L(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function L(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(N=function(){return!!e})()}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},q(e,t)}var W=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,r){return t=H(t),function(e,t){if(t&&("object"==D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,N()?Reflect.construct(t,r||[],H(e).constructor):t.apply(e,r))}(this,t,[e])).state={open:!1,showAll:!1,status:e.item.getStatus(),previewUrl:null,progress:e.item.getProgress()||0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(t,e),r=t,(o=[{key:"componentDidMount",value:function(){var e=this,t=this.props.item;if(this._pgObserver=function(t){e.setState({progress:t})},this._statusObserver=function(t){e.setState({status:t})},t.observe("progress",this._pgObserver),t.observe("status",this._statusObserver),t.observe("children",(function(){e.forceUpdate()})),t instanceof UploaderModel.UploadItem&&/\.(jpe?g|png|gif)$/i.test(t.getFile().name)){if(t.previewUrl)return void this.setState({previewUrl:t.previewUrl});var r=new FileReader;r.addEventListener("load",(function(){t.previewUrl=r.result,e.setState({previewUrl:r.result})}),!1),r.readAsDataURL(t.getFile())}}},{key:"componentWillUnmount",value:function(){var e=this.props.item;e.stopObserving("progress",this._pgObserver),e.stopObserving("status",this._statusObserver)}},{key:"remove",value:function(){var e=this.props.item;e.getParent()&&e.getParent().removeChild(e)}},{key:"abort",value:function(){this.props.item.abort()}},{key:"retry",value:function(){var e=this.props,t=e.item,r=e.store;t.setStatus(M.StatusNew),r.processNext()}},{key:"render",value:function(){var e,r,o,l,s,u,c=this,p=this.props,f=p.item,d=p.className,y=p.style,h=p.limit,m=p.level,g=p.extensions,b=p.store,v=p.muiTheme,w=this.state,O=w.open,S=w.showAll,E=w.progress,k=w.status,P=w.previewUrl,j=f.getChildren(),C=f instanceof UploaderModel.FolderItem,T=f instanceof UploaderModel.PartItem,x=f instanceof UploaderModel.Session,I=i().getMessages(),R={main:F(F({},y),{},{fontSize:14}),line:{paddingLeft:24*(m-1),display:"flex",alignItems:"center",paddingTop:m>1?10:16,paddingBottom:6,cursor:j.length?"pointer":"default",borderLeft:1===m?"3px solid transparent":""},secondaryLine:{color:v.palette.mui3["on-surface-variant"],display:"flex",alignItems:"center",fontSize:11},leftIcon:{display:"inline-block",width:50,textAlign:"center",fontSize:18},previewImage:{display:"inline-block",backgroundColor:"#eee",backgroundSize:"cover",height:32,width:32,borderRadius:"50%"},label:{fontSize:15,fontWeight:C?500:400,fontStyle:T?"italic":null,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},errMessage:{fontSize:11,flex:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pgBar:{position:"relative"},rightButton:{display:"inline-block",width:48,textAlign:"center",cursor:"pointer",fontSize:16},toggleIcon:{marginLeft:4}},B=[];if(j.length){if(O||x&&k!==M.StatusAnalyze){var D=S?j:j.slice(0,h);B=D.map((function(e){return n().createElement(t,{key:e.getId(),item:e,limit:h,level:m+1,extensions:g,store:b,muiTheme:v})})),j.length>D.length&&B.push(n().createElement("div",{style:F(F({},R.line),{},{cursor:"pointer",borderLeft:"",paddingLeft:20*m}),onClick:function(){c.setState({showAll:!0})}},n().createElement("span",{style:R.leftIcon,className:"mdi mdi-plus-box-outline"}),n().createElement("span",{style:{flex:1,fontStyle:"italic"}},I["html_uploader.list.show-more"].replace("%d",j.length-D.length))))}s=function(){c.setState({open:!O})},l=n().createElement("span",{onClick:s,style:R.toggleIcon,className:"mdi mdi-chevron-"+(O?"down":"right")})}if(C)e="mdi mdi-folder",r=n().createElement("span",{className:"mdi mdi-close-circle-outline",onClick:function(){c.remove()}}),100===E&&(u="#4caf50");else if(T)e="mdi mdi-package-up",100===E&&(u="#4caf50");else{e="mdi mdi-file";var A=_().getFileExtension(f.getFullPath());g.has(A)&&(e="mimefont mdi mdi-"+g.get(A).fontIcon),k===M.StatusLoading||k===M.StatusCannotPause||k===M.StatusMultiPause?r=n().createElement("span",{className:"mdi mdi-stop",onClick:function(){return c.abort()}}):k===M.StatusError?(u="#e53935",r=n().createElement("span",{className:"mdi mdi-restart",style:{color:"#e53935"},onClick:function(){c.retry()}})):(u="#4caf50",r=n().createElement("span",{className:"mdi mdi-close-circle-outline",onClick:function(){c.remove()}}))}var U,z=_().getBasename(f.getFullPath()),L=n().createElement(a.LinearProgress,{style:{backgroundColor:"#eeeeee",height:3},color:u,min:0,max:100,value:E,mode:"determinate"});if(x){if(k!==M.StatusAnalyze)return n().createElement("div",null,B);z=i().getMessages()["html_uploader.analyze.step"],L=null,s=null,l=null,r=n().createElement(a.CircularProgress,{size:16,thickness:2,style:{marginTop:1}})}o=P?n().createElement("span",{style:F(F({},R.leftIcon),{},{marginTop:-4,marginBottom:-5})},n().createElement("div",{style:F({background:"url("+P+")"},R.previewImage)})):n().createElement("span",{style:R.leftIcon},n().createElement("span",{className:e,style:{display:"block",width:R.previewImage.width,height:R.previewImage.height,lineHeight:R.previewImage.width+"px",backgroundColor:v.palette.mui3["mimefont-background"],borderRadius:"50%",marginLeft:8}}));var N=F({},R.secondaryLine),H=C?"dir":T?"part":"file";return"error"===k?(N.opacity=1,U=n().createElement("span",{style:R.errMessage,title:f.getErrorMessage()},f.getErrorMessage())):(U=I["html_uploader.status."+H+"."+k]||I["html_uploader.status."+k]||k,f.getSize&&(U=f.getHumanSize()+" - "+U),k===M.StatusAnalyze&&f.getAnalyzeStatus&&f.getAnalyzeStatus()&&(U+=" ("+f.getAnalyzeStatus()+")"),k===M.StatusLoading&&f.getRetry&&f.getRetry()>0&&(U+=" ("+I["html_uploader.attempt"]+" "+(1+f.getRetry())+")")),n().createElement("div",{style:R.main,className:"upload-"+k+" "+(d||"")},n().createElement("div",{style:R.line},o,n().createElement("div",{style:{flex:1,overflow:"hidden",paddingLeft:4}},n().createElement("div",{onClick:s,style:R.label},z," ",l),n().createElement("div",{style:N},U),n().createElement("div",{style:R.pgBar},L)),n().createElement("span",{style:R.rightButton},r)),B)}}])&&z(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(n().Component);const V=require("pydio/util/dom");var G=e.n(V);function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X(n.key),n)}}function X(e){var t=function(e){if("object"!=$(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$(t)?t:t+""}function Y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Y=function(){return!!e})()}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},J(e,t)}var K=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=Z(t),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Y()?Reflect.construct(t,r||[],Z(e).constructor):t.apply(e,r))}(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J(e,t)}(t,e),r=t,(o=[{key:"render",value:function(){var e,t=this.props,r=t.sessions,o=t.store,a=t.muiTheme,l=t.onPickFile,s=t.onPickFolder,u=G().getBeziersTransition().replace("all ","color "),c=i().getMessages();if(r){var p=!0,f=i().getInstance().Registry.getFilesExtensions(),d=r.map((function(e){return e.getChildren().length&&(p=!1),n().createElement(W,{item:e,store:o,style:{},limit:10,level:0,extensions:f,muiTheme:a})}));p||(e=n().createElement("div",{style:{height:"100%",overflowY:"auto",padding:10,paddingBottom:20}},d))}var y=n().createElement("div",{style:{display:"flex",alignItems:"center",height:"100%",width:"100%",transition:u},className:"drop-transfer-list"},n().createElement("div",{style:{textAlign:"center",width:"100%",fontWeight:500,fontSize:18,padding:24,lineHeight:"28px"}},n().createElement("div",{className:"mdi mdi-cloud-upload",style:{fontSize:110}}),n().createElement("div",null,c["html_uploader.drophere"]," ",c["html_uploader.drop-or"]," ",n().createElement("a",{onClick:l},c["html_uploader.drop-pick-file"]),s&&n().createElement("span",null," ",c["html_uploader.drop-or"]," ",n().createElement("a",{onClick:s},c["html_uploader.drop-pick-folder"])))),n().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n            .drop-transfer-list{\n                color:rgba(3, 169, 244, 0.5);\n            }\n            .transparent-dropzone.active .drop-transfer-list{\n                color:rgba(3, 169, 244, 0.8);\n            }\n            .drop-transfer-list a,.drop-transfer-list a:hover {\n                color:rgba(3, 169, 244, 1);\n                cursor: pointer;\n            }\n        "}}));return n().createElement("div",{style:{display:"flex",height:"calc(100% - 10px)",margin:10,overflow:"hidden",borderRadius:a.borderRadius,backgroundColor:a.palette.mui3.surface}},n().createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"}},y),e&&n().createElement("div",{style:{width:420,minWidth:420,maxWidth:420}},e))}}])&&Q(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(n().Component);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,re(n.key),n)}}function re(e){var t=function(e){if("object"!=ee(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ee(t)?t:t+""}function ne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ne=function(){return!!e})()}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}function ie(e,t){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ie(e,t)}K=(0,B.muiThemeable)()(K);var ae=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,r){return t=oe(t),function(e,t){if(t&&("object"==ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ne()?Reflect.construct(t,r||[],oe(e).constructor):t.apply(e,r))}(this,t,[e])).state={value:"rename-folders",saveValue:!1},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ie(e,t)}(t,e),r=t,o=[{key:"cancel",value:function(){this.props.onCancel()}},{key:"submit",value:function(){var e=this.state,t=e.value,r=e.saveValue;this.props.onConfirm(t,r)}},{key:"checkChange",value:function(e,t){this.setState({saveValue:t})}},{key:"radioChange",value:function(e,t){this.setState({value:t})}},{key:"render",value:function(){var e=this,t=i().getInstance(),r=this.state,o=r.value,l=r.saveValue;return n().createElement(a.Dialog,{title:t.MessageHash[124],actions:[n().createElement(a.FlatButton,{label:t.MessageHash[54],onClick:function(){return e.cancel()}}),n().createElement(a.FlatButton,{label:t.MessageHash[48],onClick:function(){return e.submit()},primary:!0})],modal:!0,open:!0,bodyStyle:{paddingBottom:0},contentStyle:{width:420,maxWidth:"100%",background:"var(--md-sys-color-surface-3)",borderRadius:20}},n().createElement("div",null,n().createElement(a.RadioButtonGroup,{ref:"group",name:"shipSpeed",defaultSelected:o,onChange:this.radioChange.bind(this)},n().createElement(a.RadioButton,{value:"rename-folders",label:t.MessageHash["html_uploader.confirm.rename.all"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"rename",label:t.MessageHash["html_uploader.confirm.rename.merge"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"overwrite",label:t.MessageHash["html_uploader.confirm.overwrite"]})),n().createElement("div",{style:{marginTop:30}},n().createElement(a.Checkbox,{label:t.MessageHash["html_uploader.confirm.save.choice"],checked:l,onCheck:function(t,r){return e.checkChange(t,r)}}))))}}],o&&te(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(n().Component);function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ue(n.key),n)}}function ue(e){var t=function(e){if("object"!=le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==le(t)?t:t+""}function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ce=function(){return!!e})()}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}var de=i().requireLib("hoc").dropProvider,ye=i().requireLib("form").FileDropZone,he=function(t){function r(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t=function(e,t,r){return t=pe(t),function(e,t){if(t&&("object"==le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ce()?Reflect.construct(t,r||[],pe(e).constructor):t.apply(e,r))}(this,r,[e]);var n=UploaderModel.Store.getInstance();return t._storeObserver=function(){t.setState({sessions:n.getSessions(),storeRunning:n.isRunning()})},n.observe("update",t._storeObserver),n.observe("auto_close",(function(){t.props.onDismiss&&t.props.onDismiss()})),t.state={showOptions:!1,configs:UploaderModel.Configs.getInstance(),sessions:n.getSessions(),storeRunning:n.isRunning(),confirmDialog:e.confirmDialog},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(r,t),o=r,l=[{key:"componentWillReceiveProps",value:function(e){e.confirmDialog!==this.state.confirmDialog&&this.setState({confirmDialog:e.confirmDialog})}},{key:"componentWillUnmount",value:function(){this._storeObserver&&(UploaderModel.Store.getInstance().stopObserving("update",this._storeObserver),UploaderModel.Store.getInstance().stopObserving("auto_close"))}},{key:"onDrop",value:function(e){var t=i().getInstance().getContextHolder().getContextNode();UploaderModel.Store.getInstance().handleDropEventResults(null,e,t)}},{key:"onFolderPicked",value:function(e){var t=i().getInstance().getContextHolder().getContextNode();UploaderModel.Store.getInstance().handleFolderPickerResult(e,t)}},{key:"start",value:function(e){e.preventDefault(),UploaderModel.Store.getInstance().resume()}},{key:"pause",value:function(e){UploaderModel.Store.getInstance().pause()}},{key:"openClear",value:function(e){e.preventDefault(),this.setState({showClear:!0,clearAnchorEl:e.currentTarget})}},{key:"toggleOptions",value:function(e){if(e){e.preventDefault&&e.preventDefault();var t=this.state.showOptions,r=void 0!==t&&t;this.setState({showOptions:!r,optionsAnchorEl:e.currentTarget})}else this.setState({showOptions:!1,optionsAnchorEl:null})}},{key:"openFilePicker",value:function(e){e.preventDefault(),this.refs.dropzone.open()}},{key:"openFolderPicker",value:function(e){e.preventDefault(),this.refs.dropzone.openFolderPicker()}},{key:"dialogSubmit",value:function(e,t){var r=this.state.configs;UploaderModel.Store.getInstance().getSessions().forEach((function(t){"confirm"===t.getStatus()&&t.prepare(e)})),t&&r.updateOption("upload_existing",e),this.setState({confirmDialog:!1}),i().getInstance().getController().fireAction("upload")}},{key:"dialogCancel",value:function(){var e=UploaderModel.Store.getInstance();e.getSessions().forEach((function(t){"confirm"===t.getStatus()&&e.removeSession(t)})),this.setState({confirmDialog:!1}),i().getInstance().getController().fireAction("upload")}},{key:"supportsFolder",value:function(){var t=!1,r=e.g.document.createElement("input");return r.setAttribute("type","file"),"webkitdirectory"in r&&(t=!0),r=null,t}},{key:"render",value:function(){var e=this,t=i().getInstance().MessageHash,r=this.props,o=r.showDismiss,l=r.onDismiss,s=this.props.connectDropTarget||function(e){return e},u=this.state,c=u.configs,p=u.showOptions,f=u.optionsAnchorEl,d=u.showClear,h=u.clearAnchorEl,m=u.sessions,g=(u.storeRunning,u.confirmDialog),b=UploaderModel.Store.getInstance(),v=!0;return m.forEach((function(e){e.getChildren().length&&(v=!1)})),s(n().createElement("div",{style:{position:"relative"}},n().createElement("div",{style:{position:"relative",display:"flex",alignItems:"center",paddingLeft:16,paddingRight:16,paddingTop:8,width:"100%"}},n().createElement("h3",{style:{marginBottom:16,display:"none"}},t["html_uploader.dialog.title"]),n().createElement(a.FlatButton,{icon:n().createElement(a.FontIcon,{style:{fontSize:16},className:"mdi mdi-play"}),label:t["html_uploader.start"],onClick:this.start.bind(this),disabled:b.isRunning()||!b.hasQueue()}),n().createElement(a.FlatButton,{icon:n().createElement(a.FontIcon,{style:{fontSize:16},className:"mdi mdi-pause"}),label:t["html_uploader.pause"],onClick:this.pause.bind(this),disabled:!b.isRunning()}),n().createElement(a.FlatButton,{icon:n().createElement(a.FontIcon,{style:{fontSize:16},className:"mdi mdi-delete"}),label:n().createElement("span",null,t["html_uploader.clear"],n().createElement("span",{className:"mdi mdi-menu-down"})),onClick:this.openClear.bind(this),disabled:v}),n().createElement("span",{style:{flex:1}}),n().createElement(a.FlatButton,{primary:!0,label:t["html_uploader.options"],onClick:this.toggleOptions.bind(this)}),o&&n().createElement(a.IconButton,{iconClassName:"mdi mdi-close",style:{padding:14},onClick:function(){return l()}})),n().createElement(ye,{className:"transparent-dropzone",ref:"dropzone",multiple:!0,enableFolders:!0,supportClick:!1,ignoreNativeDrop:!0,onDrop:this.onDrop.bind(this),onFolderPicked:this.onFolderPicked.bind(this),style:{width:"100%",height:420}},n().createElement(K,{sessions:m,autoStart:c.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send"),onDismiss:this.props.onDismiss,store:b,onPickFile:function(t){e.openFilePicker(t)},onPickFolder:this.supportsFolder()?function(t){e.openFolderPicker(t)}:null})),n().createElement(y,{configs:c,open:p,anchorEl:f,onDismiss:function(t){e.toggleOptions()}}),n().createElement(O,{configs:c,open:d,anchorEl:h,onDismiss:function(){e.setState({showClear:!1,clearAnchorEl:null})}}),g&&n().createElement(ae,{onConfirm:this.dialogSubmit.bind(this),onCancel:this.dialogCancel.bind(this)})))}}],l&&se(o.prototype,l),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,l}(n().Component);he=de(he),window.UploaderView=t})();